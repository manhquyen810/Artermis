import{a as pe}from"./chunk-7MKMUXV6.js";import{a as ce}from"./chunk-KVEPPZB4.js";import{a as ae,c as me,e as F}from"./chunk-DOLVNMRR.js";import{D as se}from"./chunk-RTOKZMYN.js";import{a as ie,b as re}from"./chunk-TECMX7AA.js";import{a as le}from"./chunk-2QXIMOEO.js";import{t as ee}from"./chunk-VZRSC3LP.js";import{A as z,B as J,C as K,J as Z,L as $,b as H,c as q,e as y,h as P,i as W,n as G,o as Q,s as Y,v as X}from"./chunk-WA5GEAJB.js";import{a as oe}from"./chunk-K3W6YFKH.js";import{Oc as M,kb as E}from"./chunk-Z4VHWOB5.js";import{a as ne}from"./chunk-U54OSGNH.js";import{c as te}from"./chunk-E2KBL4LX.js";import{Db as n,Dc as U,Ea as h,J as L,La as j,Ma as O,Mc as R,Na as N,Oc as p,P as V,Rc as A,Tb as S,Va as _,Y as w,Zb as d,dd as t,fd as B,gd as D,kc as u,oa as k,rd as I,s as v,sc as c,xc as l,yc as a,yd as C,z as b,zc as m,zd as f}from"./chunk-5LC5EQRR.js";var Ce=(o,s,e)=>r=>v(r.value).pipe(w(250),k(i=>e&&i===e?v(null):o.getCourseCompetencyTitles(s).pipe(b(x=>{let T=x.body;return i&&T.includes(i)?{titleUnique:{valid:!1}}:null}),V(()=>v(null))))),Ne=(()=>{class o{fb=h(Z);courseCompetencyService=h(pe);isEditMode=!1;isInConnectMode=!1;isInSingleLectureMode=!1;courseId;lecturesOfCourseWithLectureUnits=[];averageStudentScore;hasCancelButton;onCancel=new _;formSubmitted=new _;form;faTimes=M;faQuestionCircle=E;get titleControl(){return this.form.get("title")}get descriptionControl(){return this.form.get("description")}get softDueDateControl(){return this.form.get("softDueDate")}get optionalControl(){return this.form.get("optional")}updateDescriptionControl(e){this.descriptionControl?.setValue(e),this.descriptionControl?.markAsDirty()}initializeForm(){if(this.form)return;let e;this.isEditMode&&this.formData&&this.formData.title&&(e=this.formData.title),this.form=this.fb.nonNullable.group({title:[void 0,[y.required,y.maxLength(255)],[Ce(this.courseCompetencyService,this.courseId,e)]],description:[void 0,[y.maxLength(1e4)]],softDueDate:[void 0],taxonomy:[void 0],masteryThreshold:[F,[y.min(0),y.max(100)]],optional:[!1]})}cancelForm(){this.onCancel.emit()}get isSubmitPossible(){return!this.form.invalid}static \u0275fac=function(r){return new(r||o)};static \u0275cmp=S({type:o,selectors:[["ng-component"]],inputs:{isEditMode:"isEditMode",isInConnectMode:"isInConnectMode",isInSingleLectureMode:"isInSingleLectureMode",courseId:"courseId",lecturesOfCourseWithLectureUnits:"lecturesOfCourseWithLectureUnits",averageStudentScore:"averageStudentScore",hasCancelButton:"hasCancelButton"},outputs:{onCancel:"onCancel",formSubmitted:"formSubmitted"},decls:0,vars:0,template:function(r,i){},encapsulation:2})}return o})();var ue=o=>({max:o});function fe(o,s){if(o&1&&(t(0,`
                        `),m(1,"div",9),t(2,`
                    `)),o&2){let e=p(3);n(),u("jhiTranslate","artemisApp."+(e.courseCompetency==null?null:e.courseCompetency.type)+".create.titleRequiredValidationError")}}function xe(o,s){if(o&1&&(t(0,`
                        `),m(1,"div",10),t(2,`
                    `)),o&2){let e=p(3);n(),u("jhiTranslate","artemisApp."+(e.courseCompetency==null?null:e.courseCompetency.type)+".create.titleMaxLengthValidationError")("translateValues",I(2,ue,e.competencyValidators.TITLE_MAX))}}function ye(o,s){o&1&&(t(0,`
                        `),m(1,"div",11),t(2,`
                    `))}function he(o,s){if(o&1&&(t(0,`
                `),l(1,"div",8),t(2,`
                    `),d(3,fe,3,1)(4,xe,3,4)(5,ye,3,0),a(),t(6,`
            `)),o&2){let e=p(2);n(3),c(!(e.titleControl==null||e.titleControl.errors==null)&&e.titleControl.errors.required?3:-1),n(),c(!(e.titleControl==null||e.titleControl.errors==null)&&e.titleControl.errors.maxlength?4:-1),n(),c(!(e.titleControl==null||e.titleControl.errors==null)&&e.titleControl.errors.titleUnique?5:-1)}}function _e(o,s){if(o&1&&(t(0,`
        `),l(1,"div",1),t(2,`
            `),m(3,"label",6),t(4,`
            `),m(5,"input",7),C(6,"artemisTranslate"),t(7,`
            `),d(8,he,7,3),a(),t(9,`
    `)),o&2){let e=p();n(3),u("jhiTranslate","artemisApp."+(e.courseCompetency==null?null:e.courseCompetency.type)+".title"),n(2),u("placeholder",f(6,3,"artemisApp."+(e.courseCompetency==null?null:e.courseCompetency.type)+".create.titlePlaceholder")),n(3),c(e.titleControl!=null&&e.titleControl.invalid&&(e.titleControl!=null&&e.titleControl.dirty||e.titleControl!=null&&e.titleControl.touched)?8:-1)}}function Te(o,s){if(o&1&&(t(0,`
                        `),m(1,"div",10),t(2,`
                    `)),o&2){let e=p(3);n(),u("jhiTranslate","artemisApp."+(e.courseCompetency==null?null:e.courseCompetency.type)+".create.descriptionMaxLengthValidationError")("translateValues",I(2,ue,e.competencyValidators.DESCRIPTION_MAX))}}function ge(o,s){if(o&1&&(t(0,`
                `),l(1,"div",8),t(2,`
                    `),d(3,Te,3,4),a(),t(4,`
            `)),o&2){let e=p(2);n(3),c(!(e.descriptionControl==null||e.descriptionControl.errors==null)&&e.descriptionControl.errors.maxlength?3:-1)}}function ve(o,s){if(o&1){let e=U();t(0,`
        `),l(1,"div",1),t(2,`
            `),m(3,"label",12),t(4,`
            `),l(5,"jhi-markdown-editor-monaco",13),R("markdownChange",function(i){O(e);let x=p();return N(x.updateDescriptionControl(i))}),a(),t(6,`
            `),d(7,ge,5,1),a(),t(8,`
    `)}if(o&2){let e=p();n(5),u("markdown",e.descriptionControl==null?null:e.descriptionControl.value)("enableFileUpload",!1),n(2),c(e.descriptionControl!=null&&e.descriptionControl.invalid&&(e.descriptionControl!=null&&e.descriptionControl.dirty)?7:-1)}}function Se(o,s){if(o&1&&(t(0,`
                    `),l(1,"small"),t(2),C(3,"artemisTranslate"),a(),t(4,`
                `)),o&2){let e=p(2);n(2),D(" (",f(3,2,"artemisApp.courseCompetency.create.suggestedTaxonomy"),": ",e.suggestedTaxonomies.join(", "),") ")}}function De(o,s){if(o&1&&(t(0,`
        `),l(1,"div",1),t(2,`
            `),l(3,"label",14),t(4),C(5,"artemisTranslate"),d(6,Se,5,4),a(),t(7,`
            `),m(8,"jhi-taxonomy-select",15),t(9,`
        `),a(),t(10,`
    `)),o&2){let e=p();n(4),B(`
                `,f(5,3,"artemisApp.courseCompetency.taxonomy"),`
                `),n(2),c(e.suggestedTaxonomies!=null&&e.suggestedTaxonomies.length?6:-1),n(2),u("form",e.taxonomyControl)}}function Ee(o,s){if(o&1&&(t(0,`
                    `),l(1,"small"),t(2),C(3,"artemisTranslate"),a(),t(4,`
                `)),o&2){let e=p(2);n(2),D(" (",f(3,2,"artemisApp.courseCompetency.create.averageMastery"),": ",e.averageStudentScore,"%) ")}}function Me(o,s){if(o&1&&(t(0,`
        `),l(1,"div",1),t(2,`
            `),l(3,"label",16),t(4),C(5,"artemisTranslate"),d(6,Ee,5,4),a(),t(7,`
            `),m(8,"input",17),t(9,`
        `),a(),t(10,`
    `)),o&2){let e,r=p();n(4),D(`
                `,f(5,3,"artemisApp.courseCompetency.masteryThreshold"),": ",(e=r.masteryThresholdControl.value)!==null&&e!==void 0?e:r.DEFAULT_MASTERY_THRESHOLD,`%
                `),n(2),c(r.averageStudentScore?6:-1)}}var it=(()=>{class o{translateService=h(te);formData;isEditMode=!1;isInConnectMode=!1;isInSingleLectureMode=!1;lecturesOfCourseWithLectureUnits=[];averageStudentScore;form;courseCompetency;onTitleOrDescriptionChange=new _;competencyValidators=me;DateTimePickerType=ie;suggestedTaxonomies=[];faTimes=M;faQuestionCircle=E;DEFAULT_MASTERY_THRESHOLD=F;competencyTaxonomy=ae;get titleControl(){return this.form.get("title")}get descriptionControl(){return this.form.get("description")}get masteryThresholdControl(){return this.form.get("masteryThreshold")}get taxonomyControl(){return this.form.get("taxonomy")}updateDescriptionControl(e){this.descriptionControl?.setValue(e),this.descriptionControl?.markAsDirty()}ngOnInit(){L(this.titleControl.valueChanges,this.descriptionControl.valueChanges).subscribe(()=>this.suggestTaxonomies())}ngOnChanges(){this.isEditMode&&this.formData&&this.setFormValues(this.formData)}setFormValues(e){this.form.patchValue(e)}suggestTaxonomies(){this.suggestedTaxonomies=[];let e=this.titleControl?.value?.toLowerCase()??"",r=this.descriptionControl?.value?.toLowerCase()??"";for(let i in this.competencyTaxonomy){let x=this.translateService.instant("artemisApp.courseCompetency.keywords."+i).split(", "),T=this.translateService.instant("artemisApp.courseCompetency.taxonomies."+i);x.push(T),x.map(g=>g.toLowerCase()).some(g=>e.includes(g)||r.includes(g))&&this.suggestedTaxonomies.push(T)}}static \u0275fac=function(r){return new(r||o)};static \u0275cmp=S({type:o,selectors:[["jhi-common-course-competency-form"]],inputs:{formData:"formData",isEditMode:"isEditMode",isInConnectMode:"isInConnectMode",isInSingleLectureMode:"isInSingleLectureMode",lecturesOfCourseWithLectureUnits:"lecturesOfCourseWithLectureUnits",averageStudentScore:"averageStudentScore",form:"form",courseCompetency:"courseCompetency"},outputs:{onTitleOrDescriptionChange:"onTitleOrDescriptionChange"},features:[j],decls:23,vars:14,consts:[[3,"formGroup"],[1,"form-group"],["id","softDueDate","formControlName","softDueDate",3,"labelName","labelTooltip","pickerType"],["type","checkbox","id","optional","formControlName","optional",1,"form-check-input"],["for","optional",1,"form-control-label",3,"jhiTranslate"],[3,"text"],["for","title",3,"jhiTranslate"],["type","text","id","title","formControlName","title",1,"form-control",3,"placeholder"],[1,"alert","alert-danger"],[3,"jhiTranslate"],[3,"jhiTranslate","translateValues"],["jhiTranslate","artemisApp.courseCompetency.create.titleUniqueValidationError"],["for","description","jhiTranslate","artemisApp.courseCompetency.description"],["id","description",1,"markdown-preview",3,"markdownChange","markdown","enableFileUpload"],["for","taxonomy"],["selectId","taxonomy",3,"form"],["for","masteryThreshold"],["required","","type","number","name","masteryThreshold","id","masteryThreshold","min","1","max","100","formControlName","masteryThreshold",1,"form-control"]],template:function(r,i){r&1&&(l(0,"form",0),t(1,`
    `),d(2,_e,10,5)(3,ve,9,3),l(4,"div",1),t(5,`
        `),m(6,"jhi-date-time-picker",2),C(7,"artemisTranslate"),C(8,"artemisTranslate"),t(9,`
    `),a(),t(10,`
    `),d(11,De,11,5)(12,Me,11,5),l(13,"div",1),t(14,`
        `),m(15,"input",3),t(16,`
        `),m(17,"label",4),t(18,`
        `),m(19,"jhi-help-icon",5),t(20,`
    `),a(),t(21,`
`),a(),t(22,`
`)),r&2&&(u("formGroup",i.form),n(2),c(i.isInConnectMode?-1:2),n(),c(i.isInConnectMode?-1:3),n(3),A("labelName",f(7,10,"artemisApp."+(i.courseCompetency==null?null:i.courseCompetency.type)+".create.softDueDate")),A("labelTooltip",f(8,12,"artemisApp."+(i.courseCompetency==null?null:i.courseCompetency.type)+".create.softDueDateHint")),u("pickerType",i.DateTimePickerType.CALENDAR),n(5),c(i.isInConnectMode?-1:11),n(),c(i.isInConnectMode?-1:12),n(5),u("jhiTranslate","artemisApp."+(i.courseCompetency==null?null:i.courseCompetency.type)+".optional"),n(2),u("text","artemisApp."+(i.courseCompetency==null?null:i.courseCompetency.type)+".optionalDescription"))},dependencies:[ee,$,G,q,Q,H,P,W,K,J,z,Y,X,re,ce,se,le,ne,oe],styles:["tr[_ngcontent-%COMP%]:hover{background-color:#d3d3d3}"]})}return o})();export{Ne as a,it as b};
//# sourceMappingURL=chunk-GJB34RKX.js.map
