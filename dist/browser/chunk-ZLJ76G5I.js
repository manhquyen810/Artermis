import{f as m}from"./chunk-MLVGKM2P.js";import{a as l,b}from"./chunk-XBLNBTXN.js";import{a as y}from"./chunk-G3JOQOSD.js";import{a as u,b as o}from"./chunk-EELXLOHY.js";import{b as v}from"./chunk-R5BZWVRQ.js";import{L as p,O as d}from"./chunk-IOA4DPXY.js";import{Ea as c,ra as a,ya as h,z as s}from"./chunk-5LC5EQRR.js";var E=(()=>{class n{http=c(d);accountService=c(v);lectureUnitService=c(m);entityTitleService=c(b);resourceUrl="api/lecture/lectures";create(e){let t=this.convertLectureDatesFromClient(e);return this.http.post(this.resourceUrl,t,{observe:"response"}).pipe(s(r=>this.convertLectureResponseDatesFromServer(r)))}update(e){let t=this.convertLectureDatesFromClient(e);return this.http.put(this.resourceUrl,t,{observe:"response"}).pipe(s(r=>this.convertLectureResponseDatesFromServer(r)))}find(e){return this.http.get(`${this.resourceUrl}/${e}`,{observe:"response"}).pipe(s(t=>(this.convertLectureResponseDatesFromServer(t),this.setAccessRightsLecture(t.body),this.sendTitlesToEntityTitleService(t?.body),t)))}findWithDetails(e){return this.http.get(`${this.resourceUrl}/${e}/details`,{observe:"response"}).pipe(s(t=>(t.body&&t.body.posts===void 0&&(t.body.posts=[]),this.convertLectureResponseDatesFromServer(t),this.setAccessRightsLecture(t.body),this.sendTitlesToEntityTitleService(t?.body),t)))}findWithDetailsWithSlides(e){return this.http.get(`${this.resourceUrl}/${e}/details-with-slides`,{observe:"response"}).pipe(s(t=>(t.body&&t.body.posts===void 0&&(t.body.posts=[]),this.convertLectureResponseDatesFromServer(t),this.setAccessRightsLecture(t.body),this.sendTitlesToEntityTitleService(t?.body),t)))}query(e){let t=y(e);return this.http.get(this.resourceUrl,{params:t,observe:"response"}).pipe(s(r=>this.convertLectureArrayResponseDatesFromServer(r)),a(r=>r?.body?.forEach(this.sendTitlesToEntityTitleService.bind(this))))}findAllByCourseId(e,t=!1){let r=new p().set("withLectureUnits",t?"1":"0");return this.http.get(`api/lecture/courses/${e}/lectures`,{params:r,observe:"response"}).pipe(s(i=>this.convertLectureArrayResponseDatesFromServer(i)),s(i=>this.setAccessRightsLectureEntityArrayResponseType(i)),a(i=>i?.body?.forEach(this.sendTitlesToEntityTitleService.bind(this))))}findAllByCourseIdWithSlides(e){return this.http.get(`api/lecture/courses/${e}/lectures-with-slides`,{observe:"response"}).pipe(s(t=>this.convertLectureArrayResponseDatesFromServer(t)),s(t=>this.setAccessRightsLectureEntityArrayResponseType(t)),a(t=>t?.body?.forEach(this.sendTitlesToEntityTitleService.bind(this))))}ingestLecturesInPyris(e,t){let r=new p;return t!==void 0&&(r=r.set("lectureId",t.toString())),this.http.post(`api/lecture/courses/${e}/ingest`,null,{params:r,observe:"response"})}getIngestionState(e){return this.http.get(`api/iris/courses/${e}/lectures/ingestion-state`,{observe:"response"})}import(e,t){let r=new p().set("courseId",e);return this.http.post(`${this.resourceUrl}/import/${t}`,null,{params:r,observe:"response"}).pipe(s(i=>(this.convertLectureResponseDatesFromServer(i),this.setAccessRightsLecture(i.body),this.sendTitlesToEntityTitleService(i?.body),i)))}delete(e){return this.http.delete(`${this.resourceUrl}/${e}`,{observe:"response"})}convertLectureDatesFromClient(e){let t=Object.assign({},e,{startDate:u(e.startDate),endDate:u(e.endDate),visibleDate:u(e.visibleDate)});return t.lectureUnits&&(t.lectureUnits=this.lectureUnitService.convertLectureUnitArrayDatesFromClient(t.lectureUnits)),t.course&&(t.course.exercises=void 0,t.course.lectures=void 0),t}convertLectureResponseDatesFromServer(e){return e.body&&(e.body.startDate=o(e.body.startDate),e.body.endDate=o(e.body.endDate),e.body.visibleDate=o(e.body.visibleDate),e.body.lectureUnits&&(e.body.lectureUnits=this.lectureUnitService.convertLectureUnitArrayDatesFromServer(e.body.lectureUnits))),e}convertLectureArrayResponseDatesFromServer(e){return e.body&&e.body.map(t=>this.convertLectureDatesFromServer(t)),e}setAccessRightsLectureEntityArrayResponseType(e){return e.body&&e.body.forEach(t=>{this.setAccessRightsLecture(t)}),e}setAccessRightsLecture(e){return e&&e.course&&(this.accountService.setAccessRightsForCourse(e.course),e.isAtLeastEditor=e.course.isAtLeastEditor,e.isAtLeastInstructor=e.course.isAtLeastInstructor),e}convertLectureDatesFromServer(e){return e&&(e.startDate=o(e.startDate),e.endDate=o(e.endDate),e.visibleDate=o(e.visibleDate),e.lectureUnits&&(e.lectureUnits=this.lectureUnitService.convertLectureUnitArrayDatesFromServer(e.lectureUnits))),e}convertLectureArrayDatesFromServer(e){if(e)return e.map(t=>this.convertLectureDatesFromServer(t))}sendTitlesToEntityTitleService(e){this.entityTitleService.setTitle(l.LECTURE,[e?.id],e?.title)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();export{E as a};
//# sourceMappingURL=chunk-ZLJ76G5I.js.map
