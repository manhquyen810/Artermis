import{a as Wi}from"./chunk-4S5JQ74I.js";import{a as Ui}from"./chunk-PMLSEW7X.js";import{a as Li}from"./chunk-3MCREQ7G.js";import{a as Bi,b as ji}from"./chunk-PCAOW5RI.js";import{a as Ue}from"./chunk-VDG3BHQZ.js";import{a as Vi}from"./chunk-XHKY56WD.js";import"./chunk-57BCHYEO.js";import{a as Ri}from"./chunk-RZNOTHJ6.js";import"./chunk-NV4PYWIT.js";import{a as Ni,b as Di,c as Be}from"./chunk-MD6Z63OB.js";import{a as Oi}from"./chunk-SLVT6IA5.js";import"./chunk-FAFORKWV.js";import{b as Gi}from"./chunk-T4L3VFV2.js";import"./chunk-YSX3GO3R.js";import"./chunk-W3K7VYWC.js";import"./chunk-QU4DXSXD.js";import"./chunk-LTHMYHP7.js";import"./chunk-U4DJRHYQ.js";import{a as wi}from"./chunk-RYZEETVB.js";import{a as _t}from"./chunk-VTF2OQPK.js";import"./chunk-5AQXEKLE.js";import"./chunk-3JSWSN6W.js";import{l as Ii}from"./chunk-DXTZ4GAW.js";import{b as ki}from"./chunk-2UXGFGK3.js";import{b as Pi,d as ut,e as Fi,g as xt}from"./chunk-BDII35IB.js";import"./chunk-LARBQRTJ.js";import"./chunk-OTNXTVPX.js";import{c as Si,d as vi,e as Ei,f as yi,g as Ai}from"./chunk-F3NFBBHK.js";import"./chunk-Z2YUBN6N.js";import"./chunk-OTCBNILH.js";import"./chunk-PA7LJOOC.js";import"./chunk-AOI2U3YC.js";import"./chunk-USOMQCKZ.js";import{b as Ti}from"./chunk-6EYB5QBP.js";import{a as X}from"./chunk-W7RIOT23.js";import"./chunk-GERFCPB6.js";import"./chunk-VRAVBLUK.js";import{a as dt,d as Ve}from"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import"./chunk-2QXIMOEO.js";import"./chunk-JHBUBEY6.js";import{g as fi}from"./chunk-P2M2VQE3.js";import{d as Mi}from"./chunk-GXOKLIFX.js";import{b as Ci}from"./chunk-ZPITQMA6.js";import"./chunk-2CUFQLAH.js";import{a as gt}from"./chunk-DRMCDU75.js";import"./chunk-Z6NSEM73.js";import{d as _i}from"./chunk-AR57MWOI.js";import"./chunk-A5PTZAPN.js";import"./chunk-AU6UEH3U.js";import"./chunk-FGAONQTL.js";import"./chunk-HQ6UGNQX.js";import"./chunk-ZLJ76G5I.js";import"./chunk-MLVGKM2P.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import{d as hi,f as Te,l as bi}from"./chunk-CT44YL7Q.js";import"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import{D as $t,K as Z,P as Qt,j as Yt,u as le,v as Me}from"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import{B as zt,J as qt,K as oe,L as Kt,c as Ie,e as he,h as be,i as it,k as jt,m as we,n as nt,o as Lt,p as Ut,s as Wt,v as Ht,w as at,x as rt,z as st}from"./chunk-WA5GEAJB.js";import"./chunk-VK7JPHFE.js";import"./chunk-BNDLMKXK.js";import"./chunk-BQNBT6PW.js";import{B as xi,g as di,h as gi,p as ui}from"./chunk-5GXY5RYT.js";import{a as W}from"./chunk-K3W6YFKH.js";import{c as ee}from"./chunk-JXJXC4DZ.js";import{d as Y,f as pt}from"./chunk-EDXSOKK5.js";import"./chunk-R5BZWVRQ.js";import{p as Vt}from"./chunk-DID2YGL7.js";import{c as pi}from"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Ba as ti,J as Zt,Jc as ci,Na as ii,Qa as Ge,S as ei,Sa as ni,Y as lt,Zc as mt,d as Jt,ic as ct,j as De,jb as ai,kb as Oe,nc as li,tb as ri,ub as si,vb as Re,wb as oi,wd as mi}from"./chunk-Z4VHWOB5.js";import{a as ot}from"./chunk-XUCCGZJR.js";import{a as Xt}from"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as w}from"./chunk-U54OSGNH.js";import{f as Bt,h as tt}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import{c as Ne}from"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import{B as Ze,D as Ot,E as et,L as St,O as Rt,i as Gt,n as Je,t as Fe}from"./chunk-IOA4DPXY.js";import{Ad as $e,B as kt,Bd as Dt,Cc as N,Db as r,Dc as S,Ea as b,Ed as j,La as _e,Ma as C,Mc as u,N as Pt,Na as f,Oc as d,P as $,Pd as Qe,Qa as wt,Qd as Le,Rd as Xe,Sc as Q,Tb as k,Va as L,Vb as Mt,W as Ft,Xb as qe,Ya as ze,Za as G,Zb as x,_ as It,ab as v,cd as q,dd as e,ed as F,f as At,fd as se,gd as de,jc as Tt,kc as c,lc as je,ld as te,mc as Ke,md as J,nc as Pe,nd as ie,oc as Ye,pd as Ce,qd as fe,ra as O,rd as A,s as z,sc as h,sd as K,td as Nt,uc as R,vc as V,wb as re,wc as B,xc as s,ya as He,yc as o,yd as E,z as ke,zc as m,zd as P}from"./chunk-5LC5EQRR.js";import{a as me,b as pe,j as U}from"./chunk-3E746U5Y.js";var Se=function(i){return i.Always="ALWAYS",i.AfterDueDate="AFTER_DUE_DATE",i.Never="NEVER",i}(Se||{});var H=function(i){return i.Inactive="INACTIVE",i.Feedback="FEEDBACK",i.Graded="GRADED",i}(H||{});var ve=(()=>{class i{tableFiltered=!1;ngxColors={name:"programming grading",selectable:!0,group:Pi.Ordinal,domain:[]};xAxisFormatting=ki;static RESET_TABLE=-5;resetTableFilter(){this.tableFiltered=!1}static \u0275fac=function(a){return new(a||i)};static \u0275dir=Mt({type:i})}return i})();var Ct=class{numPassed=0;numFailed=0};var Ae=(()=>{class i{http=b(Rt);alertService=b(ee);gradingService=b(Be);exercise;course;gradingStatistics;maxPoints;currentTasks;tasks;ignoreInactive=!0;resourceUrl="api/programming/programming-exercises";get totalWeights(){return ft(this.testCases.map(({weight:t})=>t??0))}get testCases(){return this.currentTasks.flatMap(t=>t.testCases)}hasUnsavedChanges(){return!this.tasks||!this.currentTasks?!1:this.testCases.some(({changed:t})=>t)}updateTasks(){return this.updateAllTaskPoints(),this.currentTasks}toggleIgnoreInactive(){this.ignoreInactive=!this.ignoreInactive,this.setCurrentTasks(),this.updateAllTaskPoints()}configure(t,a,n){return this.exercise=t,this.course=a,this.gradingStatistics=n,this.maxPoints=this.exercise.maxPoints??0,this.getTasksByExercise(this.exercise).pipe(ke(this.initializeTasks))}saveTestCases(){let t=this.currentTasks.map(l=>l.testCases).flatMap(l=>l).filter(l=>l.changed),a=t.map(l=>Ni.from(l));return ft(t.map(l=>l.weight))<0?(this.alertService.error("artemisApp.programmingExercise.configureGrading.testCases.weightSumError"),z(void 0)):this.gradingService.updateTestCase(this.exercise.id,a).pipe(O(l=>{let g=l.map(y=>y.id);this.testCases.filter(y=>g.includes(y.id)).forEach(y=>{y.changed=!1}),this.gradingService.notifyTestCases(this.exercise.id,this.testCases);let _=this.testCases.filter(y=>y.changed);_.length?this.alertService.error("artemisApp.programmingExercise.configureGrading.testCases.couldNotBeUpdated",{testCases:_}):this.alertService.success("artemisApp.programmingExercise.configureGrading.testCases.updated")}),$(l=>(l.status===400&&l.error?.errorKey?this.alertService.error("artemisApp.programmingExercise.configureGrading.testCases."+l.error.errorKey,l.error):this.alertService.error("artemisApp.programmingExercise.configureGrading.testCases.couldNotBeUpdated",{testCases:t}),z(null))))}resetTestCases(){return this.gradingService.resetTestCases(this.exercise.id).pipe(O(t=>{this.alertService.success("artemisApp.programmingExercise.configureGrading.testCases.resetSuccessful"),this.gradingService.notifyTestCases(this.exercise.id,t)}),$(()=>(this.alertService.error("artemisApp.programmingExercise.configureGrading.testCases.resetFailed"),z(void 0))),kt(()=>this.getTasksByExercise(this.exercise).pipe(ke(this.initializeTasks))))}removeDuplicateTestCasesFromTasks(){let t=new Set;for(let a of this.tasks){let n=[];for(let l of a.testCases)t.has(l.id)||(t.add(l.id),n.push(l));a.testCases=n}this.tasks=this.tasks.filter(a=>a.testCases.length>0)}initializeTasks=t=>(this.tasks=t.map(a=>a),this.tasks=this.tasks.map(a=>pe(me({},a),{testCases:a.testCases??[]})).map(this.addGradingStats),this.removeDuplicateTestCasesFromTasks(),this.setCurrentTasks(),this.updateAllTaskPoints(),this.currentTasks);setCurrentTasks=()=>{let t=JSON.parse(JSON.stringify(this.tasks));this.ignoreInactive?this.currentTasks=t.filter(a=>(a.testCases=a.testCases.filter(n=>n.active),a.testCases.length)):this.currentTasks=t,this.currentTasks.forEach(this.initializeTask)};getTasksByExercise=t=>this.http.get(`${this.resourceUrl}/${t.id}/tasks-with-unassigned-test-cases`);addGradingStats=t=>{t.stats=new Ct;let a=this.gradingStatistics?.testCaseStatsMap;if(!a)return t;for(let n of t.testCases){let l=a[n.testName];l&&(n.testCaseStats=l,t.stats.numPassed+=l.numPassed,t.stats.numFailed+=l.numFailed)}return t};initializeTask=t=>(t.weight=ft(t.testCases.map(a=>a.weight??0)),t.bonusMultiplier=vt(t.testCases.map(a=>a.bonusMultiplier)),t.bonusPoints=ft(t.testCases.map(a=>a.bonusPoints??0)),t.visibility=vt(t.testCases.map(a=>a.visibility)),t.type=vt(t.testCases.map(a=>a.type))??"MIXED",t);updateAllTaskPoints=()=>{this.currentTasks.forEach(this.updateTaskPoints)};updateTaskPoints=t=>{let[a,n]=this.calculatePoints(t);return t.resultingPoints=a,t.resultingPointsPercent=n,t.testCases.forEach(l=>{let[g,_]=this.calculatePoints(l);l.resultingPoints=g,l.resultingPointsPercent=_}),t};calculatePoints=t=>{let a=Number(t.weight??0),n=Number(t.bonusMultiplier??1),l=Number(t.bonusPoints??0),g=a*n/this.totalWeights*this.maxPoints+l,_=Te(g,this.course),y=g/this.maxPoints*100,M=Te(y,this.course);return[_,M]};static \u0275fac=function(a){return new(a||i)};static \u0275prov=He({token:i,factory:i.\u0275fac})}return i})(),vt=i=>{let p=new Set(i);if(p.size==1)return p.values().next().value},ft=i=>(i??[]).reduce((p,t)=>Number(p)+Number(t),0);function xn(i,p){i&1&&(e(0,`
                        `),m(1,"span",6),e(2,`
                    `))}function _n(i,p){i&1&&(e(0,`
                        `),m(1,"span",7),e(2,`
                    `))}function Cn(i,p){i&1&&(e(0,`
                        `),m(1,"span",8),e(2,`
                    `))}function fn(i,p){if(i&1&&(e(0,`
                `),s(1,"div",4),e(2,`
                    `),m(3,"fa-icon",5),e(4,`
                    `),x(5,xn,3,0)(6,_n,3,0)(7,Cn,3,0),o(),e(8,`
            `)),i&2){let t=d();r(3),c("icon",t.faExclamationTriangle),r(2),h(t.hasUnsavedTestCaseChanges&&t.hasUnsavedCategoryChanges?5:-1),r(),h(t.hasUnsavedTestCaseChanges&&!t.hasUnsavedCategoryChanges?6:-1),r(),h(!t.hasUnsavedTestCaseChanges&&t.hasUnsavedCategoryChanges?7:-1)}}function hn(i,p){if(i&1&&(e(0,`
                `),s(1,"div",9),e(2,`
                    `),m(3,"fa-icon",5),e(4,`
                    `),m(5,"span",10),e(6,`
                `),o(),e(7,`
            `)),i&2){let t=d();r(3),c("icon",t.faCheckCircle)}}function bn(i,p){if(i&1&&(e(0,`
                `),s(1,"div",9),e(2,`
                    `),m(3,"fa-icon",5),e(4,`
                    `),m(5,"span",10),e(6,`
                `),o(),e(7,`
            `)),i&2){let t=d();r(3),c("icon",t.faCheckCircle)}}function Tn(i,p){if(i&1&&(e(0,`
                    `),s(1,"div",11),e(2,`
                        `),m(3,"fa-icon",12),E(4,"artemisTranslate"),e(5,`
                        `),m(6,"span",13),e(7,`
                    `),o(),e(8,`
                `)),i&2){let t=d(2);r(3),c("icon",t.faExclamationTriangle)("ngbTooltip",P(4,2,"artemisApp.programmingExercise.configureGrading.updatedGradingConfigTooltip"))}}function Sn(i,p){if(i&1&&(e(0,`
                    `),s(1,"div",14),e(2,`
                        `),m(3,"fa-icon",5),e(4,`
                        `),m(5,"span",15),e(6,`
                    `),o(),e(7,`
                `)),i&2){let t=d(2);r(3),c("icon",t.faCheckCircle)}}function vn(i,p){if(i&1&&(e(0,`
                    `),s(1,"div",14),e(2,`
                        `),m(3,"fa-icon",5),e(4,`
                        `),m(5,"span",15),e(6,`
                    `),o(),e(7,`
                `)),i&2){let t=d(2);r(3),c("icon",t.faCheckCircle)}}function En(i,p){if(i&1&&(e(0,`
                `),x(1,Tn,9,4)(2,Sn,8,1)(3,vn,8,1,"ng-template",null,2,j),e(5,`
            `)),i&2){let t=d();r(),h(t.hasUpdatedGradingConfig?1:2)}}function yn(i,p){if(i&1&&(e(0,`
                `),s(1,"div",16),e(2,`
                    `),m(3,"fa-icon",12),E(4,"artemisTranslate"),e(5,`
                    `),m(6,"span",17),e(7,`
                `),o(),e(8,`
            `)),i&2){let t=d();r(3),c("icon",t.faQuestionCircle)("ngbTooltip",P(4,2,"artemisApp.programmingExercise.configureGrading.notReleasedTooltip"))}}function An(i,p){if(i&1&&(e(0,`
                `),s(1,"div",16),e(2,`
                    `),m(3,"fa-icon",12),E(4,"artemisTranslate"),e(5,`
                    `),m(6,"span",17),e(7,`
                `),o(),e(8,`
            `)),i&2){let t=d();r(3),c("icon",t.faQuestionCircle)("ngbTooltip",P(4,2,"artemisApp.programmingExercise.configureGrading.notReleasedTooltip"))}}var Hi=(()=>{class i{exerciseIsReleasedAndHasResults;hasUnsavedTestCaseChanges;hasUnsavedCategoryChanges;hasUpdatedGradingConfig;faExclamationTriangle=mi;faCheckCircle=ti;faQuestionCircle=Oe;static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-programming-exercise-configure-grading-status"]],inputs:{exerciseIsReleasedAndHasResults:"exerciseIsReleasedAndHasResults",hasUnsavedTestCaseChanges:"hasUnsavedTestCaseChanges",hasUnsavedCategoryChanges:"hasUnsavedCategoryChanges",hasUpdatedGradingConfig:"hasUpdatedGradingConfig"},decls:14,vars:2,consts:[["noUnsavedChanges",""],["notReleased",""],["noUpdatedGradingConfig",""],[1,"d-flex","flex-column","justify-content-between"],["id","test-case-status-unsaved-changes",1,"d-flex","align-items-center","badge","bg-warning","mb-1"],[1,"ms-2","text-white",3,"icon"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.status.unsavedChanges",1,"ms-1"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.status.unsavedTestCaseChanges",1,"ms-1"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.status.unsavedCategoryChanges",1,"ms-1"],["id","test-case-status-no-unsaved-changes",1,"d-flex","align-items-center","badge","bg-success","mb-1"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.status.noUnsavedChanges",1,"ms-1"],["id","test-case-status-updated",1,"d-flex","align-items-center","badge","bg-warning"],[1,"ms-2","text-white",3,"icon","ngbTooltip"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.updatedGradingConfigShort",1,"ms-1"],["id","test-case-status-no-updated",1,"d-flex","align-items-center","badge","bg-success"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.noUpdatedGradingConfig",1,"ms-1"],["id","test-case-status-not-released",1,"d-flex","align-items-center","badge","bg-secondary"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.notReleased",1,"ms-1"]],template:function(a,n){a&1&&(e(0,`
        `),s(1,"div",3),e(2,`
            `),x(3,fn,9,4)(4,hn,8,1)(5,bn,8,1,"ng-template",null,0,j),e(7,`
            `),x(8,En,6,1)(9,yn,9,4)(10,An,9,4,"ng-template",null,1,j),e(12,`
        `),o(),e(13,`
    `)),a&2&&(r(3),h(n.hasUnsavedTestCaseChanges||n.hasUnsavedCategoryChanges?3:4),r(5),h(n.exerciseIsReleasedAndHasResults?8:9))},dependencies:[Y,w,Z,W],encapsulation:2})}return i})();var zi=(()=>{class i{testCaseService=b(Be);alertService=b(ee);FeatureToggle=Xt;ButtonType=dt;exercise;disabled=!1;isReEvaluationRunning=!1;faRedo=oi;triggerReEvaluate(){this.isReEvaluationRunning=!0,this.testCaseService.reEvaluate(this.exercise.id).subscribe({next:t=>{this.isReEvaluationRunning=!1,this.alertService.success("artemisApp.programmingExercise.reEvaluateSuccessful",{number:t})},error:t=>{this.isReEvaluationRunning=!1,this.alertService.error("artemisApp.programmingExercise.reEvaluateFailed",{message:t.message})}})}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-programming-exercise-re-evaluate-button"]],inputs:{exercise:"exercise",disabled:"disabled"},decls:3,vars:7,consts:[["id","re-evaluate-button",1,"ms-3",3,"onClick","disabled","btnType","isLoading","tooltip","icon","title","featureToggle"]],template:function(a,n){a&1&&(e(0,`
        `),s(1,"jhi-button",0),u("onClick",function(){return n.triggerReEvaluate()}),o(),e(2,`
    `)),a&2&&(r(),c("disabled",n.disabled||n.isReEvaluationRunning)("btnType",n.ButtonType.ERROR)("isLoading",n.isReEvaluationRunning)("tooltip","artemisApp.programmingExercise.reEvaluateTooltip")("icon",n.faRedo)("title","artemisApp.programmingExercise.reEvaluate")("featureToggle",n.FeatureToggle.ProgrammingExercises))},dependencies:[Ve],encapsulation:2})}return i})();var qi=(()=>{class i{exercise;hasUpdatedGradingConfig;isSaving;onBuildTriggered=new L;static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-programming-exercise-configure-grading-actions"]],inputs:{exercise:"exercise",hasUpdatedGradingConfig:"hasUpdatedGradingConfig",isSaving:"isSaving"},outputs:{onBuildTriggered:"onBuildTriggered"},decls:5,vars:4,consts:[[3,"exercise","disabled"],[3,"onBuildTriggered","exercise","disabled"]],template:function(a,n){a&1&&(e(0,`
        `),m(1,"jhi-programming-exercise-re-evaluate-button",0),e(2,`
        `),s(3,"jhi-programming-exercise-trigger-all-button",1),u("onBuildTriggered",function(){return n.onBuildTriggered.emit()}),o(),e(4,`
    `)),a&2&&(r(),c("exercise",n.exercise)("disabled",n.isSaving),r(2),c("exercise",n.exercise)("disabled",n.isSaving))},dependencies:[zi,Ri],encapsulation:2})}return i})();function kn(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"jhi-button",1),u("onClick",function(){C(t);let n=d();return f(n.onUpdate.emit())}),o(),e(2,`
            `)}if(i&2){let t=d();r(),c("btnType",t.ButtonType.PRIMARY)("title","artemisApp.programmingExercise.submissionPolicy.updateButton.title")("tooltip","artemisApp.programmingExercise.submissionPolicy.updateButton.tooltip")("icon",t.faSave)("disabled",t.isSaving||!t.exercise.submissionPolicy||(t.exercise.submissionPolicy==null?null:t.exercise.submissionPolicy.type)===t.SubmissionPolicyType.NONE&&!t.hadPolicyBefore||t.formInvalid)}}function Pn(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"jhi-button",2),u("onClick",function(){C(t);let n=d();return f(n.onToggle.emit())}),o(),e(2,`
            `)}if(i&2){let t=d();r(),c("btnType",t.ButtonType.ERROR)("title","artemisApp.programmingExercise.submissionPolicy.deactivateButton.title")("tooltip","artemisApp.programmingExercise.submissionPolicy.deactivateButton.tooltip")("disabled",t.isSaving)}}function Fn(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"jhi-button",2),u("onClick",function(){C(t);let n=d();return f(n.onToggle.emit())}),o(),e(2,`
            `)}if(i&2){let t=d();r(),c("btnType",t.ButtonType.SUCCESS)("title","artemisApp.programmingExercise.submissionPolicy.activateButton.title")("tooltip","artemisApp.programmingExercise.submissionPolicy.activateButton.tooltip")("disabled",t.isSaving)}}var Ki=(()=>{class i{ButtonType=dt;SubmissionPolicyType=Ue;exercise;isSaving;formInvalid;hadPolicyBefore;onUpdate=new L;onToggle=new L;faSave=ri;static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-programming-exercise-grading-submission-policy-configuration-actions"]],inputs:{exercise:"exercise",isSaving:"isSaving",formInvalid:"formInvalid",hadPolicyBefore:"hadPolicyBefore"},outputs:{onUpdate:"onUpdate",onToggle:"onToggle"},decls:7,vars:3,consts:[["align","right"],[3,"onClick","btnType","title","tooltip","icon","disabled"],[3,"onClick","btnType","title","tooltip","disabled"]],template:function(a,n){a&1&&(e(0,`
        `),s(1,"div",0),e(2,`
            `),x(3,kn,3,5)(4,Pn,3,4)(5,Fn,3,4),o(),e(6,`
    `)),a&2&&(r(3),h(n.exercise.isAtLeastInstructor?3:-1),r(),h(n.exercise.isAtLeastInstructor&&n.hadPolicyBefore&&n.exercise.submissionPolicy.active?4:-1),r(),h(n.exercise.isAtLeastInstructor&&n.hadPolicyBefore&&!n.exercise.submissionPolicy.active?5:-1))},dependencies:[Ve],encapsulation:2})}return i})();var In=i=>({width:i}),wn=(i,p)=>({left:i,width:p}),Yi=(()=>{class i{testCaseStats;totalParticipations;passedPercent=0;failedPercent=0;tooltip="";ngOnChanges(){let t=(this.testCaseStats?.numPassed??0)+(this.testCaseStats?.numFailed??0);if(t>this.totalParticipations&&(this.totalParticipations=t),this.totalParticipations>0){let a=(this.testCaseStats?.numPassed||0)/this.totalParticipations*100,n=(this.testCaseStats?.numFailed||0)/this.totalParticipations*100;setTimeout(()=>{this.passedPercent=a,this.failedPercent=n,this.tooltip=i.generateTooltip(a,n,this.totalParticipations)})}else setTimeout(()=>{this.passedPercent=0,this.failedPercent=0,this.tooltip=i.generateTooltip(0,0,0)})}static generateTooltip(t,a,n){let l=hi(100-t-a);return`${t.toFixed(0)}% passed, ${a.toFixed(0)}% failed${l>0?`, ${l}% not executed`:""} of ${n} students.`}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-test-case-passed-builds-chart"]],inputs:{testCaseStats:"testCaseStats",totalParticipations:"totalParticipations"},features:[_e],decls:8,vars:10,consts:[["placement","left auto",1,"chart-body",3,"ngbTooltip"],[1,"passed-bar"],[1,"failed-bar"]],template:function(a,n){a&1&&(e(0,`
        `),s(1,"div",0),e(2,`
            `),m(3,"div",1),e(4,`
            `),m(5,"div",2),e(6,`
        `),o(),e(7,`
    `)),a&2&&(r(),c("ngbTooltip",n.tooltip),r(2),Pe(A(5,In,n.passedPercent+"%")),r(2),Pe(K(7,wn,n.passedPercent+"%",n.failedPercent+"%")))},dependencies:[Z],styles:[".chart-body[_ngcontent-%COMP%]{border-radius:4px;background-color:#999;height:10px;max-width:100px;overflow:hidden;position:relative}",".passed-bar[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:10px;background-color:#28a745}",".failed-bar[_ngcontent-%COMP%]{position:absolute;top:0;height:10px;background-color:#dc3545}"]})}return i})();function Mn(i,p){if(i&1&&(e(0,`
                            `),s(1,"option",12),e(2),E(3,"artemisTranslate"),o(),e(4,`
                        `)),i&2){let t=p.$implicit;r(),c("value",t.value),r(),se(`
                                `,P(3,2,"artemisApp.programmingExerciseTestCase.visibility."+t.name),`
                            `)}}function Nn(i,p){if(i&1){let t=S();e(0,`
        `),s(1,"div",1),e(2,`
            `),s(3,"button",2),u("click",function(){C(t);let n=d();return f(n.open=!n.open)}),e(4,`
                `),m(5,"fa-icon",3),e(6,`
            `),o(),e(7,`
            `),s(8,"div",4),e(9,`
                `),s(10,"div",5),e(11,`
                    `),s(12,"b"),e(13),o(),e(14,`
                    `),s(15,"span",6),e(16,`
                        `),s(17,"b"),e(18),o()(),e(19,`
                `),o(),e(20,`
                `),s(21,"div",7),e(22,`
                    `),s(23,"input",8),ie("ngModelChange",function(n){C(t);let l=d();return J(l.task.weight,n)||(l.task.weight=n),f(n)}),u("change",function(){C(t);let n=d();return f(n.taskUpdateHandler())}),o(),e(24,`
                `),o(),e(25,`
                `),s(26,"div",7),e(27,`
                    `),s(28,"input",8),ie("ngModelChange",function(n){C(t);let l=d();return J(l.task.bonusMultiplier,n)||(l.task.bonusMultiplier=n),f(n)}),u("change",function(){C(t);let n=d();return f(n.taskUpdateHandler())}),o(),e(29,`
                `),o(),e(30,`
                `),s(31,"div",7),e(32,`
                    `),s(33,"input",8),ie("ngModelChange",function(n){C(t);let l=d();return J(l.task.bonusPoints,n)||(l.task.bonusPoints=n),f(n)}),u("change",function(){C(t);let n=d();return f(n.taskUpdateHandler())}),o(),e(34,`
                `),o(),e(35,`
                `),s(36,"div",9),e(37,`
                    `),s(38,"select",10),ie("ngModelChange",function(n){C(t);let l=d();return J(l.task.visibility,n)||(l.task.visibility=n),f(n)}),u("change",function(){C(t);let n=d();return f(n.taskUpdateHandler())}),e(39,`
                        `),V(40,Mn,5,4,null,null,R),o(),e(42,`
                `),o(),e(43,`
                `),s(44,"div",9),e(45,`
                    `),s(46,"span",6),e(47),o(),e(48,`
                `),o(),e(49,`
                `),s(50,"div",9),e(51,`
                    `),s(52,"span",6),e(53),E(54,"artemisTranslate"),o(),e(55,`
                `),o(),e(56,`
                `),s(57,"div",9),e(58,`
                    `),m(59,"jhi-test-case-passed-builds-chart",11),e(60,`
                `),o(),e(61,`
            `),o(),e(62,`
        `),o(),e(63,`
    `)}if(i&2){let t,a=d();r(5),c("icon",a.open?a.faAngleDown:a.faAngleRight),r(8),F(a.index+1),r(5),F(a.task.taskName),r(5),Q("name","",a.task.taskName,"-name"),c("disabled",a.task.taskName===a.NOT_ASSIGNED_TO_TASK_NAME),te("ngModel",a.task.weight),r(5),Q("name","",a.task.taskName,"-bonusMultiplier"),c("disabled",a.task.taskName===a.NOT_ASSIGNED_TO_TASK_NAME),te("ngModel",a.task.bonusMultiplier),r(5),Q("name","",a.task.taskName,"-bonusPoints"),c("disabled",a.task.taskName===a.NOT_ASSIGNED_TO_TASK_NAME),te("ngModel",a.task.bonusPoints),r(5),Q("name","",a.task.taskName,"-visibility"),c("disabled",a.task.taskName===a.NOT_ASSIGNED_TO_TASK_NAME),te("ngModel",a.task.visibility),r(2),B(a.testCaseVisibilityList),r(7),de("",a.task.resultingPoints,"P (",a.task.resultingPointsPercent,"%)"),r(6),F(P(54,24,"artemisApp.programmingExerciseTestCase.type."+((t=a.task.type)!==null&&t!==void 0?t:"DEFAULT"))),r(6),c("testCaseStats",a.task.stats)("totalParticipations",a.numParticipations)}}function Dn(i,p){if(i&1&&(e(0,`
                                `),s(1,"option",12),e(2),E(3,"artemisTranslate"),o(),e(4,`
                            `)),i&2){let t=p.$implicit;r(),c("value",t.value),r(),se(`
                                    `,P(3,2,"artemisApp.programmingExerciseTestCase.visibility."+t.name),`
                                `)}}function Gn(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"div",4),e(2,`
                    `),s(3,"div",5),e(4,`
                        `),s(5,"span",14),e(6),o(),e(7,`
                        `),s(8,"span",6),e(9),o(),e(10,`
                    `),o(),e(11,`
                    `),s(12,"div",7),e(13,`
                        `),s(14,"input",15),ie("ngModelChange",function(n){let l=C(t).$implicit;return J(l.weight,n)||(l.weight=n),f(n)}),u("change",function(){let n=C(t).$implicit,l=d(2);return f(l.testUpdateHandler(n))}),o(),e(15,`
                    `),o(),e(16,`
                    `),s(17,"div",7),e(18,`
                        `),s(19,"input",15),ie("ngModelChange",function(n){let l=C(t).$implicit;return J(l.bonusMultiplier,n)||(l.bonusMultiplier=n),f(n)}),u("change",function(){let n=C(t).$implicit,l=d(2);return f(l.testUpdateHandler(n))}),o(),e(20,`
                    `),o(),e(21,`
                    `),s(22,"div",7),e(23,`
                        `),s(24,"input",15),ie("ngModelChange",function(n){let l=C(t).$implicit;return J(l.bonusPoints,n)||(l.bonusPoints=n),f(n)}),u("change",function(){let n=C(t).$implicit,l=d(2);return f(l.testUpdateHandler(n))}),o(),e(25,`
                    `),o(),e(26,`
                    `),s(27,"div",9),e(28,`
                        `),s(29,"select",16),ie("ngModelChange",function(n){let l=C(t).$implicit;return J(l.visibility,n)||(l.visibility=n),f(n)}),u("change",function(){let n=C(t).$implicit,l=d(2);return f(l.testUpdateHandler(n))}),e(30,`
                            `),V(31,Dn,5,4,null,null,R),o(),e(33,`
                    `),o(),e(34,`
                    `),s(35,"div",9),e(36,`
                        `),s(37,"span",6),e(38),o(),e(39,`
                    `),o(),e(40,`
                    `),s(41,"div",9),e(42,`
                        `),s(43,"span",6),e(44),E(45,"artemisTranslate"),o(),e(46,`
                    `),o(),e(47,`
                    `),s(48,"div",9),e(49,`
                        `),m(50,"jhi-test-case-passed-builds-chart",11),e(51,`
                    `),o(),e(52,`
                `),o(),e(53,`
            `)}if(i&2){let t,a=p.$implicit,n=p.$index,l=d(2);r(),Ke("bg-secondary",!a.active),r(5),F(l.formatTestIndex(l.index,n)),r(3),F(a.testName),r(5),Q("name","",a.testName,"-name"),te("ngModel",a.weight),r(5),Q("name","",a.testName,"-bonusMultiplier"),te("ngModel",a.bonusMultiplier),r(5),Q("name","",a.testName,"-bonusPoints"),te("ngModel",a.bonusPoints),r(5),Q("name","",a.testName,"-visibility"),te("ngModel",a.visibility),r(2),B(l.testCaseVisibilityList),r(7),de("",a.resultingPoints,"P (",a.resultingPointsPercent,"%)"),r(6),F(P(45,21,"artemisApp.programmingExerciseTestCase.type."+((t=a.type)!==null&&t!==void 0?t:"DEFAULT"))),r(6),c("testCaseStats",a.testCaseStats)("totalParticipations",l.numParticipations)}}function On(i,p){if(i&1&&(e(0,`
        `),s(1,"div",13),e(2,`
            `),V(3,Gn,54,23,null,null,R),o(),e(5,`
    `)),i&2){let t=d();r(3),B(t.task.testCases)}}var $i=(()=>{class i{programmingExerciseTaskService=b(Ae);index;task;openSubject;isExamExercise;updateTasksEvent=new L;faAngleDown=ct;faAngleRight=lt;NOT_ASSIGNED_TO_TASK_NAME="Not assigned to task";open;onlyViewTestCases;testCaseVisibilityList=[];get numParticipations(){return this.programmingExerciseTaskService?.gradingStatistics?.numParticipations??0}ngOnInit(){this.openSubject.subscribe(t=>this.open=t),this.programmingExerciseTaskService.currentTasks.length==1&&(this.onlyViewTestCases=!0,this.open=!0),this.updateTestCaseVisibilityList()}testUpdateHandler(t){this.programmingExerciseTaskService.initializeTask(this.task),t.changed=!0,this.updateTasksEvent.emit()}taskUpdateHandler(){let t=this.task.testCases.length,a=this.task.testCases.reduce((n,{weight:l})=>n+(l??0),0);this.task.testCases.forEach(n=>{n.changed=!0,this.task.weight!==void 0&&a!==0&&(n.weight=(n.weight??0)/a*this.task.weight),this.task.bonusMultiplier!==void 0&&(n.bonusMultiplier=this.task.bonusMultiplier),this.task.bonusPoints!==void 0&&(n.bonusPoints=this.task.bonusPoints/t),this.task.visibility!==void 0&&(n.visibility=this.task.visibility)}),this.updateTasksEvent.emit()}formatTestIndex(t,a){return`${t+1}.${a+1}`}updateTestCaseVisibilityList(){this.testCaseVisibilityList=Object.entries(Se).map(([t,a])=>{let n=t;return this.isExamExercise&&a===Se.AfterDueDate&&(n="AfterReleaseDateOfResults"),{value:a,name:n}})}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-programming-exercise-task"]],inputs:{index:"index",task:"task",openSubject:"openSubject",isExamExercise:"isExamExercise"},outputs:{updateTasksEvent:"updateTasksEvent"},decls:5,vars:2,consts:[[1,"task"],[1,"d-flex"],["type","button",1,"task__collapse",3,"click"],[1,"me-2",3,"icon"],[1,"task__row"],[1,"task__row__cell","gap-3"],[1,"task__field"],[1,"task__row__cell","task__row__cell--small"],["type","number","min","0",1,"form-control",3,"ngModelChange","change","disabled","ngModel","name"],[1,"task__row__cell"],[1,"form-select",3,"ngModelChange","change","disabled","ngModel","name"],[1,"w-100",3,"testCaseStats","totalParticipations"],[3,"value"],[1,"task__body"],[1,"ps-3"],["type","number","min","0",1,"form-control",3,"ngModelChange","change","ngModel","name"],[1,"form-select",3,"ngModelChange","change","ngModel","name"]],template:function(a,n){a&1&&(s(0,"div",0),e(1,`
    `),x(2,Nn,64,26)(3,On,6,0),o(),e(4,`
`)),a&2&&(r(2),h(n.onlyViewTestCases?-1:2),r(),h(n.open?3:-1))},dependencies:[Y,oe,rt,st,Ie,Lt,at,be,zt,we,Yi,W],styles:[".task__body[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:2rem}.task__field[_ngcontent-%COMP%]{display:flex;align-items:center;overflow-wrap:anywhere}.task__row[_ngcontent-%COMP%]{display:flex;gap:.5rem;padding:1rem;width:100%}.task__row__index[_ngcontent-%COMP%]{display:flex;align-items:center;width:3rem}.task__row__cell[_ngcontent-%COMP%]{flex:1 1 0;display:flex;align-items:center}.task__row__cell--small[_ngcontent-%COMP%]{width:80px;flex:initial}.task__collapse[_ngcontent-%COMP%]{color:var(--bs-card-color);background:none;border:none;width:2rem}.sort__button[_ngcontent-%COMP%]{border:none;background:none;color:var(--bs-card-color)}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]})}return i})();function Rn(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"jhi-button",17),u("click",function(){C(t);let n=d();return f(n.toggleAllTasksExpanded(!0))}),e(2,`
                    Expand all
                `),o(),e(3,`
            `)}if(i&2){let t=d();r(),c("shouldSubmit",!1)("icon",t.faAngleDown)}}function Vn(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"jhi-button",18),u("click",function(){C(t);let n=d();return f(n.toggleAllTasksExpanded(!1))}),e(2,`
                    Collapse all
                `),o(),e(3,`
            `)}if(i&2){let t=d();r(),c("shouldSubmit",!1)("icon",t.faAngleRight)}}function Bn(i,p){if(i&1){let t=S();e(0,`
        `),s(1,"jhi-programming-exercise-task",19),u("updateTasksEvent",function(){C(t);let n=d();return f(n.updateTasks())}),o(),e(2,`
    `)}if(i&2){let t=p.$implicit,a=p.$index,n=d();r(),c("index",a)("task",t)("openSubject",n.allTasksExpandedSubject)("isExamExercise",n.isExamExercise)}}var Qi=(()=>{class i{taskService=b(Ae);exercise;course;gradingStatisticsObservable;faAngleDown=ct;faAngleRight=lt;faQuestionCircle=Oe;faScaleUnbalanced=si;faMedal=li;faAsterisk=Zt;isSaving=!1;tasks=[];allTasksExpandedSubject;currentSort;isExamExercise=!1;get ignoreInactive(){return this.taskService.ignoreInactive}ngOnInit(){this.allTasksExpandedSubject=new At,this.gradingStatisticsObservable.subscribe(t=>{this.taskService.configure(this.exercise,this.course,t).subscribe(this.updateTasks)}),this.currentSort={by:"name",descending:!0},this.isExamExercise=bi(this.exercise)}updateTasks=()=>{this.tasks=this.taskService.updateTasks()};toggleShowInactiveTestsShown=()=>{this.taskService.toggleIgnoreInactive(),this.updateTasks()};saveTestCases=()=>{this.isSaving=!0,this.taskService.saveTestCases().subscribe(()=>this.isSaving=!1)};resetTestCases=()=>{this.isSaving=!0,this.taskService.resetTestCases().subscribe(()=>{this.isSaving=!1,this.updateTasks()})};toggleAllTasksExpanded=t=>{this.allTasksExpandedSubject.next(t)};changeSort=t=>{this.currentSort?.by===t?this.currentSort.descending=!this.currentSort.descending:this.currentSort={by:t,descending:!0},this.sort()};getSortIcon=t=>this.currentSort?.by!==t?Ge:this.currentSort.descending?De:Re;sort=()=>{let t={name:this.compareStringForAttribute("taskName"),weight:this.compareNumForAttribute("weight"),multiplier:this.compareNumForAttribute("bonusMultiplier"),bonusPoints:this.compareNumForAttribute("bonusPoints"),visibility:this.compareStringForAttribute("visibility"),resulting:this.compareNumForAttribute("resultingPoints"),type:this.compareStringForAttribute("type")},a=(n,l)=>{let g=t[this.currentSort.by](n,l);return this.currentSort?.descending?g:-g};this.tasks=this.tasks.sort(a),this.currentSort?.by==="name"&&(a=(n,l)=>{let g=this.compareStringForAttribute("testName")(n,l);return this.currentSort?.descending?g:-g}),this.tasks.filter(({testCases:n})=>n).forEach(n=>n.testCases.sort(a))};compareNumForAttribute=t=>(a,n)=>(a[t]??0)-(n[t]??0);compareStringForAttribute=t=>(a,n)=>{let l=a[t]??"",g=n[t]??"";return l<g?-1:l>g?1:0};static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-programming-exercise-grading-tasks-table"]],inputs:{exercise:"exercise",course:"course",gradingStatisticsObservable:"gradingStatisticsObservable"},decls:117,vars:56,consts:[[1,"d-flex","flex-column","gap-3","mb-3"],[1,"fw-medium"],[1,"d-flex","justify-content-between"],["type","button","jhiTranslate","artemisApp.programmingExercise.configureGrading.save",1,"btn","btn-primary",3,"click","disabled"],["type","button","jhiTranslate","artemisApp.programmingExercise.configureGrading.reset",1,"btn","btn-secondary",3,"click","disabled"],[1,"form-check","form-switch"],["type","checkbox","id","grading-task-inactive-toggle",1,"form-check-input",3,"click","value"],["for","grading-task-inactive-toggle","jhiTranslate","artemisApp.programmingExercise.configureGrading.testCases.showInactive",1,"form-check-label"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.testCases.exercisePoints",1,"form-check-label"],[1,"ps-5","task__row"],["type","button","placement","bottom auto",1,"task__row__cell","sort__button",3,"click","ngbTooltip"],[1,"mb-0",3,"innerHtml"],[1,"ms-2",3,"icon"],[1,"text-secondary","ms-2",3,"icon"],["type","button","placement","bottom auto",1,"task__row__cell","task__row__cell--small","ps-2","sort__button",3,"click","ngbTooltip"],["size","xl",3,"icon"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.gradingTableHeader.passedPercent",1,"task__row__cell"],["title","artemisApp.programmingExercise.configureGrading.expandAll",3,"click","shouldSubmit","icon"],["title","artemisApp.programmingExercise.configureGrading.collapseAll",3,"click","shouldSubmit","icon"],[3,"updateTasksEvent","index","task","openSubject","isExamExercise"]],template:function(a,n){a&1&&(s(0,"div",0),e(1,`
    `),s(2,"h2",1),e(3,"Tasks"),o(),e(4,`
    `),s(5,"div",2),e(6,`
        `),s(7,"div"),e(8,`
            `),x(9,Rn,4,2)(10,Vn,4,2),o(),e(11,`
        `),s(12,"div"),e(13,`
            `),s(14,"button",3),u("click",function(){return n.saveTestCases()}),o(),e(15,`
            `),s(16,"button",4),u("click",function(){return n.resetTestCases()}),o(),e(17,`
        `),o(),e(18,`
    `),o(),e(19,`
    `),s(20,"div",5),e(21,`
        `),s(22,"input",6),u("click",function(){return n.toggleShowInactiveTestsShown()}),o(),e(23,`
        `),m(24,"label",7),e(25,`
    `),o(),e(26,`
    `),s(27,"div"),e(28,`
        `),m(29,"label",8),e(30),o(),e(31,`
`),o(),e(32,`
`),s(33,"form"),e(34,`
    `),s(35,"div",9),e(36,`
        `),s(37,"button",10),E(38,"artemisTranslate"),u("click",function(){return n.changeSort("name")}),e(39,`
            `),m(40,"p",11),E(41,"artemisTranslate"),e(42,`
            `),m(43,"fa-icon",12),e(44,`
            `),m(45,"fa-icon",13),e(46,`
        `),o(),e(47,`
        `),s(48,"button",14),E(49,"artemisTranslate"),u("click",function(){return n.changeSort("weight")}),e(50,`
            `),m(51,"fa-icon",15),e(52,`
            `),m(53,"fa-icon",12),e(54,`
            `),m(55,"fa-icon",13),e(56,`
        `),o(),e(57,`
        `),s(58,"button",14),E(59,"artemisTranslate"),u("click",function(){return n.changeSort("multiplier")}),e(60,`
            `),m(61,"fa-icon",15),e(62,`
            `),m(63,"fa-icon",12),e(64,`
            `),m(65,"fa-icon",13),e(66,`
        `),o(),e(67,`
        `),s(68,"button",14),E(69,"artemisTranslate"),u("click",function(){return n.changeSort("bonusPoints")}),e(70,`
            `),m(71,"fa-icon",15),e(72,`
            `),m(73,"fa-icon",12),e(74,`
            `),m(75,"fa-icon",13),e(76,`
        `),o(),e(77,`
        `),s(78,"button",10),E(79,"artemisTranslate"),u("click",function(){return n.changeSort("visibility")}),e(80,`
            `),m(81,"p",11),E(82,"artemisTranslate"),e(83,`
            `),m(84,"fa-icon",12),e(85,`
            `),m(86,"fa-icon",13),e(87,`
        `),o(),e(88,`
        `),s(89,"button",10),E(90,"artemisTranslate"),u("click",function(){return n.changeSort("resulting")}),e(91,`
            `),m(92,"p",11),E(93,"artemisTranslate"),e(94,`
            `),m(95,"fa-icon",12),e(96,`
            `),m(97,"fa-icon",13),e(98,`
        `),o(),e(99,`
        `),s(100,"button",10),E(101,"artemisTranslate"),u("click",function(){return n.changeSort("type")}),e(102,`
            `),m(103,"p",11),E(104,"artemisTranslate"),e(105,`
            `),m(106,"fa-icon",12),e(107,`
            `),m(108,"fa-icon",13),e(109,`
        `),o(),e(110,`
        `),m(111,"div",16),e(112,`
    `),o(),e(113,`
    `),V(114,Bn,3,4,null,null,R),o(),e(116,`
`)),a&2&&(r(9),h(n.tasks.length!==1?9:-1),r(),h(n.tasks.length!==1?10:-1),r(4),c("disabled",n.isSaving),r(2),c("disabled",n.isSaving),r(6),c("value",n.ignoreInactive),r(8),se(`
        `,n.exercise.maxPoints,` P
    `),r(7),c("ngbTooltip",P(38,34,"artemisApp.programmingExercise.configureGrading.help.name")),r(3),c("innerHtml",P(41,36,"artemisApp.programmingExercise.configureGrading.gradingTableHeader.testName"),re),r(3),c("icon",n.getSortIcon("name")),r(2),c("icon",n.faQuestionCircle),r(3),c("ngbTooltip",P(49,38,"artemisApp.programmingExercise.configureGrading.help.weight")),r(3),c("icon",n.faScaleUnbalanced),r(2),c("icon",n.getSortIcon("weight")),r(2),c("icon",n.faQuestionCircle),r(3),c("ngbTooltip",P(59,40,"artemisApp.programmingExercise.configureGrading.help.bonusMultiplier")),r(3),c("icon",n.faAsterisk),r(2),c("icon",n.getSortIcon("multiplier")),r(2),c("icon",n.faQuestionCircle),r(3),c("ngbTooltip",P(69,42,"artemisApp.programmingExercise.configureGrading.help.bonusPoints")),r(3),c("icon",n.faMedal),r(2),c("icon",n.getSortIcon("bonusPoints")),r(2),c("icon",n.faQuestionCircle),r(3),c("ngbTooltip",P(79,44,n.isExamExercise?"artemisApp.programmingExercise.configureGrading.help.visibilityExam":"artemisApp.programmingExercise.configureGrading.help.visibility")),r(3),c("innerHtml",P(82,46,"artemisApp.programmingExercise.configureGrading.gradingTableHeader.visibility"),re),r(3),c("icon",n.getSortIcon("visibility")),r(2),c("icon",n.faQuestionCircle),r(3),c("ngbTooltip",P(90,48,"artemisApp.programmingExercise.configureGrading.help.points")),r(3),c("innerHtml",P(93,50,"artemisApp.programmingExercise.configureGrading.gradingTableHeader.resultingPoints"),re),r(3),c("icon",n.getSortIcon("resulting")),r(2),c("icon",n.faQuestionCircle),r(3),c("ngbTooltip",n.exercise.programmingLanguage==="JAVA"?P(101,52,"artemisApp.programmingExercise.configureGrading.help.type"):void 0),r(3),c("innerHtml",P(104,54,"artemisApp.programmingExercise.configureGrading.gradingTableHeader.testType"),re),r(3),c("icon",n.getSortIcon("type")),r(2),c("icon",n.faQuestionCircle),r(6),B(n.tasks))},dependencies:[Ve,w,oe,nt,it,jt,Z,Y,$i,W],styles:[".task__body[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:2rem}.task__field[_ngcontent-%COMP%]{display:flex;align-items:center;overflow-wrap:anywhere}.task__row[_ngcontent-%COMP%]{display:flex;gap:.5rem;padding:1rem;width:100%}.task__row__index[_ngcontent-%COMP%]{display:flex;align-items:center;width:3rem}.task__row__cell[_ngcontent-%COMP%]{flex:1 1 0;display:flex;align-items:center}.task__row__cell--small[_ngcontent-%COMP%]{width:80px;flex:initial}.task__collapse[_ngcontent-%COMP%]{color:var(--bs-card-color);background:none;border:none;width:2rem}.sort__button[_ngcontent-%COMP%]{border:none;background:none;color:var(--bs-card-color)}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]})}return i})();function bt(i,p){return`hsl(${i*360*3%360}, 55%, ${p}%)`}var Xi=(i,p)=>[i,p],We=i=>({percentage:i});function Ln(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"button",12),u("click",function(){C(t);let n=d();return f(n.resetTableFilter())}),o(),e(2,`
            `)}}function Un(i,p){if(i&1&&(e(0,`
                    `),s(1,"div"),e(2,`
                        `),m(3,"span",13),e(4,`
                        `),m(5,"br"),e(6,`
                        `),m(7,"span",14),e(8,`
                    `),o(),e(9,`
                `)),i&2){let t=d().model;r(3),c("translateValues",A(2,We,t.value.toFixed(2))),r(4),c("translateValues",A(4,We,t.bonus.toFixed(2)))}}function Wn(i,p){if(i&1&&(e(0,`
                    `),s(1,"div"),e(2,`
                        `),m(3,"span",13),e(4,`
                        `),m(5,"br"),e(6,`
                        `),m(7,"span",14),e(8,`
                    `),o(),e(9,`
                `)),i&2){let t=d().model;r(3),c("translateValues",A(2,We,t.weight.toFixed(2))),r(4),c("translateValues",A(4,We,t.value.toFixed(2)))}}function Hn(i,p){if(i&1&&(e(0,`
                `),s(1,"b"),e(2),o(),e(3,`
                `),m(4,"br"),e(5,`
                `),x(6,Un,10,6)(7,Wn,10,6)),i&2){let t=p.model,a=d();r(2),F(t.name),r(4),h(K(3,Xi,a.testCaseBarTitle.WEIGHT_EN,a.testCaseBarTitle.WEIGHT_DE).includes(t.series)?6:-1),r(),h(K(6,Xi,a.testCaseBarTitle.WEIGHT_AND_BONUS_EN,a.testCaseBarTitle.WEIGHT_AND_BONUS_DE).includes(t.series)?7:-1)}}function zn(i,p){if(i&1&&(e(0,`
                `),s(1,"b"),e(2),o(),e(3,`
                `),m(4,"br"),e(5,`
                `),m(6,"span",15),e(7,`
            `)),i&2){let t=p.model;r(2),F(t.name),r(4),c("translateValues",A(2,We,t.value.toFixed(2)))}}var Ji=function(i){return i.WEIGHT_EN="Weight",i.WEIGHT_DE="Gewichtung",i.WEIGHT_AND_BONUS_EN="Weight & Bonus",i.WEIGHT_AND_BONUS_DE="Gewichtung & Bonus",i}(Ji||{}),Zi=(()=>{class i extends ve{translateService=b(Ne);navigationUtilService=b(gt);testCases;testCaseStatsMap;totalParticipations;exercise;testCaseColorsChange=new L;testCaseRowFilter=new L;testCaseBarTitle=Ji;totalWeight;ngxWeightData=[{name:"",series:[]},{name:"",series:[]}];ngxPointsData=[{name:"",series:[]}];constructor(){super(),this.translateService.onLangChange.subscribe(()=>{this.updateTranslation()})}ngOnInit(){this.updateTranslation()}ngOnChanges(){this.testCases==null&&(this.testCases=[]),this.testCases=this.testCases.filter(g=>g.visibility!==Se.Never),this.totalWeight=this.testCases.reduce((g,_)=>g+_.weight,0);let t=this.exercise.maxPoints,a=Ii(this.exercise)/t,n=t*(this.totalParticipations||0),l=this.testCases.map(g=>{let _=(this.totalWeight>0?g.weight*g.bonusMultiplier/this.totalWeight:0)+(g.bonusPoints||0)/t,y=Math.min(_,a),M=this.testCaseStatsMap?this.testCaseStatsMap[g.testName]:void 0;return{id:g.id,label:g.testName,relWeight:this.totalWeight>0?g.weight/this.totalWeight*100:0,relScore:y*100,relPoints:M&&n>0?M.numPassed*y*t/n*100:0}});if(this.ngxWeightData[0].series.length!==l.length){let g={};this.ngxWeightData=[],this.ngxPointsData=[];let _={name:this.translateService.instant("artemisApp.programmingExercise.configureGrading.charts.testCaseWeights.weight"),series:[]},y={name:this.translateService.instant("artemisApp.programmingExercise.configureGrading.charts.testCaseWeights.weightAndBonus"),series:[]},M={name:this.translateService.instant("artemisApp.programmingExercise.configureGrading.charts.testCasePoints.points"),series:[]};for(let T=0;T<l.length;T++){let I=l[T],ne=I.label,ae=bt(T/this.testCases.length,50);_.series.push({name:ne,value:Math.max(I.relWeight,0),bonus:Math.max(I.relScore,0),id:I.id}),y.series.push({name:ne,value:Math.max(I.relScore,0),weight:Math.max(I.relScore,0),id:I.id}),M.series.push({name:ne,value:Math.max(I.relPoints,0)}),g[ne]=ae,this.ngxColors.domain.push(ae)}this.ngxWeightData.push(_),this.ngxWeightData.push(y),this.ngxPointsData.push(M),this.testCaseColorsChange.emit(g)}else l.forEach(g=>{this.ngxWeightData[0].series.forEach((_,y)=>{_.id===g.id&&(_.value=Math.max(g.relWeight,0),_.bonus=Math.max(g.relScore,0),this.ngxWeightData[1].series[y].value=Math.max(g.relScore,0),this.ngxWeightData[1].series[y].weight=Math.max(g.relWeight,0),this.ngxPointsData[0].series[y].value=Math.max(g.relPoints,0))})});this.ngxWeightData=[...this.ngxWeightData],this.ngxPointsData=[...this.ngxPointsData]}onSelectPoints(){this.navigationUtilService.routeInNewTab(["course-management",this.exercise.course.id,"programming-exercises",this.exercise.id,"exercise-statistics"])}onSelectWeight(t){this.tableFiltered=!0,this.testCaseRowFilter.emit(t.id)}resetTableFilter(){this.tableFiltered=!1,this.testCaseRowFilter.emit(ve.RESET_TABLE)}updateTranslation(){let t=this.translateService.instant("artemisApp.programmingExercise.configureGrading.charts.testCaseWeights.weight"),a=this.translateService.instant("artemisApp.programmingExercise.configureGrading.charts.testCaseWeights.weightAndBonus"),n=this.translateService.instant("artemisApp.programmingExercise.configureGrading.charts.testCasePoints.points");this.ngxWeightData[0].name=t,this.ngxWeightData[1].name=a,this.ngxPointsData[0].name=n,this.ngxWeightData=[...this.ngxWeightData],this.ngxPointsData=[...this.ngxPointsData]}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-test-case-distribution-chart"]],inputs:{testCases:"testCases",testCaseStatsMap:"testCaseStatsMap",totalParticipations:"totalParticipations",exercise:"exercise"},outputs:{testCaseColorsChange:"testCaseColorsChange",testCaseRowFilter:"testCaseRowFilter"},features:[qe,_e],decls:47,vars:22,consts:[["containerRefWeight",""],["tooltipTemplate",""],["containerRefPoints",""],[1,"d-flex","justify-content-between"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.testCaseWeights.title"],[3,"innerHTML"],[1,"chart","bg-light"],[3,"select","results","xAxis","yAxis","xAxisTickFormatting","scheme"],[1,"mt-4"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.testCasePoints.title"],[1,"points-chart","bg-light"],[3,"select","results","xAxis","yAxis","xAxisTickFormatting","scheme","xScaleMax"],["type","button","jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.resetFilter",1,"btn","btn-info",3,"click"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.testCaseWeights.weightTooltip",3,"translateValues"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.testCaseWeights.weightAndBonusTooltip",3,"translateValues"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.testCasePoints.pointsTooltip",3,"translateValues"]],template:function(a,n){if(a&1){let l=S();s(0,"div"),e(1,`
    `),s(2,"div"),e(3,`
        `),s(4,"div",3),e(5,`
            `),m(6,"h4",4),e(7,`
            `),x(8,Ln,3,0),o(),e(9,`
        `),s(10,"p"),e(11),E(12,"artemisTranslate"),o(),e(13,`
        `),m(14,"p",5),E(15,"artemisTranslate"),e(16,`
    `),o(),e(17,`
    `),s(18,"div",6,0),e(20,`
        `),s(21,"ngx-charts-bar-horizontal-normalized",7),u("select",function(_){return C(l),f(n.onSelectWeight(_))}),e(22,`
            `),x(23,Hn,8,9,"ng-template",null,1,j),e(25,`
        `),o(),e(26,`
    `),o(),e(27,`
    `),s(28,"div",8),e(29,`
        `),m(30,"h4",9),e(31,`
        `),m(32,"p",5),E(33,"artemisTranslate"),e(34,`
    `),o(),e(35,`
    `),s(36,"div",10,2),e(38,`
        `),s(39,"ngx-charts-bar-horizontal-stacked",11),u("select",function(){return C(l),f(n.onSelectPoints())}),e(40,`
            `),x(41,zn,8,4,"ng-template",null,1,j),e(43,`
        `),o(),e(44,`
    `),o(),e(45,`
`),o(),e(46,`
`)}a&2&&(r(8),h(n.tableFiltered?8:-1),r(3),de(`
            `,P(12,16,"artemisApp.programmingExercise.configureGrading.charts.testCaseWeights.sumOfTestWeights"),`
            `,n.totalWeight,`
        `),r(3),c("innerHTML",P(15,18,"artemisApp.programmingExercise.configureGrading.charts.testCaseWeights.description"),re),r(7),c("results",n.ngxWeightData)("xAxis",!0)("yAxis",!0)("xAxisTickFormatting",n.xAxisFormatting)("scheme",n.ngxColors),r(11),c("innerHTML",P(33,20,"artemisApp.programmingExercise.configureGrading.charts.testCasePoints.description"),re),r(7),c("results",n.ngxPointsData)("xAxis",!0)("yAxis",!0)("xAxisTickFormatting",n.xAxisFormatting)("scheme",n.ngxColors)("xScaleMax",100))},dependencies:[w,xt,ut,Fi,W],styles:[".chart[_ngcontent-%COMP%]{height:150px}.points-chart[_ngcontent-%COMP%]{height:100px}"]})}return i})();function qn(i,p){if(i&1){let t=S();e(0,`
    `),s(1,"button",2),u("click",function(){C(t);let n=d();return f(n.openImportModal())}),e(2,`
        `),m(3,"fa-icon",3),e(4,`
        `),m(5,"span",4),e(6,`
    `),o(),e(7,`
`)}if(i&2){let t=d();r(),c("disabled",t.isSaving),r(2),c("icon",t.faCopy)}}var en=(()=>{class i{modalService=b(Me);faCopy=ci;exercise;hasUnsavedChanges;isSaving;activeTab;onSave=new L;onReset=new L;onCategoryImport=new L;openImportModal(){let t=this.modalService.open(Vi,{size:"lg",backdrop:"static"});t.componentInstance.exerciseType=pi.PROGRAMMING,t.componentInstance.programmingLanguage=this.exercise.programmingLanguage,t.result.then(a=>this.onCategoryImport.emit(a.id))}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-programming-exercise-grading-table-actions"]],inputs:{exercise:"exercise",hasUnsavedChanges:"hasUnsavedChanges",isSaving:"isSaving",activeTab:"activeTab"},outputs:{onSave:"onSave",onReset:"onReset",onCategoryImport:"onCategoryImport"},decls:5,vars:3,consts:[["id","save-table-button","jhiTranslate","artemisApp.programmingExercise.configureGrading.save",1,"btn","btn-primary","ms-3","my-3",3,"click","disabled"],["id","reset-table-button","jhiTranslate","artemisApp.programmingExercise.configureGrading.reset",1,"btn","btn-secondary","ms-3","my-1",3,"click","disabled"],["id","import-configuration-button",1,"btn","btn-primary","ms-3","my-1",3,"click","disabled"],[3,"icon"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.categories.import",1,"hidden-sm-down"]],template:function(a,n){a&1&&(x(0,qn,8,2),s(1,"button",0),u("click",function(){return n.onSave.emit()}),o(),e(2,`
`),s(3,"button",1),u("click",function(){return n.onReset.emit()}),o(),e(4,`
`)),a&2&&(h(n.activeTab==="code-analysis"?0:-1),r(),c("disabled",n.isSaving||!n.hasUnsavedChanges),r(2),c("disabled",n.isSaving))},dependencies:[Y,w],encapsulation:2})}return i})();var Kn=i=>({width:i,height:"30px"}),Yn=(i,p)=>({width:"100%",height:i,background:p});function $n(i,p){if(i&1&&(e(0,`
                    `),s(1,"div",2),e(2,`
                        `),m(3,"div"),e(4,`
                    `),o(),e(5,`
                `)),i&2){let t=p.$implicit;r(),Pe(A(5,Kn,t.w)),c("ngbTooltip",t.tooltip),r(2),Pe(K(7,Yn,t.h,t.color))}}var tn=(()=>{class i{issuesMap;category;maxGradedIssues;totalStudents;maxNumberOfIssues;columns=[];ngOnChanges(){let t=Math.max(this.maxNumberOfIssues,10)+1,a=2,n=(100+a)/t-a,l=this.category.penalty>0?this.category.maxPenalty/this.category.penalty:0,g=new Array(t).fill(0).map((_,y)=>{let M=y+1,T=this.issuesMap&&this.issuesMap[M]||0;return{w:n+"%",h:(this.totalStudents>0?T/this.totalStudents*95:0)+4+"%",color:this.category.state===H.Inactive?"#ddd":T===0||this.category.state!==H.Graded?"#28a745":M>l?"#dc3545":"#ffc107",tooltip:`${T} student${T!==1?"s":""} ${T!==1?"have":"has"} ${M} issue${M!==1?"s":""}.`}});setTimeout(()=>this.columns=g)}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-category-issues-chart"]],inputs:{issuesMap:"issuesMap",category:"category",maxGradedIssues:"maxGradedIssues",totalStudents:"totalStudents",maxNumberOfIssues:"maxNumberOfIssues"},features:[_e],decls:9,vars:0,consts:[[2,"max-width","120px","margin","auto"],[1,"d-flex","justify-content-between",2,"height","30px"],["placement","bottom auto",1,"d-flex","align-items-end",3,"ngbTooltip"]],template:function(a,n){a&1&&(e(0,`
        `),s(1,"div",0),e(2,`
            `),s(3,"div",1),e(4,`
                `),V(5,$n,6,10,null,null,R),o(),e(7,`
        `),o(),e(8,`
    `)),a&2&&(r(5),B(n.columns))},dependencies:[Z],encapsulation:2})}return i})();var nn=(i,p)=>[i,p],ge=i=>({percentage:i});function Qn(i,p){if(i&1){let t=S();e(0,`
                        `),s(1,"button",7),u("click",function(){C(t);let n=d();return f(n.resetTableFilter())}),o(),e(2,`
                    `)}}function Xn(i,p){if(i&1&&(e(0,`
                                    `),s(1,"div"),e(2,`
                                        `),m(3,"span",8),e(4,`
                                        `),m(5,"br"),e(6,`
                                        `),m(7,"span",9),e(8,`
                                        `),m(9,"br"),e(10,`
                                        `),m(11,"span",10),e(12,`
                                    `),o(),e(13,`
                                `)),i&2){let t=d().model;r(3),c("translateValues",A(3,ge,t.value.toFixed(2))),r(4),c("translateValues",A(5,ge,t.issues.toFixed(2))),r(4),c("translateValues",A(7,ge,t.points.toFixed(2)))}}function Jn(i,p){if(i&1&&(e(0,`
                                    `),s(1,"div"),e(2,`
                                        `),m(3,"span",8),e(4,`
                                        `),m(5,"br"),e(6,`
                                        `),m(7,"span",9),e(8,`
                                        `),m(9,"br"),e(10,`
                                        `),m(11,"span",10),e(12,`
                                    `),o(),e(13,`
                                `)),i&2){let t=d().model;r(3),c("translateValues",A(3,ge,t.penalty.toFixed(2))),r(4),c("translateValues",A(5,ge,t.value.toFixed(2))),r(4),c("translateValues",A(7,ge,t.points.toFixed(2)))}}function Zn(i,p){if(i&1&&(e(0,`
                            `),s(1,"div"),e(2,`
                                `),m(3,"span",8),e(4,`
                                `),m(5,"br"),e(6,`
                                `),m(7,"span",9),e(8,`
                                `),m(9,"br"),e(10,`
                                `),m(11,"span",10),e(12,`
                            `),o(),e(13,`
                        `)),i&2){let t=d().model;r(3),c("translateValues",A(3,ge,t.penalty.toFixed(2))),r(4),c("translateValues",A(5,ge,t.issues.toFixed(2))),r(4),c("translateValues",A(7,ge,t.value.toFixed(2)))}}function ea(i,p){if(i&1&&(e(0,`
                        `),s(1,"b"),e(2),o(),e(3,`
                        `),m(4,"br"),e(5,`
                        `),s(6,"div"),e(7,`
                            `),x(8,Xn,14,9)(9,Jn,14,9),e(10,`
                        `),o(),e(11,`
                        `),x(12,Zn,14,9)),i&2){let t,a=p.model,n=d();r(2),F(a.name),r(6),h((t=a.series)===n.scaChartBarTitle.PENALTY?8:t===n.scaChartBarTitle.ISSUES?9:-1),r(4),h(K(3,nn,n.scaChartBarTitle.DEDUCTIONS_EN,n.scaChartBarTitle.DEDUCTIONS_DE).includes(a.series)?12:-1)}}var an=function(i){return i.PENALTY="Penalty",i.ISSUES="Issues",i.DEDUCTIONS_EN="Deductions",i.DEDUCTIONS_DE="Punkte",i}(an||{}),rn=(()=>{class i extends ve{translateService=b(Ne);navigationUtilsService=b(gt);categories;categoryIssuesMap;exercise;categoryColorsChange=new L;scaCategoryFilter=new L;scaChartBarTitle=an;ngxData=[];constructor(){super(),this.translateService.onLangChange.subscribe(()=>{this.updateTranslations()})}ngOnChanges(){this.ngxData=[],this.ngxColors.domain=[];let t={},a=this.categories.map(T=>pe(me({},T),{penalty:T.state===H.Graded?T.penalty:0,maxPenalty:T.state===H.Graded?T.maxPenalty:0})).map(T=>{let I=this.categoryIssuesMap?this.categoryIssuesMap[T.name]||{}:{},ne=Object.entries(I).reduce((ce,[xe,un])=>ce+parseInt(xe,10)*un,0),ae=Object.entries(I).map(([ce,xe])=>xe*Math.min(parseInt(ce,10)*T.penalty,T.maxPenalty)).reduce((ce,xe)=>ce+xe,0);return(this.exercise.maxStaticCodeAnalysisPenalty||1/0)<ae&&(ae=this.exercise.maxStaticCodeAnalysisPenalty),{category:T,issues:ne||0,penaltyPoints:ae}}),n=a.reduce((T,{category:I})=>T+Math.min(I.penalty,I.maxPenalty),0),l=a.reduce((T,{issues:I})=>T+I,0),g=a.reduce((T,{penaltyPoints:I})=>T+I,0),_={name:this.translateService.instant("artemisApp.programmingAssessment.penalty"),series:[]},y={name:this.translateService.instant("artemisApp.programmingAssessment.issues"),series:[]},M={name:this.translateService.instant("artemisApp.programmingAssessment.deductions"),series:[]};a.forEach((T,I)=>{let ne=n>0?Math.max(Math.min(T.category.penalty,T.category.maxPenalty)/n*100,0):0,ae=l>0?Math.max(T.issues/l*100,0):0,ce=g>0?Math.max(T.penaltyPoints/g*100,0):0,xe=bt(I/this.categories.length,50);_.series.push({name:T.category.name,value:ne,issues:ae,points:ce,isPenalty:!0,id:T.category.id}),y.series.push({name:T.category.name,value:ae,penalty:ne,points:ce}),M.series.push({name:T.category.name,value:ce,penalty:ne,issues:ae}),this.ngxColors.domain.push(xe),t[T.category.name]=xe}),this.ngxData.push(_),this.ngxData.push(y),this.ngxData.push(M),this.ngxData=[...this.ngxData],this.categoryColorsChange.emit(t)}onSelect(t){t.isPenalty?(this.tableFiltered=!0,this.scaCategoryFilter.emit(t.id)):this.navigationUtilsService.routeInNewTab(["course-management",this.exercise.course.id,"programming-exercises",this.exercise.id,"scores"])}resetTableFilter(){super.resetTableFilter(),this.scaCategoryFilter.emit(ve.RESET_TABLE)}updateTranslations(){let t=this.translateService.instant("artemisApp.programmingAssessment.penalty"),a=this.translateService.instant("artemisApp.programmingAssessment.issues"),n=this.translateService.instant("artemisApp.programmingAssessment.deductions"),l=[t,a,n];this.ngxData.forEach((g,_)=>{g.name=l[_]}),this.ngxData=[...this.ngxData]}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-sca-category-distribution-chart"]],inputs:{categories:"categories",categoryIssuesMap:"categoryIssuesMap",exercise:"exercise"},outputs:{categoryColorsChange:"categoryColorsChange",scaCategoryFilter:"scaCategoryFilter"},features:[qe,_e],decls:26,vars:13,consts:[["containerRef",""],["tooltipTemplate",""],[1,"d-flex","justify-content-between"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.categoryDistribution.title"],[3,"innerHTML"],[1,"chart","bg-light"],[3,"select","view","scheme","results","xAxis","yAxis","xAxisTickFormatting"],["type","button","jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.resetFilter",1,"btn","btn-info",3,"click"],["jhiTranslate","artemisApp.programmingAssessment.penaltyTooltip",3,"translateValues"],["jhiTranslate","artemisApp.programmingAssessment.issuesTooltip",3,"translateValues"],["jhiTranslate","artemisApp.programmingAssessment.deductionsTooltip",3,"translateValues"]],template:function(a,n){if(a&1){let l=S();e(0,`
        `),s(1,"div"),e(2,`
            `),s(3,"div"),e(4,`
                `),s(5,"div",2),e(6,`
                    `),m(7,"h4",3),e(8,`
                    `),x(9,Qn,3,0),o(),e(10,`
                `),m(11,"p",4),E(12,"artemisTranslate"),e(13,`
            `),o(),e(14,`
            `),s(15,"div",5,0),e(17,`
                `),s(18,"ngx-charts-bar-horizontal-normalized",6),u("select",function(_){return C(l),f(n.onSelect(_))}),e(19,`
                    `),x(20,ea,13,6,"ng-template",null,1,j),e(22,`
                `),o(),e(23,`
            `),o(),e(24,`
        `),o(),e(25,`
    `)}if(a&2){let l=q(16);r(9),h(n.tableFiltered?9:-1),r(2),c("innerHTML",P(12,8,"artemisApp.programmingExercise.configureGrading.charts.categoryDistribution.description"),re),r(7),c("view",K(10,nn,l.offsetWidth,l.offsetHeight))("scheme",n.ngxColors)("results",n.ngxData)("xAxis",!0)("yAxis",!0)("xAxisTickFormatting",n.xAxisFormatting)}},dependencies:[w,xt,ut,W],styles:[".chart[_ngcontent-%COMP%]{height:150px}.points-chart[_ngcontent-%COMP%]{height:100px}"]})}return i})();var Ee=(()=>{class i extends _t{search(t,a,n){let l=new St().set("page",t.page.toString()).set("pageSize",t.pageSize.toString()).set("searchTerm",t.searchTerm||"").set("sortingOrder",t.sortingOrder).set("sortedColumn",t.sortedColumn).set("filterTasks",n.filters.tasks.join(",")).set("filterTestCases",n.filters.testCases.join(",")).set("filterOccurrence",n.filters.occurrence.join(",")).set("filterErrorCategories",n.filters.errorCategories.join(",")).set("groupFeedback",a.toString());return this.get(`assessment/exercises/${n.exerciseId}/feedback-details`,{params:l})}getMaxCount(t){return this.get(`assessment/exercises/${t}/feedback-details-max-count`)}getParticipationForFeedbackDetailText(t,a){return U(this,null,function*(){let n=new St;return a.slice(0,5).forEach((g,_)=>{n=n.set(`feedbackId${_+1}`,g.toString())}),this.get(`assessment/exercises/${t}/feedback-details-participation`,{params:n})})}createChannel(t,a,n){return this.post(`communication/courses/${t}/${a}/feedback-channel`,n)}static \u0275fac=(()=>{let t;return function(n){return(t||(t=wt(i)))(n||i)}})();static \u0275prov=He({token:i,factory:i.\u0275fac})}return i})();var Et=(i,p)=>({label:i,value:p}),ia=i=>({label:i,value:"Student Error"});function na(i,p){i&1&&N(0)}function aa(i,p){i&1&&N(0)}function ra(i,p){i&1&&N(0)}function sa(i,p){i&1&&N(0)}function oa(i,p){if(i&1&&(e(0,`
        `),s(1,"p"),e(2),o(),e(3,`
    `)),i&2){let t=d();r(2),F(t.longFeedbackText())}}function la(i,p){if(i&1&&(e(0,`
        `),s(1,"p"),e(2),o(),e(3,`
    `)),i&2){let t=d();r(2),F(t.feedbackDetail().detailTexts[0])}}function ca(i,p){if(i&1&&(e(0,`
    `),s(1,"div",9),e(2,`
        `),m(3,"span",10),e(4,`
        `),s(5,"p"),e(6),o(),e(7,`
    `),o(),e(8,`
`)),i&2){let t=p.label,a=p.value;r(3),c("jhiTranslate",t),r(3),F(a)}}var sn=(()=>{class i{feedbackDetail=G.required();longFeedbackText=v("");activeModal=b(le);longFeedbackTextService=b(wi);TRANSLATION_BASE="artemisApp.programmingExercise.configureGrading.feedbackAnalysis";ngOnInit(){this.feedbackDetail().hasLongFeedbackText&&this.longFeedbackTextService.find(this.feedbackDetail().feedbackIds[0]).subscribe(t=>{this.longFeedbackText.set(t.body||this.feedbackDetail().detailTexts[0])})}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-feedback-modal"]],inputs:{feedbackDetail:[1,"feedbackDetail"]},decls:31,vars:25,consts:[["detailTemplate",""],[1,"d-flex","justify-content-between","align-items-center","border-bottom-0","p-3"],[1,"m-0",3,"jhiTranslate"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"my-0"],[1,"p-3","mb-0"],[1,"d-flex","justify-content-between","mb-3"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mb-3",3,"jhiTranslate"],[1,"px-3","pt-2","border","rounded-3"],[1,"fw-bold",3,"jhiTranslate"]],template:function(a,n){if(a&1){let l=S();s(0,"div",1),e(1,`
    `),m(2,"h4",2),e(3,`
    `),s(4,"button",3),u("click",function(){return C(l),f(n.activeModal.close())}),o(),e(5,`
`),o(),e(6,`
`),m(7,"hr",4),e(8,`
`),s(9,"div",5),e(10,`
    `),s(11,"div",6),e(12,`
        `),x(13,na,1,0,"ng-container",7),e(14,`
        `),x(15,aa,1,0,"ng-container",7),E(16,"number"),e(17,`
        `),x(18,ra,1,0,"ng-container",7),e(19,`
        `),x(20,sa,1,0,"ng-container",7),e(21,`
    `),o(),e(22,`

    `),m(23,"h5",8),e(24,`
    `),x(25,oa,4,1)(26,la,4,1),o(),e(27,`

`),x(28,ca,9,2,"ng-template",null,0,j),e(30,`
`)}if(a&2){let l=q(29);r(2),c("jhiTranslate",n.TRANSLATION_BASE+".feedbackModal.header"),r(11),c("ngTemplateOutlet",l)("ngTemplateOutletContext",K(14,Et,n.TRANSLATION_BASE+".task",n.feedbackDetail().taskName)),r(2),c("ngTemplateOutlet",l)("ngTemplateOutletContext",K(17,Et,n.TRANSLATION_BASE+".occurrence",n.feedbackDetail().count+" ("+$e(16,11,n.feedbackDetail().relativeCount,"1.0-0")+"%)")),r(3),c("ngTemplateOutlet",l)("ngTemplateOutletContext",K(20,Et,n.TRANSLATION_BASE+".testcase",n.feedbackDetail().testCaseName)),r(2),c("ngTemplateOutlet",l)("ngTemplateOutletContext",A(23,ia,n.TRANSLATION_BASE+".errorCategory")),r(3),c("jhiTranslate",n.TRANSLATION_BASE+".feedbackModal.feedbackTitle"),r(2),h(n.longFeedbackText()?25:26)}},dependencies:[w,et,Fe,Ze],encapsulation:2})}return i})();function ma(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"div",12),e(2,`
                    `),s(3,"div",13),e(4,`
                        `),s(5,"input",14),u("change",function(n){C(t);let l=d();return f(l.onCheckboxChange(n,"tasks"))}),o(),e(6,`
                        `),s(7,"label",15),e(8),o(),e(9,`
                    `),o(),e(10,`
                `),o(),e(11,`
            `)}if(i&2){let t=p.$implicit,a=d();r(5),Q("id","task-",t,""),c("value",t)("checked",a.filters.tasks.includes(t.toString())),r(3),F(t)}}function pa(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"div",12),e(2,`
                    `),s(3,"div",13),e(4,`
                        `),s(5,"input",14),u("change",function(n){C(t);let l=d();return f(l.onCheckboxChange(n,"testCases"))}),o(),e(6,`
                        `),s(7,"label",15),e(8),o(),e(9,`
                    `),o(),e(10,`
                `),o(),e(11,`
            `)}if(i&2){let t=p.$implicit,a=d();r(5),Q("id","testCase-",t,""),c("value",t)("checked",a.filters.testCases.includes(t)),r(3),F(t)}}function da(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"div",12),e(2,`
                    `),s(3,"div",13),e(4,`
                        `),s(5,"input",14),u("change",function(n){C(t);let l=d();return f(l.onCheckboxChange(n,"errorCategories"))}),o(),e(6,`
                        `),s(7,"label",16),e(8),o(),e(9,`
                    `),o(),e(10,`
                `),o(),e(11,`
            `)}if(i&2){let t=p.$implicit,a=d();r(5),Q("id","errorCategory-",t,""),c("value",t)("checked",a.filters.errorCategories.includes(t)),r(3),F(t)}}var on=(()=>{class i{localStorage=b(ot);activeModal=b(le);filterApplied=ze();TRANSLATION_BASE="artemisApp.programmingExercise.configureGrading.feedbackAnalysis.filterModal";FILTER_TASKS_KEY="feedbackAnalysis.tasks";FILTER_TEST_CASES_KEY="feedbackAnalysis.testCases";FILTER_OCCURRENCE_KEY="feedbackAnalysis.occurrence";FILTER_ERROR_CATEGORIES_KEY="feedbackAnalysis.errorCategories";testCaseNames=v([]);minCount=v(0);maxCount=v(0);taskArray=v([]);errorCategories=v([]);filters={tasks:[],testCases:[],occurrence:[this.minCount(),this.maxCount()||1],errorCategories:[]};applyFilter(){this.localStorage.store(this.FILTER_TASKS_KEY,this.filters.tasks),this.localStorage.store(this.FILTER_TEST_CASES_KEY,this.filters.testCases),this.localStorage.store(this.FILTER_OCCURRENCE_KEY,this.filters.occurrence),this.localStorage.store(this.FILTER_ERROR_CATEGORIES_KEY,this.filters.errorCategories),this.filterApplied.emit(this.filters),this.activeModal.close()}clearFilter(){this.localStorage.clear(this.FILTER_TASKS_KEY),this.localStorage.clear(this.FILTER_TEST_CASES_KEY),this.localStorage.clear(this.FILTER_OCCURRENCE_KEY),this.localStorage.clear(this.FILTER_ERROR_CATEGORIES_KEY),this.filters={tasks:[],testCases:[],occurrence:[this.minCount(),this.maxCount()],errorCategories:[]},this.filterApplied.emit(this.filters),this.activeModal.close()}onCheckboxChange(t,a){let n=t.target,l=this.filters[a];if(a==="occurrence"){let g=Number(n.value);this.pushValue(n,l,g)}else this.pushValue(n,l,n.value)}pushValue(t,a,n){if(t.checked)a.push(n);else{let l=a.indexOf(n);l>=0&&a.splice(l,1)}}closeModal(){this.activeModal.dismiss()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-feedback-filter-modal"]],outputs:{filterApplied:"filterApplied"},features:[Ce([Ee])],decls:53,vars:12,consts:[[1,"modal-header"],[1,"modal-title",3,"jhiTranslate"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"form-group"],[3,"jhiTranslate"],[1,"row"],[3,"selectedMinValueChange","selectedMaxValueChange","generalMinValue","generalMaxValue","selectedMinValue","selectedMaxValue"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary","me-auto",3,"click","jhiTranslate"],["type","button",1,"btn","btn-secondary",3,"click","jhiTranslate"],["type","submit",1,"btn","btn-primary",3,"click","jhiTranslate"],[1,"col-4"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"change","id","value","checked"],[1,"form-check-label","text-break"],[1,"form-check-label"]],template:function(a,n){a&1&&(s(0,"div",0),e(1,`
    `),m(2,"h5",1),e(3,`
    `),s(4,"button",2),u("click",function(){return n.closeModal()}),o(),e(5,`
`),o(),e(6,`
`),s(7,"div",3),e(8,`
    `),s(9,"div",4),e(10,`
        `),m(11,"label",5),e(12,`
        `),s(13,"div",6),e(14,`
            `),V(15,ma,12,5,null,null,R),o(),e(17,`
    `),o(),e(18,`
    `),s(19,"div",4),e(20,`
        `),m(21,"label",5),e(22,`
        `),s(23,"div",6),e(24,`
            `),V(25,pa,12,5,null,null,R),o(),e(27,`
    `),o(),e(28,`
    `),s(29,"div",4),e(30,`
        `),m(31,"label",5),e(32,`
        `),s(33,"div",6),e(34,`
            `),V(35,da,12,5,null,null,R),o(),e(37,`
    `),o(),e(38,`
    `),m(39,"label",5),e(40,`
    `),s(41,"jhi-range-slider",7),ie("selectedMinValueChange",function(g){return J(n.filters.occurrence[0],g)||(n.filters.occurrence[0]=g),g})("selectedMaxValueChange",function(g){return J(n.filters.occurrence[1],g)||(n.filters.occurrence[1]=g),g}),o(),e(42,`
`),o(),e(43,`

`),s(44,"div",8),e(45,`
    `),s(46,"button",9),u("click",function(){return n.clearFilter()}),o(),e(47,`
    `),s(48,"button",10),u("click",function(){return n.closeModal()}),o(),e(49,`
    `),s(50,"button",11),u("click",function(){return n.applyFilter()}),o(),e(51,`
`),o(),e(52,`
`)),a&2&&(r(2),c("jhiTranslate",n.TRANSLATION_BASE+".modalTitle"),r(9),c("jhiTranslate",n.TRANSLATION_BASE+".task"),r(4),B(n.taskArray()),r(6),c("jhiTranslate",n.TRANSLATION_BASE+".testcase"),r(4),B(n.testCaseNames()),r(6),c("jhiTranslate",n.TRANSLATION_BASE+".errorCategory"),r(4),B(n.errorCategories()),r(4),c("jhiTranslate",n.TRANSLATION_BASE+".occurrence"),r(2),c("generalMinValue",n.minCount())("generalMaxValue",n.maxCount()),te("selectedMinValue",n.filters.occurrence[0])("selectedMaxValue",n.filters.occurrence[1]),r(5),c("jhiTranslate",n.TRANSLATION_BASE+".clear"),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".cancel"),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".apply"))},dependencies:[Wi,w],encapsulation:2})}return i})();var ln=(()=>{class i{direction=G.required();faSortUp=Re;faSortDown=De;isAscending=Le(()=>this.direction()===X.ASCENDING);isDescending=Le(()=>this.direction()===X.DESCENDING);static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-sort-icon"]],inputs:{direction:[1,"direction"]},decls:7,vars:6,consts:[[1,"d-flex","flex-column","sort-icon"],[1,"icon",3,"icon"],[3,"icon"]],template:function(a,n){a&1&&(s(0,"div",0),e(1,`
    `),m(2,"fa-icon",1),e(3,`
    `),m(4,"fa-icon",2),e(5,`
`),o(),e(6,`
`)),a&2&&(r(2),je("color",n.isAscending()?"black":"grey"),c("icon",n.faSortUp),r(2),je("color",n.isDescending()?"black":"grey"),c("icon",n.faSortDown))},dependencies:[pt,Y],styles:[".sort-icon[_ngcontent-%COMP%]{margin-left:.5rem}.icon[_ngcontent-%COMP%]{margin-bottom:-1.25rem}"]})}return i})();var ua=i=>({count:i}),cn=i=>({label:i,colSize:"col-4"}),xa=i=>({label:i,colSize:"col-2"}),_a=(i,p,t)=>["/courses",i,"exercises",p,"repository",t];function Ca(i,p){if(i&1&&(e(0,`
    `),s(1,"th",6),e(2,`
        `),m(3,"span",7),e(4,`
    `),o(),e(5,`
`)),i&2){let t=p.label,a=p.colSize;r(),Ye(a),r(2),c("jhiTranslate",t)}}function fa(i,p){i&1&&(e(0,`
        `),s(1,"div",8),e(2,`
            `),s(3,"div",9),e(4,`
                `),m(5,"span",10),e(6,`
            `),o(),e(7,`
        `),o(),e(8,`
    `))}function ha(i,p){i&1&&N(0)}function ba(i,p){i&1&&N(0)}function Ta(i,p){i&1&&N(0)}function Sa(i,p){if(i&1&&(e(0,`
                    `),s(1,"tr"),e(2,`
                        `),s(3,"td"),e(4),o(),e(5,`
                        `),s(6,"td"),e(7),o(),e(8,`
                        `),s(9,"td"),e(10,`
                            `),m(11,"jhi-code-button",14),e(12,`
                        `),o(),e(13,`
                    `),o(),e(14,`
                `)),i&2){let t=p.$implicit,a=d(2);r(4),de("",t.firstName," ",t.lastName,""),r(3),F(t.login),r(4),c("smallButtons",!0)("repositoryUri",t.repositoryURI)("routerLinkForRepositoryView",Nt(6,_a,a.courseId(),a.exerciseId(),t.participationId))}}function va(i,p){if(i&1&&(e(0,`
        `),s(1,"table",11),e(2,`
            `),s(3,"thead"),e(4,`
                `),s(5,"tr"),e(6,`
                    `),x(7,ha,1,0,"ng-container",12),e(8,`
                    `),x(9,ba,1,0,"ng-container",12),e(10,`
                    `),x(11,Ta,1,0,"ng-container",12),e(12,`
                `),o(),e(13,`
            `),o(),e(14,`
            `),s(15,"tbody",13),e(16,`
                `),V(17,Sa,15,10,null,null,R),o(),e(19,`
        `),o(),e(20,`
    `)),i&2){let t=d(),a=q(1);r(7),c("ngTemplateOutlet",a)("ngTemplateOutletContext",A(6,cn,t.TRANSLATION_BASE+".name")),r(2),c("ngTemplateOutlet",a)("ngTemplateOutletContext",A(8,cn,t.TRANSLATION_BASE+".login")),r(2),c("ngTemplateOutlet",a)("ngTemplateOutletContext",A(10,xa,t.TRANSLATION_BASE+".repository")),r(6),B(t.participation())}}var mn=(()=>{class i{courseId=G.required();exerciseId=G.required();feedbackDetail=G.required();participation=v([]);TRANSLATION_BASE="artemisApp.programmingExercise.configureGrading.feedbackAnalysis.affectedStudentsModal";faSpinner=mt;isLoading=v(!1);activeModal=b(le);feedbackService=b(Ee);alertService=b(ee);constructor(){Xe(()=>{Qe(()=>U(this,null,function*(){yield this.loadAffected()}))})}loadAffected(){return U(this,null,function*(){let t=this.feedbackDetail();this.isLoading.set(!0);try{let a=yield this.feedbackService.getParticipationForFeedbackDetailText(this.exerciseId(),t.feedbackIds);this.participation.set(a)}catch{this.alertService.error(this.TRANSLATION_BASE+".error")}finally{this.isLoading.set(!1)}})}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-affected-students-modal"]],inputs:{courseId:[1,"courseId"],exerciseId:[1,"exerciseId"],feedbackDetail:[1,"feedbackDetail"]},features:[Ce([Ee])],decls:20,vars:6,consts:[["headerTemplate",""],[1,"modal-header"],[1,"modal-title",3,"jhiTranslate"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"jhiTranslate","translateValues"],["scope","col"],[3,"jhiTranslate"],[1,"row","justify-content-center","p-2"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"table","table-striped","mb-3"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"table-group-divider"],[1,"ms-2",3,"smallButtons","repositoryUri","routerLinkForRepositoryView"]],template:function(a,n){if(a&1){let l=S();x(0,Ca,6,3,"ng-template",null,0,j),e(2,`
`),s(3,"div",1),e(4,`
    `),m(5,"h4",2),e(6,`
    `),s(7,"button",3),u("click",function(){return C(l),f(n.activeModal.dismiss())}),o(),e(8,`
`),o(),e(9,`
`),s(10,"div",4),e(11,`
    `),s(12,"div"),e(13,`
        `),m(14,"span",5),e(15,`
    `),o(),e(16,`
    `),x(17,fa,9,0)(18,va,21,12),o(),e(19,`
`)}a&2&&(r(5),c("jhiTranslate",n.TRANSLATION_BASE+".header"),r(9),c("jhiTranslate",n.TRANSLATION_BASE+".description")("translateValues",A(4,ua,n.feedbackDetail().count)),r(3),h(n.isLoading()?17:18))},dependencies:[Gi,w],encapsulation:2})}return i})();var Ea=i=>({count:i}),pn=(()=>{class i{TRANSLATION_BASE="artemisApp.programmingExercise.configureGrading.feedbackAnalysis.feedbackDetailChannel.confirmationModal";affectedStudentsCount=G.required();activeModal=b(le);confirm(){this.activeModal.close(!0)}dismiss(){this.activeModal.dismiss()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-confirm-feedback-channel-creation-modal"]],inputs:{affectedStudentsCount:[1,"affectedStudentsCount"]},decls:19,vars:7,consts:[[1,"modal-header"],[1,"modal-title",3,"jhiTranslate"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"jhiTranslate","translateValues"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click","jhiTranslate"],["type","button",1,"btn","btn-primary",3,"click","jhiTranslate"]],template:function(a,n){a&1&&(s(0,"div",0),e(1,`
    `),m(2,"h4",1),e(3,`
    `),s(4,"button",2),u("click",function(){return n.dismiss()}),o(),e(5,`
`),o(),e(6,`
`),s(7,"div",3),e(8,`
    `),m(9,"p",4),e(10,`
`),o(),e(11,`
`),s(12,"div",5),e(13,`
    `),s(14,"button",6),u("click",function(){return n.dismiss()}),o(),e(15,`
    `),s(16,"button",7),u("click",function(){return n.confirm()}),o(),e(17,`
`),o(),e(18,`
`)),a&2&&(r(2),c("jhiTranslate",n.TRANSLATION_BASE+".header"),r(7),c("jhiTranslate",n.TRANSLATION_BASE+".confirmationMessage")("translateValues",A(5,Ea,n.affectedStudentsCount)),r(5),c("jhiTranslate",n.TRANSLATION_BASE+".cancel"),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".confirm"))},dependencies:[w],encapsulation:2})}return i})();var ya=i=>({count:i}),Aa=()=>({max:"30"}),ka=()=>({max:"250"});function Pa(i,p){if(i&1&&(e(0,`
        `),s(1,"div",28),e(2,`
            `),m(3,"div",2),e(4,`
        `),o(),e(5,`
    `)),i&2){let t=d();r(3),c("jhiTranslate",t.TRANSLATION_BASE+".dueDate")}}function Fa(i,p){if(i&1&&(e(0,`
                        `),m(1,"div",2),e(2,`
                    `)),i&2){let t=d(2);r(),c("jhiTranslate",t.TRANSLATION_BASE+".requiredValidationErrorName")}}function Ia(i,p){if(i&1&&(e(0,`
                        `),m(1,"div",23),e(2,`
                    `)),i&2){let t=d(2);r(),c("jhiTranslate",t.TRANSLATION_BASE+".maxLengthValidationErrorName")("translateValues",fe(2,Aa))}}function wa(i,p){if(i&1&&(e(0,`
                        `),m(1,"div",2),e(2,`
                    `)),i&2){let t=d(2);r(),c("jhiTranslate",t.TRANSLATION_BASE+".regexValidationErrorName")}}function Ma(i,p){if(i&1&&(e(0,`
                `),s(1,"div",29),e(2,`
                    `),x(3,Fa,3,1)(4,Ia,3,3)(5,wa,3,1),o(),e(6,`
            `)),i&2){let t,a,n,l=d();r(3),h(!((t=l.form.get("name"))==null||t.errors==null)&&t.errors.required?3:-1),r(),h(!((a=l.form.get("name"))==null||a.errors==null)&&a.errors.maxlength?4:-1),r(),h(!((n=l.form.get("name"))==null||n.errors==null)&&n.errors.pattern?5:-1)}}function Na(i,p){if(i&1&&(e(0,`
                        `),m(1,"div",2),e(2,`
                    `)),i&2){let t=d(2);r(),c("jhiTranslate",t.TRANSLATION_BASE+".requiredValidationErrorDescription")}}function Da(i,p){if(i&1&&(e(0,`
                        `),m(1,"div",23),e(2,`
                    `)),i&2){let t=d(2);r(),c("jhiTranslate",t.TRANSLATION_BASE+".maxLengthValidationErrorDescription")("translateValues",fe(2,ka))}}function Ga(i,p){if(i&1&&(e(0,`
                `),s(1,"div",29),e(2,`
                    `),x(3,Na,3,1)(4,Da,3,3),o(),e(5,`
            `)),i&2){let t,a,n=d();r(3),h(!((t=n.form.get("description"))==null||t.errors==null)&&t.errors.required?3:-1),r(),h(!((a=n.form.get("description"))==null||a.errors==null)&&a.errors.maxlength?4:-1)}}var dn=(()=>{class i{TRANSLATION_BASE="artemisApp.programmingExercise.configureGrading.feedbackAnalysis.feedbackDetailChannel";feedbackDetail=G.required();exerciseDueDate=G();currentDateTime=v(Vt());formSubmitted=ze();isConfirmModalOpen=v(!1);alertService=b(ee);formBuilder=b(qt);activeModal=b(le);modalService=b(Me);form=this.formBuilder.group({name:["",[he.required,he.maxLength(30),he.pattern("^[a-z0-9-]{1}[a-z0-9-]{0,30}$")]],description:["",[he.required,he.maxLength(250)]],isPrivate:[!0,he.required],isAnnouncementChannel:[!1,he.required]});submitForm(t){return U(this,null,function*(){if(this.form.valid&&!this.isConfirmModalOpen()){if(this.isConfirmModalOpen.set(!0),yield this.handleModal()){let n=new fi;n.name=this.form.get("name")?.value,n.description=this.form.get("description")?.value,n.topic="FeedbackDiscussion",n.isPublic=!this.form.get("isPrivate")?.value||!1,n.isAnnouncementChannel=this.form.get("isAnnouncementChannel")?.value||!1,this.formSubmitted.emit({channelDto:n,navigate:t}),this.closeModal()}this.isConfirmModalOpen.set(!1)}})}handleModal(){return U(this,null,function*(){try{let t=this.modalService.open(pn,{centered:!0});return t.componentInstance.affectedStudentsCount=this.feedbackDetail().count,yield t.result}catch(t){return this.alertService.error(t),!1}})}closeModal(){this.activeModal.close()}dismissModal(){this.activeModal.dismiss()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-feedback-detail-channel-modal"]],inputs:{feedbackDetail:[1,"feedbackDetail"],exerciseDueDate:[1,"exerciseDueDate"]},outputs:{formSubmitted:"formSubmitted"},decls:104,vars:36,consts:[[1,"modal-header"],[1,"modal-title"],[3,"jhiTranslate"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3","text-muted"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","name",3,"jhiTranslate"],["type","text","id","name","formControlName","name",1,"form-control"],["for","description",3,"jhiTranslate"],["type","text","id","description","formControlName","description",1,"form-control"],["role","group",1,"btn-group"],["type","radio","id","public","formControlName","isPrivate",1,"btn-check",3,"value"],["for","public",1,"btn","btn-outline-secondary",3,"jhiTranslate"],["type","radio","id","private","formControlName","isPrivate",1,"btn-check",3,"value"],["for","private",1,"btn","btn-outline-secondary",3,"jhiTranslate"],["type","radio","id","announcement","formControlName","isAnnouncementChannel",1,"btn-check",3,"value"],["for","announcement",1,"btn","btn-outline-secondary",3,"jhiTranslate"],["type","radio","id","regular","formControlName","isAnnouncementChannel",1,"btn-check",3,"value"],["for","regular",1,"btn","btn-outline-secondary",3,"jhiTranslate"],[1,"form-group","mt-3"],[1,"text-info"],[3,"jhiTranslate","translateValues"],[1,"mt-3","text-muted"],[1,"d-flex","justify-content-end","mt-3"],["type","button",1,"btn","btn-primary","me-2",3,"click","disabled","jhiTranslate"],["type","button",1,"btn","btn-primary",3,"click","disabled","jhiTranslate"],[1,"alert","alert-info","mt-2"],[1,"alert","alert-danger","mt-2"]],template:function(a,n){a&1&&(s(0,"div",0),e(1,`
    `),s(2,"h4",1),e(3,`
        `),m(4,"span",2),e(5,`
    `),o(),e(6,`
    `),s(7,"button",3),u("click",function(){return n.dismissModal()}),o(),e(8,`
`),o(),e(9,`
`),s(10,"div",4),e(11,`
    `),s(12,"div",5),e(13,`
        `),m(14,"p",2),e(15,`
    `),o(),e(16,`
    `),x(17,Pa,6,1),s(18,"form",6),u("ngSubmit",function(){return n.submitForm(!1)}),e(19,`
        `),s(20,"div",7),e(21,`
            `),m(22,"label",8),e(23,`
            `),m(24,"input",9),E(25,"artemisTranslate"),e(26,`
            `),x(27,Ma,7,3),o(),e(28,`
        `),s(29,"div",7),e(30,`
            `),m(31,"label",10),e(32,`
            `),m(33,"input",11),E(34,"artemisTranslate"),e(35,`
            `),x(36,Ga,6,2),o(),e(37,`
        `),s(38,"div",7),e(39,`
            `),m(40,"label",2),e(41,`
            `),s(42,"div",12),e(43,`
                `),m(44,"input",13),e(45,`
                `),m(46,"label",14),e(47,`
                `),m(48,"input",15),e(49,`
                `),m(50,"label",16),e(51,`
            `),o(),e(52,`
        `),o(),e(53,`
        `),s(54,"div",7),e(55,`
            `),m(56,"label",2),e(57,`
            `),s(58,"div",12),e(59,`
                `),m(60,"input",17),e(61,`
                `),m(62,"label",18),e(63,`
                `),m(64,"input",19),e(65,`
                `),m(66,"label",20),e(67,`
            `),o(),e(68,`
        `),o(),e(69,`

        `),s(70,"div",21),e(71,`
            `),s(72,"p",22),e(73,`
                `),m(74,"strong",23),e(75,`
            `),o(),e(76,`
        `),o(),e(77,`
        `),s(78,"div",24),e(79,`
            `),s(80,"p"),e(81,`
                `),m(82,"strong",2),e(83,`
                `),m(84,"span",2),e(85,`
            `),o(),e(86,`
            `),s(87,"p"),e(88,`
                `),m(89,"strong",2),e(90,`
                `),m(91,"span",2),e(92,`
            `),o(),e(93,`
        `),o(),e(94,`
        `),s(95,"div",25),e(96,`
            `),s(97,"button",26),u("click",function(){return n.submitForm(!0)}),o(),e(98,`
            `),s(99,"button",27),u("click",function(){return n.submitForm(!1)}),o(),e(100,`
        `),o(),e(101,`
    `),o(),e(102,`
`),o(),e(103,`
`)),a&2&&(r(4),c("jhiTranslate",n.TRANSLATION_BASE+".title"),r(10),c("jhiTranslate",n.TRANSLATION_BASE+".description"),r(3),h(!n.exerciseDueDate()||n.currentDateTime().isBefore(n.exerciseDueDate())?17:-1),r(),c("formGroup",n.form),r(4),c("jhiTranslate",n.TRANSLATION_BASE+".label"),r(2),Tt("placeholder",P(25,30,n.TRANSLATION_BASE+".placeholder")),r(3),h(n.form.controls.name.invalid&&(n.form.controls.name.dirty||n.form.controls.name.touched)?27:-1),r(4),c("jhiTranslate",n.TRANSLATION_BASE+".descriptionLabel"),r(2),Tt("placeholder",P(34,32,n.TRANSLATION_BASE+".placeholder")),r(3),h(n.form.controls.description.invalid&&(n.form.controls.description.dirty||n.form.controls.description.touched)?36:-1),r(4),c("jhiTranslate",n.TRANSLATION_BASE+".channelVisibility"),r(4),c("value",!1),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".visibilityPublic"),r(2),c("value",!0),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".visibilityPrivate"),r(6),c("jhiTranslate",n.TRANSLATION_BASE+".announcementChannel"),r(4),c("value",!0),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".announcementChannelYes"),r(2),c("value",!1),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".announcementChannelNo"),r(8),c("jhiTranslate",n.TRANSLATION_BASE+".studentNumber")("translateValues",A(34,ya,n.feedbackDetail().count)),r(8),c("jhiTranslate",n.TRANSLATION_BASE+".createAndNavigateLabel"),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".createAndNavigateDescription"),r(5),c("jhiTranslate",n.TRANSLATION_BASE+".createChannelLabel"),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".createChannelDescription"),r(6),c("disabled",!n.form.valid)("jhiTranslate",n.TRANSLATION_BASE+".createAndNavigateLabel"),r(2),c("disabled",!n.form.valid)("jhiTranslate",n.TRANSLATION_BASE+".createChannelLabel"))},dependencies:[oe,nt,Ie,Ut,be,it,Kt,Wt,Ht,w,W],encapsulation:2})}return i})();var Oa=i=>({exerciseTitle:i}),Ra=i=>({column:"count",label:i,colSize:"col-1"}),Va=i=>({column:"detailTexts",label:i,colSize:"col-6"}),Ba=i=>({column:"taskName",label:i,colSize:"col-1"}),ja=i=>({column:"testCaseName",label:i,colSize:"col-2"}),La=i=>({column:"errorCategory",label:i,colSize:"col-1"}),Ua=i=>({count:i});function Wa(i,p){if(i&1&&(e(0,`
                `),m(1,"jhi-sort-icon",23),e(2,`
            `)),i&2){let t=d().column,a=d();r(),c("direction",a.getSortDirection(t))}}function Ha(i,p){if(i&1){let t=S();e(0,`
    `),s(1,"th",22),u("click",function(){let n=C(t).column,l=d();return f(n!=="errorCategory"&&l.setSortedColumn(n))}),e(2,`
        `),s(3,"div",6),e(4,`
            `),m(5,"span",10),e(6,`
            `),x(7,Wa,3,1),o(),e(8,`
    `),o(),e(9,`
`)}if(i&2){let t=p.column,a=p.label,n=p.colSize;r(),Ye(n),Ke("clickable",t!=="errorCategory"),r(4),c("jhiTranslate",a),r(2),h(t!=="errorCategory"?7:-1)}}function za(i,p){if(i&1&&(e(0,`
    `),m(1,"div",24),e(2,`
`)),i&2){let t=d();r(),c("jhiTranslate",t.selectedFiltersCount()>0||t.searchTerm()!==""?t.TRANSLATION_BASE+".noDataFilter":t.TRANSLATION_BASE+".noData")}}function qa(i,p){i&1&&N(0)}function Ka(i,p){i&1&&N(0)}function Ya(i,p){i&1&&N(0)}function $a(i,p){i&1&&N(0)}function Qa(i,p){i&1&&N(0)}function Xa(i,p){i&1&&(e(0,`
                `),s(1,"div",25),e(2,`
                    `),s(3,"div",26),e(4,`
                        `),m(5,"span",27),e(6,`
                    `),o(),e(7,`
                `),o(),e(8,`
            `))}function Ja(i,p){i&1&&N(0)}function Za(i,p){if(i&1&&(e(0,`
                        `),s(1,"tr"),e(2,`
                            `),s(3,"td",29),e(4,`
                                `),x(5,Ja,1,0,"ng-container",30),e(6,`
                            `),o(),e(7,`
                        `),o(),e(8,`
                    `)),i&2){d(2);let t=q(4);r(5),c("ngTemplateOutlet",t)}}function er(i,p){if(i&1){let t=S();e(0,`
                                            `),s(1,"fa-icon",33),u("click",function(){C(t);let n=d().$implicit,l=d(3);return f(l.openFeedbackDetailChannelModal(n))}),o(),e(2,`
                                        `)}if(i&2){let t=d(4);r(),c("icon",t.faMessage)}}function tr(i,p){if(i&1){let t=S();e(0,`
                            `),s(1,"tr"),e(2,`
                                `),s(3,"td",31),e(4),E(5,"number"),o(),e(6,`
                                `),s(7,"td"),e(8),E(9,"slice"),o(),e(10,`
                                `),s(11,"td"),e(12),o(),e(13,`
                                `),s(14,"td"),e(15),o(),e(16,`
                                `),s(17,"td"),e(18),o(),e(19,`
                                `),s(20,"td",31),e(21,`
                                    `),s(22,"div",32),e(23,`
                                        `),s(24,"fa-icon",33),u("click",function(){let n=C(t).$implicit,l=d(3);return f(l.openFeedbackModal(n))}),o(),e(25,`
                                        `),s(26,"fa-icon",33),u("click",function(){let n=C(t).$implicit,l=d(3);return f(l.openAffectedStudentsModal(n))}),o(),e(27,`
                                        `),x(28,er,3,1),o(),e(29,`
                                `),o(),e(30,`
                            `),o(),e(31,`
                        `)}if(i&2){let t=p.$implicit,a=d(3);r(4),de("",t.count," (",$e(5,9,t.relativeCount,"1.0-0"),"%)"),r(4),se(`
                                    `,t.detailTexts[0].length>a.MAX_FEEDBACK_DETAIL_TEXT_LENGTH?Dt(9,12,t.detailTexts[0],0,100)+"...":t.detailTexts[0],`
                                `),r(4),F(t.taskName),r(3),F(t.testCaseName),r(3),F(t.errorCategory),r(6),c("icon",a.facDetails),r(2),c("icon",a.faUsers),r(2),h(a.isCommunicationEnabled()?28:-1)}}function ir(i,p){if(i&1&&(e(0,`
                        `),V(1,tr,32,16,null,null,R)),i&2){let t=d(2);r(),B(t.content().resultsOnPage)}}function nr(i,p){if(i&1&&(e(0,`
                `),s(1,"tbody",28),e(2,`
                    `),x(3,Za,9,1)(4,ir,3,0),o(),e(5,`
            `)),i&2){let t=d();r(3),h(t.content().resultsOnPage?4:3)}}var gn=(()=>{class i{exerciseTitle=G.required();exerciseId=G.required();exerciseDueDate=G();courseId=G.required();isCommunicationEnabled=G.required();feedbackAnalysisService=b(Ee);alertService=b(ee);modalService=b(Me);localStorage=b(ot);router=b(tt);page=v(1);pageSize=v(25);searchTerm=v("");sortingOrder=v(X.DESCENDING);sortedColumn=v("count");content=v({resultsOnPage:[],numberOfPages:0});totalItems=v(0);collectionsSize=Le(()=>this.content().numberOfPages*this.pageSize());TRANSLATION_BASE="artemisApp.programmingExercise.configureGrading.feedbackAnalysis";faSort=Ge;faFilter=ni;facDetails=Mi;faUsers=ei;faMessage=Jt;faCircleQuestion=ai;SortingOrder=X;MAX_FEEDBACK_DETAIL_TEXT_LENGTH=200;faSpinner=mt;isLoading=v(!1);FILTER_TASKS_KEY="feedbackAnalysis.tasks";FILTER_TEST_CASES_KEY="feedbackAnalysis.testCases";FILTER_OCCURRENCE_KEY="feedbackAnalysis.occurrence";FILTER_ERROR_CATEGORIES_KEY="feedbackAnalysis.errorCategories";selectedFiltersCount=v(0);taskNames=v([]);testCaseNames=v([]);minCount=v(0);maxCount=v(0);errorCategories=v(["Student Error","Ares Error","AST Error"]);isFeedbackDetailChannelModalOpen=!1;debounceLoadData=_t.debounce(this.loadData.bind(this),300);groupFeedback=v(!1);currentRequestFilters=v(void 0);currentRequestState=v(void 0);currentRequestGroupFeedback=v(void 0);currentResponseData=v(void 0);previousRequestFilters=v(void 0);previousRequestState=v(void 0);previousRequestGroupFeedback=v(void 0);previousResponseData=v(void 0);constructor(){Xe(()=>{Qe(()=>U(this,null,function*(){yield this.loadData()}))})}loadData(){return U(this,null,function*(){let t=this.localStorage.retrieve(this.FILTER_TASKS_KEY)||[],a=this.localStorage.retrieve(this.FILTER_TEST_CASES_KEY)||[],n=this.localStorage.retrieve(this.FILTER_OCCURRENCE_KEY)||[],l=this.localStorage.retrieve(this.FILTER_ERROR_CATEGORIES_KEY)||[],g={page:this.page(),pageSize:this.pageSize(),searchTerm:this.searchTerm()||"",sortingOrder:this.sortingOrder(),sortedColumn:this.sortedColumn(),filterErrorCategories:this.errorCategories()},_={tasks:this.selectedFiltersCount()!==0?t:[],testCases:this.selectedFiltersCount()!==0?a:[],occurrence:this.selectedFiltersCount()!==0?n:[],errorCategories:this.selectedFiltersCount()!==0?l:[]},y=this.previousResponseData();if(JSON.stringify(this.previousRequestFilters())===JSON.stringify(_)&&JSON.stringify(this.previousRequestState())===JSON.stringify(g)&&this.previousRequestGroupFeedback()===this.groupFeedback()&&y){this.updateCache(y,g,_);return}this.isLoading.set(!0);try{let M=yield this.feedbackAnalysisService.search(g,this.groupFeedback(),{exerciseId:this.exerciseId(),filters:_});this.updateCache(M,g,_)}catch{this.alertService.error(this.TRANSLATION_BASE+".error")}finally{this.isLoading.set(!1)}})}updateCache(t,a,n){this.content.set(t.feedbackDetails),this.totalItems.set(t.totalItems),this.taskNames.set(t.taskNames),this.testCaseNames.set(t.testCaseNames),this.errorCategories.set(t.errorCategories),this.maxCount.set(t.highestOccurrenceOfGroupedFeedback),this.previousResponseData.set(this.currentResponseData()),this.previousRequestGroupFeedback.set(this.currentRequestGroupFeedback()),this.previousRequestState.set(this.currentRequestState()),this.previousRequestFilters.set(this.currentRequestFilters()),this.currentResponseData.set(t),this.currentRequestGroupFeedback.set(this.groupFeedback()),this.currentRequestState.set(a),this.currentRequestFilters.set(n)}setPage(t){this.page.set(t),this.loadData()}search(t){return U(this,null,function*(){this.page.set(1),this.searchTerm.set(t),this.debounceLoadData()})}openFeedbackModal(t){let a=this.modalService.open(sn,{centered:!0,size:"lg"});a.componentInstance.feedbackDetail=v(t)}setSortedColumn(t){this.sortedColumn()===t?this.sortingOrder.set(this.sortingOrder()===X.ASCENDING?X.DESCENDING:X.ASCENDING):(this.sortedColumn.set(t),this.sortingOrder.set(X.ASCENDING)),this.loadData()}getSortDirection(t){return this.sortedColumn()===t?this.sortingOrder()===X.ASCENDING?X.ASCENDING:X.DESCENDING:"none"}openFilterModal(){return U(this,null,function*(){let t=this.localStorage.retrieve(this.FILTER_TASKS_KEY),a=this.localStorage.retrieve(this.FILTER_TEST_CASES_KEY),n=this.localStorage.retrieve(this.FILTER_OCCURRENCE_KEY),l=this.localStorage.retrieve(this.FILTER_ERROR_CATEGORIES_KEY);this.minCount.set(0),this.groupFeedback()?this.maxCount.set(this.maxCount()):this.maxCount.set(yield this.feedbackAnalysisService.getMaxCount(this.exerciseId()));let g=this.modalService.open(on,{centered:!0,size:"lg"});g.componentInstance.exerciseId=this.exerciseId,g.componentInstance.taskArray=this.taskNames,g.componentInstance.testCaseNames=this.testCaseNames,g.componentInstance.maxCount=this.maxCount,g.componentInstance.errorCategories=this.errorCategories,g.componentInstance.filters={tasks:this.selectedFiltersCount()!==0?t:[],testCases:this.selectedFiltersCount()!==0?a:[],occurrence:this.selectedFiltersCount()!==0?n:[this.minCount(),this.maxCount()],errorCategories:this.selectedFiltersCount()!==0?l:[]},g.componentInstance.filterApplied.subscribe(_=>{this.applyFilters(_)})})}applyFilters(t){this.selectedFiltersCount.set(this.countAppliedFilters(t)),this.loadData()}countAppliedFilters(t){let a=0;return t.tasks&&t.tasks.length>0&&(a+=t.tasks.length),t.testCases&&t.testCases.length>0&&(a+=t.testCases.length),t.errorCategories?.length&&(a+=t.errorCategories.length),t.occurrence&&(t.occurrence[0]!==0||t.occurrence[1]!==this.maxCount())&&a++,a}openAffectedStudentsModal(t){return U(this,null,function*(){let a=this.modalService.open(mn,{centered:!0,size:"lg"});a.componentInstance.courseId=this.courseId,a.componentInstance.exerciseId=this.exerciseId,a.componentInstance.feedbackDetail=v(t)})}openFeedbackDetailChannelModal(t){return U(this,null,function*(){if(this.isFeedbackDetailChannelModalOpen)return;this.isFeedbackDetailChannelModalOpen=!0;let a=this.modalService.open(dn,{centered:!0,size:"lg"});a.componentInstance.feedbackDetail=v(t),a.componentInstance.exerciseDueDate=v(this.exerciseDueDate()),a.componentInstance.formSubmitted.subscribe(g=>U(this,[g],function*({channelDto:n,navigate:l}){try{let _={channel:n,feedbackDetailTexts:t.detailTexts,testCaseName:t.testCaseName},y=yield this.feedbackAnalysisService.createChannel(this.courseId(),this.exerciseId(),_),M=y.name;if(this.alertService.success(this.TRANSLATION_BASE+".channelSuccess",{channelName:M}),l){let T=this.router.createUrlTree(["courses",this.courseId(),"communication"],{queryParams:{conversationId:y.id}});yield this.router.navigateByUrl(T)}}catch(_){this.alertService.error(_)}}));try{yield a.result}catch{}finally{this.isFeedbackDetailChannelModalOpen=!1}})}toggleGroupFeedback(){this.groupFeedback.update(t=>!t),this.loadData()}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-feedback-analysis"]],inputs:{exerciseTitle:[1,"exerciseTitle"],exerciseId:[1,"exerciseId"],exerciseDueDate:[1,"exerciseDueDate"],courseId:[1,"courseId"],isCommunicationEnabled:[1,"isCommunicationEnabled"]},features:[Ce([Ee])],decls:77,vars:47,consts:[["headerTemplate",""],["emptyTableTemplate",""],[1,"m-3"],[1,"row","m-0","justify-content-between","align-items-center"],[1,"justify-content-between","d-flex","align-items-center"],[1,"m-0","p-0",3,"jhiTranslate","translateValues"],[1,"d-flex","align-items-center"],[1,"form-switch","d-flex","align-items-center","flex-md-shrink-0","me-2"],["type","checkbox",1,"form-check-input","mt-0",2,"width","2.5rem","height","1.25rem",3,"click","checked"],[1,"ms-1","me-2","mb-0"],[3,"jhiTranslate"],["size","sm",1,"btn-warning",3,"icon","ngbTooltip"],[1,"btn","me-2",3,"click","ngClass"],[3,"icon"],["type","search","aria-label","Search feedback",1,"form-control",3,"ngModelChange","placeholder","ngModel"],[2,"overflow-x","auto"],[1,"table","table-striped","mb-3"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"d-flex","flex-column","align-items-end","mt-2"],["size","sm",3,"pageChange","collectionSize","pageSize","page","maxSize"],[1,"text-muted","text-end"],[3,"jhiTranslate","translateValues"],["scope","col",3,"click"],[3,"direction"],[1,"text-center","p-3","text-muted",3,"jhiTranslate"],[1,"row","justify-content-center","p-2"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"table-group-divider"],["colspan","6"],[4,"ngTemplateOutlet"],[1,"text-center"],[1,"d-flex","justify-content-center","align-items-center"],[1,"ms-2","clickable","text-primary",3,"click","icon"]],template:function(a,n){if(a&1){let l=S();x(0,Ha,10,6,"ng-template",null,0,j),e(2,`
`),x(3,za,3,1,"ng-template",null,1,j),e(5,`
`),s(6,"div",2),e(7,`
    `),s(8,"div",3),e(9,`
        `),s(10,"div",4),e(11,`
            `),m(12,"h3",5),e(13,`
            `),s(14,"div",6),e(15,`
                `),s(16,"div",7),e(17,`
                    `),s(18,"input",8),u("click",function(){return C(l),f(n.toggleGroupFeedback())}),o(),e(19,`
                    `),s(20,"label",9),e(21,`
                        `),m(22,"span",10),e(23,`
                        `),m(24,"fa-icon",11),E(25,"artemisTranslate"),e(26,`
                    `),o(),e(27,`
                `),o(),e(28,`
                `),s(29,"button",12),u("click",function(){return C(l),f(n.openFilterModal())}),e(30,`
                    `),m(31,"fa-icon",13),e(32,`
                    `),m(33,"span",10),e(34),o(),e(35,`
                `),s(36,"input",14),E(37,"artemisTranslate"),u("ngModelChange",function(_){return C(l),f(n.search(_))}),o(),e(38,`
            `),o(),e(39,`
        `),o(),e(40,`
    `),o(),e(41,`
    `),s(42,"div",15),e(43,`
        `),s(44,"table",16),e(45,`
            `),s(46,"thead"),e(47,`
                `),s(48,"tr"),e(49,`
                    `),x(50,qa,1,0,"ng-container",17),e(51,`
                    `),x(52,Ka,1,0,"ng-container",17),e(53,`
                    `),x(54,Ya,1,0,"ng-container",17),e(55,`
                    `),x(56,$a,1,0,"ng-container",17),e(57,`
                    `),x(58,Qa,1,0,"ng-container",17),e(59,`
                `),o(),e(60,`
            `),o(),e(61,`
            `),x(62,Xa,9,0)(63,nr,6,1),o(),e(64,`
    `),o(),e(65,`
    `),s(66,"div",18),e(67,`
        `),s(68,"ngb-pagination",19),u("pageChange",function(_){return C(l),f(n.setPage(_))}),o(),e(69,`
        `),s(70,"div",20),e(71,`
            `),m(72,"span",21),e(73,`
        `),o(),e(74,`
    `),o(),e(75,`
`),o(),e(76,`
`)}if(a&2){let l=q(1);r(12),c("jhiTranslate",n.TRANSLATION_BASE+".title")("translateValues",A(33,Oa,n.exerciseTitle())),r(6),c("checked",n.groupFeedback()),r(4),c("jhiTranslate",n.TRANSLATION_BASE+".groupFeedback"),r(2),c("icon",n.faCircleQuestion)("ngbTooltip",P(25,29,n.TRANSLATION_BASE+".groupFeedbackTooltip")),r(5),c("ngClass",n.selectedFiltersCount()?"btn-success":"btn-secondary"),r(2),c("icon",n.faFilter),r(2),c("jhiTranslate",n.TRANSLATION_BASE+".filter"),r(),se(" (",n.selectedFiltersCount(),`)
                `),r(2),c("placeholder",P(37,31,n.TRANSLATION_BASE+".search"))("ngModel",n.searchTerm()),r(14),c("ngTemplateOutlet",l)("ngTemplateOutletContext",A(35,Ra,n.TRANSLATION_BASE+".occurrence")),r(2),c("ngTemplateOutlet",l)("ngTemplateOutletContext",A(37,Va,n.TRANSLATION_BASE+".feedback")),r(2),c("ngTemplateOutlet",l)("ngTemplateOutletContext",A(39,Ba,n.TRANSLATION_BASE+".task")),r(2),c("ngTemplateOutlet",l)("ngTemplateOutletContext",A(41,ja,n.TRANSLATION_BASE+".testcase")),r(2),c("ngTemplateOutlet",l)("ngTemplateOutletContext",A(43,La,n.TRANSLATION_BASE+".errorCategory")),r(4),h(n.isLoading()?62:63),r(6),c("collectionSize",n.collectionsSize())("pageSize",n.pageSize())("page",n.page())("maxSize",5),r(4),c("jhiTranslate",n.TRANSLATION_BASE+".totalItems")("translateValues",A(45,Ua,n.totalItems()))}},dependencies:[ln,Qt,$t,Z,w,pt,Y,et,Je,Fe,Ot,Ze,W,oe,Ie,be,we],styles:[".position-relative[_ngcontent-%COMP%]{position:relative}.search-icon[_ngcontent-%COMP%]{position:absolute;right:10px;pointer-events:none}"]})}return i})();var ar=()=>({type:"test-cases",translation:"artemisApp.programmingExercise.configureGrading.testCases.title"}),rr=()=>({type:"submission-policy",translation:"artemisApp.programmingExercise.submissionPolicy.title"}),sr=()=>({type:"code-analysis",translation:"artemisApp.programmingExercise.configureGrading.categories.titleHeader"}),or=()=>({type:"feedback-analysis",translation:"artemisApp.programmingExercise.configureGrading.feedbackAnalysis.titleHeader"});function lr(i,p){if(i&1){let t=S();e(0,`
    `),s(1,"div",4),u("click",function(){let n=C(t).type,l=d();return f(l.selectTab(n))}),e(2,`
        `),m(3,"b",5),e(4,`
    `),o(),e(5,`
`)}if(i&2){let t=p.type,a=p.translation,n=d();r(),c("ngClass",n.activeTab===t?"active":""),r(2),c("jhiTranslate",a)}}function cr(i,p){i&1&&N(0)}function mr(i,p){i&1&&N(0)}function pr(i,p){if(i&1&&(e(0,`
                    `),x(1,mr,1,0,"ng-container",8),e(2,`
                `)),i&2){d(2);let t=q(1);r(),c("ngTemplateOutlet",t)("ngTemplateOutletContext",fe(2,sr))}}function dr(i,p){i&1&&N(0)}function gr(i,p){i&1&&N(0)}function ur(i,p){if(i&1&&(e(0,`
                    `),x(1,gr,1,0,"ng-container",8),e(2,`
                `)),i&2){d(2);let t=q(1);r(),c("ngTemplateOutlet",t)("ngTemplateOutletContext",fe(2,or))}}function xr(i,p){i&1&&(e(0,`
                `),m(1,"div"),e(2,`
            `))}function _r(i,p){if(i&1&&(e(0,`
                    `),m(1,"jhi-programming-exercise-configure-grading-status",10),e(2,`
                `)),i&2){let t=d(2);r(),c("exerciseIsReleasedAndHasResults",t.isReleasedAndHasResults)("hasUnsavedTestCaseChanges",t.hasUnsavedChanges)("hasUnsavedCategoryChanges",!!t.changedCategoryIds.length)("hasUpdatedGradingConfig",t.hasUpdatedGradingConfig)}}function Cr(i,p){if(i&1&&(e(0,`
                    `),m(1,"jhi-programming-exercise-configure-grading-actions",11),e(2,`
                `)),i&2){let t=d(2);r(),c("exercise",t.programmingExercise)("hasUpdatedGradingConfig",t.hasUpdatedGradingConfig)("isSaving",t.isSaving)}}function fr(i,p){i&1&&(e(0,`
                        `),s(1,"ngb-alert",14),e(2,`
                            `),m(3,"span",15),e(4,`
                        `),o(),e(5,`
                    `)),i&2&&(r(),c("dismissible",!1)("type","info"))}function hr(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"div"),e(2,`
                    `),s(3,"jhi-programming-exercise-grading-submission-policy-configuration-actions",12),u("onUpdate",function(){C(t);let n=d(2);return f(n.updateSubmissionPolicy())})("onToggle",function(){C(t);let n=d(2);return f(n.toggleSubmissionPolicy())}),o(),e(4,`
                    `),m(5,"jhi-submission-policy-update",13,1),e(7,`
                    `),x(8,fr,6,2),o(),e(9,`
            `)}if(i&2){let t=q(6),a=d(2);r(3),c("exercise",a.programmingExercise)("isSaving",a.isSaving)("hadPolicyBefore",a.hadPolicyBefore)("formInvalid",t.invalid),r(2),c("programmingExercise",a.programmingExercise)("editable",a.programmingExercise.isAtLeastInstructor),r(3),h(a.programmingExercise.isAtLeastEditor&&a.programmingExercise.submissionPolicy!==void 0?8:-1)}}function br(i,p){i&1&&(e(0,`
                                    `),m(1,"span",23),e(2,`
                                `))}function Tr(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"div"),e(2,`
                    `),s(3,"div",16),e(4,`
                        `),s(5,"div",17),e(6,`
                            `),m(7,"jhi-programming-exercise-grading-tasks-table",18),e(8,`
                        `),o(),e(9,`
                        `),s(10,"div",19),e(11,`
                            `),s(12,"h2",20),e(13,`
                                `),m(14,"span",21),e(15,`
                                `),x(16,br,3,0),o(),e(17,`
                            `),s(18,"jhi-test-case-distribution-chart",22),u("testCaseColorsChange",function(n){C(t);let l=d(2);return f(l.testCaseColors=n)})("testCaseRowFilter",function(n){C(t);let l=d(2);return f(l.filterByChart(n,l.chartFilterType.TEST_CASES))}),o(),e(19,`
                        `),o(),e(20,`
                    `),o(),e(21,`
                `),o(),e(22,`
            `)}if(i&2){let t=d(2);r(7),c("exercise",t.programmingExercise)("course",t.course)("gradingStatisticsObservable",t.gradingStatisticsObservable),r(9),h(t.changedTestCaseIds.length?16:-1),r(2),c("testCases",t.filteredTestCasesForCharts)("testCaseStatsMap",t.gradingStatistics==null?null:t.gradingStatistics.testCaseStatsMap)("totalParticipations",t.gradingStatistics==null?null:t.gradingStatistics.numParticipations)("exercise",t.programmingExercise)}}function Sr(i,p){if(i&1){let t=S();e(0,`
                                        `),s(1,"span",36),u("click",function(){let n=C(t).sortFn;return f(n())}),e(2,`
                                            `),s(3,"span",37),e(4,"Category"),o(),e(5,`
                                            `),m(6,"fa-icon",38),e(7,`
                                        `),o(),e(8,`
                                    `)}if(i&2){let t=d(3);r(6),c("icon",t.iconForSortPropField("codeAnalysis","name"))}}function vr(i,p){if(i&1&&(e(0,`
                                        `),m(1,"fa-icon",39),e(2)),i&2){let t=p.value,a=d(3);r(),je("color",a.categoryColors[t]||"white"),c("icon",a.faSquare),r(),se(`
                                        `,t,`
                                    `)}}function Er(i,p){if(i&1){let t=S();e(0,`
                                        `),s(1,"span",36),u("click",function(){let n=C(t).sortFn;return f(n())}),e(2,`
                                            `),s(3,"span",37),e(4,"State"),o(),e(5,`
                                            `),m(6,"fa-icon",38),e(7,`
                                            `),m(8,"fa-icon",40),E(9,"artemisTranslate"),e(10,`
                                        `),o(),e(11,`
                                    `)}if(i&2){let t=d(3);r(6),c("icon",t.iconForSortPropField("codeAnalysis","state")),r(2),c("icon",t.faQuestionCircle)("ngbTooltip",P(9,3,"artemisApp.programmingExercise.configureGrading.help.state"))}}function yr(i,p){if(i&1&&(e(0,`
                                                `),s(1,"option",42),e(2),o(),e(3,`
                                            `)),i&2){let t=p.$implicit;r(),c("value",t.value),r(),F(t.name)}}function Ar(i,p){if(i&1){let t=S();e(0,`
                                        `),s(1,"select",41),u("change",function(n){let l=C(t).row,g=d(3);return f(g.updateEditedCategoryField(l,g.EditableField.STATE)(g.getEventValue(n)))}),e(2,`
                                            `),V(3,yr,4,2,null,null,R),o(),e(5,`
                                    `)}if(i&2){let t=p.value,a=p.row,n=d(3);r(),c("id",a.id+"-state")("ngModel",t),r(2),B(n.categoryStateList)}}function kr(i,p){if(i&1){let t=S();e(0,`
                                        `),s(1,"span",36),u("click",function(){let n=C(t).sortFn;return f(n())}),e(2,`
                                            `),s(3,"span",37),e(4,"Penalty"),o(),e(5,`
                                            `),m(6,"fa-icon",38),e(7,`
                                            `),m(8,"fa-icon",40),E(9,"artemisTranslate"),e(10,`
                                        `),o(),e(11,`
                                    `)}if(i&2){let t=d(3);r(6),c("icon",t.iconForSortPropField("codeAnalysis","penalty")),r(2),c("icon",t.faQuestionCircle)("ngbTooltip",P(9,3,"artemisApp.programmingExercise.configureGrading.help.penalty"))}}function Pr(i,p){if(i&1&&(e(0,`
                                            `),m(1,"jhi-table-editable-field",43),e(2,`
                                        `)),i&2){let t=d(),a=t.value,n=t.row,l=d(3);r(),c("id",n.id+"-penalty")("value",a)("onValueUpdate",l.updateEditedCategoryField(n,l.EditableField.PENALTY))}}function Fr(i,p){i&1&&(e(0,`
                                            `),m(1,"span",44),e(2,`
                                        `))}function Ir(i,p){i&1&&(e(0,`
                                            `),m(1,"span",45),e(2,`
                                        `))}function wr(i,p){if(i&1&&(e(0,`
                                        `),x(1,Pr,3,3)(2,Fr,3,0)(3,Ir,3,0)),i&2){let t=p.row,a=d(3);r(),h(t.state===a.CategoryState.Graded?1:-1),r(),h(t.state===a.CategoryState.Feedback?2:-1),r(),h(t.state===a.CategoryState.Inactive?3:-1)}}function Mr(i,p){if(i&1){let t=S();e(0,`
                                        `),s(1,"span",36),u("click",function(){let n=C(t).sortFn;return f(n())}),e(2,`
                                            `),s(3,"span",37),e(4,"Max Penalty"),o(),e(5,`
                                            `),m(6,"fa-icon",38),e(7,`
                                            `),m(8,"fa-icon",40),E(9,"artemisTranslate"),e(10,`
                                        `),o(),e(11,`
                                    `)}if(i&2){let t=d(3);r(6),c("icon",t.iconForSortPropField("codeAnalysis","maxPenalty")),r(2),c("icon",t.faQuestionCircle)("ngbTooltip",P(9,3,"artemisApp.programmingExercise.configureGrading.help.maxPenalty"))}}function Nr(i,p){if(i&1&&(e(0,`
                                            `),m(1,"jhi-table-editable-field",43),e(2,`
                                        `)),i&2){let t=d(),a=t.value,n=t.row,l=d(3);r(),c("id",n.id+"-maxpenalty")("value",a)("onValueUpdate",l.updateEditedCategoryField(n,l.EditableField.MAX_PENALTY))}}function Dr(i,p){i&1&&(e(0,`
                                            `),m(1,"span",44),e(2,`
                                        `))}function Gr(i,p){i&1&&(e(0,`
                                            `),m(1,"span",45),e(2,`
                                        `))}function Or(i,p){if(i&1&&(e(0,`
                                        `),x(1,Nr,3,3)(2,Dr,3,0)(3,Gr,3,0)),i&2){let t=p.row,a=d(3);r(),h(t.state===a.CategoryState.Graded?1:-1),r(),h(t.state===a.CategoryState.Feedback?2:-1),r(),h(t.state===a.CategoryState.Inactive?3:-1)}}function Rr(i,p){if(i&1){let t=S();e(0,`
                                        `),s(1,"span",36),u("click",function(){let n=C(t).sortFn;return f(n())}),e(2,`
                                            `),s(3,"span",37),e(4,"Detected Issues"),o(),e(5,`
                                            `),m(6,"fa-icon",38),e(7,`
                                            `),m(8,"fa-icon",40),E(9,"artemisTranslate"),e(10,`
                                        `),o(),e(11,`
                                    `)}if(i&2){let t=d(3);r(6),c("icon",t.iconForSortPropField("codeAnalysis","detectedIssues")),r(2),c("icon",t.faQuestionCircle)("ngbTooltip",P(9,3,"artemisApp.programmingExercise.configureGrading.help.detectedIssues"))}}function Vr(i,p){if(i&1&&(e(0,`
                                        `),m(1,"jhi-category-issues-chart",46),e(2,`
                                    `)),i&2){let t=p.row,a=d(3);r(),c("category",t)("issuesMap",a.getIssuesMap(t.name))("totalStudents",(a.gradingStatistics==null?null:a.gradingStatistics.numParticipations)||0)("maxNumberOfIssues",a.maxIssuesPerCategory)}}function Br(i,p){i&1&&(e(0,`
                                    `),m(1,"span",23),e(2,`
                                `))}function jr(i,p){if(i&1){let t=S();e(0,`
                `),s(1,"div"),e(2,`
                    `),s(3,"div",16),e(4,`
                        `),s(5,"div",17),e(6,`
                            `),s(7,"div",24),e(8,`
                                `),m(9,"h2",25),e(10,`
                                `),s(11,"jhi-programming-exercise-grading-table-actions",26),u("onReset",function(){C(t);let n=d(2);return f(n.resetCategories())})("onSave",function(){C(t);let n=d(2);return f(n.saveCategories())})("onCategoryImport",function(n){C(t);let l=d(2);return f(l.importCategories(n))}),o(),e(12,`
                            `),o(),e(13,`
                            `),s(14,"ngx-datatable",27),u("sort",function(n){C(t);let l=d(2);return f(l.onSort("codeAnalysis",n))}),e(15,`
                                `),s(16,"ngx-datatable-column",28),e(17,`
                                    `),x(18,Sr,9,1,"ng-template",29),e(19,`
                                    `),x(20,vr,3,4,"ng-template",30),e(21,`
                                `),o(),e(22,`
                                `),s(23,"ngx-datatable-column",31),e(24,`
                                    `),x(25,Er,12,5,"ng-template",29),e(26,`
                                    `),x(27,Ar,6,2,"ng-template",30),e(28,`
                                `),o(),e(29,`
                                `),s(30,"ngx-datatable-column",32),e(31,`
                                    `),x(32,kr,12,5,"ng-template",29),e(33,`
                                    `),x(34,wr,4,3,"ng-template",30),e(35,`
                                `),o(),e(36,`
                                `),s(37,"ngx-datatable-column",33),e(38,`
                                    `),x(39,Mr,12,5,"ng-template",29),e(40,`
                                    `),x(41,Or,4,3,"ng-template",30),e(42,`
                                `),o(),e(43,`
                                `),s(44,"ngx-datatable-column",34),e(45,`
                                    `),x(46,Rr,12,5,"ng-template",29),e(47,`
                                    `),x(48,Vr,3,4,"ng-template",30),e(49,`
                                `),o(),e(50,`
                            `),o(),e(51,`
                        `),o(),e(52,`
                        `),s(53,"div",19),e(54,`
                            `),s(55,"h2",20),e(56,`
                                `),m(57,"span",21),e(58,`
                                `),x(59,Br,3,0),o(),e(60,`
                            `),s(61,"jhi-sca-category-distribution-chart",35),u("categoryColorsChange",function(n){C(t);let l=d(2);return f(l.categoryColors=n)})("scaCategoryFilter",function(n){C(t);let l=d(2);return f(l.filterByChart(n,l.chartFilterType.CATEGORIES))}),o(),e(62,`
                        `),o(),e(63,`
                    `),o(),e(64,`
                `),o(),e(65,`
            `)}if(i&2){let t=d(2);r(11),c("exercise",t.programmingExercise)("hasUnsavedChanges",!!t.changedCategoryIds.length)("isSaving",t.isSaving)("activeTab",t.activeTab),r(3),c("headerHeight",50)("limit",20)("columnMode","force")("footerHeight",50)("rowHeight","auto")("rows",t.staticCodeAnalysisCategoriesForTable)("sorts",t.tableSorts.codeAnalysis),r(9),c("comparator",t.compareCategoryState),r(7),c("comparator",t.comparePenalty),r(7),c("comparator",t.compareMaxPenalty),r(7),c("comparator",t.compareDetectedIssues),r(15),h(t.changedCategoryIds.length?59:-1),r(2),c("categories",t.staticCodeAnalysisCategoriesForCharts)("categoryIssuesMap",t.gradingStatistics==null?null:t.gradingStatistics.categoryIssuesMap)("exercise",t.programmingExercise)}}function Lr(i,p){if(i&1&&(e(0,`
                `),m(1,"jhi-feedback-analysis",47),e(2,`
            `)),i&2){let t=d(2);r(),c("exerciseTitle",t.programmingExercise.title)("exerciseId",t.programmingExercise.id)("exerciseDueDate",t.programmingExercise.dueDate)("courseId",t.course.id)("isCommunicationEnabled",t.isCommunicationEnabled(t.course))}}function Ur(i,p){if(i&1&&(e(0,`
        `),s(1,"div",6),e(2,`
            `),s(3,"div",7),e(4,`
                `),x(5,cr,1,0,"ng-container",8),e(6,`
                `),x(7,pr,3,3)(8,dr,1,0,"ng-container",8),e(9,`
                `),x(10,ur,3,3),o(),e(11,`
            `),x(12,xr,3,0,"ng-template"),e(13,`
            `),s(14,"div",7),e(15,`
                `),x(16,_r,3,4)(17,Cr,3,3),o(),e(18,`
        `),o(),e(19,`
        `),s(20,"div",9),e(21,`
            `),x(22,hr,10,7),o(),e(23,`
        `),s(24,"div",9),e(25,`
            `),x(26,Tr,23,8)(27,jr,66,19),o(),e(28,`
        `),s(29,"div",9),e(30,`
            `),x(31,Lr,3,5),o(),e(32,`
    `)),i&2){let t=d(),a=q(1);r(5),c("ngTemplateOutlet",a)("ngTemplateOutletContext",fe(12,ar)),r(2),h(t.programmingExercise.staticCodeAnalysisEnabled?7:-1),r(),c("ngTemplateOutlet",a)("ngTemplateOutletContext",fe(13,rr)),r(2),h(t.programmingExercise.isAtLeastEditor?10:-1),r(6),h(t.activeTab==="test-cases"||t.activeTab==="code-analysis"?16:-1),r(),h(t.programmingExercise.isAtLeastInstructor&&t.activeTab!=="feedback-analysis"?17:-1),r(5),h(t.activeTab==="submission-policy"?22:-1),r(4),h(t.activeTab==="test-cases"?26:-1),r(),h(t.activeTab==="code-analysis"&&t.programmingExercise.staticCodeAnalysisEnabled?27:-1),r(4),h(t.programmingExercise.isAtLeastEditor&&t.activeTab==="feedback-analysis"&&t.programmingExercise.title&&t.programmingExercise.id&&t.course.id?31:-1)}}var ye=function(i){return i.WEIGHT="weight",i.BONUS_MULTIPLIER="bonusMultiplier",i.BONUS_POINTS="bonusPoints",i.VISIBILITY="visibility",i.PENALTY="penalty",i.MAX_PENALTY="maxPenalty",i.STATE="state",i}(ye||{}),yt=function(i){return i[i.TEST_CASES=0]="TEST_CASES",i[i.CATEGORIES=1]="CATEGORIES",i}(yt||{}),ue=function(i){return i[i.TABLE=0]="TABLE",i[i.CHART=1]="CHART",i[i.BACKUP=2]="BACKUP",i[i.SAVE_VALUES=3]="SAVE_VALUES",i}(ue||{}),Wr={[ye.WEIGHT]:1,[ye.BONUS_MULTIPLIER]:1,[ye.BONUS_POINTS]:0,[ye.PENALTY]:0,[ye.MAX_PENALTY]:0},Um=(()=>{class i{gradingService=b(Be);programmingExerciseService=b(Oi);programmingExerciseSubmissionPolicyService=b(Li);programmingExerciseWebsocketService=b(Ui);programmingExerciseTaskService=b(Ae);route=b(Bt);alertService=b(ee);translateService=b(Ne);location=b(Gt);router=b(tt);courseManagementService=b(_i);EditableField=ye;CategoryState=H;Visibility=Se;course;programmingExercise;testCaseSubscription;testCaseChangedSubscription;paramSub;testCasesValue=[];changedTestCaseIds=[];filteredTestCasesForTable=[];filteredTestCasesForCharts=[];backupTestCases=[];testCasePoints={};testCasePointsRelative={};RESET_TABLE=ve.RESET_TABLE;chartFilterType=yt;ProgrammingLanguage=Ti;isCommunicationEnabled=Ci;staticCodeAnalysisCategoriesForTable=[];staticCodeAnalysisCategoriesForCharts=[];backupStaticCodeAnalysisCategories=[];changedCategoryIds=[];buildAfterDueDateActive;isReleasedAndHasResults;showInactiveValue=!1;isSaving=!1;isLoading=!1;hasUpdatedGradingConfig=!1;activeTab;gradingStatistics;gradingStatisticsObservable;maxIssuesPerCategory=0;categoryStateList=Object.entries(H).map(([t,a])=>({value:a,name:t}));testCaseColors={};categoryColors={};totalWeight=0;submissionPolicy;hadPolicyBefore;faQuestionCircle=Oe;faSquare=ii;get testCases(){return this.testCasesValue}get activeTestCases(){return this.testCases.filter(({active:t})=>t)}get hasUnsavedChanges(){return this.programmingExerciseTaskService.hasUnsavedChanges()}set testCases(t){this.testCasesValue=t,this.updateTestCaseFilter(),this.updateTestPoints()}set showInactive(t){this.showInactiveValue=t,this.updateTestCaseFilter()}ngOnInit(){this.paramSub=this.route.params.pipe(It()).subscribe(t=>{this.isLoading=!0;let a=Number(t.exerciseId);if(this.courseManagementService.find(t.courseId).subscribe(l=>this.course=l.body),this.programmingExercise==null||this.programmingExercise.id!==a){this.testCaseSubscription&&this.testCaseSubscription.unsubscribe(),this.testCaseChangedSubscription&&this.testCaseChangedSubscription.unsubscribe();let l=this.programmingExerciseService.find(a).pipe(ke(_=>_.body),O(_=>this.programmingExercise=_),O(()=>{this.programmingExercise.staticCodeAnalysisEnabled&&this.loadStaticCodeAnalysisCategories(),this.hadPolicyBefore=this.programmingExercise.submissionPolicy!==void 0}),$(()=>z(null))),g=this.getExerciseTestCaseState(a).pipe(O(_=>{this.hasUpdatedGradingConfig=_.testCasesChanged,this.isReleasedAndHasResults=_.released&&_.hasStudentResult,this.buildAfterDueDateActive=!!_.buildAndTestStudentSubmissionsAfterDueDate}),$(()=>z(null)));this.loadStatistics(a),Pt(l,g).pipe(Ft(1)).subscribe(()=>{this.subscribeForTestCaseUpdates(),this.subscribeForExerciseTestCasesChangedUpdates(),this.isLoading=!1})}else this.isLoading=!1;["test-cases","code-analysis","submission-policy","feedback-analysis"].includes(t.tab)?this.selectTab(t.tab):this.selectTab("test-cases")})}ngOnDestroy(){this.testCaseSubscription&&this.testCaseSubscription.unsubscribe(),this.testCaseChangedSubscription&&this.testCaseChangedSubscription.unsubscribe(),this.paramSub&&this.paramSub.unsubscribe()}subscribeForTestCaseUpdates(){this.testCaseSubscription&&this.testCaseSubscription.unsubscribe(),this.testCaseSubscription=this.gradingService.subscribeForTestCases(this.programmingExercise.id).pipe(O(t=>{this.testCases=t}),O(()=>this.loadStatistics(this.programmingExercise.id))).subscribe()}subscribeForExerciseTestCasesChangedUpdates(){this.testCaseChangedSubscription&&this.testCaseChangedSubscription.unsubscribe(),this.testCaseChangedSubscription=this.programmingExerciseWebsocketService.getTestCaseState(this.programmingExercise.id).pipe(O(t=>this.hasUpdatedGradingConfig=t)).subscribe()}getExerciseTestCaseState(t){return this.programmingExerciseService.getProgrammingExerciseTestCaseState(t).pipe(ke(({body:a})=>a))}updateEditedField(t,a){return n=>(n=this.checkFieldValue(n,t[a],a),n!==t[a]&&(this.changedTestCaseIds=this.changedTestCaseIds.includes(t.id)?this.changedTestCaseIds:[...this.changedTestCaseIds,t.id],this.updateAllTestCaseViewsAfterEditing(t,a,n),this.updateTestPoints(t,a,n)),n)}updateEditedCategoryField(t,a){return n=>(n=this.checkFieldValue(n,t[a],a),n!==t[a]&&(this.changedCategoryIds=this.changedCategoryIds.includes(t.id)?this.changedCategoryIds:[...this.changedCategoryIds,t.id],this.updateStaticCodeAnalysisCategories(t,a,n)),n)}checkFieldValue(t,a,n){return t===""&&(t=Wr[n]),typeof a=="number"&&(t=Number(t),isNaN(t)&&(t=a)),t}saveCategories(){this.isSaving=!0,this.backupStaticCodeAnalysisCategories=this.backupStaticCodeAnalysisCategories.map(l=>l.state===H.Graded?l:pe(me({},l),{penalty:0,maxPenalty:0}));let t=ui(this.backupStaticCodeAnalysisCategories,this.changedCategoryIds,(l,g)=>l.id===g),a=t.map(l=>Di.from(l));this.gradingService.updateCodeAnalysisCategories(this.programmingExercise.id,a).pipe(O(l=>{this.changedCategoryIds=gi(this.changedCategoryIds,l,(_,y)=>y.id===_),this.staticCodeAnalysisCategoriesForTable=xi(l,this.backupStaticCodeAnalysisCategories,"id"),this.setChartAndBackupCategoryView();let g=di(t,l,"id");g.length?this.alertService.error("artemisApp.programmingExercise.configureGrading.categories.couldNotBeUpdated",{categories:g.map(_=>_.name).join(", ")}):this.alertService.success("artemisApp.programmingExercise.configureGrading.categories.updated")}),$(()=>(this.alertService.error("artemisApp.programmingExercise.configureGrading.categories.couldNotBeUpdated",{categories:t.map(l=>l.name).join(", ")}),z(null)))).subscribe(()=>{this.isSaving=!1})}importCategories(t){this.isSaving=!0,this.gradingService.importCategoriesFromExercise(this.programmingExercise.id,t).pipe(O(a=>{this.staticCodeAnalysisCategoriesForTable=a,this.setChartAndBackupCategoryView(),this.alertService.success("artemisApp.programmingExercise.configureGrading.categories.importSuccessful",{exercise:t})}),$(()=>(this.alertService.error("artemisApp.programmingExercise.configureGrading.categories.importFailed",{exercise:t}),z(null)))).subscribe(()=>this.isSaving=!1)}resetCategories(){this.isSaving=!0,this.gradingService.resetCategories(this.programmingExercise.id).pipe(O(t=>{this.alertService.success("artemisApp.programmingExercise.configureGrading.categories.resetSuccessful"),this.staticCodeAnalysisCategoriesForTable=t,this.setChartAndBackupCategoryView(),this.loadStatistics(this.programmingExercise.id)}),$(()=>(this.alertService.error("artemisApp.programmingExercise.configureGrading.categories.resetFailed"),z(null)))).subscribe(()=>{this.isSaving=!1,this.changedCategoryIds=[]})}removeSubmissionPolicy(){this.isSaving=!0,this.programmingExerciseSubmissionPolicyService.removeSubmissionPolicyFromProgrammingExercise(this.programmingExercise.id).pipe(O(()=>{this.programmingExercise.submissionPolicy=void 0,this.hadPolicyBefore=!1}),$(()=>z(null))).subscribe(()=>{this.isSaving=!1})}addSubmissionPolicy(){this.isSaving=!0,this.programmingExerciseSubmissionPolicyService.addSubmissionPolicyToProgrammingExercise(this.programmingExercise.submissionPolicy,this.programmingExercise.id).pipe(O(t=>{this.programmingExercise.submissionPolicy=t,this.hadPolicyBefore=!0}),$(()=>z(null))).subscribe(()=>{this.isSaving=!1})}updateSubmissionPolicy(){if(this.programmingExercise.submissionPolicy?.type===Ue.NONE&&this.hadPolicyBefore){this.removeSubmissionPolicy();return}else if(!this.hadPolicyBefore&&this.programmingExercise.submissionPolicy?.type!==Ue.NONE){this.addSubmissionPolicy();return}this.isSaving=!0,this.programmingExerciseSubmissionPolicyService.updateSubmissionPolicyToProgrammingExercise(this.programmingExercise.submissionPolicy,this.programmingExercise.id).pipe($(()=>z(null))).subscribe(()=>{this.isSaving=!1})}toggleSubmissionPolicy(){this.isSaving=!0;let t=()=>{this.isSaving=!1};this.programmingExercise.submissionPolicy.active?this.programmingExerciseSubmissionPolicyService.disableSubmissionPolicyOfProgrammingExercise(this.programmingExercise.id).pipe(O(()=>{this.programmingExercise.submissionPolicy.active=!1})).subscribe(t):this.programmingExerciseSubmissionPolicyService.enableSubmissionPolicyOfProgrammingExercise(this.programmingExercise.id).pipe(O(()=>{this.programmingExercise.submissionPolicy.active=!0})).subscribe(t)}updateTestCaseFilter(){this.filteredTestCasesForTable=!this.showInactiveValue&&this.testCases?this.testCases.filter(({active:t})=>t):this.testCases,this.filteredTestCasesForCharts=this.filteredTestCasesForTable,this.backupTestCases=this.filteredTestCasesForTable}updateTestPoints(t,a,n){if(!this.testCases)return;let l=this.programmingExercise.maxPoints;if(!this.totalWeight||!t||!a||a===ye.WEIGHT||n===void 0)this.testCasePoints={},this.testCasePointsRelative={},this.totalWeight=this.activeTestCases.reduce((g,_)=>g+_.weight,0),this.activeTestCases.forEach(g=>{let _=(this.totalWeight>0?g.weight*g.bonusMultiplier/this.totalWeight:0)*l+(g.bonusPoints??0);this.testCasePoints[g.testName]=Te(_,this.course);let y=_/l*100;this.testCasePointsRelative[g.testName]=Te(y,this.course)});else{let g=pe(me({},t),{[a]:n}),_=(this.totalWeight>0?g.weight*g.bonusMultiplier/this.totalWeight:0)*l+(g.bonusPoints??0);this.testCasePoints[g.testName]=Te(_,this.course);let y=_/l*100;this.testCasePointsRelative[g.testName]=Te(y,this.course)}}canDeactivate(){if(!this.changedTestCaseIds.length&&(!this.isReleasedAndHasResults||!this.hasUpdatedGradingConfig))return!0;let t=this.changedTestCaseIds.length?this.translateService.instant("pendingChanges"):this.translateService.instant("artemisApp.programmingExercise.configureGrading.updatedGradingConfig");return confirm(t)}selectTab(t){let a=this.router.url.substring(0,this.router.url.lastIndexOf("/"));this.location.replaceState(`${a}/${t}`),this.activeTab=t}getIssuesMap(t){return this.gradingStatistics?.categoryIssuesMap?this.gradingStatistics.categoryIssuesMap[t]:void 0}tableSorts={testCases:[{prop:"testName",dir:"asc"}],codeAnalysis:[{prop:"name",dir:"asc"}]};onSort(t,a){this.tableSorts[t]=a.sorts}iconForSortPropField(t,a){let n=this.tableSorts[t].find(l=>l.prop===a);return n?n.dir==="asc"?Re:De:Ge}valForState=t=>t===H.Inactive?0:t===H.Feedback?1:2;compareCategoryState=(t,a,n,l)=>this.valForState(n.state)-this.valForState(l.state);comparePenalty=(t,a,n,l)=>{let g=_=>this.valForState(_.state)+(_.state===H.Graded?_.penalty:0);return g(n)-g(l)};compareMaxPenalty=(t,a,n,l)=>{let g=_=>this.valForState(_.state)+(_.state===H.Graded?_.maxPenalty:0);return g(n)-g(l)};compareDetectedIssues=(t,a,n,l)=>{let g=this.getIssuesMap(n.name),_=this.getIssuesMap(l.name),y=Object.values(g??{}).reduce((T,I)=>T+I,0),M=Object.values(_??{}).reduce((T,I)=>T+I,0);return y!==M?y-M:this.compareCategoryState(t,a,n,l)};loadStaticCodeAnalysisCategories(){this.gradingService.getCodeAnalysisCategories(this.programmingExercise.id).pipe(O(t=>{this.staticCodeAnalysisCategoriesForTable=t,this.setChartAndBackupCategoryView()}),$(()=>z(null))).subscribe()}loadStatistics(t){this.gradingStatisticsObservable=this.gradingService.getGradingStatistics(t),this.gradingStatisticsObservable.subscribe(a=>{if(this.gradingStatistics=a,this.maxIssuesPerCategory=0,a?.categoryIssuesMap)for(let n of Object.values(a?.categoryIssuesMap)){let l=Object.keys(n).reduce((g,_)=>Math.max(g,parseInt(_,10)),0);l>this.maxIssuesPerCategory&&(this.maxIssuesPerCategory=l)}})}getEventValue(t){return t.target.value}filterByChart(t,a){let n=l=>l.id===t;a===yt.TEST_CASES?(this.filteredTestCasesForTable=this.backupTestCases,t!==this.RESET_TABLE&&(this.filteredTestCasesForTable=this.filteredTestCasesForTable.filter(n))):(this.staticCodeAnalysisCategoriesForTable=this.backupStaticCodeAnalysisCategories,t!==this.RESET_TABLE&&(this.staticCodeAnalysisCategoriesForTable=this.staticCodeAnalysisCategoriesForTable.filter(n)))}updateAllTestCaseViewsAfterEditing(t,a,n){[ue.TABLE,ue.CHART,ue.BACKUP,ue.SAVE_VALUES].forEach(g=>this.updateTestCases(t,a,n,g))}updateTestCases(t,a,n,l){let g=_=>_.id!==t.id?_:pe(me({},_),{[a]:n});switch(l){case ue.TABLE:this.filteredTestCasesForTable=this.filteredTestCasesForTable.map(g);break;case ue.CHART:this.filteredTestCasesForCharts=this.filteredTestCasesForCharts.map(g);break;case ue.BACKUP:this.backupTestCases=this.backupTestCases.map(g);break;case ue.SAVE_VALUES:this.testCasesValue=this.testCases.map(g);break}}updateStaticCodeAnalysisCategories(t,a,n){let l=g=>g.id!==t.id?g:pe(me({},g),{[a]:n});this.staticCodeAnalysisCategoriesForTable=this.staticCodeAnalysisCategoriesForTable.map(l),this.backupStaticCodeAnalysisCategories=this.backupStaticCodeAnalysisCategories.map(l),this.staticCodeAnalysisCategoriesForCharts=this.backupStaticCodeAnalysisCategories}setChartAndBackupCategoryView(){this.staticCodeAnalysisCategoriesForCharts=this.staticCodeAnalysisCategoriesForTable,this.backupStaticCodeAnalysisCategories=this.staticCodeAnalysisCategoriesForTable}static \u0275fac=function(a){return new(a||i)};static \u0275cmp=k({type:i,selectors:[["jhi-programming-exercise-configure-grading"]],features:[Ce([Ae])],decls:12,vars:1,consts:[["tabTemplate",""],["policyUpdate",""],[1,"d-flex","align-content-center","mb-2"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.title",1,"fw-medium"],[1,"tab-item",3,"click","ngClass"],[3,"jhiTranslate"],[1,"top-bar"],[1,"d-flex","align-items-center"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"grading-body-container","mt-3"],[3,"exerciseIsReleasedAndHasResults","hasUnsavedTestCaseChanges","hasUnsavedCategoryChanges","hasUpdatedGradingConfig"],[3,"exercise","hasUpdatedGradingConfig","isSaving"],[3,"onUpdate","onToggle","exercise","isSaving","hadPolicyBefore","formInvalid"],[3,"programmingExercise","editable"],[3,"dismissible","type"],["jhiTranslate","artemisApp.programmingExercise.submissionPolicy.submissionPenalty.triggerAllInformation"],[1,"grading-table-layout"],[1,"col-7"],[3,"exercise","course","gradingStatisticsObservable"],[1,"col-5"],[1,"mb-5","fw-medium"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.title"],[3,"testCaseColorsChange","testCaseRowFilter","testCases","testCaseStatsMap","totalParticipations","exercise"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.charts.preview",1,"badge","bg-primary"],[1,"d-flex","align-items-center","justify-content-between","mb-4"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.categories.title",1,"fw-medium"],[3,"onReset","onSave","onCategoryImport","exercise","hasUnsavedChanges","isSaving","activeTab"],["id","codeAnalysisTable","trackByProp","id",1,"bootstrap",3,"sort","headerHeight","limit","columnMode","footerHeight","rowHeight","rows","sorts"],["name","Category","prop","name"],["ngx-datatable-header-template",""],["ngx-datatable-cell-template",""],["name","State","prop","state",3,"comparator"],["name","Penalty","prop","penalty",3,"comparator"],["name","Max Penalty","prop","maxPenalty",3,"comparator"],["name","Detected Issues","prop","detectedIssues",3,"comparator"],[3,"categoryColorsChange","scaCategoryFilter","categories","categoryIssuesMap","exercise"],[1,"datatable-header-cell-wrapper",3,"click"],[1,"datatable-header-cell-label","bold","sortable"],[3,"icon"],[1,"me-2",3,"icon"],["placement","bottom auto",1,"text-secondary","ms-2",3,"icon","ngbTooltip"],[1,"p-1","form-select",3,"change","id","ngModel"],[3,"value"],[3,"id","value","onValueUpdate"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.categories.notGraded"],["jhiTranslate","artemisApp.programmingExercise.configureGrading.categories.noFeedback"],[3,"category","issuesMap","totalStudents","maxNumberOfIssues"],[3,"exerciseTitle","exerciseId","exerciseDueDate","courseId","isCommunicationEnabled"]],template:function(a,n){a&1&&(x(0,lr,6,2,"ng-template",null,0,j),e(2,`
`),s(3,"div"),e(4,`
    `),s(5,"div",2),e(6,`
        `),m(7,"h3",3),e(8,`
    `),o(),e(9,`
    `),x(10,Ur,33,14),o(),e(11,`
`)),a&2&&(r(10),h(n.isLoading?-1:10))},dependencies:[Je,w,Fe,Hi,qi,Ki,ji,Yt,Qi,Zi,en,Ai,yi,Ei,Si,vi,Y,Z,oe,rt,st,at,be,we,Bi,tn,rn,gn,W],styles:[`.test-case--inactive{color:gray}.run-after-due-date-disabled{max-width:200px}.top-bar{display:flex;flex-wrap:wrap;align-items:center;padding:10px 0;justify-content:space-between;border-bottom:1px solid var(--border-color)}.top-bar .tab-item{cursor:pointer;margin:0 .5em}.top-bar .tab-item.active{box-shadow:0 2px 0 var(--artemis-dark)}.grading-table-layout{display:flex;flex-wrap:wrap}.grading-table-layout>div{padding:20px}.grading-table-layout>div:last-child{border-left:1px solid #ddd}.datatable-header-cell-wrapper{display:flex;align-items:center}.datatable-header-cell-wrapper .datatable-header-cell-label{overflow:hidden;text-overflow:ellipsis;margin-right:2px}@media screen and (max-width: 1200px){.grading-table-layout{flex-flow:column}.grading-table-layout>div{width:100%!important}.grading-table-layout>div:last-child{border-left:hidden;border-top:1px solid #ddd}}
`],encapsulation:2})}return i})();export{yt as ChartFilterType,ye as EditableField,Um as ProgrammingExerciseConfigureGradingComponent};
//# sourceMappingURL=programming-exercise-configure-grading.component-ZAEXL4OJ.js.map
