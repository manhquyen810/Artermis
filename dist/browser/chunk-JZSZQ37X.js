import{a as Qt}from"./chunk-MASKPWNP.js";import{a as Ni,b as Ui}from"./chunk-NOW2PQV7.js";import{a as qt}from"./chunk-SUUJN3EQ.js";import{B as lt,C as ke,D as ut,a as jt,b as Lt,c as Bt,d as Nt,e as Ut,f as Ht,g as zt,m as Gt,n as Ii,o as dn,p as Ri,q as pn,s as Wt,t as Di,v as Fi,w as ji,x as Li,y as at,z as Bi}from"./chunk-RTOKZMYN.js";import{d as be,e as Me}from"./chunk-5QODR5GQ.js";import{a as Vi}from"./chunk-DIZEKHOC.js";import{g as Ei}from"./chunk-Z2YUBN6N.js";import{a as st}from"./chunk-LYZAUST5.js";import{a as Ti,b as bi,c as Mi,d as ki,e as Oi,f as Si,g as Ai}from"./chunk-D6LEDP6W.js";import{k as yi}from"./chunk-VWRLJYRR.js";import{a as vi}from"./chunk-2QXIMOEO.js";import{B as gi,D,E as _i,F as hi,H as Ft,e as le,f as Z,g as Dt,j as A,k as Vt,l as ci,m as it,n as pt,o as mt,r as mi,u as ui}from"./chunk-QH7SWO42.js";import{a as di,h as pi,i as ge}from"./chunk-P2M2VQE3.js";import{a as fi,b as Ci}from"./chunk-4I367PEU.js";import{b as nt,c as li,d as cn}from"./chunk-ZPITQMA6.js";import{c as Tt,d as Qe,g as xe,j as $e}from"./chunk-2CUFQLAH.js";import{e as Pi,f as wi,g as ot,h as rt}from"./chunk-MKPB4JKY.js";import{d as Rt}from"./chunk-AR57MWOI.js";import{a as ai}from"./chunk-ZLJ76G5I.js";import{a as xi}from"./chunk-YLNI6ED3.js";import{c as Te}from"./chunk-JNO6DNVW.js";import{K as ae,u as Ln,v as Mt}from"./chunk-VZRSC3LP.js";import{J as jn,K as se,L as Pe,a as Rn,c as Ke,e as Y,h as re,i as Xe,l as Dn,m as Vn,n as Je,r as Fn,s as Ye,v as Ze}from"./chunk-WA5GEAJB.js";import{a as V}from"./chunk-K3W6YFKH.js";import{d as z}from"./chunk-EDXSOKK5.js";import{b as tt}from"./chunk-R5BZWVRQ.js";import{p as qe}from"./chunk-DID2YGL7.js";import{$b as ei,Bb as Ot,Hc as ni,Ic as ii,L as qn,Mb as Yn,Oc as At,Pc as oi,Rb as Zn,Sc as Et,Ta as an,Wc as et,Xc as ri,_ as ve,a as kt,b as Hn,ca as Qn,cb as Jn,d as zn,da as $n,fa as Kn,ic as St,id as It,q as we,qc as ln,ra as Xn,s as Gn,sd as si,u as Wn,wc as ti,xd as ye}from"./chunk-Z4VHWOB5.js";import{a as Un}from"./chunk-XUCCGZJR.js";import{a as Nn}from"./chunk-NOBD5HSR.js";import{a as j}from"./chunk-U54OSGNH.js";import{h as En,i as bt,j as In}from"./chunk-M6Z6DKZQ.js";import{c as Bn}from"./chunk-E2KBL4LX.js";import{A as On,L as Sn,O as An,d as vt,n as W,s as Ce,u as yt}from"./chunk-IOA4DPXY.js";import{Ac as pe,Ad as F,Bc as me,Cb as Ne,Cc as Ct,Cd as sn,Db as r,Dc as P,Ea as w,Ed as wt,Ib as Ue,Id as H,La as I,Lb as Re,Ma as m,Mb as Q,Mc as h,Na as u,Oc as c,P as xn,Pb as Tn,Qa as fe,Qd as je,Rc as $,Rd as kn,Tb as k,Va as Ee,Vb as He,Wb as ft,Xb as J,Ya as b,Yc as te,Za as C,Zb as x,Zc as ne,_c as ie,ab as q,ad as K,bd as oe,c as hn,cd as G,dd as t,ed as U,fd as O,gd as xt,kc as p,la as Pn,lc as ze,ld as De,mc as ee,md as Ve,na as wn,nd as Fe,pd as Pt,qd as We,ra as vn,rc as Ge,rd as E,s as fn,sc as f,sd as ue,t as Cn,td as bn,uc as de,ud as Mn,vc as B,wb as rn,wc as N,x as _t,xa as yn,xb as Ie,xc as a,ya as ht,yc as l,yd as y,z as Ae,zc as g,zd as T}from"./chunk-5LC5EQRR.js";import{a as X,b as he,j as Be}from"./chunk-3E746U5Y.js";var $t=(()=>{class o{http=w(An);resourceUrl="api/communication/link-preview";cache={};links=[];fetchLink(e){if(this.cache[e])return this.cache[e];let i=encodeURIComponent(e),n=new Sn().set("url",i),s=this.http.get(this.resourceUrl,{params:n}).pipe(Pn(1));return this.cache[e]=s,s}static \u0275fac=function(i){return new(i||o)};static \u0275prov=ht({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var mn=/https?:\/\/[^\s/$.?#>][^\s>]*?(?=\s|[\])]|$)/g,Kt=(()=>{class o{find(e){let i=[],n;for(;(n=mn.exec(e))!==null;){let s=n[0],_=n.index,v=_+s.length,S=e[_-1]==="<"&&e[v]===">",M={type:"url",value:s,isLink:!0,href:s,start:_,end:v,isLinkPreviewRemoved:S};S||i.push(M)}return i}static \u0275fac=function(i){return new(i||o)};static \u0275prov=ht({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var ho=5e3,Xt=(()=>{class o{metisService=w(D);modalService=w(Mt);formBuilder=w(jn);posting;onCreate=new Ee;isModalOpen=new Ee;modalRef;isLoading=!1;maxContentLength=ho;editorHeight=ke.INLINE;content;formGroup;EditType=le;get editType(){return this.posting.id?le.UPDATE:le.CREATE}ngOnInit(){this.content=this.posting.content??""}ngOnChanges(){this.content=this.posting?.content??"",this.resetFormGroup()}confirm(){this.isLoading||this.formGroup.valid&&(this.isLoading=!0,this.editType===le.UPDATE?this.updatePosting():this.editType===le.CREATE&&this.createPosting())}static \u0275fac=function(i){return new(i||o)};static \u0275dir=He({type:o,inputs:{posting:"posting"},outputs:{onCreate:"onCreate",isModalOpen:"isModalOpen"},features:[I]})}return o})();var fo=["postingEditor"],Jt=(()=>{class o extends Xt{postingEditor;modalTitle;ngOnInit(){super.ngOnInit(),this.updateModalTitle()}ngOnChanges(){super.ngOnChanges(),this.updateModalTitle()}static \u0275fac=(()=>{let e;return function(n){return(e||(e=fe(o)))(n||o)}})();static \u0275dir=He({type:o,viewQuery:function(i,n){if(i&1&&te(fo,5),i&2){let s;ne(s=ie())&&(n.postingEditor=s.first)}},features:[J,I]})}return o})();var Hi=(()=>{class o extends jt{metisService;channelService;static ID="channel-reference.action";static DEFAULT_INSERT_TEXT="#";cachedChannels;disposableCompletionProvider;constructor(e,i){super(o.ID,"artemisApp.metis.editor.channel",It),this.metisService=e,this.channelService=i}register(e,i){super.register(e,i),this.disposableCompletionProvider=this.registerCompletionProviderForCurrentModel(e,this.fetchChannels.bind(this),(n,s)=>new Me(`#${n.name}`,this.label,`[channel]${n.name}(${n.id})[/channel]`,be.Default,s),"#")}run(e){this.replaceTextAtCurrentSelection(e,o.DEFAULT_INSERT_TEXT),e.triggerCompletion(),e.focus()}fetchChannels(){return Be(this,null,function*(){if(!this.cachedChannels){let e=yield _t(this.channelService.getPublicChannelsOfCourse(this.metisService.getCourse().id));this.cachedChannels=e.body}return this.cachedChannels})}dispose(){super.dispose(),this.disposableCompletionProvider?.dispose(),this.cachedChannels=void 0}}return o})();var zi=(()=>{class o extends jt{courseManagementService;metisService;disposableCompletionProvider;static ID="user-mention.action";static DEFAULT_INSERT_TEXT="@";constructor(e,i){super(o.ID,"artemisApp.metis.editor.user",kt),this.courseManagementService=e,this.metisService=i}register(e,i){super.register(e,i),this.disposableCompletionProvider=this.registerCompletionProviderForCurrentModel(e,this.loadUsersForSearchTerm.bind(this),(n,s)=>new Me(`@${n.name}`,this.label,`[user]${n.name}(${n.login})[/user]`,be.User,s),"@",!0)}run(e){this.replaceTextAtCurrentSelection(e,o.DEFAULT_INSERT_TEXT),e.triggerCompletion(),e.focus()}dispose(){super.dispose(),this.disposableCompletionProvider?.dispose()}loadUsersForSearchTerm(e){return Be(this,null,function*(){return(yield _t(this.courseManagementService.searchMembersForUserMentions(this.metisService.getCourse().id,e))).body??[]})}}return o})();var Gi=(()=>{class o extends Wt{metisService;static ID="exercise-reference.action";static DEFAULT_INSERT_TEXT="/exercise";disposableCompletionProvider;constructor(e){super(o.ID,"artemisApp.metis.editor.exercise"),this.metisService=e}register(e,i){super.register(e,i);let n=this.metisService.getCourse().exercises??[];this.setValues(n.map(s=>({id:s.id.toString(),value:s.title,type:s.type}))),this.disposableCompletionProvider=this.registerCompletionProviderForCurrentModel(e,()=>Promise.resolve(this.getValues()),(s,_)=>new Me(`/exercise ${s.value}`,s.type,`[${s.type}]${s.value}(${this.metisService.getLinkForExercise(s.id)})[/${s.type}]`,be.Default,_),"/")}run(e){this.replaceTextAtCurrentSelection(e,o.DEFAULT_INSERT_TEXT),e.triggerCompletion(),e.focus()}dispose(){super.dispose(),this.disposableCompletionProvider?.dispose()}getOpeningIdentifier(){return"[exercise]"}}return o})();var Wi=(()=>{class o extends Wt{metisService;static ID="faq-reference.action";static DEFAULT_INSERT_TEXT="/faq";disposableCompletionProvider;constructor(e){super(o.ID,"artemisApp.metis.editor.faq"),this.metisService=e}register(e,i){super.register(e,i);let n=this.metisService.getCourse().faqs??[];this.setValues(n.map(s=>({id:s.id.toString(),value:s.questionTitle,type:"faq"}))),this.disposableCompletionProvider=this.registerCompletionProviderForCurrentModel(e,()=>Promise.resolve(this.getValues()),(s,_)=>new Me(`/faq ${s.value}`,s.type,`[${s.type}]${s.value}(${this.metisService.getLinkForFaq()}?faqId=${s.id})[/${s.type}]`,be.Default,_),"/")}run(e){this.replaceTextAtCurrentSelection(e,o.DEFAULT_INSERT_TEXT),e.triggerCompletion(),e.focus()}dispose(){super.dispose(),this.disposableCompletionProvider?.dispose()}getOpeningIdentifier(){return"[faq]"}}return o})();var qi=(()=>{class o{data=w(Ni);static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["ng-component"]],decls:5,vars:3,consts:[["alt","",1,"img-fluid",3,"src"]],template:function(i,n){i&1&&(a(0,"div"),t(1,`
    `),g(2,"img",0),t(3,`
`),l(),t(4,`
`)),i&2&&(r(2),ze("max-height",95,"vh"),p("src",n.data.slideToReference,Ie))},encapsulation:2})}return o})();var Qi=(()=>{class o{markdownService=w(Vi);transform(e,i=!0,n=void 0,s=void 0){return this.markdownService.safeHtmlForPostingMarkdown(e,i,n,s)}static \u0275fac=function(i){return new(i||o)};static \u0275pipe=ft({name:"htmlForPostingMarkdown",type:o,pure:!0})}return o})();function Co(o,d){if(o&1&&(t(0,`
    `),g(1,"span",0),y(2,"htmlForPostingMarkdown"),t(3,`
`)),o&2){let e=c();r(),p("innerHTML",sn(2,1,e.processedContentBeforeReference,!0,e.allowedHtmlTags,e.allowedHtmlAttributes),rn)}}function xo(o,d){if(o&1&&(t(0,`
    `),a(1,"a",1),t(2,`
        `),g(3,"fa-icon",2),t(4),l(),t(5,`
`)),o&2){let e,i,n,s,_=c();r(),p("routerLink",(e=_.postingContentPart())==null?null:e.linkToReference)("queryParams",(i=_.postingContentPart())==null?null:i.queryParams),r(2),p("icon",_.referenceIcon((n=_.postingContentPart())==null?null:n.referenceType)),r(),O("",(s=_.postingContentPart())==null?null:s.referenceStr,`
    `)}}function Po(o,d){if(o&1&&(t(0,`
    `),a(1,"a",3),t(2," "),g(3,"fa-icon",2),t(4),l(),t(5,`
`)),o&2){let e,i,n=c();r(3),p("icon",n.referenceIcon((e=n.postingContentPart())==null?null:e.referenceType)),r(),O("",(i=n.postingContentPart())==null?null:i.referenceStr," ")}}function wo(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"a",4),h("click",function(){let n;m(e);let s=c();return u(s.onClickUserReference((n=s.postingContentPart())==null||n.queryParams==null?null:n.queryParams.referenceUserLogin))}),t(2,`
        `),g(3,"fa-icon",2),t(4),l(),t(5,`
`)}if(o&2){let e,i=c();r(3),p("icon",i.faAt),r(),O("",(e=i.postingContentPart())==null?null:e.referenceStr,`
    `)}}function vo(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"a",4),h("click",function(){let n;m(e);let s=c();return u(s.onClickChannelReference((n=s.postingContentPart())==null||n.queryParams==null?null:n.queryParams.channelId))}),t(2,`
        `),g(3,"fa-icon",2),t(4),l(),t(5,`
`)}if(o&2){let e,i=c();r(3),p("icon",i.faHashtag),r(),O("",(e=i.postingContentPart())==null?null:e.referenceStr,`
    `)}}function yo(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"a",4),h("click",function(){let n;m(e);let s=c();return u(s.openAttachment(((n=s.postingContentPart())==null?null:n.attachmentToReference)||""))}),t(2,`
        `),g(3,"fa-icon",2),t(4),l(),t(5,`
`)}if(o&2){let e,i=c();r(3),p("icon",i.faFile),r(),O("",(e=i.postingContentPart())==null?null:e.referenceStr,`
    `)}}function To(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"img",6),h("error",function(){m(e);let n=c(2);return u(n.toggleImageNotFound())}),l(),t(2,`
            `)}if(o&2){let e,i,n,s=c(2);r(),p("src",(e=s.postingContentPart())==null?null:e.slideToReference,Ie)("alt",(i=s.postingContentPart())==null?null:i.referenceStr)("title",(n=s.postingContentPart())==null?null:n.referenceStr)}}function bo(o,d){if(o&1&&(t(0,`
            `),a(1,"div",7),t(2,`
                `),a(3,"h5",8),g(4,"fa-icon",2)(5,"span",9),l(),t(6,`
            `),l(),t(7,`
        `)),o&2){let e=c(2);r(4),p("icon",e.faBan)}}function Mo(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"div",5),t(2,`
        `),a(3,"a",4),h("click",function(){let n;m(e);let s=c();return u(s.enlargeImage(((n=s.postingContentPart())==null?null:n.slideToReference)||""))}),t(4,`
            `),x(5,To,3,3),l(),t(6,`
        `),x(7,bo,8,1),l(),t(8,`
`)}if(o&2){let e,i=c();r(5),f((e=i.postingContentPart())!=null&&e.slideToReference&&!i.imageNotFound?5:-1),r(2),f(i.imageNotFound?7:-1)}}function ko(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"a",4),h("click",function(){let n;m(e);let s=c(2);return u(s.enlargeImage(((n=s.postingContentPart())==null?null:n.imageToReference)||""))}),t(2,`
                `),a(3,"img",6),h("error",function(){m(e);let n=c(2);return u(n.toggleImageNotFound())}),l(),t(4,`
            `),l(),t(5,`
        `)}if(o&2){let e,i,n,s=c(2);r(3),p("src",(e=s.postingContentPart())==null?null:e.imageToReference,Ie)("alt",(i=s.postingContentPart())==null?null:i.referenceStr)("title",(n=s.postingContentPart())==null?null:n.referenceStr)}}function Oo(o,d){if(o&1&&(t(0,`
            `),a(1,"div",7),t(2,`
                `),a(3,"h5",8),g(4,"fa-icon",2)(5,"span",10),l(),t(6,`
            `),l(),t(7,`
        `)),o&2){let e=c(2);r(4),p("icon",e.faBan)}}function So(o,d){if(o&1&&(t(0,`
    `),a(1,"div"),t(2,`
        `),x(3,ko,6,3)(4,Oo,8,1),l(),t(5,`
`)),o&2){let e,i=c();r(),ze("user-select","none")("max-width",400,"px"),r(2),f((e=i.postingContentPart())!=null&&e.imageToReference&&!i.imageNotFound?3:i.imageNotFound?4:-1)}}function Ao(o,d){if(o&1&&(t(0,`
    `),g(1,"span",0),y(2,"htmlForPostingMarkdown"),t(3,`
`)),o&2){let e=c();r(),p("innerHTML",sn(2,1,e.processedContentAfterReference,!1,e.allowedHtmlTags,e.allowedHtmlAttributes),rn)}}var $i=(()=>{class o{fileService=w(qt);dialog=w(Ui);accountService=w(tt);postingContentPart=C();userReferenceClicked=b();channelReferenceClicked=b();imageNotFound=!1;hasClickedUserReference=!1;allowedHtmlTags=["a","b","br","blockquote","code","del","em","i","ins","mark","p","pre","small","s","span","strong","sub","sup"];allowedHtmlAttributes=["href"];faFile=ln;faBan=Kn;faAt=kt;faHashtag=It;faQuestion=an;ReferenceType=A;processedContentBeforeReference;processedContentAfterReference;ngOnInit(){this.processContent()}ngOnChanges(){this.processContent()}openAttachment(e){this.fileService.downloadFile(e)}toggleImageNotFound(){this.imageNotFound=!0}processContent(){this.postingContentPart()?.contentBeforeReference&&(this.processedContentBeforeReference=this.escapeNumberedList(this.postingContentPart()?.contentBeforeReference||""),this.processedContentBeforeReference=this.escapeUnorderedList(this.processedContentBeforeReference)),this.postingContentPart()?.contentAfterReference&&(this.processedContentAfterReference=this.escapeNumberedList(this.postingContentPart()?.contentAfterReference||""),this.processedContentAfterReference=this.escapeUnorderedList(this.processedContentAfterReference))}escapeNumberedList(e){return e.replace(/^(\s*\d+)\. /gm,"$1\\.  ")}escapeUnorderedList(e){return e.replace(/^(- )/gm,"\\$1")}enlargeImage(e){this.dialog.open(qi,{data:{slideToReference:e},maxWidth:"95vw"})}referenceIcon(e){switch(e){case A.POST:return zn;case A.LECTURE:return oi;case A.PROGRAMMING:return ei;case A.MODELING:return ii;case A.QUIZ:return Zn;case A.TEXT:return ti;case A.FILE_UPLOAD:return Xn;case A.SLIDE:return ln;case A.FAQ:return an;default:return Yn}}onClickUserReference(e){!this.hasClickedUserReference&&e&&e!==this.accountService.userIdentity?.login&&(this.hasClickedUserReference=!0,this.userReferenceClicked.emit(e))}onClickChannelReference(e){e&&this.channelReferenceClicked.emit(e)}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-posting-content-part"]],inputs:{postingContentPart:[1,"postingContentPart"]},outputs:{userReferenceClicked:"userReferenceClicked",channelReferenceClicked:"channelReferenceClicked"},features:[I],decls:9,vars:9,consts:[[1,"markdown-preview",2,"white-space","pre-wrap",3,"innerHTML"],[1,"reference",3,"routerLink","queryParams"],[1,"px-1",3,"icon"],[1,"reference"],[1,"reference",3,"click"],[2,"max-width","400px"],["height","auto","width","100%",1,"img-fluid","rounded-sm","border","mt-1","mb-1",3,"error","src","alt","title"],[1,"card"],[1,"card-body"],["jhiTranslate","artemisApp.markdownEditor.preview.slideNotFound"],["jhiTranslate","artemisApp.markdownEditor.preview.imageNotFound"]],template:function(i,n){if(i&1&&x(0,Co,4,6)(1,xo,6,4)(2,Po,6,2)(3,wo,6,2)(4,vo,6,2)(5,yo,6,2)(6,Mo,9,2)(7,So,6,5)(8,Ao,4,6),i&2){let s,_,v,S,M,L,_e,dt,Le;f((s=n.postingContentPart())!=null&&s.contentBeforeReference?0:-1),r(),f((_=n.postingContentPart())!=null&&_.linkToReference?1:-1),r(),f(((v=n.postingContentPart())==null?null:v.referenceType)===n.ReferenceType.POST&&!((v=n.postingContentPart())!=null&&v.linkToReference)?2:-1),r(),f(((S=n.postingContentPart())==null?null:S.referenceType)===n.ReferenceType.USER?3:-1),r(),f(((M=n.postingContentPart())==null?null:M.referenceType)===n.ReferenceType.CHANNEL?4:-1),r(),f((L=n.postingContentPart())!=null&&L.attachmentToReference?5:-1),r(),f((_e=n.postingContentPart())!=null&&_e.slideToReference?6:-1),r(),f((dt=n.postingContentPart())!=null&&dt.imageToReference?7:-1),r(),f((Le=n.postingContentPart())!=null&&Le.contentAfterReference?8:-1)}},dependencies:[bt,z,Qi,j],styles:[".post-result-information[_ngcontent-%COMP%]{font-size:small;font-style:italic}.post-separation-line[_ngcontent-%COMP%]{height:1px;background:var(--metis-light-gray)}.bold-line[_ngcontent-%COMP%]{height:2px;background:var(--metis-light-gray)}.icon[_ngcontent-%COMP%]{color:var(--metis-gray)}.resolved[_ngcontent-%COMP%]{color:var(--metis-green)}.post-header-author-date[_ngcontent-%COMP%]{line-height:1.1}.post-content-padding[_ngcontent-%COMP%]{padding-left:3.42rem}.post-authority-icon-student[_ngcontent-%COMP%]{display:none}.reference[_ngcontent-%COMP%]{font-weight:200;display:inline-flex}.hideAfter5Seconds[_ngcontent-%COMP%]{-webkit-animation:_ngcontent-%COMP%_cssAnimation 5s forwards;animation:_ngcontent-%COMP%_cssAnimation 5s forwards}@keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}@-webkit-keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}.card[_ngcontent-%COMP%]{border-radius:.25em}@media (max-width: 575.98px){.post-header-author-date[_ngcontent-%COMP%]{flex-direction:column;gap:0!important}.post-content-padding[_ngcontent-%COMP%]{margin-left:0}.post-header-date-separator[_ngcontent-%COMP%]{display:none}.post-header-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6c757d;font-size:.75rem!important}}.post-delete-button-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;z-index:0;background-color:#0d6efd4d;animation:_ngcontent-%COMP%_increaseWidth 6s forwards linear}@media (prefers-reduced-motion){.post-delete-button-background[_ngcontent-%COMP%]{animation:none}}.post-delete-button-label[_ngcontent-%COMP%]{position:relative;z-index:1}@keyframes _ngcontent-%COMP%_increaseWidth{0%{width:0}to{width:100%}}"]})}return o})();function Eo(o,d){o&1&&(t(0,`
        `),a(1,"div",0),t(2,`
            `),t(3,`
            `),a(4,"div",1),t(5,`
                `),g(6,"div",2),t(7,`
            `),l(),t(8,`
        `),l(),t(9,`
    `))}function Io(o,d){if(o&1&&(t(0,`
    `),x(1,Eo,10,0)),o&2){let e=c();r(),f(e.hasError?-1:1)}}function Ro(o,d){if(o&1){let e=P();t(0,`
                    `),a(1,"jhi-confirm-icon",9),y(2,"artemisTranslate"),y(3,"artemisTranslate"),h("confirmEvent",function(){m(e);let n=c(3);return u(n.removeLinkPreview(n.linkPreview))}),l(),t(4,`
                `)}if(o&2){let e=c(3);r(),p("ngClass","faTimes clickable icon")("initialIcon",e.faTimes)("initialTooltip",T(2,4,"artemisApp.metis.removeLinkPreview"))("confirmTooltip",T(3,6,"artemisApp.metis.confirmRemoveLinkPreview"))}}function Do(o,d){if(o&1&&(t(0,`
                        `),a(1,"div",10),t(2,`
                            `),g(3,"img",11),t(4,`
                        `),l(),t(5,`
                    `)),o&2){let e=c(3);r(3),p("src",e.linkPreview.image,Ie)}}function Vo(o,d){if(o&1&&(t(0,`
        `),a(1,"div",3),t(2,`
            `),t(3,`
            `),a(4,"div",4),t(5,`
                `),x(6,Ro,5,8),a(7,"div",5),t(8,`
                    `),a(9,"div",6),t(10,`
                        `),a(11,"h2",7),t(12),l(),t(13,`
                        `),a(14,"p",8),t(15),l(),t(16,`
                    `),l(),t(17,`
                    `),x(18,Do,6,1),l(),t(19,`
            `),l(),t(20,`
        `),l(),t(21,`
    `)),o&2){let e=c(2);r(6),f(e.isAuthorOfOriginalPost?6:-1),r(6),U(e.linkPreview.title),r(3),U(e.linkPreview.description),r(3),f(e.linkPreview.image&&!e.multiple?18:-1)}}function Fo(o,d){if(o&1&&(t(0,`
    `),x(1,Vo,22,4)),o&2){let e=c();r(),f(e.linkPreview&&e.linkPreview.shouldPreviewBeShown?1:-1)}}var Ki=(()=>{class o{metisService=w(D);linkPreview;posting;showLoadingsProgress;loaded;hasError;isReply;multiple;isAuthorOfOriginalPost;faTimes=At;ngOnInit(){this.isAuthorOfOriginalPost=this.metisService.metisUserIsAuthorOfPosting(this.posting)}removeLinkPreview(e){let i=e.url;if(this.posting){let n,s=this.posting.content;for(;(n=mn.exec(s))!==null;){let _=n[0],v=n.index,S=v+_.length;(_===i||_.includes(i))&&(s=s.substring(0,v)+`<${_}>`+s.substring(S))}this.posting.content=s,this.isReply?this.metisService.updateAnswerPost(this.posting).subscribe({next:()=>{}}):this.metisService.updatePost(this.posting).subscribe({next:()=>{}})}}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-link-preview"]],inputs:{linkPreview:"linkPreview",posting:"posting",showLoadingsProgress:"showLoadingsProgress",loaded:"loaded",hasError:"hasError",isReply:"isReply",multiple:"multiple"},decls:2,vars:1,consts:[[1,"loading-container"],[1,"loading-spinner"],[1,"spinner"],[1,"preview-container"],[1,"preview-card"],[1,"left-border"],[1,"preview-content"],[1,"preview-title"],[1,"preview-description"],["iconSize","sm",1,"close-button",3,"confirmEvent","ngClass","initialIcon","initialTooltip","confirmTooltip"],[1,"preview-image"],["alt","Preview Image",3,"src"]],template:function(i,n){i&1&&x(0,Io,2,1)(1,Fo,2,1),i&2&&f(!n.linkPreview&&!n.loaded&&n.showLoadingsProgress?0:1)},dependencies:[Qt,W,V],styles:['.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100px}.loading-spinner[_ngcontent-%COMP%]{display:flex;align-items:center}.spinner[_ngcontent-%COMP%]{border:4px solid var(--secondary);border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-container[_ngcontent-%COMP%], .preview-content[_ngcontent-%COMP%]{margin-left:5px;max-width:600px}@media (max-width: 768px){.loading-container[_ngcontent-%COMP%], .preview-content[_ngcontent-%COMP%]{margin-left:0;margin-top:10px}}.preview-title[_ngcontent-%COMP%]{font-size:15px;font-weight:700}.preview-description[_ngcontent-%COMP%]{margin-top:5px;font-size:14px}.preview-url[_ngcontent-%COMP%]{display:block;margin-top:10px;color:var(--primary)}.preview-container[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:10px;margin-left:10px}.preview-card[_ngcontent-%COMP%]{flex-direction:row;padding-left:10px;margin-left:2px;position:relative}.preview-card[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;width:4px;height:100%;background-color:var(--secondary);border-radius:4px}.preview-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:150px;margin-right:10px;margin-top:10px;border-radius:4px}.close-button[_ngcontent-%COMP%]{position:absolute;top:0;left:-12px;font-weight:700;cursor:pointer;opacity:0;transition:opacity .3s}.preview-card[_ngcontent-%COMP%]:hover   .close-button[_ngcontent-%COMP%]{opacity:1}']})}return o})();function jo(o,d){if(o&1&&(t(0,`
    `),a(1,"div"),t(2,`
        `),g(3,"jhi-link-preview",0),t(4,`
    `),l(),t(5,`
`)),o&2){let e=d.$implicit,i=c();r(3),p("linkPreview",e)("showLoadingsProgress",i.showLoadingsProgress())("hasError",i.hasError())("loaded",i.loaded())("posting",i.posting())("isReply",i.isReply())("multiple",i.multiple())}}var Xi=(()=>{class o{linkPreviewService=w($t);linkifyService=w(Kt);data=C();author=C();posting=C();isEdited=C();isReply=C();linkPreviews=q([]);hasError=q(!1);loaded=q(!1);showLoadingsProgress=q(!0);multiple=q(!1);ngOnInit(){this.findPreviews()}ngOnChanges(){this.reloadLinkPreviews()}reloadLinkPreviews(){this.loaded.set(!1),this.showLoadingsProgress.set(!0),this.linkPreviews.set([]),this.findPreviews()}findPreviews(){this.linkifyService.find(this.data()??"").filter(i=>!i.isLinkPreviewRemoved).slice(0,5).forEach(i=>{this.linkPreviewService.fetchLink(i.href).subscribe({next:n=>{n.shouldPreviewBeShown=!!(n.url&&n.title&&n.description&&n.image);let s=this.linkPreviews().findIndex(_=>_.url===n.url);s!==-1?this.linkPreviews.update(_=>{let v=_[s];return Object.assign(v,n),_}):this.linkPreviews.set([...this.linkPreviews(),n]),this.hasError.set(!1),this.loaded.set(!0),this.showLoadingsProgress.set(!1),this.multiple.set(this.linkPreviews().length>1)}})})}trackLinks(e,i){return i?.url}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-link-preview-container"]],inputs:{data:[1,"data"],author:[1,"author"],posting:[1,"posting"],isEdited:[1,"isEdited"],isReply:[1,"isReply"]},features:[I],decls:2,vars:0,consts:[[3,"linkPreview","showLoadingsProgress","hasError","loaded","posting","isReply","multiple"]],template:function(i,n){i&1&&B(0,jo,6,7,null,null,n.trackLinks,!0),i&2&&N(n.linkPreviews())},dependencies:[Ki],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return o})();var Lo=o=>({progress:o}),Bo=()=>({color:"#6a737d"});function No(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"span",0),t(2,`
        `),g(3,"span",1),t(4,`
        `),a(5,"button",2),h("click",function(){m(e);let n=c();return u(n.onUndoDeleteEvent.emit())}),t(6,`
            `),g(7,"span",3),t(8,`
            `),g(9,"span",4),t(10,`
        `),l(),t(11,`
    `),l(),t(12,`
`)}if(o&2){let e=c();r(3),p("translateValues",E(1,Lo,e.deleteTimerInSeconds()))}}function Uo(o,d){if(o&1){let e=P();t(0,`
                        `),a(1,"jhi-posting-content-part",9),h("userReferenceClicked",function(n){m(e);let s=c(4);return u(s.userReferenceClicked.emit(n))})("channelReferenceClicked",function(n){m(e);let s=c(4);return u(s.channelReferenceClicked.emit(n))}),l(),t(2,`
                    `)}if(o&2){let e=d.$implicit;r(),p("postingContentPart",e)}}function Ho(o,d){o&1&&(t(0,`
                        `),g(1,"span",10),t(2,`
                    `))}function zo(o,d){if(o&1&&(t(0,`
                `),a(1,"div"),t(2,`
                    `),B(3,Uo,3,1,null,null,Ge().contentPartTrack,!0),x(5,Ho,3,0),l(),t(6,`
            `)),o&2){let e=c(3);r(3),N(e.postingContentParts()),r(2),f(e.isEdited()?5:-1)}}function Go(o,d){if(o&1){let e=P();t(0,`
        `),a(1,"div",5),t(2,`
            `),a(3,"span",6),t(4,`
                `),a(5,"fa-icon",7),h("click",function(){m(e);let n=c(2);return u(n.showContent=!n.showContent)}),l(),t(6,`
            `),l(),t(7,`
            `),g(8,"span",8),t(9,`
            `),x(10,zo,7,1),l(),t(11,`
    `)}if(o&2){let e=c(2);r(5),p("icon",e.showContent?e.faAngleUp:e.faAngleDown)("size","xs")("ngStyle",We(5,Bo)),r(3),$("jhiTranslate",e.showContent?"artemisApp.metis.post.collapseContent":"artemisApp.metis.post.showContent"),r(2),f(e.showContent?10:-1)}}function Wo(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"jhi-posting-content-part",9),h("userReferenceClicked",function(n){m(e);let s=c(3);return u(s.userReferenceClicked.emit(n))})("channelReferenceClicked",function(n){m(e);let s=c(3);return u(s.channelReferenceClicked.emit(n))}),l(),t(2,`
            `)}if(o&2){let e=d.$implicit;r(),p("postingContentPart",e)}}function qo(o,d){o&1&&(t(0,`
                `),g(1,"span",10),t(2,`
            `))}function Qo(o,d){if(o&1&&(t(0,`
        `),a(1,"div",5),t(2,`
            `),B(3,Wo,3,1,null,null,Ge().contentPartTrack,!0),x(5,qo,3,0),g(6,"jhi-link-preview-container",11),t(7,`
        `),l(),t(8,`
    `)),o&2){let e=c(2);r(3),N(e.postingContentParts()),r(2),f(e.isEdited()?5:-1),r(),p("data",e.content())("author",e.author())("posting",e.posting())("isEdited",e.isEdited())("isReply",e.isReply())}}function $o(o,d){if(o&1&&(t(0,`
    `),t(1,`
    `),x(2,Go,12,6)(3,Qo,9,6)),o&2){let e=c();r(2),f(e.previewMode()?2:-1),r(),f(e.previewMode()?-1:3)}}var ce=(()=>{class o{metisService=w(D);content=C();previewMode=C();author=C();isEdited=C(!1);posting=C();isReply=C();userReferenceClicked=b();channelReferenceClicked=b();isDeleted=C(!1);isSubscribeToMetis=C(!0);deleteTimerInSeconds=C(0);onUndoDeleteEvent=b();showContent=!1;currentlyLoadedPosts=[];postingContentParts=q([]);postsSubscription;ATTACHMENT_DIR="api/core/files/attachments/";faAngleUp=Et;faAngleDown=St;ngOnInit(){if(this.isSubscribeToMetis())this.computeContentPartsOfPosts();else{let e=this.getPatternMatches();this.computePostingContentParts(e)}}ngOnChanges(){this.isSubscribeToMetis()||this.computeContentPartsOfPosts();let e=this.getPatternMatches();this.computePostingContentParts(e)}computeContentPartsOfPosts(){this.postsSubscription=this.metisService.posts.subscribe(e=>{this.currentlyLoadedPosts=e;let i=this.getPatternMatches();this.computePostingContentParts(i)})}ngOnDestroy(){this.postsSubscription?.unsubscribe()}computePostingContentParts(e){if(this.postingContentParts.set([]),e&&e.length>0)e.forEach((i,n)=>{if(this.content()===void 0)return;let s=this.content().substring(i.startIndex+1,i.endIndex),_=i.referenceType,v,S,M,L,_e,dt;if(A.POST===_){let Se=this.currentlyLoadedPosts.find(_o=>_o.id===+s);v=this.content().substring(i.startIndex,i.endIndex),nt(this.metisService.getCourse())&&(S=this.metisService.getLinkForPost(),_e=Se?this.metisService.getQueryParamsForPost(Se):{searchText:v})}else if(A.LECTURE===_||A.PROGRAMMING===_||A.MODELING===_||A.QUIZ===_||A.TEXT===_||A.FILE_UPLOAD===_)v=this.content().substring(this.content().indexOf("]",i.startIndex)+1,this.content().indexOf("(",i.startIndex)),S=[this.content().substring(this.content().indexOf("(",i.startIndex)+1,this.content().indexOf(")",i.startIndex))];else if(A.FAQ===_)v=this.content().substring(this.content().indexOf("]",i.startIndex)+1,this.content().indexOf("(/courses",i.startIndex)),S=[this.content().substring(this.content().indexOf("(/courses",i.startIndex)+1,this.content().indexOf("?faqId",i.startIndex))],_e={faqId:this.content().substring(this.content().indexOf("=")+1,this.content().indexOf(")"))};else if(A.ATTACHMENT===_||A.ATTACHMENT_UNITS===_)v=this.content().substring(this.content().indexOf("]",i.startIndex)+1,this.content().indexOf("(",i.startIndex)),M=this.ATTACHMENT_DIR+this.content().substring(this.content().indexOf("(",i.startIndex)+1,this.content().indexOf(")",i.startIndex));else if(A.SLIDE===_)v=this.content().substring(this.content().indexOf("]",i.startIndex)+1,this.content().indexOf("(",i.startIndex)),L=this.ATTACHMENT_DIR+this.content().substring(this.content().indexOf("(",i.startIndex)+1,this.content().indexOf(")",i.startIndex));else if(A.USER===_)v=this.content().substring(this.content().indexOf("]",i.startIndex)+1,this.content().indexOf("(",i.startIndex)),_e={referenceUserLogin:this.content().substring(this.content().indexOf("(",i.startIndex)+1,this.content().indexOf(")",i.startIndex))};else if(A.CHANNEL===_){v=this.content().substring(this.content().indexOf("]",i.startIndex)+1,this.content().indexOf("(",i.startIndex));let Se=parseInt(this.content().substring(this.content().indexOf("(",i.startIndex)+1,this.content().indexOf(")",i.startIndex)));_e={channelId:isNaN(Se)?void 0:Se}}else A.IMAGE===_&&(v=this.content().substring(this.content().indexOf("![")+2,this.content().indexOf("](",i.startIndex)),dt=this.content().substring(this.content().indexOf("(",i.startIndex)+1,this.content().indexOf(")",i.startIndex)));let Le;n<e.length-1?Le=e[n+1].startIndex:Le=this.content().length;let go={contentBeforeReference:n===0?this.content().substring(0,i.startIndex):void 0,linkToReference:S,attachmentToReference:M,slideToReference:L,queryParams:_e,referenceStr:v,referenceType:_,imageToReference:dt,contentAfterReference:this.content().substring(i.endIndex,Le)};this.postingContentParts.set([...this.postingContentParts(),go])});else{let i={contentBeforeReference:this.content(),linkToReference:void 0,queryParams:void 0,referenceStr:void 0,referenceType:void 0,contentAfterReference:void 0};this.postingContentParts.set([...this.postingContentParts(),i])}}getPatternMatches(){let e=/(?<POST>#\d+)|(?<PROGRAMMING>\[programming].*?\[\/programming])|(?<MODELING>\[modeling].*?\[\/modeling])|(?<QUIZ>\[quiz].*?\[\/quiz])|(?<TEXT>\[text].*?\[\/text])|(?<FILE_UPLOAD>\[file-upload].*?\[\/file-upload])|(?<LECTURE>\[lecture].*?\[\/lecture])|(?<ATTACHMENT>\[attachment].*?\[\/attachment])|(?<ATTACHMENT_UNITS>\[lecture-unit].*?\[\/lecture-unit])|(?<SLIDE>\[slide].*?\[\/slide])|(?<USER>\[user].*?\[\/user])|(?<CHANNEL>\[channel].*?\[\/channel])|(?<IMAGE>!\[.*?]\(.*?\))|(?<FAQ>\[faq].*?\[\/faq])/g,i=[],n=e.exec(this.content());for(;n;){let s;for(let _ in n.groups)n.groups[_]&&(s=A[_]);s&&i.push({startIndex:n.index,endIndex:e.lastIndex,referenceType:s}),n=e.exec(this.content())}return i}contentPartTrack(e){return this.posting()?.id+"_"+e}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-posting-content"]],inputs:{content:[1,"content"],previewMode:[1,"previewMode"],author:[1,"author"],isEdited:[1,"isEdited"],posting:[1,"posting"],isReply:[1,"isReply"],isDeleted:[1,"isDeleted"],isSubscribeToMetis:[1,"isSubscribeToMetis"],deleteTimerInSeconds:[1,"deleteTimerInSeconds"]},outputs:{userReferenceClicked:"userReferenceClicked",channelReferenceClicked:"channelReferenceClicked",onUndoDeleteEvent:"onUndoDeleteEvent"},features:[I],decls:2,vars:1,consts:[[1,"posting-content-undo-delete","d-inline-flex","align-items-center"],["jhiTranslate","artemisApp.metis.post.deletedContent",1,"text-secondary",3,"translateValues"],[1,"btn","btn-outline-primary","btn-sm","ms-2","position-relative",3,"click"],["jhiTranslate","artemisApp.metis.post.undoDelete",1,"post-delete-button-label"],[1,"post-delete-button-background"],[1,"pb-1"],[1,"clickable","p-0"],[3,"click","icon","size","ngStyle"],[1,"toggle-content",3,"jhiTranslate"],[3,"userReferenceClicked","channelReferenceClicked","postingContentPart"],["jhiTranslate","artemisApp.metis.edited",1,"edited-text"],[3,"data","author","posting","isEdited","isReply"]],template:function(i,n){i&1&&x(0,No,13,3)(1,$o,4,2),i&2&&f(n.isDeleted()?0:1)},dependencies:[j,z,Ce,$i,Xi],styles:[".post-result-information[_ngcontent-%COMP%]{font-size:small;font-style:italic}.post-separation-line[_ngcontent-%COMP%]{height:1px;background:var(--metis-light-gray)}.bold-line[_ngcontent-%COMP%]{height:2px;background:var(--metis-light-gray)}.icon[_ngcontent-%COMP%]{color:var(--metis-gray)}.resolved[_ngcontent-%COMP%]{color:var(--metis-green)}.post-header-author-date[_ngcontent-%COMP%]{line-height:1.1}.post-content-padding[_ngcontent-%COMP%]{padding-left:3.42rem}.post-authority-icon-student[_ngcontent-%COMP%]{display:none}.reference[_ngcontent-%COMP%]{font-weight:200;display:inline-flex}.hideAfter5Seconds[_ngcontent-%COMP%]{-webkit-animation:_ngcontent-%COMP%_cssAnimation 5s forwards;animation:_ngcontent-%COMP%_cssAnimation 5s forwards}@keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}@-webkit-keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}.card[_ngcontent-%COMP%]{border-radius:.25em}@media (max-width: 575.98px){.post-header-author-date[_ngcontent-%COMP%]{flex-direction:column;gap:0!important}.post-content-padding[_ngcontent-%COMP%]{margin-left:0}.post-header-date-separator[_ngcontent-%COMP%]{display:none}.post-header-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6c757d;font-size:.75rem!important}}.post-delete-button-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;z-index:0;background-color:#0d6efd4d;animation:_ngcontent-%COMP%_increaseWidth 6s forwards linear}@media (prefers-reduced-motion){.post-delete-button-background[_ngcontent-%COMP%]{animation:none}}.post-delete-button-label[_ngcontent-%COMP%]{position:relative;z-index:1}@keyframes _ngcontent-%COMP%_increaseWidth{0%{width:0}to{width:100%}}.toggle-content[_ngcontent-%COMP%]{font-size:smaller;color:var(--metis-light-gray)}.announcement-post[_ngcontent-%COMP%]{background-color:var(--metis-light-blue);border-radius:7px}.edited-text[_ngcontent-%COMP%]{color:var(--metis-gray);font-size:smaller}"],changeDetection:0})}return o})();var Ko=()=>[],Xo=o=>({color:o});function Jo(o,d){if(o&1&&(t(0,`
                `),g(1,"jhi-posting-content",3),t(2,`
            `)),o&2){let e=c();r(),p("content",e.content)}}function Yo(o,d){if(o&1&&(t(0,`
    `),a(1,"div",4),t(2,`
        `),a(3,"p",5),t(4),l(),t(5,`
    `),l(),t(6,`
`)),o&2){let e,i=c();r(3),p("ngStyle",E(3,Xo,(i.content==null?null:i.content.length)>i.maxContentLength||(i.content==null?null:i.content.length)===0?"red":"inherit")),r(),xt(`
            `,(e=i.content==null?null:i.content.length)!==null&&e!==void 0?e:0," / ",i.maxContentLength,`
        `)}}var ct=(()=>{class o{cdref=w(H);metisService=w(D);fileService=w(qt);courseManagementService=w(Rt);lectureService=w(ai);channelService=w(hi);viewContainerRef=w(Re);positionBuilder=w(Pi);markdownEditor;maxContentLength;editorHeight=ke.INLINE;isInputLengthDisplayed=!0;suppressNewlineOnEnter=!0;isButtonLoading=C(!1);isFormGroupValid=C(!1);editType=C();EditType=le.CREATE;activeConversation=C();valueChange=new Ee;lectureAttachmentReferenceAction;defaultActions;content;previewMode=!1;fallbackConversationId=je(()=>this.activeConversation()?.id);MarkdownEditorHeight=ke;overlay=w(wi);ngOnInit(){let e=nt(this.metisService.getCourse())?[new zi(this.courseManagementService,this.metisService),new Hi(this.metisService,this.channelService)]:[],i=li(this.metisService.getCourse())?[new Wi(this.metisService)]:[];this.defaultActions=[new Lt,new Bt,new Nt,new Ri,new Bi(this.viewContainerRef,this.overlay,this.positionBuilder),new dn,new pn,new Ut,new Ht,new zt,new Gt,new Ii,...e,new Gi(this.metisService),...i],this.lectureAttachmentReferenceAction=new Di(this.metisService,this.lectureService,this.fileService)}ngAfterViewInit(){this.markdownEditor.enableTextFieldMode();let e=this.markdownEditor.monacoEditor;e&&e.onDidChangeModelContent(i=>{let n=e.getPosition();if(!n)return;let s=e.getModel();if(!s)return;let _=s.getLineContent(n.lineNumber).trimStart(),v=_.startsWith("- ")||/^\s*1\. /.test(_);v&&i.changes.length===1&&(i.changes[0].text.startsWith("- ")||i.changes[0].text.startsWith("1. "))||v&&this.handleKeyDown(s,n.lineNumber)})}handleKeyDown(e,i){let n=e.getLineContent(i).trimStart();n.startsWith("- ")?this.markdownEditor.handleActionClick(new MouseEvent("click"),this.defaultActions.find(s=>s instanceof dn)):/^\d+\. /.test(n)&&this.markdownEditor.handleActionClick(new MouseEvent("click"),this.defaultActions.find(s=>s instanceof pn))}ngAfterContentChecked(){this.cdref.detectChanges()}onChange=e=>{};valueChanged(){this.valueChange.emit()}writeValue(e){this.content=e??""}registerOnChange(e){this.onChange=e}registerOnTouched(){}updateField(e){this.content=e,this.onChange(this.content),this.valueChanged()}onKeyDown(e){this.suppressNewlineOnEnter&&e.key==="Enter"&&!e.shiftKey&&e.preventDefault()}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-posting-markdown-editor"]],viewQuery:function(i,n){if(i&1&&te(ut,7),i&2){let s;ne(s=ie())&&(n.markdownEditor=s.first)}},inputs:{maxContentLength:"maxContentLength",editorHeight:"editorHeight",isInputLengthDisplayed:"isInputLengthDisplayed",suppressNewlineOnEnter:"suppressNewlineOnEnter",isButtonLoading:[1,"isButtonLoading"],isFormGroupValid:[1,"isFormGroupValid"],editType:[1,"editType"],activeConversation:[1,"activeConversation"]},outputs:{valueChange:"valueChange"},features:[Pt([{provide:Rn,useExisting:yn(()=>o),multi:!0}])],decls:14,vars:23,consts:[[1,"col-12"],[1,"markdown-editor","background-editor-color","w-100",3,"markdownChange","onEditSelect","onPreviewSelect","keydown","markdown","metaActions","headerActions","defaultActions","lectureReferenceAction","enableFileUpload","useCommunicationForFileUpload","fallbackConversationId","colorAction","enableResize","showDefaultPreview","useDefaultMarkdownEditorOptions","linkEditorHeightToContentHeight","initialEditorHeight","resizableMinHeight","resizableMaxHeight","isButtonLoading","isFormGroupValid","editType","isInCommunication"],["id","previewMonaco"],[3,"content"],[1,"col","mt-1","text-end"],[1,"small","my-0","ms-2",3,"ngStyle"]],template:function(i,n){if(i&1&&(a(0,"div",0),t(1,`
    `),a(2,"jhi-markdown-editor-monaco",1),h("markdownChange",function(_){return n.updateField(_)})("onEditSelect",function(){return n.previewMode=!1})("onPreviewSelect",function(){return n.previewMode=!0})("keydown",function(_){return n.onKeyDown(_)}),t(3,`
        `),pe(4,2),t(5,`
            `),x(6,Jo,3,1),g(7,"hr"),t(8,`
        `),me(),t(9,`
        `),t(10,`
    `),l(),t(11,`
`),l(),t(12,`
`),x(13,Yo,7,5)),i&2){let s;r(2),p("markdown",n.content)("metaActions",We(22,Ko))("headerActions",void 0)("defaultActions",n.defaultActions)("lectureReferenceAction",n.lectureAttachmentReferenceAction)("enableFileUpload",!0)("useCommunicationForFileUpload",!0)("fallbackConversationId",n.fallbackConversationId())("colorAction",void 0)("enableResize",!1)("showDefaultPreview",!1)("useDefaultMarkdownEditorOptions",!1)("linkEditorHeightToContentHeight",!0)("initialEditorHeight",n.editorHeight)("resizableMinHeight",n.editorHeight)("resizableMaxHeight",n.MarkdownEditorHeight.MEDIUM)("isButtonLoading",n.isButtonLoading())("isFormGroupValid",n.isFormGroupValid())("editType",n.editType())("isInCommunication",!0),r(4),f(n.previewMode?6:-1),r(7),f(n.isInputLengthDisplayed||((s=n.content==null?null:n.content.length)!==null&&s!==void 0?s:0)>n.maxContentLength?13:-1)}},dependencies:[ut,ce,Ce],encapsulation:2,changeDetection:0})}return o})();var Zo=["tagInput"];function er(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"mat-chip-row",7),h("removed",function(){let n=m(e).$implicit,s=c();return u(s.onItemRemove(n))}),t(2,`
                `),a(3,"div",8),t(4),a(5,"button",9),t(6,`
                        `),g(7,"fa-icon",10),t(8,`
                    `),l(),t(9,`
                `),l(),t(10,`
            `),l(),t(11,`
        `)}if(o&2){let e=d.$implicit,i=c();r(4),O(`
                    `,e,`
                    `),r(3),p("icon",i.faTimes)}}function tr(o,d){if(o&1&&(t(0,`
            `),a(1,"mat-option",11),t(2),l(),t(3,`
        `)),o&2){let e=d.$implicit;r(),p("value",e),r(),O(`
                `,e,`
            `)}}var Ji=(()=>{class o{metisService=w(D);changeDetector=w(H);postTags;postTagsChange=new Ee;tagInput;existingPostTags;tags;separatorKeysCodes=[13,188,9];tagCtrl=new Dn(void 0);tagsSubscription;faTimes=At;ngOnInit(){this.tagsSubscription=this.metisService.tags.subscribe(e=>{this.existingPostTags=this.tagCtrl.valueChanges.pipe(wn(void 0),Ae(i=>i?this._filter(i):e.slice()))}),this.tags=this.postTags?this.postTags:[]}_filter(e){let i=e.toLowerCase();return this.tags.filter(n=>n.toLowerCase().includes(i))}ngOnChanges(){this.tags=this.postTags?this.postTags:[]}ngAfterContentChecked(){this.changeDetector.detectChanges()}onItemAdd(e){let i=(e.value||"").trim();i&&!this.tags?.includes(i)&&this.tags?.length<3&&(this.tags||(this.tags=[]),this.tags.push(i),this.postTagsChange.emit(this.tags)),e.chipInput.clear(),this.tagCtrl.setValue(null)}onItemSelect(e){!this.tags?.includes(e.option.viewValue)&&this.tags?.length<3&&(this.tags||(this.tags=[]),this.tags.push(e.option.viewValue),this.postTagsChange.emit(this.tags)),this.tagInput.nativeElement.value="",this.tagCtrl.setValue(null)}onItemRemove(e){this.tags=this.tags.filter(i=>i!==e),this.postTagsChange.emit(this.tags)}ngOnDestroy(){this.tagsSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-post-tag-selector"]],viewQuery:function(i,n){if(i&1&&te(Zo,5),i&2){let s;ne(s=ie())&&(n.tagInput=s.first)}},inputs:{postTags:"postTags"},outputs:{postTagsChange:"postTagsChange"},features:[I],decls:20,vars:10,consts:[["chipList",""],["tagInput",""],["auto","matAutocomplete"],["appearance","outline",1,"post-tag-list"],["aria-label","Tag selection"],[1,"post-tag-input",3,"matChipInputTokenEnd","hidden","placeholder","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes"],[3,"optionSelected"],[1,"post-tag",3,"removed"],[1,"custom-tag"],["matChipRemove",""],[1,"post-tag-remove",3,"icon"],[1,"tag-option",3,"value"]],template:function(i,n){if(i&1){let s=P();a(0,"mat-form-field",3),t(1,`
    `),a(2,"mat-chip-grid",4,0),t(4,`
        `),B(5,er,12,2,null,null,de),a(7,"input",5,1),y(9,"artemisTranslate"),h("matChipInputTokenEnd",function(v){return m(s),u(n.onItemAdd(v))}),l(),t(10,`
    `),l(),t(11,`
    `),a(12,"mat-autocomplete",6,2),h("optionSelected",function(v){return m(s),u(n.onItemSelect(v))}),t(14,`
        `),B(15,tr,4,2,null,null,de),y(17,"async"),l(),t(18,`
`),l(),t(19,`
`)}if(i&2){let s=G(3),_=G(13);r(5),N(n.tags),r(2),p("hidden",n.tags&&n.tags.length>=3)("placeholder",T(9,6,"artemisApp.metis.post.tagPlaceholder"))("formControl",n.tagCtrl)("matAutocomplete",_)("matChipInputFor",s)("matChipInputSeparatorKeyCodes",n.separatorKeysCodes),r(8),N(T(17,8,n.existingPostTags))}},dependencies:[Ti,ki,Mi,bi,z,se,Ke,re,Ai,Oi,Pe,Fn,Si,yi,yt,V],styles:[".post-tag-list[_ngcontent-%COMP%]{width:100%}.post-tag-list[_ngcontent-%COMP%]   .post-tag[_ngcontent-%COMP%]{padding:0!important;height:30px!important;border-radius:.25rem!important;background:transparent!important}.post-tag-list[_ngcontent-%COMP%]   .post-tag[_ngcontent-%COMP%]   .custom-tag[_ngcontent-%COMP%]{padding:.15rem .45rem;background:var(--metis-blue);border-radius:.25rem;color:var(--colored-btn-font)}.post-tag-list[_ngcontent-%COMP%]   .post-tag[_ngcontent-%COMP%]   .custom-tag[_ngcontent-%COMP%]:hover{opacity:.8}.post-tag-list[_ngcontent-%COMP%]   .post-tag[_ngcontent-%COMP%]   .custom-tag[_ngcontent-%COMP%]   .post-tag-remove[_ngcontent-%COMP%]{color:var(--colored-btn-font)}.post-tag-list[_ngcontent-%COMP%]   .post-tag-input[_ngcontent-%COMP%]{height:30px!important;color:var(--text-editor-color)}.tag-option[_ngcontent-%COMP%]{background:var(--metis-selection-option-background)}.tag-option[_ngcontent-%COMP%]:hover{background:var(--metis-selection-option-hover-background)}"]})}return o})();function nr(o,d){o&1&&(t(0,`
                `),g(1,"div",15),t(2,`
            `))}function ir(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"div",6),t(2,`
                    `),a(3,"div"),t(4,`
                        `),g(5,"label",16),t(6,`
                        `),g(7,"jhi-help-icon",17),t(8,`
                    `),l(),t(9,`
                    `),a(10,"div"),t(11,`
                        `),a(12,"jhi-post-tag-selector",18),Fe("postTagsChange",function(n){m(e);let s=c(2);return Ve(s.tags,n)||(s.tags=n),u(n)}),l(),t(13,`
                    `),l(),t(14,`
                `),l(),t(15,`
            `)}if(o&2){let e=c(2);r(12),De("postTags",e.tags)}}function or(o,d){if(o&1&&(t(0,`
            `),a(1,"div",19),t(2,`
                `),g(3,"button",20),y(4,"artemisTranslate"),t(5,`
            `),l(),t(6,`
        `)),o&2){let e=c(2);r(3),p("buttonLoading",e.isLoading)("disabled",e.isLoading||!e.formGroup.valid)("buttonLabel",T(4,3,"artemisApp.conversationsLayout.saveMessage"))}}function rr(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"form",1),h("ngSubmit",function(){m(e);let n=c();return u(n.confirm())}),t(2,`
        `),a(3,"div",2),t(4,`
            `),a(5,"h4",3),t(6),y(7,"artemisTranslate"),l(),t(8,`
            `),a(9,"button",4),h("click",function(){let n=m(e).dismiss;return u(n("Cross click"))}),l(),t(10,`
        `),l(),t(11,`
        `),a(12,"div",5),t(13,`
            `),t(14,`
            `),x(15,nr,3,0),a(16,"div",6),t(17,`
                `),a(18,"div"),t(19,`
                    `),g(20,"label",7),t(21,`
                    `),g(22,"jhi-help-icon",8),t(23,`
                `),l(),t(24,`
                `),a(25,"div"),t(26,`
                    `),g(27,"input",9),t(28,`
                `),l(),t(29,`
            `),l(),t(30,`
            `),t(31,`
            `),x(32,ir,16,1),a(33,"div",10),t(34,`
                `),a(35,"div"),t(36,`
                    `),g(37,"label",11),t(38,`
                    `),g(39,"jhi-help-icon",12),t(40,`
                `),l(),t(41,`
                `),a(42,"div",13),t(43,`
                    `),g(44,"jhi-posting-markdown-editor",14),t(45,`
                `),l(),t(46,`
            `),l(),t(47,`
        `),l(),t(48,`
        `),x(49,or,7,5),l(),t(50,`
`)}if(o&2){let e,i=c();r(),p("formGroup",i.formGroup),r(5),U(T(7,11,i.modalTitle)),r(9),f(i.editType===i.EditType.CREATE&&i.isCommunicationPage()&&((e=i.getAsChannel(i.posting.conversation))!=null&&e.isAnnouncementChannel)?15:-1),r(17),f(i.pageType!==i.PageType.PLAGIARISM_CASE_INSTRUCTOR&&i.pageType!==i.PageType.PLAGIARISM_CASE_STUDENT&&!i.isCommunicationPage()&&!i.posting.conversation?32:-1),r(12),p("editorHeight",i.editorHeight)("maxContentLength",i.maxContentLength)("suppressNewlineOnEnter",!1)("isButtonLoading",i.isLoading)("isFormGroupValid",i.formGroup.valid)("editType",i.editType),r(5),f(i.editType===i.EditType.UPDATE?49:-1)}}var sr=200,Yi=(()=>{class o extends Jt{isCommunicationPage=C(!1);exercises;lectures;tags;course;pageType;isAtLeastTutorInCourse;isAtLeastInstructorInCourse;currentContextSelectorOption;similarPosts=[];PageType=Dt;EditType=le;getAsChannel=ge;faAngleUp=Et;faAngleDown=St;ngOnInit(){this.resetCurrentContextSelectorOption(),super.ngOnInit(),this.course=this.metisService.getCourse(),this.lectures=this.course.lectures,this.exercises=this.course.exercises,this.isAtLeastTutorInCourse=this.metisService.metisUserIsAtLeastTutorInCourse(),this.isAtLeastInstructorInCourse=this.metisService.metisUserIsAtLeastInstructorInCourse()}ngOnChanges(){super.ngOnChanges()}open(){this.modalRef=this.modalService.open(this.postingEditor,{size:"lg",backdrop:"static",beforeDismiss:()=>(this.resetFormGroup(),!0)})}resetFormGroup(){this.pageType=this.metisService.getPageType(),this.tags=this.posting?.tags??[],this.similarPosts=[],this.posting.title=this.posting.title??"",this.resetCurrentContextSelectorOption(),this.formGroup=this.formBuilder.group(this.postValidator()),this.formGroup.controls.context.valueChanges.subscribe(e=>{this.currentContextSelectorOption=e,this.similarPosts=[]})}createPosting(){this.posting=this.setPostProperties(this.posting),this.metisService.createPost(this.posting).subscribe({next:e=>{this.isLoading=!1,this.modalRef?.close(),this.onCreate.emit(e)},error:()=>{this.isLoading=!1}})}updatePosting(){this.posting=this.setPostProperties(this.posting),this.metisService.updatePost(this.posting).subscribe({next:()=>{this.isLoading=!1,this.modalRef?.close()},error:()=>{this.isLoading=!1}})}updateModalTitle(){this.editType===this.EditType.UPDATE?this.modalTitle="artemisApp.metis.editPosting":this.editType===this.EditType.CREATE&&(this.modalTitle="artemisApp.metis."+(ge(this.posting.conversation)?.isAnnouncementChannel?"createModalTitleAnnouncement":"createModalTitlePost"))}setPostProperties(e){e.title=this.formGroup.get("title")?.value,e.tags=this.tags,e.content=this.formGroup.get("content")?.value;let i=X({},this.formGroup.get("context")?.value);return e=X(X({},e),i),i.conversation&&(e.conversation=i.conversation),e}resetCurrentContextSelectorOption(){this.currentContextSelectorOption={conversation:this.posting.conversation}}postValidator(){return{title:[this.posting.title,[Y.required,Y.maxLength(sr),ci]],content:[this.posting.content,[Y.required,Y.maxLength(this.maxContentLength),it]],context:[this.currentContextSelectorOption,[Y.required]]}}static \u0275fac=(()=>{let e;return function(n){return(e||(e=fe(o)))(n||o)}})();static \u0275cmp=k({type:o,selectors:[["jhi-post-create-edit-modal"]],inputs:{isCommunicationPage:[1,"isCommunicationPage"]},features:[J,I],decls:3,vars:0,consts:[["postingEditor",""],[3,"ngSubmit","formGroup"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"position-relative","mb-3"],["for","title","jhiTranslate","artemisApp.metis.post.title",1,"mb-1"],["text","artemisApp.metis.post.titleTooltip"],["id","title","formControlName","title","type","text","name","title",1,"form-control"],[1,"position-relative","mb-1"],["jhiTranslate","artemisApp.metis.post.content",1,"mb-1"],["text","artemisApp.metis.post.contentTooltip"],[1,"row","mb-2"],["formControlName","content",3,"editorHeight","maxContentLength","suppressNewlineOnEnter","isButtonLoading","isFormGroupValid","editType"],["jhiTranslate","artemisApp.metis.post.announcementHint",1,"alert","alert-warning"],["jhiTranslate","artemisApp.metis.post.tags"],["text","artemisApp.metis.post.tagsTooltip"],[3,"postTagsChange","postTags"],[1,"modal-footer"],["jhi-posting-button","","id","save","type","submit",1,"btn","btn-sm","btn-outline-primary",3,"buttonLoading","disabled","buttonLabel"]],template:function(i,n){i&1&&(x(0,rr,51,13,"ng-template",null,0,wt),t(2,`
`))},dependencies:[se,Je,Ke,re,Xe,Pe,Ye,Ze,j,vi,Ji,ct,lt,V],styles:[".post-result-information[_ngcontent-%COMP%]{font-size:small;font-style:italic}.post-separation-line[_ngcontent-%COMP%]{height:1px;background:var(--metis-light-gray)}.bold-line[_ngcontent-%COMP%]{height:2px;background:var(--metis-light-gray)}.icon[_ngcontent-%COMP%]{color:var(--metis-gray)}.resolved[_ngcontent-%COMP%]{color:var(--metis-green)}.post-header-author-date[_ngcontent-%COMP%]{line-height:1.1}.post-content-padding[_ngcontent-%COMP%]{padding-left:3.42rem}.post-authority-icon-student[_ngcontent-%COMP%]{display:none}.reference[_ngcontent-%COMP%]{font-weight:200;display:inline-flex}.hideAfter5Seconds[_ngcontent-%COMP%]{-webkit-animation:_ngcontent-%COMP%_cssAnimation 5s forwards;animation:_ngcontent-%COMP%_cssAnimation 5s forwards}@keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}@-webkit-keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}.card[_ngcontent-%COMP%]{border-radius:.25em}@media (max-width: 575.98px){.post-header-author-date[_ngcontent-%COMP%]{flex-direction:column;gap:0!important}.post-content-padding[_ngcontent-%COMP%]{margin-left:0}.post-header-date-separator[_ngcontent-%COMP%]{display:none}.post-header-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6c757d;font-size:.75rem!important}}.post-delete-button-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;z-index:0;background-color:#0d6efd4d;animation:_ngcontent-%COMP%_increaseWidth 6s forwards linear}@media (prefers-reduced-motion){.post-delete-button-background[_ngcontent-%COMP%]{animation:none}}.post-delete-button-label[_ngcontent-%COMP%]{position:relative;z-index:1}@keyframes _ngcontent-%COMP%_increaseWidth{0%{width:0}to{width:100%}}"]})}return o})();var Zt=(()=>{class o{posting;isCommunicationPage;showChannelReference;hasChannelModerationRights=!1;isThreadSidebar;showDropdown=!1;dropdownPosition={x:0,y:0};showReactionSelector=!1;clickPosition={x:0,y:0};isAnswerPost=!1;isDeleted=!1;timeToDeleteInSeconds=6;deleteTimerInSeconds=6;deleteTimer;deleteInterval;content;oneToOneChatService=w(_i);metisConversationService=w(Ft);metisService=w(D);changeDetector=w(H);router=w(En);farBookmark=Ei;faBookmark=ve;ngOnInit(){this.content=this.posting.content}ngOnDestroy(){this.deleteTimer!==void 0&&(clearTimeout(this.deleteTimer),this.deletePostingWithoutTimeout()),this.deleteInterval!==void 0&&clearInterval(this.deleteInterval)}onDeleteEvent(e){this.isDeleted=e,this.deleteTimer!==void 0&&clearTimeout(this.deleteTimer),this.deleteInterval!==void 0&&clearInterval(this.deleteInterval),e&&(this.deleteTimerInSeconds=this.timeToDeleteInSeconds,this.deleteTimer=setTimeout(()=>{this.deletePostingWithoutTimeout()},this.deleteTimerInSeconds*1e3+1e3),this.deleteInterval=setInterval(()=>{this.deleteTimerInSeconds=Math.max(0,this.deleteTimerInSeconds-1),this.changeDetector.detectChanges()},1e3))}editPosting(){this.reactionsBar.editPosting(),this.showDropdown=!1}togglePin(){this.reactionsBar.togglePin(),this.showDropdown=!1,this.changeDetector.detectChanges()}deletePost(){this.reactionsBar.deletePosting(),this.showDropdown=!1}forwardMessage(){this.reactionsBar.forwardMessage()}checkIfPinned(){return this.reactionsBar.checkIfPinned()}selectReaction(e){this.reactionsBar.selectReaction(e),this.showReactionSelector=!1}addReaction(e){e.preventDefault(),this.showDropdown=!1,this.clickPosition={x:e.clientX,y:e.clientY},this.showReactionSelector=!0}toggleEmojiSelect(){this.showReactionSelector=!this.showReactionSelector}toggleSavePost(){this.posting.isSaved?(this.metisService.removeSavedPost(this.posting),this.posting.isSaved=!1):(this.metisService.savePost(this.posting),this.posting.isSaved=!0)}deletePostingWithoutTimeout(){this.isAnswerPost?this.metisService.deleteAnswerPost(this.posting):this.metisService.deletePost(this.posting)}onUserReferenceClicked(e){let i=this.metisService.course;cn(i)&&(this.isCommunicationPage?this.metisConversationService.createOneToOneChat(e).subscribe():this.oneToOneChatService.create(i.id,e).subscribe(n=>{this.router.navigate(["courses",i.id,"communication"],{queryParams:{conversationId:n.body.id}})}))}onUserNameClicked(){if(!this.posting.author?.id)return;let e=this.posting.author?.id,i=this.metisService.course;cn(i)&&(this.isCommunicationPage?this.metisConversationService.createOneToOneChatWithId(e).subscribe():this.oneToOneChatService.createWithId(i.id,e).subscribe(n=>{this.router.navigate(["courses",i.id,"communication"],{queryParams:{conversationId:n.body.id}})}))}static \u0275fac=function(i){return new(i||o)};static \u0275dir=He({type:o,inputs:{posting:"posting",isCommunicationPage:"isCommunicationPage",showChannelReference:"showChannelReference",hasChannelModerationRights:"hasChannelModerationRights",isThreadSidebar:"isThreadSidebar"}})}return o})();function ar(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"form",1),h("ngSubmit",function(){m(e);let n=c();return u(n.confirm())}),t(2,`
        `),a(3,"div"),t(4,`
            `),a(5,"jhi-posting-markdown-editor",2),h("keydown.enter",function(){m(e);let n=c();return u(n.confirm())}),l(),t(6,`
            `),a(7,"div",3),t(8,`
                `),a(9,"button",4),y(10,"artemisTranslate"),h("click",function(){m(e);let n=c();return u(n.close())}),l(),t(11,`
                `),g(12,"button",5),y(13,"artemisTranslate"),t(14,`
            `),l(),t(15,`
        `),l(),t(16,`
    `),l(),t(17,`
`)}if(o&2){let e=c();r(),p("formGroup",e.formGroup),r(4),p("editorHeight",e.editorHeight)("maxContentLength",e.maxContentLength)("isInputLengthDisplayed",!1)("isButtonLoading",e.isLoading)("isFormGroupValid",e.formGroup.valid)("editType",e.editType),r(4),p("buttonLabel",T(10,11,"artemisApp.metis.cancel")),r(3),p("buttonLoading",e.isLoading)("disabled",e.isLoading||!e.formGroup.valid)("buttonLabel",T(13,13,"artemisApp.metis.savePosting"))}}var gt=(()=>{class o extends Jt{createEditAnswerPostContainerRef=C();postingUpdated=b();isInputOpen=!1;open(){this.close(),this.createEditAnswerPostContainerRef()?.createEmbeddedView(this.postingEditor),this.isInputOpen=!0}close(){this.createEditAnswerPostContainerRef()?.clear(),this.resetFormGroup(),this.isInputOpen=!1}resetFormGroup(){this.posting=this.posting||{content:""},this.formGroup=this.formBuilder.group({content:[this.posting.content,[Y.required,Y.maxLength(this.maxContentLength),it]]})}createPosting(){this.posting.content=this.formGroup.get("content")?.value,this.metisService.createAnswerPost(this.posting).subscribe({next:e=>{this.resetFormGroup(),this.isLoading=!1,this.onCreate.emit(e),this.createEditAnswerPostContainerRef()?.clear()},error:()=>{this.isLoading=!1}})}updatePosting(){this.posting.content=this.formGroup.get("content")?.value,this.metisService.updateAnswerPost(this.posting).subscribe({next:e=>{this.postingUpdated.emit(e),this.isLoading=!1,this.isInputOpen=!1,this.createEditAnswerPostContainerRef()?.clear()},error:()=>{this.isLoading=!1}})}updateModalTitle(){this.editType===this.EditType.UPDATE?this.modalTitle="artemisApp.metis.editPosting":this.editType===this.EditType.CREATE&&(this.modalTitle="artemisApp.metis.createModalTitleAnswer")}static \u0275fac=(()=>{let e;return function(n){return(e||(e=fe(o)))(n||o)}})();static \u0275cmp=k({type:o,selectors:[["jhi-answer-post-create-edit-modal"]],inputs:{createEditAnswerPostContainerRef:[1,"createEditAnswerPostContainerRef"]},outputs:{postingUpdated:"postingUpdated"},features:[J],decls:3,vars:0,consts:[["postingEditor",""],[3,"ngSubmit","formGroup"],["formControlName","content",3,"keydown.enter","editorHeight","maxContentLength","isInputLengthDisplayed","isButtonLoading","isFormGroupValid","editType"],[1,"col","mt-1","text-end"],["jhi-posting-button","",1,"btn","btn-sm","btn-outline-secondary",3,"click","buttonLabel"],["jhi-posting-button","","id","save","type","submit",1,"btn","btn-sm","btn-outline-primary",3,"buttonLoading","disabled","buttonLabel"]],template:function(i,n){i&1&&(x(0,ar,18,15,"ng-template",null,0,wt),t(2,`
`))},dependencies:[se,Je,re,Xe,Pe,Ye,Ze,ct,lt,V],styles:[`.markdown-editor-wrapper{background-color:transparent!important}.markdown-editor-wrapper .markdown-editor{border:1px solid var(--border-color);background-color:transparent!important}
`],encapsulation:2})}return o})();function lr(o,d){if(o&1&&(t(0,`
    `),g(1,"ngx-emoji",0),t(2,`
`)),o&2){let e=c();r(),p("backgroundImageFn",e.utils.EMOJI_SHEET_URL)("emoji",e.emoji())("size",16)}}function cr(o,d){if(o&1&&(t(0,`
    `),g(1,"ngx-emoji",1),t(2,`
`)),o&2){let e=c();r(),p("imageUrlFn",e.utils.singleDarkModeEmojiUrlFn)("backgroundImageFn",e.utils.EMOJI_SHEET_URL)("emoji",e.emoji())("size",16)}}var en=(()=>{class o{themeService=w(Ci);utils=Fi;emoji=C("");dark=je(()=>this.themeService.currentTheme()===fi.DARK);static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-emoji"]],inputs:{emoji:[1,"emoji"]},decls:3,vars:1,consts:[[1,"emoji",3,"backgroundImageFn","emoji","size"],[1,"emoji",3,"imageUrlFn","backgroundImageFn","emoji","size"]],template:function(i,n){i&1&&(t(0,`
`),x(1,lr,3,3)(2,cr,3,4)),i&2&&(r(),f(n.dark()?2:1))},dependencies:[Li,ji],styles:["[_nghost-%COMP%]{height:16px;display:inline}"]})}return o})();var dr=o=>({clickable:o});function pr(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"span",5),t(2,`
                `),g(3,"jhi-profile-picture",6),t(4,`
                `),a(5,"span",7),t(6,`
                    `),a(7,"span",8),h("click",function(){m(e);let n=c();return u(n.userNameClicked())}),t(8),l(),t(9,`
                    `),a(10,"span",9),t(11,`
                        `),a(12,"span",10),t(13,`
                            `),g(14,"fa-icon",11),t(15,`
                        `),l(),t(16,`
                        `),g(17,"span",12),y(18,"artemisTranslate"),t(19,`
                    `),l(),t(20,`
                `),l(),t(21,`
            `),l(),t(22,`
        `)}if(o&2){let e,i=c();r(3),p("isGray",i.isDeleted())("authorId",i.authorOfPosting.id)("authorName",i.authorOfPosting.name)("imageUrl",i.authorOfPosting.imageUrl)("isEditable",i.currentUser!==void 0&&i.authorOfPosting.id===i.currentUser.id),r(4),p("ngClass",E(13,dr,!i.isAuthorOfPosting&&((e=i.posting())==null?null:e.authorRole))),r(),U(i.authorOfPosting.name),r(4),p("ngClass","post-authority-icon-"+i.userAuthority),r(2),p("icon",i.userAuthorityIcon),r(3),$("ngbTooltip",T(18,11,i.userAuthorityTooltip)),p("jhiTranslate",i.userRoleBadge)}}function mr(o,d){if(o&1&&(t(0,`
                `),g(1,"span",13),t(2,`,
            `)),o&2){let e,i=c();r(),p("jhiTranslate",(e=i.todayFlag)!==null&&e!==void 0?e:"")}}function ur(o,d){if(o&1&&(t(0,`
            `),g(1,"fa-icon",14),y(2,"artemisTranslate"),t(3,`
        `)),o&2){let e=c();r(),p("icon",e.faCheckSquare)("ngbTooltip",T(2,2,"artemisApp.metis.post.postMarkedAsResolvedTooltip"))}}function gr(o,d){o&1&&(t(0,`
            `),g(1,"jhi-emoji",15),t(2,`
        `))}function _r(o,d){o&1&&(t(0,`
            `),g(1,"span",16),t(2,`
        `))}var tn=(()=>{class o{lastReadDate=C();posting=C();readOnlyMode=C(!1);previewMode=C(!1);hasChannelModerationRights=C(!1);isCommunicationPage=C();isDeleted=C(!1);isModalOpen=b();onUserNameClicked=b();isAtLeastInstructorInCourse;isAtLeastTutorInCourse;isAuthorOfPosting;postingIsOfToday;todayFlag;userAuthorityIcon;userAuthority;userRoleBadge;userAuthorityTooltip;currentUser;faPencilAlt=we;faCheckSquare=qn;metisService=w(D);accountService=w(tt);isPostResolved=je(()=>{let e=this.posting();return this.isPost(e)&&e.resolved===!0});isPostPinned=je(()=>{let e=this.posting();return this.isPost(e)&&e.displayPriority==Z.PINNED});ngOnInit(){this.accountService.getAuthenticationState().pipe(vn(e=>{this.currentUser=e,this.setUserProperties()})).subscribe(),this.postingIsOfToday=qe().isSame(this.posting()?.creationDate,"day"),this.todayFlag=this.getTodayFlag()}isPost(e){return e!==void 0&&"resolved"in e}ngOnChanges(){this.setUserProperties(),this.setUserAuthorityIconAndTooltip()}get isAfter(){return this.posting()?.creationDate?.isAfter(this.lastReadDate())}get authorOfPosting(){return this.posting()?.author}get creationDate(){return this.posting()?.creationDate}getTodayFlag(){if(this.postingIsOfToday)return"artemisApp.metis.today"}setUserProperties(){this.isAuthorOfPosting=this.metisService.metisUserIsAuthorOfPosting(this.posting()),this.setUserAuthorityIconAndTooltip()}setUserAuthorityIconAndTooltip(){let e="artemisApp.metis.userAuthorityTooltips.",i="artemisApp.metis.userRoles.";this.userAuthorityIcon=Qn,this.posting()?.authorRole===Vt.USER?(this.userAuthority="student",this.userRoleBadge=i+this.userAuthority,this.userAuthorityTooltip=e+this.userAuthority):this.posting()?.authorRole===Vt.INSTRUCTOR?(this.userAuthorityIcon=ni,this.userAuthority="instructor",this.userRoleBadge=i+this.userAuthority,this.userAuthorityTooltip=e+this.userAuthority):this.posting()?.authorRole===Vt.TUTOR?(this.userAuthorityIcon=Wn,this.userAuthority="tutor",this.userRoleBadge=i+this.userAuthority,this.userAuthorityTooltip=e+this.userAuthority):(this.userAuthority="student",this.userRoleBadge="artemisApp.metis.userRoles.deleted",this.userAuthorityTooltip="artemisApp.metis.userAuthorityTooltips.deleted")}userNameClicked(){this.isAuthorOfPosting||!this.posting()?.authorRole||this.onUserNameClicked.emit()}CachingStrategy=xi;static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-posting-header"]],inputs:{lastReadDate:[1,"lastReadDate"],posting:[1,"posting"],readOnlyMode:[1,"readOnlyMode"],previewMode:[1,"previewMode"],hasChannelModerationRights:[1,"hasChannelModerationRights"],isCommunicationPage:[1,"isCommunicationPage"],isDeleted:[1,"isDeleted"]},outputs:{isModalOpen:"isModalOpen",onUserNameClicked:"onUserNameClicked"},features:[I],decls:24,vars:20,consts:[[1,"d-flex","justify-content-between",2,"padding-top","0.25rem"],["id","header-author-date",1,"post-header-author-date","d-flex","align-items-start","gap-2","flex-wrap"],[1,"post-header-date-separator"],[1,"post-header-date"],[1,"post-header-date","fs-small",3,"disableTooltip","ngbTooltip"],[1,"d-inline-flex","align-items-start","gap-2","flex-wrap"],["imageSizeInRem","2.15","fontSizeInRem","0.9","imageId","post-profile-picture","defaultPictureId","post-default-profile-picture",3,"isGray","authorId","authorName","imageUrl","isEditable"],[1,"fs-small","d-inline-flex","flex-column","align-items-start"],[1,"fw-semibold",3,"click","ngClass"],[1,"fs-x-small","mt-1","text-body-secondary"],["id","role-badge",1,"me-1","fs-x-small",3,"ngClass"],[3,"icon"],[3,"ngbTooltip","jhiTranslate"],["id","today-flag",1,"fs-small",3,"jhiTranslate"],["iconSize","xs",1,"col-auto","pe-0","resolved","px-1",3,"icon","ngbTooltip"],["emoji","pushpin",1,"fs-x-small"],["jhiTranslate","global.generic.new",1,"badge","bg-secondary","hideAfter5Seconds"]],template:function(i,n){i&1&&(a(0,"div",0),t(1,`
    `),a(2,"div",1),t(3,`
        `),x(4,pr,23,15),a(5,"span",2),t(6,"-"),l(),t(7,`
        `),a(8,"span",3),t(9,`
            `),x(10,mr,3,1),a(11,"span",4),y(12,"artemisDate"),t(13),y(14,"artemisDate"),y(15,"artemisDate"),y(16,"artemisDate"),l(),t(17,`
        `),l(),t(18,`
        `),x(19,ur,4,4)(20,gr,3,0)(21,_r,3,0),l(),t(22,`
`),l(),t(23,`
`)),i&2&&(r(4),f(n.authorOfPosting?4:-1),r(6),f(n.postingIsOfToday?10:-1),r(),$("ngbTooltip",F(12,8,n.creationDate,"time")),p("disableTooltip",n.postingIsOfToday),r(2),O(`
                `,n.postingIsOfToday?F(14,11,n.creationDate,"time"):F(15,14,n.creationDate,"short-date")+" - "+F(16,17,n.creationDate,"time"),`
            `),r(6),f(n.isPostResolved()?19:-1),r(),f(n.isPostPinned()?20:-1),r(),f(n.isCommunicationPage()&&!n.lastReadDate()||n.lastReadDate()&&n.creationDate&&n.isAfter&&!n.isAuthorOfPosting?21:-1))},dependencies:[st,W,z,ae,j,Te,V,en],styles:[".post-result-information[_ngcontent-%COMP%]{font-size:small;font-style:italic}.post-separation-line[_ngcontent-%COMP%]{height:1px;background:var(--metis-light-gray)}.bold-line[_ngcontent-%COMP%]{height:2px;background:var(--metis-light-gray)}.icon[_ngcontent-%COMP%]{color:var(--metis-gray)}.resolved[_ngcontent-%COMP%]{color:var(--metis-green)}.post-header-author-date[_ngcontent-%COMP%]{line-height:1.1}.post-content-padding[_ngcontent-%COMP%]{padding-left:3.42rem}.post-authority-icon-student[_ngcontent-%COMP%]{display:none}.reference[_ngcontent-%COMP%]{font-weight:200;display:inline-flex}.hideAfter5Seconds[_ngcontent-%COMP%]{-webkit-animation:_ngcontent-%COMP%_cssAnimation 5s forwards;animation:_ngcontent-%COMP%_cssAnimation 5s forwards}@keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}@-webkit-keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}.card[_ngcontent-%COMP%]{border-radius:.25em}@media (max-width: 575.98px){.post-header-author-date[_ngcontent-%COMP%]{flex-direction:column;gap:0!important}.post-content-padding[_ngcontent-%COMP%]{margin-left:0}.post-header-date-separator[_ngcontent-%COMP%]{display:none}.post-header-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6c757d;font-size:.75rem!important}}.post-delete-button-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;z-index:0;background-color:#0d6efd4d;animation:_ngcontent-%COMP%_increaseWidth 6s forwards linear}@media (prefers-reduced-motion){.post-delete-button-background[_ngcontent-%COMP%]{animation:none}}.post-delete-button-label[_ngcontent-%COMP%]{position:relative;z-index:1}@keyframes _ngcontent-%COMP%_increaseWidth{0%{width:0}to{width:100%}}"]})}return o})();var nn=class{id;user;creationDate;emojiId;post;answerPost};var un=10,on="REPLACE_WITH_TRANSLATED_YOU",Zi=(()=>{class o{translateService=w(Bn);transform(e){return new hn(i=>{i.next(this.updateReactingUsersString(e)),this.translateService.onLangChange.subscribe(()=>{i.next(this.updateReactingUsersString(e))})})}updateReactingUsersString(e){if(e.includes(on)){if(e.length===1)return this.translateService.instant("artemisApp.metis.you");e=e.filter(n=>n!==on),e=[this.translateService.instant("artemisApp.metis.you")].concat(e)}let i=e.length;if(i>un)return e=e.slice(0,un),e.join(", ")+this.translateService.instant("artemisApp.metis.reactedTooltipTrimmed",{number:i-un});{let n=e.join(", ")+this.translateService.instant("artemisApp.metis.reactedTooltip"),s=n.lastIndexOf(",");if(s>-1){let _=n.substring(0,s),v=n.substring(s+2,n.length);n=_+this.translateService.instant("artemisApp.metis.and")+v}return n}}static \u0275fac=function(i){return new(i||o)};static \u0275pipe=ft({name:"reactingUsersOnPosting",type:o,pure:!0})}return o})();var hr=["searchInput"],fr=["messageContent"],Cr=()=>[],xr=(o,d)=>({"channel-option":o,"chat-option":d}),Pr=o=>({expanded:o});function wr(o,d){if(o&1){let e=P();t(0,`
                `),pe(1),t(2,`
                    `),a(3,"span",13),t(4),a(5,"button",14),h("click",function(){let n=m(e).$implicit,s=c();return u(s.removeSelectedChannel(n))}),l(),t(6,`
                    `),l(),t(7,`
                `),me(),t(8,`
            `)}if(o&2){let e=d.$implicit;r(4),O(`
                        `,e.name,`
                        `)}}function vr(o,d){if(o&1){let e=P();t(0,`
                `),pe(1),t(2,`
                    `),a(3,"span",15),t(4),a(5,"button",14),h("click",function(){let n=m(e).$implicit,s=c();return u(s.removeSelectedUser(n))}),l(),t(6,`
                    `),l(),t(7,`
                `),me(),t(8,`
            `)}if(o&2){let e=d.$implicit;r(4),O(`
                        `,e.name,`
                        `)}}function yr(o,d){o&1&&(t(0,`
                            `),a(1,"span",18),t(2,"#"),l(),t(3,`
                        `))}function Tr(o,d){if(o&1&&(t(0,`
                            `),g(1,"jhi-profile-picture",19),t(2,`
                        `)),o&2){let e,i,n=c().$implicit,s=c(2);r(),p("authorId",(e=s.postToForward())==null||e.author==null?null:e.author.id)("authorName",(i=s.postToForward())==null||i.author==null?null:i.author.name)("imageUrl",n.img)}}function br(o,d){if(o&1){let e=P();t(0,`
                    `),a(1,"li",17),h("mousedown",function(){let n=m(e).$implicit,s=c(2);return u(s.selectOption(n))}),t(2,`
                        `),x(3,yr,4,0)(4,Tr,3,3),t(5),l(),t(6,`
                `)}if(o&2){let e=d.$implicit;r(),p("ngClass",ue(3,xr,e.type==="channel",e.type==="chat")),r(2),f(e.type==="channel"?3:4),r(2),O(`
                        `,e.name,`
                    `)}}function Mr(o,d){if(o&1&&(t(0,`
            `),a(1,"ul",16),t(2,`
                `),B(3,br,7,6,null,null,de),l(),t(5,`
        `)),o&2){let e=c();r(3),N(e.filteredOptions)}}function kr(o,d){if(o&1){let e=P();t(0,`
                    `),a(1,"button",27),h("click",function(){m(e);let n=c(2);return u(n.toggleShowFullForwardedMessage())}),t(2),y(3,"artemisTranslate"),y(4,"artemisTranslate"),l(),t(5,`
                `)}if(o&2){let e=c(2);r(2),O(`
                        `,e.showFullForwardedMessage?T(3,1,"artemisApp.metis.forward.showLess"):T(4,3,"artemisApp.metis.forward.showMore"),`
                    `)}}function Or(o,d){if(o&1&&(t(0,`
        `),a(1,"div",20),t(2,`
            `),g(3,"div",21),t(4,`
            `),a(5,"div",22),t(6,`
                `),a(7,"div",23),t(8,`
                    `),g(9,"jhi-profile-picture",19),t(10,`
                    `),a(11,"span",24),t(12),l(),t(13,`
                `),l(),t(14,`
                `),a(15,"div",25,1),t(17,`
                    `),g(18,"jhi-posting-content",26),t(19,`
                `),l(),t(20,`
                `),x(21,kr,6,5),l(),t(22,`
        `),l(),t(23,`
    `)),o&2){let e,i,n,s,_,v,S,M=c();r(9),p("authorId",(e=M.postToForward())==null||e.author==null?null:e.author.id)("authorName",(i=M.postToForward())==null||i.author==null?null:i.author.name)("imageUrl",(n=M.postToForward())==null||n.author==null?null:n.author.imageUrl),r(3),U((s=M.postToForward())==null||s.author==null?null:s.author.name),r(3),p("ngClass",E(13,Pr,M.showFullForwardedMessage)),r(3),p("previewMode",!1)("content",(_=M.postToForward())==null?null:_.content)("author",(v=M.postToForward())==null?null:v.author)("isEdited",!!((S=M.postToForward())!=null&&S.updatedDate))("posting",M.postToForward())("isReply",!1)("isSubscribeToMetis",!1),r(3),f(M.isContentLong?21:-1)}}var eo=(()=>{class o{channels=q([]);users=q([]);postToForward=q(void 0);courseId=q(void 0);editorHeight=C(ke.INLINE);filteredChannels=[];filteredUsers=[];selectedChannels=[];selectedUsers=[];combinedOptions=[];filteredOptions=[];defaultActions;searchTerm="";newPost=new pt;isInputFocused=!1;showDropdown=!1;showFullForwardedMessage=!1;isContentLong=!1;activeModal=w(Ln);searchInput=Q("searchInput");messageContent=Q("messageContent");courseManagementService=w(Rt);cdr=w(H);renderer=w(Ue);ngOnInit(){this.filteredChannels=this.channels()||[],this.defaultActions=[new Lt,new Bt,new Nt,new Ut,new Ht,new zt,new Gt],this.filteredUsers=this.users(),this.combinedOptions=[...this.channels().filter(e=>e.name!==void 0).map(e=>({id:e.id,name:e.name,type:"channel",img:""})),...this.users().map(e=>({id:e.id,name:e.name,type:"user",img:e.imageUrl}))],this.filterOptions(),this.focusInput()}ngAfterViewInit(){setTimeout(()=>{this.checkIfContentOverflows()},0)}checkIfContentOverflows(){if(this.messageContent){let e=this.messageContent().nativeElement;this.isContentLong=e.scrollHeight>e.clientHeight,this.cdr.detectChanges()}}toggleShowFullForwardedMessage(){this.showFullForwardedMessage=!this.showFullForwardedMessage}updateField(e){this.newPost.content=e}filterItems(e){this.searchTerm=e.target.value,this.filterOptions()}filterOptions(){if(this.searchTerm){let e=this.searchTerm.toLowerCase();e.length>=3?this.courseManagementService.searchUsers(this.courseId(),e,["students","tutors","instructors"]).pipe(Ae(i=>i.body||[]),Ae(i=>i.filter(n=>!this.selectedUsers.find(s=>s.id===n.id))),xn(()=>fn([]))).subscribe(i=>{this.filteredUsers=i,this.updateCombinedOptions(),this.cdr.detectChanges()}):this.filteredUsers=[],this.filteredChannels=this.channels().filter(i=>i.name?.toLowerCase().includes(e)),this.updateCombinedOptions()}else this.filteredUsers=[...this.users()],this.filteredChannels=[...this.channels()],this.updateCombinedOptions()}updateCombinedOptions(){this.filteredOptions=[...this.filteredChannels.map(e=>({id:e.id,name:e.name,type:"channel",img:""})),...this.filteredUsers.map(e=>({id:e.id,name:e.name,type:"user",img:e.imageUrl}))]}selectOption(e){if(e.type==="channel"){if(!this.selectedChannels.find(n=>n.id===e.id)){let n=this.channels()?.find(s=>s.id===e.id);n&&this.selectedChannels.push(n)}}else if(e.type==="user"&&!this.selectedUsers.find(n=>n.id===e.id)){let n=this.filteredUsers.find(s=>s.id===e.id);n&&this.selectedUsers.push(n)}this.searchTerm="",this.filterOptions(),this.showDropdown=!1,this.focusInput()}removeSelectedChannel(e){let i=this.selectedChannels.findIndex(n=>n.id===e.id);i>-1&&this.selectedChannels.splice(i,1),this.focusInput()}removeSelectedUser(e){let i=this.selectedUsers.findIndex(n=>n.id===e.id);i>-1&&this.selectedUsers.splice(i,1),this.focusInput()}send(){let e={channels:this.selectedChannels,users:this.selectedUsers,messageContent:this.newPost.content};this.activeModal.close(e)}hasSelections(){return this.selectedChannels.length>0||this.selectedUsers.length>0}onInputFocus(){this.isInputFocused=!0,this.showDropdown=!0}onInputBlur(){this.isInputFocused=!1,this.showDropdown=!1}focusInput(){this.searchInput&&this.renderer.selectRootElement(this.searchInput().nativeElement,!0).focus()}onClickOutside(e){this.searchInput&&!this.searchInput().nativeElement.contains(e.target)&&(this.showDropdown=!1)}MarkdownEditorHeight=ke;static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-forward-message-dialog"]],viewQuery:function(i,n){i&1&&(K(n.searchInput,hr,5),K(n.messageContent,fr,5)),i&2&&oe(2)},hostBindings:function(i,n){i&1&&h("click",function(_){return n.onClickOutside(_)},!1,Ne)},inputs:{editorHeight:[1,"editorHeight"]},features:[Pt([D,$t,Kt])],decls:35,vars:19,consts:[["searchInput",""],["messageContent",""],[1,"modal-header"],["jhiTranslate","artemisApp.metis.forward.forwardMessage",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"autocomplete-container","mt-1","mb-2","form-group"],[1,"tag-input-container","form-control",3,"click"],["type","text",1,"tag-input",3,"ngModelChange","input","focus","blur","placeholder","ngModel"],["jhiTranslate","artemisApp.metis.forward.addMessage"],[1,"markdown-editor","background-editor-color","w-100",3,"markdownChange","markdown","enableResize","enableFileUpload","showDefaultPreview","colorAction","headerActions","metaActions","defaultActions","initialEditorHeight","resizableMinHeight","resizableMaxHeight"],[1,"modal-footer"],["type","button","jhiTranslate","artemisApp.conversationsLayout.sendMessage",1,"btn","btn-primary",3,"click","disabled"],[1,"badge","bg-primary","me-1"],["type","button","aria-label","Remove",1,"btn-close","btn-close-white","btn-sm","ms-1",3,"click"],[1,"badge","bg-secondary","me-1"],["tabindex","0",1,"list-group","autocomplete-dropdown"],[1,"list-group-item","list-group-item-action",3,"mousedown","ngClass"],[1,"me-2"],["imageSizeInRem","1.5","fontSizeInRem","0.6","imageId","user-profile-picture","defaultPictureId","user-default-profile-picture",2,"margin-right","0.2rem",3,"authorId","authorName","imageUrl"],[1,"forwarded-message-container"],[1,"left-border-line"],[1,"forwarded-message-content"],[1,"forwarded-message-header"],[1,"forwarded-message-author"],["id","messageContent",1,"forwarded-message-body",3,"ngClass"],[3,"previewMode","content","author","isEdited","posting","isReply","isSubscribeToMetis"],["type","button",1,"btn","btn-link","p-0",2,"width","fit-content",3,"click"]],template:function(i,n){if(i&1){let s=P();a(0,"div",2),t(1,`
    `),g(2,"h4",3),t(3,`
    `),a(4,"button",4),h("click",function(){return m(s),u(n.activeModal.dismiss())}),l(),t(5,`
`),l(),t(6,`
`),a(7,"div",5),t(8,`
    `),a(9,"div",6),t(10,`
        `),a(11,"div",7),h("click",function(){return m(s),u(n.focusInput())}),t(12,`
            `),B(13,wr,9,1,null,null,de),B(15,vr,9,1,null,null,de),a(17,"input",8,0),y(19,"artemisTranslate"),Fe("ngModelChange",function(v){return m(s),Ve(n.searchTerm,v)||(n.searchTerm=v),u(v)}),h("input",function(v){return m(s),u(n.filterItems(v))})("focus",function(){return m(s),u(n.onInputFocus())})("blur",function(){return m(s),u(n.onInputBlur())}),l(),t(20,`
        `),l(),t(21,`
        `),x(22,Mr,6,0),l(),t(23,`

    `),g(24,"h5",9),t(25,`
    `),a(26,"jhi-markdown-editor-monaco",10),h("markdownChange",function(v){return m(s),u(n.updateField(v))}),l(),t(27,`

    `),x(28,Or,24,15),l(),t(29,`
`),a(30,"div",11),t(31,`
    `),a(32,"button",12),h("click",function(){return m(s),u(n.send())}),l(),t(33,`
`),l(),t(34,`
`)}i&2&&(r(13),N(n.selectedChannels),r(2),N(n.selectedUsers),r(2),$("placeholder",T(19,16,"artemisApp.metis.forward.searchBar")),De("ngModel",n.searchTerm),r(5),f(n.showDropdown&&n.filteredOptions.length>0?22:-1),r(4),p("markdown",n.newPost.content)("enableResize",!1)("enableFileUpload",!1)("showDefaultPreview",!0)("colorAction",void 0)("headerActions",void 0)("metaActions",We(18,Cr))("defaultActions",n.defaultActions)("initialEditorHeight",n.editorHeight())("resizableMinHeight",n.editorHeight())("resizableMaxHeight",n.MarkdownEditorHeight.MEDIUM),r(2),f(n.postToForward()?28:-1),r(4),p("disabled",!n.hasSelections()))},dependencies:[V,st,W,ce,ut,se,Ke,re,Vn,j],styles:[".tag-input-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap;border-radius:.25rem;padding:.375rem .75rem;min-height:2rem;cursor:text;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.tag-input-container[_ngcontent-%COMP%]:focus-within{box-shadow:0 0 0 .2rem #0d6efd40}.tag-input[_ngcontent-%COMP%]{flex:1;background:transparent;border:none;outline:none;min-width:4rem;color:var(--form-control-color)}.badge[_ngcontent-%COMP%]{display:flex;align-items:center;height:1.5rem;margin-bottom:.2rem}.badge[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{padding:0 .2rem;margin-left:.5rem;cursor:pointer}.list-group-item.active[_ngcontent-%COMP%]{background-color:var(--bs-primary);border-color:var(--bs-primary)}.list-group-item[_ngcontent-%COMP%]{cursor:pointer;font-weight:500}.autocomplete-container[_ngcontent-%COMP%]{position:relative}.autocomplete-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;z-index:1000;max-height:200px;overflow-y:auto}.left-border-line[_ngcontent-%COMP%]{background-color:var(--metis-gray);width:.3rem;border-radius:3px;margin-right:.5rem}.forwarded-message-container[_ngcontent-%COMP%]{display:flex;padding-top:.3rem;padding-bottom:.3rem;border-radius:5px;margin-top:1rem}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-header[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:.5rem}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-author[_ngcontent-%COMP%]{font-weight:700}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-body[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:.5rem;max-height:120px;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;transition:all .3s ease}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-body.expanded[_ngcontent-%COMP%]{max-height:none;-webkit-line-clamp:none}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;font-size:.8rem}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-footer[_ngcontent-%COMP%]   .forwarded-message-channel[_ngcontent-%COMP%]{margin-right:1rem}"]})}return o})();var Sr=["createEditModal"],ro=o=>({number:o});function Ar(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"div"),t(2,`
                `),a(3,"button",5),h("click",function(){m(e);let n=c(2);return u(n.isCommunicationPage()?n.openThread.emit():n.openAnswerView())}),t(4,`
                    `),g(5,"fa-icon",6),t(6,`
                    `),g(7,"span",7),t(8,`
                `),l(),t(9,`
            `),l(),t(10,`
        `)}if(o&2){let e=c(2);r(5),p("icon",e.faArrowRight)}}function Er(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"div"),t(2,`
                    `),a(3,"button",8),h("click",function(){m(e);let n=c(3);return u(n.closeAnswerView())}),t(4,`
                        `),g(5,"jhi-emoji",9),t(6,`
                        `),g(7,"span",10),t(8,`
                    `),l(),t(9,`
                `),l(),t(10,`
            `)}if(o&2){let e=c(3);r(3),ee("reaction-button--reacted",e.showAnswers()),r(2),p("emoji",e.closeCrossId)}}function Ir(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"div"),t(2,`
                    `),a(3,"button",11),h("click",function(){m(e);let n=c(3);return u(n.openAnswerView())}),t(4,`
                        `),g(5,"fa-icon",6),t(6,`
                        `),a(7,"span",12),t(8),y(9,"artemisTranslate"),y(10,"artemisTranslate"),l(),t(11,`
                    `),l(),t(12,`
                `),l(),t(13,`
            `)}if(o&2){let e,i=c(3);r(5),p("icon",i.faArrowRight),r(3),U(((e=i.sortedAnswerPosts())==null?null:e.length)===1?T(9,2,"artemisApp.metis.showSingleAnswer"):F(10,4,"artemisApp.metis.showMultipleAnswers",E(7,ro,(e=i.sortedAnswerPosts())==null?null:e.length)))}}function Rr(o,d){if(o&1&&(t(0,`
            `),x(1,Er,11,3)(2,Ir,14,9)),o&2){let e=c(2);r(),f(e.showAnswers()?1:2)}}function Dr(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"div"),t(2,`
                `),a(3,"button",11),h("click",function(){m(e);let n=c(2);return u(n.openThread.emit())}),t(4,`
                    `),g(5,"fa-icon",13),t(6,`
                    `),a(7,"span",14),t(8),y(9,"artemisTranslate"),y(10,"artemisTranslate"),l(),t(11,`
                `),l(),t(12,`
            `),l(),t(13,`
        `)}if(o&2){let e,i=c(2);r(5),p("icon",i.faArrowRight),r(3),U(((e=i.sortedAnswerPosts())==null?null:e.length)===1?T(9,2,"artemisApp.metis.showSingleAnswer"):F(10,4,"artemisApp.metis.showMultipleAnswers",E(7,ro,(e=i.sortedAnswerPosts())==null?null:e.length)))}}function Vr(o,d){if(o&1&&(t(0,`
        `),x(1,Ar,11,1)(2,Rr,3,1)(3,Dr,14,9)),o&2){let e,i,n=c();r(),f(n.hoverBar()&&((e=n.sortedAnswerPosts())==null?null:e.length)===0?1:-1),r(),f(!n.isCommunicationPage()&&((i=n.sortedAnswerPosts())!=null&&i.length)?2:!n.isThreadSidebar()&&!n.showAnswers()&&((i=n.sortedAnswerPosts())!=null&&i.length)?3:-1)}}function Fr(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"div"),t(2,`
                `),a(3,"button",15),y(4,"reactingUsersOnPosting"),y(5,"async"),h("click",function(){m(e);let n=c().$implicit,s=c();return u(s.updateReaction(n.key))}),t(6,`
                    `),a(7,"div",16),t(8,`
                        `),g(9,"jhi-emoji",9),t(10,`
                        `),a(11,"span",12),t(12),l(),t(13,`
                    `),l(),t(14,`
                `),l(),t(15,`
            `),l(),t(16,`
        `)}if(o&2){let e=c().$implicit,i=c();r(3),ee("reaction-button--reacted",e.value.hasReacted),p("disabled",i.isReadOnlyMode())("ngbTooltip",T(5,10,T(4,8,e.value.reactingUsers))),r(6),p("emoji",e.key),r(2),ee("reaction-count--reacted",e.value.hasReacted),r(),O(`
                            `,e.value.count,`
                        `)}}function jr(o,d){if(o&1&&(t(0,`
        `),x(1,Fr,17,12)),o&2){let e=c();r(),f(e.isEmojiCount()?1:-1)}}function Lr(o,d){if(o&1){let e=P();t(0,`
                    `),a(1,"jhi-emoji-picker",20),h("emojiSelect",function(n){m(e);let s=c(2);return u(s.selectReaction(n))}),l(),t(2,`
                `)}if(o&2){let e=c(2);r(),p("emojisToShowFilter",e.emojisToShowFilter)("categoriesIcons",e.categoriesIcons)("recent",e.selectedCourseEmojis)}}function Br(o,d){if(o&1){let e=P();t(0,`
            `),pe(1),t(2,`
                `),a(3,"button",17,1),h("click",function(){m(e);let n=c();return u(n.showReactionSelector=!n.showReactionSelector)}),t(5,`
                    `),g(6,"fa-icon",18),y(7,"artemisTranslate"),t(8,`
                `),l(),t(9,`

                `),x(10,Lr,3,3,"ng-template",19),h("backdropClick",function(){m(e);let n=c();return u(n.toggleEmojiSelect())}),t(11,`
            `),me(),t(12,`
        `)}if(o&2){let e=G(4),i=c();r(6),ee("open-selector",i.showReactionSelector),p("icon",(i.getPostingType()==="post",i.faSmile))("title",T(7,8,"artemisApp.metis.chooseReaction")),r(4),p("cdkConnectedOverlayHasBackdrop",!0)("cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop")("cdkConnectedOverlayOrigin",e)("cdkConnectedOverlayOpen",i.showReactionSelector)}}function Nr(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"button",21),y(2,"artemisTranslate"),h("click",function(){m(e);let n=c();return u(n.editPosting())}),t(3,`
                `),g(4,"fa-icon",13),t(5,`
            `),l(),t(6,`
        `)}if(o&2){let e=c();r(),p("ngbTooltip",T(2,2,"artemisApp.metis.editPosting")),r(3),p("icon",e.faPencilAlt)}}function Ur(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"button",22),t(2,`
                `),a(3,"jhi-confirm-icon",23),y(4,"artemisTranslate"),y(5,"artemisTranslate"),h("confirmEvent",function(){m(e);let n=c();return u(n.deletePosting())}),l(),t(6,`
            `),l(),t(7,`
        `)}o&2&&(r(3),p("initialTooltip",T(4,2,"artemisApp.metis.deleteAnswer"))("confirmTooltip",T(5,4,"artemisApp.metis.confirmDeleteAnswer")))}function Hr(o,d){if(o&1&&(t(0,`
                        `),g(1,"fa-icon",25),y(2,"artemisTranslate"),y(3,"artemisTranslate"),t(4,`
                    `)),o&2){let e=c(3);r(),p("icon",e.faCheck)("ngbTooltip",e.isAtLeastTutorInCourse||e.isAuthorOfOriginalPost?T(2,2,"artemisApp.metis.unmarkAsResolvingAnswerTooltip"):T(3,4,"artemisApp.metis.resolvingAnswerTooltip"))}}function zr(o,d){if(o&1&&(t(0,`
                            `),g(1,"fa-icon",26),y(2,"artemisTranslate"),t(3,`
                        `)),o&2){let e=c(4);r(),p("icon",e.faCheck)("ngbTooltip",T(2,2,"artemisApp.metis.markAsResolvingAnswerTooltip"))}}function Gr(o,d){if(o&1&&(t(0,`
                        `),x(1,zr,4,4)),o&2){let e=c(3);r(),f(e.isAtLeastTutorInCourse||e.isAuthorOfOriginalPost?1:-1)}}function Wr(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"button",24),h("click",function(){m(e);let n=c(2);return u(n.toggleResolvesPost())}),t(2,`
                    `),x(3,Hr,5,6)(4,Gr,2,1),l(),t(5,`
            `)}if(o&2){let e=c(2);r(),p("ngClass",e.isAtLeastTutorInCourse||e.isAuthorOfOriginalPost?"clickable":""),r(2),f(e.getResolvesPost()?3:4)}}function qr(o,d){if(o&1&&(t(0,`
            `),x(1,Wr,6,2)),o&2){let e=c();r(),f(!e.isAnswerOfAnnouncement&&(e.isAtLeastTutorInCourse||e.isAuthorOfOriginalPost)?1:-1)}}function Qr(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"button",27),h("click",function(){m(e);let n=c();return u(n.canPin&&n.togglePin())}),t(2,`
                `),g(3,"jhi-emoji",28),y(4,"artemisTranslate"),t(5,`
            `),l(),t(6,`
        `)}if(o&2){let e=c();r(),ee("reaction-button--not-hoverable",!e.canPin)("reaction-button--reacted",e.displayPriority===e.DisplayPriority.PINNED&&e.canPin),p("disabled",!e.canPin||e.isReadOnlyMode()),r(2),p("emoji",e.pinEmojiId)("ngbTooltip",T(4,7,e.pinTooltip))}}function $r(o,d){if(o&1){let e=P();t(0,`
            `),t(1,`
            `),a(2,"button",29),y(3,"artemisTranslate"),h("click",function(){m(e);let n=c();return u(n.bookmarkPosting())}),t(4,`
                `),g(5,"fa-icon",13),t(6,`
            `),l(),t(7,`
            `),t(8,`
            `),a(9,"button",30),y(10,"artemisTranslate"),h("click",function(){m(e);let n=c();return u(n.forwardMessage())}),t(11,`
                `),g(12,"fa-icon",31),t(13,`
            `),l(),t(14,`
        `)}if(o&2){let e=c();r(2),p("ngbTooltip",T(3,5,e.getSaved()?"artemisApp.metis.post.removeBookmarkPost":"artemisApp.metis.post.bookmarkPost")),r(3),p("icon",(e.getSaved(),e.faBookmark)),r(4),p("disabled",e.isReadOnlyMode())("ngbTooltip",T(10,7,"artemisApp.metis.post.forwardMessage")),r(3),p("icon",e.faShare)}}function Kr(o,d){o&1&&(t(0,`
        `),g(1,"div",32),t(2,`
    `))}var Xr="pushpin",Jr="open_file_folder",Yr="heavy_multiplication_x",to="1F4AC",no="1F4C2",io="1F4CC",oo="2716",Oe=(()=>{class o{onBookmarkClicked=b();DisplayPriority=Z;faBookmark=ve;faSmile=et;faCheck=si;faPencilAlt=we;faArrowRight=Jn;faTrash=Hn;faShare=ye;pinEmojiId=Xr;archiveEmojiId=Jr;closeCrossId=Yr;showReactionSelector=!1;isAtLeastTutorInCourse;isAuthorOfPosting;isAuthorOfOriginalPost;isAnswerOfAnnouncement;isAtLeastInstructorInCourse;mayEdit;mayDelete;pinTooltip;displayPriority;canPin=!1;channels=[];users=[];posting=C();isThreadSidebar=C();isEmojiCount=C(!1);isReadOnlyMode=C(!1);openPostingCreateEditModal=b();closePostingCreateEditModal=b();reactionsUpdated=b();isModalOpen=b();mayDeleteOutput=b();mayEditOutput=b();canPinOutput=b();showAnswers=C();sortedAnswerPosts=C();isCommunicationPage=C();lastReadDate=C();previewMode=C();hoverBar=C(!0);showAnswersChange=b();isLastAnswer=C(!1);postingUpdated=b();openThread=b();originalPostDetails=C();course=C();isDeleteEvent=b();createEditModal=Q.required("createEditModal");metisService=w(D);accountService=w(tt);conversationService=w(gi);modalService=w(Mt);metisConversationService=w(Ft);ngOnInit(){if(this.updatePostingWithReactions(),this.isAuthorOfPosting=this.metisService.metisUserIsAuthorOfPosting(this.posting()),this.isAtLeastTutorInCourse=this.metisService.metisUserIsAtLeastTutorInCourse(),this.isAtLeastInstructorInCourse=this.metisService.metisUserIsAtLeastInstructorInCourse(),this.isAnswerOfAnnouncement=this.getPostingType()==="answerPost"?ge(this.posting().post?.conversation)?.isAnnouncementChannel??!1:!1,this.isAuthorOfOriginalPost=this.getPostingType()==="answerPost"?this.metisService.metisUserIsAuthorOfPosting(this.posting().post):!1,this.getPostingType()==="post"){let e=this.metisService.getCurrentConversation();this.setCanPin(e),this.resetTooltipsAndPriority()}this.setMayDelete(),this.setMayEdit()}ngOnChanges(){this.updatePostingWithReactions(),this.isAtLeastTutorInCourse=this.metisService.metisUserIsAtLeastTutorInCourse(),this.getPostingType()==="post"&&this.resetTooltipsAndPriority(),this.setMayDelete(),this.setMayEdit()}categoriesIcons={recent:"M10 1h3v21h-3zm10.186 4l1.5 2.598L3.5 18.098 2 15.5zM2 7.598L3.5 5l18.186 10.5-1.5 2.598z"};setCanPin(e){if(!e){this.canPin=this.metisService.metisUserIsAtLeastTutorInCourse();return}pi(e)?this.canPin=e.hasChannelModerationRights??!1:mi(e)?this.canPin=e.creator?.id===this.accountService.userIdentity?.id:ui(e)&&(this.canPin=!0),this.canPinOutput.emit(this.canPin)}resetTooltipsAndPriority(){this.displayPriority=this.posting().displayPriority,this.pinTooltip=this.getPinTooltip()}getShowNewMessageIcon(){let e=!1;return this.sortedAnswerPosts().forEach(i=>{let n=this.metisService.metisUserIsAuthorOfPosting(i),s=this.lastReadDate?.(),_=i.creationDate;if(s&&_){let v=qe(s);!n&&_.isAfter(v)&&(e=!0)}}),e}getPinTooltip(){return this.canPin&&this.displayPriority===Z.PINNED?"artemisApp.metis.removePinPostTooltip":this.canPin&&this.displayPriority!==Z.PINNED?"artemisApp.metis.pinPostTooltip":"artemisApp.metis.pinnedPostTooltip"}selectedCourseEmojis=["smile","joy","sunglasses","tada","rocket","heavy_plus_sign","thumbsup","memo","coffee","recycle"];emojisToShowFilter=e=>typeof e=="string"?e!==io&&e!==no&&e!==to&&e!==oo:e.unified!==io&&e.unified!==no&&e.unified!==to&&e.unified!==oo;reactionMetaDataMap={};buildReaction(e){let i=new nn;return i.emojiId=e,this.getPostingType()==="answerPost"?i.answerPost=this.posting():i.post=this.posting(),i}selectReaction(e){e.emoji!=null&&this.addOrRemoveReaction(e.emoji.id)}toggleEmojiSelect(){this.showReactionSelector=!this.showReactionSelector}updateReaction(e){e!=null&&this.addOrRemoveReaction(e)}addOrRemoveReaction(e){let i=this.posting().reactions?this.posting().reactions.findIndex(n=>n.user?.id===this.metisService.getUser().id&&n.emojiId===e):-1;if(this.posting().reactions&&i>-1){let n=this.posting().reactions[i];this.metisService.deleteReaction(n).subscribe(()=>{this.posting().reactions=this.posting().reactions?.filter(s=>s.id!==n.id),this.updatePostingWithReactions(),this.showReactionSelector=!1,this.reactionsUpdated.emit(this.posting().reactions)})}else{let n=this.buildReaction(e);this.metisService.createReaction(n).subscribe(()=>{this.updatePostingWithReactions(),this.showReactionSelector=!1,this.reactionsUpdated.emit(this.posting().reactions||[])})}}updatePostingWithReactions(){if(this.posting().reactions&&this.posting().reactions.length>0){let e=this.posting().reactions.filter(i=>i.emojiId!==this.pinEmojiId||i.emojiId!==this.archiveEmojiId);this.reactionMetaDataMap=this.buildReactionMetaDataMap(e)}else this.reactionMetaDataMap={}}buildReactionMetaDataMap(e){return e.reduce((i,n)=>{let s=n.user?.id===this.metisService.getUser().id,_=s?on:n.user?.name,v={count:i[n.emojiId]?i[n.emojiId].count+1:1,hasReacted:i[n.emojiId]&&i[n.emojiId].hasReacted||s,reactingUsers:i[n.emojiId]?i[n.emojiId].reactingUsers.concat(_):[_]};return he(X({},i),{[n.emojiId]:v})},{})}bookmarkPosting(){this.onBookmarkClicked.emit()}isAnyReactionCountAboveZero(){return Object.values(this.reactionMetaDataMap).some(e=>e.count>=1)}deletePosting(){this.isDeleteEvent.emit(!0)}togglePin(){this.canPin&&(this.displayPriority===Z.PINNED?this.displayPriority=Z.NONE:this.displayPriority=Z.PINNED,this.posting().displayPriority=this.displayPriority,this.metisService.updatePostDisplayPriority(this.posting().id,this.displayPriority).subscribe())}toggleResolvesPost(){(this.isAtLeastTutorInCourse||this.isAuthorOfOriginalPost)&&(this.posting().resolvesPost=!this.posting().resolvesPost,this.metisService.updateAnswerPost(this.posting()).subscribe())}checkIfPinned(){return this.displayPriority}openAnswerView(){this.showAnswersChange.emit(!0),this.openPostingCreateEditModal.emit()}closeAnswerView(){this.showAnswersChange.emit(!1),this.closePostingCreateEditModal.emit()}setMayEdit(){this.mayEdit=this.isAuthorOfPosting,this.mayEditOutput.emit(this.mayEdit)}editPosting(){this.getPostingType()==="post"?this.posting().title!=""?this.createEditModal().open():this.isModalOpen.emit():this.openPostingCreateEditModal.emit()}forwardMessage(){let e=this.getPostingType()==="answerPost";!this.posting().content||this.posting().content===""?this.openForwardMessageView(this.originalPostDetails(),e):this.openForwardMessageView(this.posting(),e)}openForwardMessageView(e,i){this.course()?.id&&(this.channels=[],this.users=[],this.conversationService.getConversationsOfUser(this.course().id).pipe(Ae(n=>n.body||[])).subscribe({next:n=>{n.forEach(_=>{_.type===di.CHANNEL&&!_.isAnnouncementChannel&&this.channels.push(_)});let s=this.modalService.open(eo,{size:"lg",backdrop:"static"});s.componentInstance.users.set([]),s.componentInstance.channels.set(this.channels),s.componentInstance.postToForward.set(e),s.componentInstance.courseId.set(this.course()?.id),s.result.then(_=>Be(this,null,function*(){if(_){let v=[..._.channels],S=_.users.map(M=>M.login);if(S.length>0){let M=null;if(S.length===1)try{M=(yield this.metisConversationService.createDirectConversation(S[0]).toPromise())?.body??null,M&&v.push(M)}catch{return}else try{let L=yield this.metisConversationService.createGroupConversation(S).toPromise();L&&L.body&&(M=L.body,v.push(M))}catch{return}}v.forEach(M=>{M&&M.id&&this.forwardPost(e,M,_.messageContent,i)})}}))}}))}forwardPost(e,i,n,s){this.metisService.createForwardedMessages([e],i,s,n).subscribe({})}setMayDelete(){let e=this.getConversation(),i=ge(e),n=this.getPostingType()==="answerPost"?i?.isAnnouncementChannel??!1:!1,s=i?.isCourseWide??!1,_=n?this.isAtLeastInstructorInCourse:!0,v=s&&this.isAtLeastTutorInCourse||(ge(this.metisService.getCurrentConversation())?.hasChannelModerationRights??!1);this.mayDelete=!this.isReadOnlyMode()&&!this.previewMode()&&(this.isAuthorOfPosting||v)&&_,this.mayDeleteOutput.emit(this.mayDelete)}getConversation(){return this.getPostingType()==="answerPost"?this.posting().post?.conversation:this.posting().conversation}getPostingType(){return this.posting()&&"post"in this.posting()?"answerPost":"post"}getSaved(){return this.posting()?.isSaved}getResolvesPost(){return this.posting()?.resolvesPost}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-posting-reactions-bar"]],viewQuery:function(i,n){i&1&&K(n.createEditModal,Sr,5),i&2&&oe()},inputs:{posting:[1,"posting"],isThreadSidebar:[1,"isThreadSidebar"],isEmojiCount:[1,"isEmojiCount"],isReadOnlyMode:[1,"isReadOnlyMode"],showAnswers:[1,"showAnswers"],sortedAnswerPosts:[1,"sortedAnswerPosts"],isCommunicationPage:[1,"isCommunicationPage"],lastReadDate:[1,"lastReadDate"],previewMode:[1,"previewMode"],hoverBar:[1,"hoverBar"],isLastAnswer:[1,"isLastAnswer"],originalPostDetails:[1,"originalPostDetails"],course:[1,"course"]},outputs:{onBookmarkClicked:"onBookmarkClicked",openPostingCreateEditModal:"openPostingCreateEditModal",closePostingCreateEditModal:"closePostingCreateEditModal",reactionsUpdated:"reactionsUpdated",isModalOpen:"isModalOpen",mayDeleteOutput:"mayDeleteOutput",mayEditOutput:"mayEditOutput",canPinOutput:"canPinOutput",showAnswersChange:"showAnswersChange",postingUpdated:"postingUpdated",openThread:"openThread",isDeleteEvent:"isDeleteEvent"},features:[I],decls:23,vars:15,consts:[["createEditModal",""],["trigger","cdkOverlayOrigin"],[1,"d-flex","flex-wrap","gap-2","fs-xx-small","align-items-center"],[3,"hidden"],[3,"isModalOpen","posting","isCommunicationPage"],[1,"reaction-button","clickable","reply-btn",3,"click"],[1,"fa-xs","align-self-center",3,"icon"],["jhiTranslate","artemisApp.conversationsLayout.threadSideBar.reply",1,"emoji-count","px-2"],[1,"reaction-button","clickable","collapse-answers-btn",3,"click"],[3,"emoji"],["jhiTranslate","artemisApp.metis.collapseAnswers",1,"emoji-count"],[1,"reaction-button","clickable","expand-answers-btn",3,"click"],[1,"emoji-count"],[3,"icon"],[1,"emoji-count","px-2"],[1,"reaction-button","clickable",3,"click","disabled","ngbTooltip"],[1,"emoji-container"],["cdkOverlayOrigin","",1,"reaction-button","clickable","px-2","fs-small",3,"click"],[3,"icon","title"],["cdkConnectedOverlay","",3,"backdropClick","cdkConnectedOverlayHasBackdrop","cdkConnectedOverlayBackdropClass","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen"],[3,"emojiSelect","emojisToShowFilter","categoriesIcons","recent"],[1,"reaction-button","clickable","px-2","fs-small","edit",3,"click","ngbTooltip"],[1,"reaction-button","clickable","fs-small"],["iconSize","sm",3,"confirmEvent","initialTooltip","confirmTooltip"],["id","toggleElement",1,"reaction-button","clickable","px-2","fs-small","resolve",3,"click","ngClass"],[1,"resolved",3,"icon","ngbTooltip"],[1,"icon","notResolved",3,"icon","ngbTooltip"],[1,"reaction-button","pin","clickable","fs-small",3,"click","disabled"],[1,"fs-x-small",3,"emoji","ngbTooltip"],[1,"reaction-button","clickable","px-2","fs-small","bookmark",3,"click","ngbTooltip"],[1,"reaction-button","clickable","px-2","fs-small","forward",3,"click","disabled","ngbTooltip"],["cdkOverlayOrigin","",3,"icon"],["jhiTranslate","global.generic.new",1,"badge","bg-secondary","hideAfter5Seconds"]],template:function(i,n){if(i&1){let s=P();a(0,"div",2),t(1,`
    `),x(2,Vr,4,2),B(3,jr,2,1,null,null,de),y(5,"keyvalue"),a(6,"div",3),t(7,`
        `),t(8,`
        `),x(9,Br,13,10)(10,Nr,7,4),a(11,"jhi-post-create-edit-modal",4,0),h("isModalOpen",function(){return m(s),u(n.isModalOpen.emit())}),l(),t(13,`
        `),t(14,`
        `),x(15,Ur,8,6)(16,qr,2,1)(17,Qr,7,9)(18,$r,15,9),l(),t(19,`

    `),t(20,`
    `),x(21,Kr,3,0),l(),t(22,`
`)}i&2&&(ze("width",n.getPostingType()==="post"?"max-content":""),r(2),f(n.getPostingType()==="post"?2:-1),r(),N(T(5,13,n.reactionMetaDataMap)),r(3),p("hidden",n.isReadOnlyMode()),r(3),f(n.isAnyReactionCountAboveZero()&&n.isEmojiCount()||!n.isEmojiCount()?9:-1),r(),f(!n.isEmojiCount()&&n.mayEdit?10:-1),r(),p("posting",n.posting())("isCommunicationPage",n.isCommunicationPage()),r(4),f(!n.isEmojiCount()&&n.mayDelete?15:-1),r(),f(n.getPostingType()==="answerPost"&&!n.isEmojiCount()?16:-1),r(),f(n.getPostingType()==="post"&&!n.isEmojiCount()&&(n.displayPriority===n.DisplayPriority.PINNED||n.canPin)?17:-1),r(),f(n.isEmojiCount()?-1:18),r(3),f(n.getPostingType()==="post"&&n.isEmojiCount()&&n.getShowNewMessageIcon()?21:-1))},dependencies:[ae,en,ot,z,j,rt,at,Qt,yt,On,V,Zi,W,Yi],styles:[".post-result-information[_ngcontent-%COMP%]{font-size:small;font-style:italic}.post-separation-line[_ngcontent-%COMP%]{height:1px;background:var(--metis-light-gray)}.bold-line[_ngcontent-%COMP%]{height:2px;background:var(--metis-light-gray)}.icon[_ngcontent-%COMP%]{color:var(--metis-gray)}.resolved[_ngcontent-%COMP%]{color:var(--metis-green)}.post-header-author-date[_ngcontent-%COMP%]{line-height:1.1}.post-content-padding[_ngcontent-%COMP%]{padding-left:3.42rem}.post-authority-icon-student[_ngcontent-%COMP%]{display:none}.reference[_ngcontent-%COMP%]{font-weight:200;display:inline-flex}.hideAfter5Seconds[_ngcontent-%COMP%]{-webkit-animation:_ngcontent-%COMP%_cssAnimation 5s forwards;animation:_ngcontent-%COMP%_cssAnimation 5s forwards}@keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}@-webkit-keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}.card[_ngcontent-%COMP%]{border-radius:.25em}@media (max-width: 575.98px){.post-header-author-date[_ngcontent-%COMP%]{flex-direction:column;gap:0!important}.post-content-padding[_ngcontent-%COMP%]{margin-left:0}.post-header-date-separator[_ngcontent-%COMP%]{display:none}.post-header-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6c757d;font-size:.75rem!important}}.post-delete-button-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;z-index:0;background-color:#0d6efd4d;animation:_ngcontent-%COMP%_increaseWidth 6s forwards linear}@media (prefers-reduced-motion){.post-delete-button-background[_ngcontent-%COMP%]{animation:none}}.post-delete-button-label[_ngcontent-%COMP%]{position:relative;z-index:1}@keyframes _ngcontent-%COMP%_increaseWidth{0%{width:0}to{width:100%}}.emoji-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.2rem}.reaction-button[_ngcontent-%COMP%]{background:var(--reaction-button-default-color);color:var(--metis-gray);border:none;border-radius:1rem;align-items:center;height:1.2rem;display:inline-flex}.reaction-button.open-selector[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 1px var(--metis-gray);background:var(--reaction-button-hover-color)}.reaction-button[_ngcontent-%COMP%]   fa-icon[_ngcontent-%COMP%]{display:inline-flex;justify-content:center}.reaction-button[_ngcontent-%COMP%]   .emoji-count[_ngcontent-%COMP%]{color:var(--reaction-button-emoji-count-color);padding-left:.2em}.reaction-button[_ngcontent-%COMP%]   .emoji-count.reaction-count--reacted[_ngcontent-%COMP%]{font-weight:600;color:var(--reaction-button-reacted-accent-color)}.reaction-button[_ngcontent-%COMP%]:not(.reaction-button--not-hoverable):hover{box-shadow:inset 0 0 0 1px var(--metis-gray);background:var(--reaction-button-hover-color)}.reaction-button[_ngcontent-%COMP%]:active{transform:scale(.94)}.reaction-button.reaction-button--reacted[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 1px var(--reaction-button-reacted-accent-color);background:var(--reaction-button-reacted-color)}"]})}return o})();var Zr=["createEditAnswerPostContainer"],es=(o,d,e)=>({"module-bg rounded-2":o,"is-saved":d,"non-consecutive":e}),so=(o,d)=>({position:"fixed","top.px":o,"left.px":d}),gn=o=>({"is-saved":o});function ts(o,d){if(o&1&&(t(0,`
        `),a(1,"div",8),t(2,`
            `),a(3,"div",9),t(4,`
                `),g(5,"fa-icon",10),t(6,`
                `),g(7,"span",11),t(8,`
            `),l(),t(9,`
        `),l(),t(10,`
    `)),o&2){let e=c();r(),p("ngClass",E(2,gn,e.isConsecutive()&&e.posting.isSaved)),r(4),p("icon",e.faBookmark)}}function ns(o,d){if(o&1&&(t(0,`
        `),a(1,"span",12),y(2,"artemisDate"),t(3),y(4,"artemisDate"),l(),t(5,`
    `)),o&2){let e=c();r(),$("ngbTooltip",F(2,2,e.posting.creationDate,"time")),r(2),O(`
            `,F(4,5,e.posting.creationDate,"time"),`
        `)}}function is(o,d){if(o&1){let e=P();t(0,`
        `),a(1,"div",13),t(2,`
            `),a(3,"jhi-posting-header",14),h("onUserNameClicked",function(){m(e);let n=c();return u(n.onUserNameClicked())}),l(),t(4,`
        `),l(),t(5,`
    `)}if(o&2){let e=c();r(3),p("posting",e.posting)("readOnlyMode",e.isReadOnlyMode())("isCommunicationPage",e.isCommunicationPage)("lastReadDate",e.lastReadDate())("isDeleted",e.isDeleted)}}function os(o,d){if(o&1){let e=P();t(0,`
        `),a(1,"div",15),h("contextmenu",function(n){m(e);let s=c();return u(s.onRightClick(n))}),t(2,`
            `),a(3,"div",16),t(4,`
                `),a(5,"jhi-posting-content",17),h("onUndoDeleteEvent",function(){m(e);let n=c();return u(n.onDeleteEvent(!1))})("userReferenceClicked",function(n){m(e);let s=c();return u(s.onUserReferenceClicked(n))})("channelReferenceClicked",function(n){m(e);let s=c();return u(s.channelReferenceClicked.emit(n))}),l(),t(6,`
                `),a(7,"div",18),t(8,`
                    `),a(9,"jhi-posting-reactions-bar",19),h("openPostingCreateEditModal",function(){m(e),c();let n=G(15);return u(n.open())})("reactionsUpdated",function(n){m(e);let s=c();return u(s.onReactionsUpdated(n))})("mayDeleteOutput",function(n){m(e);let s=c();return u(s.onMayDelete(n))})("mayEditOutput",function(n){m(e);let s=c();return u(s.onMayEdit(n))})("isDeleteEvent",function(){m(e);let n=c();return u(n.onDeleteEvent(!0))})("onBookmarkClicked",function(){m(e);let n=c();return u(n.toggleSavePost())}),l(),t(10,`
                `),l(),t(11,`
            `),l(),t(12,`
        `),l(),t(13,`
    `)}if(o&2){let e=c();r(),p("ngClass",E(15,gn,e.isConsecutive()&&e.posting.isSaved)),r(2),ee("force-hover",e.showDropdown),r(2),p("content",e.posting.content)("isEdited",!!e.posting.updatedDate)("author",e.posting.author)("posting",e.posting)("isReply",!0)("isDeleted",e.isDeleted)("deleteTimerInSeconds",e.deleteTimerInSeconds),r(4),p("isReadOnlyMode",e.isReadOnlyMode())("course",e.course)("posting",e.posting)("isLastAnswer",e.isLastAnswer())("isThreadSidebar",e.isThreadSidebar)}}function rs(o,d){if(o&1){let e=P();t(0,`
        `),a(1,"div",20),t(2,`
            `),a(3,"jhi-posting-reactions-bar",21),h("openPostingCreateEditModal",function(){m(e),c();let n=G(15);return u(n.open())})("reactionsUpdated",function(n){m(e);let s=c();return u(s.onReactionsUpdated(n))})("onBookmarkClicked",function(){m(e);let n=c();return u(n.toggleSavePost())}),l(),t(4,`
        `),l(),t(5,`
    `)}if(o&2){let e=c();r(),p("ngClass",E(7,gn,e.posting.isSaved&&e.isConsecutive()))("@fade",void 0),r(2),p("isReadOnlyMode",e.isReadOnlyMode())("posting",e.posting)("isLastAnswer",e.isLastAnswer())("isThreadSidebar",e.isThreadSidebar)("isEmojiCount",!0)}}function ss(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"button",23),h("click",function(){m(e);let n=c(2);return u(n.editPosting())}),t(2,`
                `),g(3,"fa-icon",24),t(4,`
                `),g(5,"span",29),t(6,`
            `),l(),t(7,`
        `)}if(o&2){let e=c(2);r(3),p("icon",e.faPencilAlt)}}function as(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"button",23),h("click",function(){m(e);let n=c(2);return u(n.deletePost())}),t(2,`
                `),g(3,"fa-icon",24),t(4,`
                `),g(5,"span",30),t(6,`
            `),l(),t(7,`
        `)}if(o&2){let e=c(2);r(3),p("icon",e.faTrash)}}function ls(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"div",22),t(2,`
        `),a(3,"button",23),h("click",function(n){m(e);let s=c();return u(s.addReaction(n))}),t(4,`
            `),g(5,"fa-icon",24),t(6,`
            `),g(7,"span",25),t(8,`
        `),l(),t(9,`
        `),x(10,ss,8,1)(11,as,8,1),a(12,"button",23),h("click",function(){m(e);let n=c();return u(n.toggleSavePost())}),t(13,`
            `),g(14,"fa-icon",24),t(15,`
            `),g(16,"span",26),t(17,`
        `),l(),t(18,`
        `),a(19,"button",27),h("click",function(){m(e);let n=c();return u(n.forwardMessage())}),t(20,`
            `),g(21,"fa-icon",24),t(22,`
            `),g(23,"span",28),t(24,`
        `),l(),t(25,`
    `),l(),t(26,`
`)}if(o&2){let e=c();r(),p("ngStyle",ue(7,so,e.dropdownPosition.y,e.dropdownPosition.x)),r(4),p("icon",e.faSmile),r(5),f(e.mayEdit?10:-1),r(),f(e.mayDelete?11:-1),r(3),p("icon",e.posting.isSaved?e.faBookmark:e.farBookmark),r(2),p("jhiTranslate",e.posting.isSaved?"artemisApp.metis.post.removeBookmarkPost":"artemisApp.metis.post.bookmarkPost"),r(5),p("icon",e.faShare)}}function cs(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"jhi-emoji-picker",31),h("emojiSelect",function(n){m(e);let s=c();return u(s.selectReaction(n))}),l(),t(2,`
`)}}var ao=(()=>{class o extends Zt{changeDetector=w(H);renderer=w(Ue);document=w(vt);lastReadDate=C(void 0);isLastAnswer=C(!1);isReadOnlyMode=C(!1);isConsecutive=C(!1);openPostingCreateEditModal=b();userReferenceClicked=b();channelReferenceClicked=b();containerRef=Q.required("createEditAnswerPostContainer",{read:Re});reactionsBarComponent=Q(Oe);isAnswerPost=!0;course;faBookmark=ve;faPencilAlt=we;faShare=ye;faSmile=et;faTrash=Ot;static activeDropdownPost=null;mayEdit=!1;mayDelete=!1;constructor(){super(),this.course=this.metisService.getCourse()}ngOnInit(){super.ngOnInit(),this.assignPostingToAnswerPost()}ngOnChanges(){this.assignPostingToAnswerPost()}get reactionsBar(){return this.reactionsBarComponent()}onPostingUpdated(e){this.posting=e}onReactionsUpdated(e){this.posting=he(X({},this.posting),{reactions:e})}onClickOutside(){this.showDropdown=!1,this.enableBodyScroll()}disableBodyScroll(){let e=this.document.querySelector(".thread-answer-post");e&&this.renderer.setStyle(e,"overflow","hidden")}enableBodyScroll(){let e=this.document.querySelector(".thread-answer-post");e&&this.renderer.setStyle(e,"overflow-y","auto")}onMayDelete(e){this.mayDelete=e}onMayEdit(e){this.mayEdit=e}onRightClick(e){let i=e.target,n;try{n=window.getComputedStyle(i).cursor==="pointer"}catch(s){Nn(s),n=!0}n||(e.preventDefault(),o.activeDropdownPost!==this&&o.cleanupActiveDropdown(),o.activeDropdownPost=this,this.dropdownPosition={x:e.clientX,y:e.clientY},this.showDropdown=!0,this.adjustDropdownPosition(),this.disableBodyScroll())}adjustDropdownPosition(){let i=window.innerWidth;this.dropdownPosition.x+200>i&&(this.dropdownPosition.x=i-200-10)}static cleanupActiveDropdown(){o.activeDropdownPost&&(o.activeDropdownPost.showDropdown=!1,o.activeDropdownPost.enableBodyScroll(),o.activeDropdownPost.changeDetector.detectChanges(),o.activeDropdownPost=null)}ngOnDestroy(){o.activeDropdownPost===this&&o.cleanupActiveDropdown()}assignPostingToAnswerPost(){this.posting&&!(this.posting instanceof mt)&&(this.posting=Object.assign(new mt,this.posting))}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-answer-post"]],viewQuery:function(i,n){i&1&&(K(n.containerRef,Zr,5,Re),K(n.reactionsBarComponent,Oe,5)),i&2&&oe(2)},hostBindings:function(i,n){i&1&&h("click",function(_){return n.onClickOutside(_)},!1,Ne)},inputs:{lastReadDate:[1,"lastReadDate"],isLastAnswer:[1,"isLastAnswer"],isReadOnlyMode:[1,"isReadOnlyMode"],isConsecutive:[1,"isConsecutive"]},outputs:{openPostingCreateEditModal:"openPostingCreateEditModal",userReferenceClicked:"userReferenceClicked",channelReferenceClicked:"channelReferenceClicked"},features:[J,I],decls:24,vars:22,consts:[["createEditAnswerPostContainer",""],["createAnswerPostModal",""],["emojiPickerTrigger","cdkOverlayOrigin"],[1,"answer-post","hover-container",3,"id","ngClass"],[1,"post-content-padding"],[3,"postingUpdated","posting","createEditAnswerPostContainerRef"],["cdkOverlayOrigin","",3,"ngStyle"],["cdkConnectedOverlay","",3,"backdropClick","cdkConnectedOverlayHasBackdrop","cdkConnectedOverlayBackdropClass","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen"],[1,"post-is-saved-message","post-content-padding","fs-xx-small","py-1",3,"ngClass"],[1,"post-is-saved-message-content"],[3,"icon"],["jhiTranslate","artemisApp.metis.post.saved",1,"text-secondary"],[1,"post-time","fs-small",3,"ngbTooltip"],[1,"ps-3"],[3,"onUserNameClicked","posting","readOnlyMode","isCommunicationPage","lastReadDate","isDeleted"],[1,"message-container","post-content-padding",3,"contextmenu","ngClass"],[1,"message-content"],[3,"onUndoDeleteEvent","userReferenceClicked","channelReferenceClicked","content","isEdited","author","posting","isReply","isDeleted","deleteTimerInSeconds"],[1,"post-content-padding","hover-actions"],[3,"openPostingCreateEditModal","reactionsUpdated","mayDeleteOutput","mayEditOutput","isDeleteEvent","onBookmarkClicked","isReadOnlyMode","course","posting","isLastAnswer","isThreadSidebar"],[1,"post-content-padding","post-reactions-bar",3,"ngClass"],[3,"openPostingCreateEditModal","reactionsUpdated","onBookmarkClicked","isReadOnlyMode","posting","isLastAnswer","isThreadSidebar","isEmojiCount"],[1,"dropdown-menu","show",3,"ngStyle"],[1,"dropdown-item","d-flex",3,"click"],[1,"item-icon",3,"icon"],["jhiTranslate","artemisApp.metis.post.addReaction"],[3,"jhiTranslate"],[1,"dropdown-item","d-flex","forward",3,"click"],["jhiTranslate","artemisApp.metis.post.forwardMessage"],["jhiTranslate","artemisApp.metis.post.editMessage"],["jhiTranslate","artemisApp.metis.post.deleteMessage"],[3,"emojiSelect"]],template:function(i,n){if(i&1){let s=P();a(0,"div",3),t(1,`
    `),x(2,ts,11,4)(3,ns,6,8)(4,is,6,5)(5,os,14,17),a(6,"div",4),t(7,`
        `),Ct(8,null,0),t(10,`
    `),l(),t(11,`
    `),x(12,rs,6,9),l(),t(13,`
`),a(14,"jhi-answer-post-create-edit-modal",5,1),h("postingUpdated",function(v){return m(s),u(n.onPostingUpdated(v))}),l(),t(16,`

`),t(17,`
`),x(18,ls,27,10),g(19,"div",6,2),t(21,`

`),x(22,cs,3,0,"ng-template",7),h("backdropClick",function(){return m(s),u(n.toggleEmojiSelect())}),t(23,`
`)}if(i&2){let s=G(15),_=G(20);p("id","item-"+n.posting.id)("ngClass",bn(15,es,n.isCommunicationPage,!n.isConsecutive()&&n.posting.isSaved,!n.isConsecutive())),r(2),f(n.posting.isSaved?2:-1),r(),f(n.isConsecutive()?3:-1),r(),f(n.isConsecutive()?-1:4),r(),f(s.isInputOpen?-1:5),r(7),f(n.isDeleted?-1:12),r(2),p("posting",n.posting)("createEditAnswerPostContainerRef",n.containerRef()),r(4),f(n.showDropdown?18:-1),r(),p("ngStyle",ue(19,so,n.clickPosition.y,n.clickPosition.x)),r(3),p("cdkConnectedOverlayHasBackdrop",!0)("cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop")("cdkConnectedOverlayOrigin",_)("cdkConnectedOverlayOpen",n.showReactionSelector)}},dependencies:[W,z,j,ae,tn,ce,Oe,gt,Ce,ot,rt,at,Te],styles:[".post-result-information[_ngcontent-%COMP%]{font-size:small;font-style:italic}.post-separation-line[_ngcontent-%COMP%]{height:1px;background:var(--metis-light-gray)}.bold-line[_ngcontent-%COMP%]{height:2px;background:var(--metis-light-gray)}.icon[_ngcontent-%COMP%]{color:var(--metis-gray)}.resolved[_ngcontent-%COMP%]{color:var(--metis-green)}.post-header-author-date[_ngcontent-%COMP%]{line-height:1.1}.post-content-padding[_ngcontent-%COMP%]{padding-left:3.42rem}.post-authority-icon-student[_ngcontent-%COMP%]{display:none}.reference[_ngcontent-%COMP%]{font-weight:200;display:inline-flex}.hideAfter5Seconds[_ngcontent-%COMP%]{-webkit-animation:_ngcontent-%COMP%_cssAnimation 5s forwards;animation:_ngcontent-%COMP%_cssAnimation 5s forwards}@keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}@-webkit-keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}.card[_ngcontent-%COMP%]{border-radius:.25em}@media (max-width: 575.98px){.post-header-author-date[_ngcontent-%COMP%]{flex-direction:column;gap:0!important}.post-content-padding[_ngcontent-%COMP%]{margin-left:0}.post-header-date-separator[_ngcontent-%COMP%]{display:none}.post-header-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6c757d;font-size:.75rem!important}}.post-delete-button-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;z-index:0;background-color:#0d6efd4d;animation:_ngcontent-%COMP%_increaseWidth 6s forwards linear}@media (prefers-reduced-motion){.post-delete-button-background[_ngcontent-%COMP%]{animation:none}}.post-delete-button-label[_ngcontent-%COMP%]{position:relative;z-index:1}@keyframes _ngcontent-%COMP%_increaseWidth{0%{width:0}to{width:100%}}.answer-post[_ngcontent-%COMP%]{border-radius:7px}@media (max-width: 575.98px){.answer-post-content-margin[_ngcontent-%COMP%]{padding-left:.5rem}}.hover-actions[_ngcontent-%COMP%]{position:absolute;top:-1.8rem;right:3%;display:flex;gap:10px;visibility:hidden;max-height:2.2rem;transition:opacity .2s ease-in-out,visibility .2s ease-in-out;background:var(--metis-selection-option-background);padding:5px;border-radius:5px;border:.01rem solid var(--metis-gray)}.message-container[_ngcontent-%COMP%]{position:relative}.post-is-saved-message[_ngcontent-%COMP%], .message-container[_ngcontent-%COMP%], .post-reactions-bar[_ngcontent-%COMP%], .answer-post[_ngcontent-%COMP%]{background-color:transparent;transition:background-color .2s ease-in-out}.post-is-saved-message.is-saved[_ngcontent-%COMP%], .message-container.is-saved[_ngcontent-%COMP%], .post-reactions-bar.is-saved[_ngcontent-%COMP%], .answer-post.is-saved[_ngcontent-%COMP%]{background-color:#0d6efd1a}.message-content[_ngcontent-%COMP%], .post-is-saved-message-content[_ngcontent-%COMP%]{padding-left:.25rem}.non-consecutive[_ngcontent-%COMP%]   .hover-actions[_ngcontent-%COMP%]{top:-2rem}.hover-container[_ngcontent-%COMP%]{position:relative}.hover-container[_ngcontent-%COMP%]:hover{background:var(--metis-selection-option-hover-background);transition:background-color .2s ease-in-out}.hover-container[_ngcontent-%COMP%]:hover   .hover-actions[_ngcontent-%COMP%]{visibility:visible;opacity:1}.message-content[_ngcontent-%COMP%]:hover{background:var(--metis-selection-option-hover-background)}.message-container[_ngcontent-%COMP%]:hover   .hover-actions[_ngcontent-%COMP%]{opacity:1;visibility:visible}.clickable[_ngcontent-%COMP%]{cursor:pointer}.item-icon[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:.2rem}.post-time[_ngcontent-%COMP%]{position:absolute;top:5%;left:.5rem;margin-left:.7rem;visibility:hidden;opacity:0;transition:visibility .2s ease-in-out,opacity .2s ease-in-out;font-size:.75rem;color:var(--metis-gray-dark)}.hover-container[_ngcontent-%COMP%]:hover   .post-time[_ngcontent-%COMP%]{visibility:visible;opacity:1}"],data:{animation:[Tt("fade",[$e(":enter",[xe({opacity:0}),Qe("300ms ease-in",xe({opacity:1}))]),$e(":leave",[Qe("300ms ease-out",xe({opacity:0}))])])]},changeDetection:0})}return o})();var ds=["createEditAnswerPostContainer"],ps=["createAnswerPostModal"],ms=o=>({number:o});function us(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"jhi-answer-post",9),h("openPostingCreateEditModal",function(){m(e),c(3);let n=G(8);return u(n.open())})("userReferenceClicked",function(n){m(e);let s=c(3);return u(s.userReferenceClicked.emit(n))})("channelReferenceClicked",function(n){m(e);let s=c(3);return u(s.channelReferenceClicked.emit(n))}),l(),t(2,`
            `)}if(o&2){let e=d.$implicit,i=c().$implicit,n=c(2);r(),p("lastReadDate",n.lastReadDate())("isReadOnlyMode",n.readOnlyMode())("posting",e)("isConsecutive",e.isConsecutive||!1)("isLastAnswer",n.isLastPost(i,e))("isCommunicationPage",n.isCommunicationPage())("isThreadSidebar",n.isThreadSidebar())("hasChannelModerationRights",n.hasChannelModerationRights())}}function gs(o,d){if(o&1&&(t(0,`
            `),B(1,us,3,8,null,null,Ge().trackPostByFn,!0)),o&2){let e=d.$implicit;r(),N(e.posts)}}function _s(o,d){if(o&1&&(t(0,`
    `),a(1,"div",4),t(2,`
        `),a(3,"div",5),t(4),y(5,"artemisTranslate"),y(6,"artemisTranslate"),l(),t(7,`
        `),a(8,"div",6),t(9,`
            `),g(10,"hr",7),t(11,`
        `),l(),t(12,`
    `),l(),t(13,`
    `),pe(14,8),t(15,`
        `),B(16,gs,3,0,null,null,Ge().trackGroupByFn,!0),me(),t(18,`
`)),o&2){let e=c();r(4),O(`
            `,e.sortedAnswerPosts().length===1?T(5,1,"artemisApp.metis.singleAnswer"):F(6,3,"artemisApp.metis.multipleAnswers",E(6,ms,e.sortedAnswerPosts().length)),`
        `),r(12),N(e.groupedAnswerPosts)}}var lo=(()=>{class o{lastReadDate=C();readOnlyMode=C(!1);previewMode=C(!1);modalRef=C();hasChannelModerationRights=C(!1);showAnswers=C(!1);isCommunicationPage=C(!1);sortedAnswerPosts=C([]);isThreadSidebar=C(!1);posting=C();openThread=b();userReferenceClicked=b();channelReferenceClicked=b();answerPostCreateEditModal;containerRef;createAnswerPostModalComponent;createdAnswerPost;isAtLeastTutorInCourse=!1;courseId;groupedAnswerPosts=[];metisService=w(D);changeDetector=w(H);ngOnInit(){this.courseId=this.metisService.getCourse().id,this.isAtLeastTutorInCourse=this.metisService.metisUserIsAtLeastTutorInCourse(),this.createdAnswerPost=this.createEmptyAnswerPost(),this.groupAnswerPosts()}ngOnChanges(e){e.sortedAnswerPosts&&(this.groupAnswerPosts(),this.changeDetector.detectChanges())}ngOnDestroy(){this.answerPostCreateEditModal?.createEditAnswerPostContainerRef()?.clear()}ngAfterContentChecked(){this.changeDetector.detectChanges()}createEmptyAnswerPost(){let e=new mt;return e.content="",e.post=this.posting(),e.resolvesPost=this.isAtLeastTutorInCourse,e}groupAnswerPosts(){if(!this.sortedAnswerPosts()||this.sortedAnswerPosts().length===0){this.groupedAnswerPosts=[];return}let i=this.sortedAnswerPosts().slice().reverse().sort((_,v)=>_.creationDate.valueOf()-v.creationDate.valueOf()),n=[],s={author:i[0].author,posts:[he(X({},i[0]),{isConsecutive:!1})]};for(let _=1;_<i.length;_++){let v=i[_],S=s.posts[s.posts.length-1],M=Number.MAX_SAFE_INTEGER;v.creationDate&&S.creationDate&&(M=v.creationDate.diff(S.creationDate,"minute")),v.author?.id===s.author?.id&&M<5&&M>=0?s.posts.push(he(X({},v),{isConsecutive:!0})):(n.push(s),s={author:v.author,posts:[he(X({},v),{isConsecutive:!1})]})}n.push(s),this.groupedAnswerPosts=n,this.changeDetector.detectChanges()}trackGroupByFn(e,i){return i.posts[0].id}trackPostByFn(e,i){return i.id}isLastPost(e,i){return e.posts[e.posts.length-1].id===i.id}openCreateAnswerPostModal(){this.createAnswerPostModalComponent?.open()}closeCreateAnswerPostModal(){this.createAnswerPostModalComponent?.close()}postsTrackByFn(e,i){return i.id}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-posting-footer"]],viewQuery:function(i,n){if(i&1&&(te(gt,5),te(ds,5,Re),te(ps,5)),i&2){let s;ne(s=ie())&&(n.answerPostCreateEditModal=s.first),ne(s=ie())&&(n.containerRef=s.first),ne(s=ie())&&(n.createAnswerPostModalComponent=s.first)}},inputs:{lastReadDate:[1,"lastReadDate"],readOnlyMode:[1,"readOnlyMode"],previewMode:[1,"previewMode"],modalRef:[1,"modalRef"],hasChannelModerationRights:[1,"hasChannelModerationRights"],showAnswers:[1,"showAnswers"],isCommunicationPage:[1,"isCommunicationPage"],sortedAnswerPosts:[1,"sortedAnswerPosts"],isThreadSidebar:[1,"isThreadSidebar"],posting:[1,"posting"]},outputs:{openThread:"openThread",userReferenceClicked:"userReferenceClicked",channelReferenceClicked:"channelReferenceClicked"},features:[I],decls:11,vars:3,consts:[["createEditAnswerPostContainer",""],["createAnswerPostModal",""],[1,"new-reply-inline-input"],[3,"onCreate","posting","createEditAnswerPostContainerRef"],[1,"d-flex","align-items-center","mb-1","mx-3"],[1,"fs-x-small","fw-900","me-2"],[1,"flex-grow-1"],[1,"m-0"],[1,"list-answer-post"],[3,"openPostingCreateEditModal","userReferenceClicked","channelReferenceClicked","lastReadDate","isReadOnlyMode","posting","isConsecutive","isLastAnswer","isCommunicationPage","isThreadSidebar","hasChannelModerationRights"]],template:function(i,n){if(i&1){let s=P();x(0,_s,19,8),a(1,"div",2),t(2,`
    `),t(3,`
    `),Ct(4,null,0),t(6,`
    `),a(7,"jhi-answer-post-create-edit-modal",3,1),h("onCreate",function(){return m(s),n.createdAnswerPost=n.createEmptyAnswerPost(),u(n.showAnswers())}),l(),t(9,`
`),l(),t(10,`
`)}i&2&&(f(n.showAnswers()?0:-1),r(7),p("posting",n.createdAnswerPost)("createEditAnswerPostContainerRef",n.containerRef))},dependencies:[ao,gt,V],encapsulation:2})}return o})();function hs(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"div",4),t(2,`
                    `),a(3,"button",5),h("click",function(){m(e);let n=c();return u(n.closeAlert())}),l(),t(4,`
                    `),g(5,"h4",6),t(6,`
                    `),g(7,"p",7),t(8,`
                    `),g(9,"hr"),t(10,`
                    `),g(11,"p",8),t(12,`
                `),l(),t(13,`
            `)}}function fs(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"button",9),y(2,"artemisTranslate"),h("click",function(){m(e);let n=c();return u(n.isModalOpen.emit())}),l(),t(3,`
                `),g(4,"button",10),y(5,"artemisTranslate"),t(6,`
            `)}if(o&2){let e=c();r(),p("buttonLabel",T(2,4,"artemisApp.metis.cancel")),r(3),p("buttonLoading",e.isLoading)("disabled",e.isLoading||!e.formGroup.valid)("buttonLabel",T(5,6,"artemisApp.conversationsLayout.saveMessage"))}}var co=(()=>{class o extends Xt{localStorageService=w(Un);warningDismissed=!1;ngOnInit(){super.ngOnInit(),this.warningDismissed=!!this.localStorageService.retrieve("chatWarningDismissed")}resetFormGroup(){this.formGroup=this.formBuilder.group({content:[this.posting.content,[Y.required,Y.maxLength(this.maxContentLength),it]]})}createPosting(){this.posting.content=this.formGroup.get("content")?.value,this.metisService.createPost(this.posting).subscribe({next:e=>{this.isLoading=!1,this.onCreate.emit(e)},error:()=>{this.isLoading=!1}})}updatePosting(){this.posting.content=this.formGroup.get("content")?.value,this.metisService.updatePost(this.posting).subscribe({next:()=>{this.isLoading=!1,this.isModalOpen.emit()},error:()=>{this.isLoading=!1}})}closeAlert(){this.warningDismissed=!0,this.localStorageService.store("chatWarningDismissed",!0)}static \u0275fac=(()=>{let e;return function(n){return(e||(e=fe(o)))(n||o)}})();static \u0275cmp=k({type:o,selectors:[["jhi-message-inline-input"]],features:[J],decls:13,vars:9,consts:[[3,"ngSubmit","formGroup"],[1,"message-inline-input-form__wrapper"],["formControlName","content",3,"keydown.enter","editorHeight","maxContentLength","isInputLengthDisplayed","isButtonLoading","isFormGroupValid","editType"],[1,"col","mt-1","text-end"],["role","alert",1,"alert","alert-warning","alert-dismissible","text-start","fade","show"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["jhiTranslate","artemisApp.messageWarning.headerText",1,"alert-heading"],["jhiTranslate","artemisApp.messageWarning.mainParagraph"],["jhiTranslate","artemisApp.messageWarning.lastParagraph",1,"mb-0"],["jhi-posting-button","",1,"btn","btn-sm","btn-outline-secondary",3,"click","buttonLabel"],["jhi-posting-button","","id","save","type","submit",1,"btn","btn-sm","btn-outline-primary",3,"buttonLoading","disabled","buttonLabel"]],template:function(i,n){i&1&&(a(0,"form",0),h("ngSubmit",function(){return n.confirm()}),t(1,`
    `),a(2,"div",1),t(3,`
        `),a(4,"jhi-posting-markdown-editor",2),h("keydown.enter",function(){return n.confirm()}),l(),t(5,`
        `),a(6,"div",3),t(7,`
            `),x(8,hs,14,0)(9,fs,7,8),l(),t(10,`
    `),l(),t(11,`
`),l(),t(12,`
`)),i&2&&(p("formGroup",n.formGroup),r(4),p("editorHeight",n.editorHeight)("maxContentLength",n.maxContentLength)("isInputLengthDisplayed",!1)("isButtonLoading",n.isLoading)("isFormGroupValid",n.formGroup.valid)("editType",n.editType),r(4),f(n.warningDismissed?-1:8),r(),f(n.editType===n.EditType.UPDATE?9:-1))},dependencies:[se,Je,re,Xe,Pe,Ye,Ze,ct,j,lt,V],styles:[`.message-inline-input-form__wrapper{padding-top:5px}.message-inline-input-form__wrapper .markdown-editor-wrapper{background-color:transparent!important}.message-inline-input-form__wrapper .markdown-editor-wrapper .markdown-editor{border:1px solid var(--border-color);background-color:transparent!important}.message-inline-input-form__wrapper .ng-invalid{border:none}
`],encapsulation:2})}return o})();var Cs=["messageContent"],xs=o=>({expanded:o});function Ps(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"button",14),h("click",function(){m(e);let n=c();return u(n.onTriggerNavigateToPost())}),l(),t(2,`
            `)}}function ws(o,d){if(o&1&&(t(0,`
                    `),g(1,"span",15),t(2,`
                `)),o&2){let e,i=c();r(),p("jhiTranslate",(e=i.todayFlag)!==null&&e!==void 0?e:"")}}function vs(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"button",16),h("click",function(){m(e);let n=c();return u(n.toggleShowFullForwardedMessage())}),t(2),y(3,"artemisTranslate"),y(4,"artemisTranslate"),l(),t(5,`
        `)}if(o&2){let e=c();r(2),O(`
                `,e.showFullForwardedMessage?T(3,1,"artemisApp.metis.forward.showLess"):T(4,3,"artemisApp.metis.forward.showMore"),`
            `)}}var po=(()=>{class o{faShare=ye;onNavigateToPost=b();sourceName="";todayFlag;originalPostDetails=C();messageContent=Q("messageContent");isContentLong=!1;showFullForwardedMessage=!1;postingIsOfToday=!1;viewButtonVisible=!1;cdr=w(H);conversation;isAnswerPost=!1;constructor(){kn(()=>{try{let e=this.originalPostDetails();e?(this.isAnswerPost="post"in e,this.conversation=this.isAnswerPost?e.post?.conversation:e.conversation,this.updateSourceName(),this.isChannel(),this.postingIsOfToday=qe().isSame(e.creationDate,"day"),this.todayFlag=this.getTodayFlag()):(this.sourceName="",this.conversation=void 0,this.viewButtonVisible=!1,this.postingIsOfToday=!1,this.todayFlag=void 0)}catch{this.sourceName="",this.conversation=void 0,this.viewButtonVisible=!1}})}ngAfterViewInit(){setTimeout(()=>{this.checkIfContentOverflows()},0)}toggleShowFullForwardedMessage(){this.showFullForwardedMessage=!this.showFullForwardedMessage}checkIfContentOverflows(){if(this.messageContent()){let e=this.messageContent()?.nativeElement;this.isContentLong=e.scrollHeight>e.clientHeight,this.cdr.detectChanges()}}getTodayFlag(){if(this.postingIsOfToday)return"artemisApp.metis.today"}isChannel(){this.conversation?.type?.valueOf()==="channel"&&(this.viewButtonVisible=!0)}onTriggerNavigateToPost(){this.originalPostDetails()!==void 0&&this.onNavigateToPost.emit(this.originalPostDetails())}updateSourceName(){this.conversation?this.conversation?.type?.valueOf()==="channel"?this.isAnswerPost?this.sourceName=this.conversation?.name?`a thread in #${this.conversation?.name} |`:"a thread in #unknown |":this.sourceName=this.conversation?.name?`#${this.conversation?.name} |`:"#unknown |":this.conversation?.type?.valueOf()==="oneToOneChat"?this.sourceName=this.isAnswerPost?"a thread in a direct message ":"a direct message ":this.sourceName=this.isAnswerPost?"a thread in a group message ":"a group message ":this.sourceName=""}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=k({type:o,selectors:[["jhi-forwarded-message"]],viewQuery:function(i,n){i&1&&K(n.messageContent,Cs,5),i&2&&oe()},inputs:{originalPostDetails:[1,"originalPostDetails"]},outputs:{onNavigateToPost:"onNavigateToPost"},decls:43,vars:34,consts:[["messageContent",""],[1,"forwarded-message-container"],[1,"left-border-line"],[1,"forwarded-message-content"],[1,"forwarded-message-channel","fs-x-small","d-flex","align-items-center"],[1,"item-icon",2,"margin-right","0.3rem",3,"icon"],[1,"forwarded-message-header"],["imageSizeInRem","1.5","fontSizeInRem","0.6","imageId","user-profile-picture","defaultPictureId","user-default-profile-picture",2,"margin-right","0.2rem",3,"authorId","authorName","imageUrl"],[1,"forwarded-message-author"],[1,"post-header-date-separator"],[1,"post-header-date"],[1,"fs-x-small",3,"disableTooltip","ngbTooltip"],["id","messageContent",1,"forwarded-message-body",3,"ngClass"],[3,"previewMode","content","author","isEdited","posting","isReply","isSubscribeToMetis"],["type","button","jhiTranslate","artemisApp.metis.forward.viewConversation",1,"btn","btn-link","p-0",2,"width","fit-content","font-size","0.7rem","margin-left","0.2rem",3,"click"],["id","today-flag",1,"fs-x-small",3,"jhiTranslate"],["type","button",1,"btn","btn-link","p-0",2,"width","fit-content","font-size","0.7rem",3,"click"]],template:function(i,n){if(i&1&&(a(0,"div",1),t(1,`
    `),g(2,"div",2),t(3,`
    `),a(4,"div",3),t(5,`
        `),a(6,"span",4),t(7,`
            `),g(8,"fa-icon",5),t(9),y(10,"artemisTranslate"),x(11,Ps,3,0),l(),t(12,`
        `),a(13,"div",6),t(14,`
            `),g(15,"jhi-profile-picture",7),t(16,`
            `),a(17,"span",8),t(18),l(),t(19,`
            `),a(20,"span",9),t(21,"-"),l(),t(22,`
            `),a(23,"span",10),t(24,`
                `),x(25,ws,3,1),a(26,"span",11),y(27,"artemisDate"),t(28),y(29,"artemisDate"),y(30,"artemisDate"),l(),t(31,`
            `),l(),t(32,`
        `),l(),t(33,`
        `),a(34,"div",12,0),t(36,`
            `),g(37,"jhi-posting-content",13),t(38,`
        `),l(),t(39,`
        `),x(40,vs,6,5),l(),t(41,`
`),l(),t(42,`
`)),i&2){let s,_,v,S,M,L;r(8),p("icon",n.faShare),r(),xt(`
            `,T(10,21,"artemisApp.metis.forward.forwardedFrom")," ",n.sourceName,`
            `),r(2),f(n.viewButtonVisible?11:-1),r(4),p("authorId",(s=n.originalPostDetails())==null||s.author==null?null:s.author.id)("authorName",(_=n.originalPostDetails())==null||_.author==null?null:_.author.name)("imageUrl",(v=n.originalPostDetails())==null||v.author==null?null:v.author.imageUrl),r(3),U((S=n.originalPostDetails())==null||S.author==null?null:S.author.name),r(7),f(n.postingIsOfToday?25:-1),r(),$("ngbTooltip",F(27,23,(M=n.originalPostDetails())==null?null:M.creationDate,"time")),p("disableTooltip",n.postingIsOfToday),r(2),O(`
                    `,n.postingIsOfToday?F(29,26,(L=n.originalPostDetails())==null?null:L.creationDate,"time"):F(30,29,(L=n.originalPostDetails())==null?null:L.creationDate,"short-date"),`
                `),r(6),p("ngClass",E(32,xs,n.showFullForwardedMessage)),r(3),p("previewMode",!1)("content",n.originalPostDetails().content)("author",n.originalPostDetails().author)("isEdited",!!n.originalPostDetails().updatedDate)("posting",n.originalPostDetails())("isReply",!1)("isSubscribeToMetis",!1),r(3),f(n.isContentLong?40:-1)}},dependencies:[st,j,W,z,ae,ce,V,Te],styles:[".forwarded-message-container[_ngcontent-%COMP%]{display:flex;padding-top:.3rem;padding-bottom:.3rem;position:relative}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-header[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:.5rem;margin-top:.5rem}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-author[_ngcontent-%COMP%]{font-weight:700}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-body[_ngcontent-%COMP%]{overflow:hidden;max-height:7rem}.forwarded-message-container[_ngcontent-%COMP%]   .forwarded-message-body.expanded[_ngcontent-%COMP%]{max-height:none}.left-border-line[_ngcontent-%COMP%]{background-color:var(--metis-gray);width:4px;border-radius:3px;margin-right:.5rem}"]})}return o})();var ys=["postFooter"],Ts=(o,d,e,i)=>({"mx-0":o,"pinned-message":d,"is-saved":e,"non-consecutive":i}),_n=o=>({"is-saved":o}),uo=(o,d)=>({position:"fixed","top.px":o,"left.px":d}),bs=o=>({"mx-0":o}),Ms=o=>({"mb-2":o}),ks=(o,d)=>({"mb-2":o,"is-saved":d});function Os(o,d){if(o&1&&(t(0,`
        `),a(1,"div",8),t(2,`
            `),a(3,"div",9),t(4,`
                `),g(5,"fa-icon",10),t(6,`
                `),g(7,"span",11),t(8,`
            `),l(),t(9,`
        `),l(),t(10,`
    `)),o&2){let e=c();r(),p("ngClass",E(2,_n,e.isConsecutive()&&e.posting.isSaved)),r(4),p("icon",e.faBookmark)}}function Ss(o,d){if(o&1&&(t(0,`
        `),a(1,"span",12),y(2,"artemisDate"),t(3),y(4,"artemisDate"),l(),t(5,`
    `)),o&2){let e=c();r(),$("ngbTooltip",F(2,2,e.posting.creationDate,"time")),r(2),O(`
            `,F(4,5,e.posting.creationDate,"time"),`
        `)}}function As(o,d){if(o&1){let e=P();t(0,`
        `),a(1,"div",13),t(2,`
            `),a(3,"jhi-posting-header",14),h("isModalOpen",function(){m(e);let n=c();return u(n.displayInlineInput=!0)})("onUserNameClicked",function(){m(e);let n=c();return u(n.onUserNameClicked())}),l(),t(4,`
        `),l(),t(5,`
    `)}if(o&2){let e=c();r(3),p("previewMode",e.previewMode())("readOnlyMode",e.readOnlyMode())("posting",e.posting)("isDeleted",e.isDeleted)("isCommunicationPage",e.isCommunicationPage)("lastReadDate",e.lastReadDate())}}function Es(o,d){if(o&1&&(t(0,`
                    `),g(1,"fa-icon",15),y(2,"artemisTranslate"),t(3,`
                `)),o&2){let e=c();r(),p("icon",e.faBullhorn)("ngbTooltip",T(2,2,"artemisApp.metis.post.postMarkedAsAnnouncementTooltip"))}}function Is(o,d){if(o&1){let e=P();t(0,`
                            `),a(1,"a",16),h("click",function(n){m(e);let s=c(2);return u(s.onNavigateToContext(n))}),t(2),l(),t(3,`
                        `)}if(o&2){let e=c(2);r(),p("routerLink",e.contextInformation.routerLinkComponents)("queryParams",e.contextInformation.queryParams),r(),U(e.contextInformation.displayName)}}function Rs(o,d){if(o&1&&(t(0,`
                            `),a(1,"span",17),t(2),l(),t(3,`
                        `)),o&2){let e=c(2);r(2),O("",e.contextInformation.displayName,":")}}function Ds(o,d){if(o&1&&(t(0,`
                    `),a(1,"span"),t(2,`
                        `),x(3,Is,4,3)(4,Rs,4,1),l(),t(5,`
                `)),o&2){let e=c();r(3),f(e.contextInformation.routerLinkComponents?3:-1),r(),f(e.contextInformation.routerLinkComponents?-1:4)}}function Vs(o,d){if(o&1&&(t(0,`
                            `),a(1,"span",18),t(2),l(),t(3,`
                        `)),o&2){let e=c(2);r(2),U(e.posting.title)}}function Fs(o,d){if(o&1&&(t(0,`
                    `),a(1,"span"),t(2,`
                        `),x(3,Vs,4,1),l(),t(4,`
                `)),o&2){let e=c();r(3),f(e.posting.title!=null&&e.posting.title.length?3:-1)}}function js(o,d){if(o&1){let e=P();t(0,`
                            `),a(1,"jhi-forwarded-message",23),h("onNavigateToPost",function(){m(e);let n=c(2);return u(n.onTriggerNavigateToPost(n.originalPostDetails))}),l(),t(2,`
                        `)}if(o&2){let e=c(2);r(),p("originalPostDetails",e.originalPostDetails)}}function Ls(o,d){if(o&1){let e=P();t(0,`
                                `),t(1,`
                                `),a(2,"jhi-posting-reactions-bar",24),Fe("showAnswersChange",function(n){m(e);let s=c(2);return Ve(s.showAnswers,n)||(s.showAnswers=n),u(n)}),h("openPostingCreateEditModal",function(){m(e);let n=c(2);return u(n.openCreateAnswerPostModal())})("openThread",function(){m(e);let n=c(2);return u(n.openThread.emit())})("isModalOpen",function(){m(e);let n=c(2);return u(n.displayInlineInput=!0)})("mayEditOutput",function(n){m(e);let s=c(2);return u(s.onMayEdit(n))})("mayDeleteOutput",function(n){m(e);let s=c(2);return u(s.onMayDelete(n))})("canPinOutput",function(n){m(e);let s=c(2);return u(s.onCanPin(n))})("isDeleteEvent",function(){m(e);let n=c(2);return u(n.onDeleteEvent(!0))})("onBookmarkClicked",function(){m(e);let n=c(2);return u(n.toggleSavePost())}),l(),t(3,`
                            `)}if(o&2){let e=c(2);r(2),p("lastReadDate",e.lastReadDate())("isReadOnlyMode",e.readOnlyMode())("previewMode",e.previewMode())("course",e.course)("posting",e.posting),De("showAnswers",e.showAnswers),p("sortedAnswerPosts",e.sortedAnswerPosts)("isCommunicationPage",e.isCommunicationPage)("isThreadSidebar",e.isThreadSidebar)("originalPostDetails",e.originalPostDetails)}}function Bs(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"div",19),h("contextmenu",function(n){m(e);let s=c();return u(s.onRightClick(n))}),t(2,`
                    `),a(3,"div",20),t(4,`
                        `),a(5,"jhi-posting-content",21),h("onUndoDeleteEvent",function(){m(e);let n=c();return u(n.onDeleteEvent(!1))})("userReferenceClicked",function(n){m(e);let s=c();return u(s.onUserReferenceClicked(n))})("channelReferenceClicked",function(n){m(e);let s=c();return u(s.onChannelReferenceClicked(n))}),l(),t(6,`
                        `),x(7,js,3,1),a(8,"div",22),t(9,`
                            `),x(10,Ls,4,10),l(),t(11,`
                    `),l(),t(12,`
                `),l(),t(13,`
            `)}if(o&2){let e=c();r(),ee("force-hover",e.showDropdown),p("ngClass",E(15,_n,e.isConsecutive()&&e.posting.isSaved)),r(2),p("ngClass",E(17,bs,!e.isThreadSidebar)),r(2),p("previewMode",e.previewMode())("content",e.posting.content)("author",e.posting.author)("isEdited",!!e.posting.updatedDate)("posting",e.posting)("isReply",!1)("isDeleted",e.isDeleted)("deleteTimerInSeconds",e.deleteTimerInSeconds),r(2),f(e.originalPostDetails?7:-1),r(),p("ngClass",E(19,Ms,e.previewMode())),r(2),f(e.previewMode()?-1:10)}}function Ns(o,d){if(o&1){let e=P();t(0,`
        `),a(1,"div",25),t(2,`
            `),a(3,"jhi-message-inline-input",26),h("isModalOpen",function(){m(e);let n=c();return u(n.displayInlineInput=!1)}),l(),t(4,`
        `),l(),t(5,`
    `)}if(o&2){let e=c();r(3),p("posting",e.posting)}}function Us(o,d){if(o&1){let e=P();t(0,`
                `),a(1,"jhi-posting-reactions-bar",28),Fe("showAnswersChange",function(n){m(e);let s=c(2);return Ve(s.showAnswers,n)||(s.showAnswers=n),u(n)}),h("openPostingCreateEditModal",function(){m(e);let n=c(2);return u(n.openCreateAnswerPostModal())})("closePostingCreateEditModal",function(){m(e);let n=c(2);return u(n.closeCreateAnswerPostModal())})("openThread",function(){m(e);let n=c(2);return u(n.openThread.emit())})("isModalOpen",function(){m(e);let n=c(2);return u(n.displayInlineInput=!0)})("onBookmarkClicked",function(){m(e);let n=c(2);return u(n.toggleSavePost())}),l(),t(2,`
            `)}if(o&2){let e=c(2);r(),p("lastReadDate",e.lastReadDate())("isReadOnlyMode",e.readOnlyMode())("previewMode",e.previewMode())("posting",e.posting),De("showAnswers",e.showAnswers),p("sortedAnswerPosts",e.sortedAnswerPosts)("isCommunicationPage",e.isCommunicationPage)("isThreadSidebar",e.isThreadSidebar)("isEmojiCount",!0)("hoverBar",!1)}}function Hs(o,d){if(o&1&&(t(0,`
        `),a(1,"div",27),t(2,`
            `),t(3,`
            `),x(4,Us,3,10),l(),t(5,`
    `)),o&2){let e=c();r(),p("ngClass",ue(2,ks,e.previewMode(),e.posting.isSaved&&e.isConsecutive())),r(3),f(e.previewMode()?-1:4)}}function zs(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"button",30),h("click",function(){m(e);let n=c(2);return u(n.togglePin())}),t(2,`
                `),g(3,"fa-icon",31),t(4,`
                `),g(5,"span",34),t(6,`
            `),l(),t(7,`
        `)}if(o&2){let e=c(2);r(3),p("icon",e.faThumbtack),r(2),p("jhiTranslate",e.checkIfPinned()===e.DisplayPriority.PINNED?"artemisApp.metis.post.unpinMessage":"artemisApp.metis.post.pinMessage")}}function Gs(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"button",37),h("click",function(){m(e);let n=c(2);return u(n.editPosting())}),t(2,`
                `),g(3,"fa-icon",31),t(4,`
                `),g(5,"span",38),t(6,`
            `),l(),t(7,`
        `)}if(o&2){let e=c(2);r(3),p("icon",e.faPencilAlt)}}function Ws(o,d){if(o&1){let e=P();t(0,`
            `),a(1,"button",39),h("click",function(){m(e);let n=c(2);return u(n.deletePost())}),t(2,`
                `),g(3,"fa-icon",31),t(4,`
                `),g(5,"span",40),t(6,`
            `),l(),t(7,`
        `)}if(o&2){let e=c(2);r(3),p("icon",e.faTrash)}}function qs(o,d){if(o&1){let e=P();t(0,`
    `),a(1,"div",29),t(2,`
        `),a(3,"button",30),h("click",function(n){m(e);let s=c();return u(s.addReaction(n))}),t(4,`
            `),g(5,"fa-icon",31),t(6,`
            `),g(7,"span",32),t(8,`
        `),l(),t(9,`
        `),x(10,zs,8,2)(11,Gs,8,1)(12,Ws,8,1),a(13,"button",30),h("click",function(){let n;m(e);let s=c();return u(s.isCommunicationPage?s.openThread.emit():(n=s.reactionsBarComponent())==null?null:n.openAnswerView())}),t(14,`
            `),g(15,"fa-icon",31),t(16,`
            `),g(17,"span",33),t(18,`
        `),l(),t(19,`
        `),a(20,"button",30),h("click",function(){m(e);let n=c();return u(n.toggleSavePost())}),t(21,`
            `),g(22,"fa-icon",31),t(23,`
            `),g(24,"span",34),t(25,`
        `),l(),t(26,`
        `),a(27,"button",35),h("click",function(){m(e);let n=c();return u(n.forwardMessage())}),t(28,`
            `),g(29,"fa-icon",31),t(30,`
            `),g(31,"span",36),t(32,`
        `),l(),t(33,`
    `),l(),t(34,`
`)}if(o&2){let e=c();r(),p("ngStyle",ue(9,uo,e.dropdownPosition.y,e.dropdownPosition.x)),r(4),p("icon",e.faSmile),r(5),f(e.canPin?10:-1),r(),f(e.mayEdit?11:-1),r(),f(e.mayDelete?12:-1),r(3),p("icon",e.faComments),r(7),p("icon",e.posting.isSaved?e.faBookmark:e.farBookmark),r(2),p("jhiTranslate",e.posting.isSaved?"artemisApp.metis.post.removeBookmarkPost":"artemisApp.metis.post.bookmarkPost"),r(5),p("icon",e.faShare)}}function Qs(o,d){if(o&1){let e=P();t(0,`
        `),a(1,"jhi-emoji-picker",41),h("emojiSelect",function(n){m(e);let s=c(2);return u(s.selectReaction(n))}),l(),t(2,`
    `)}}function $s(o,d){if(o&1&&(t(0,`
    `),x(1,Qs,3,0)),o&2){let e=c();r(),f(e.readOnlyMode()?-1:1)}}var mo=class o extends Zt{metisService=w(D);changeDetector=w(H);renderer=w(Ue);document=w(vt);lastReadDate=C(void 0);readOnlyMode=C(!1);previewMode=C(!1);modalRef=C(void 0);showAnswers=Tn(!1);openThread=b();postFooterComponent=Q("postFooter");reactionsBarComponent=Q.required(Oe);static activeDropdownPost=void 0;showReactionSelector=!1;displayInlineInput=!1;routerLink;queryParams={};showAnnouncementIcon=!1;sortedAnswerPosts;createdAnswerPost;isAtLeastTutorInCourse;pageType;contextInformation;PageType=Dt;DisplayPriority=Z;mayEdit=!1;mayDelete=!1;canPin=!1;originalPostDetails=void 0;onNavigateToPost=b();faBullhorn=$n;faComments=Gn;faPencilAlt=we;faSmile=et;faTrash=Ot;faThumbtack=ri;faBookmark=ve;faShare=ye;isConsecutive=C(!1);forwardedPosts=C([]);forwardedAnswerPosts=C([]);dropdownPosition={x:0,y:0};course;constructor(){super(),this.course=this.metisService.getCourse()??Cn("Course not found")}get reactionsBar(){return this.reactionsBarComponent()}isPinned(){return this.posting.displayPriority===Z.PINNED}onMayEdit(d){this.mayEdit=d}onMayDelete(d){this.mayDelete=d}onCanPin(d){this.canPin=d}onRightClick(d){let e=d.target;window.getComputedStyle(e).cursor==="pointer"||(d.preventDefault(),o.activeDropdownPost&&o.activeDropdownPost!==this&&(o.activeDropdownPost.showDropdown=!1,o.activeDropdownPost.enableBodyScroll(),o.activeDropdownPost.changeDetector.detectChanges()),o.activeDropdownPost=this,this.dropdownPosition={x:d.clientX,y:d.clientY},this.showDropdown=!0,this.adjustDropdownPosition(),this.disableBodyScroll())}adjustDropdownPosition(){let e=window.innerWidth;this.dropdownPosition.x+200>e&&(this.dropdownPosition.x=e-200-10)}disableBodyScroll(){let d=this.document.querySelector(".posting-infinite-scroll-container");d&&this.renderer.setStyle(d,"overflow","hidden")}enableBodyScroll(){let d=this.document.querySelector(".posting-infinite-scroll-container");d&&this.renderer.setStyle(d,"overflow-y","auto")}onClickOutside(){this.showDropdown=!1,this.enableBodyScroll()}ngOnInit(){super.ngOnInit(),this.pageType=this.metisService.getPageType(),this.contextInformation=this.metisService.getContextInformation(this.posting),this.isAtLeastTutorInCourse=this.metisService.metisUserIsAtLeastTutorInCourse(),this.sortAnswerPosts(),this.assignPostingToPost(),this.fetchForwardedMessages()}fetchForwardedMessages(){try{if(this.forwardedPosts().length>0){let d=this.forwardedPosts()[0];d?.id&&(this.originalPostDetails=d,this.changeDetector.markForCheck())}if(this.forwardedAnswerPosts().length>0){let d=this.forwardedAnswerPosts()[0];d?.id&&(this.originalPostDetails=d,this.changeDetector.markForCheck())}}catch(d){throw new Error(d.toString())}}ngOnChanges(){this.contextInformation=this.metisService.getContextInformation(this.posting),this.routerLink=this.metisService.getLinkForPost(),this.queryParams=this.metisService.getQueryParamsForPost(this.posting),this.showAnnouncementIcon=(ge(this.posting.conversation)?.isAnnouncementChannel&&this.showChannelReference)??!1,this.sortAnswerPosts(),this.assignPostingToPost()}ngAfterContentChecked(){this.changeDetector.detectChanges()}onNavigateToContext(d){d.metaKey||(this.modalRef()?.dismiss(),this.metisConversationService.setActiveConversation(this.contextInformation.queryParams.conversationId))}openCreateAnswerPostModal(){this.postFooterComponent()?.openCreateAnswerPostModal()}closeCreateAnswerPostModal(){this.postFooterComponent()?.closeCreateAnswerPostModal()}sortAnswerPosts(){if(!this.posting.answers){this.sortedAnswerPosts=[];return}this.sortedAnswerPosts=this.posting.answers.sort((d,e)=>Number(e.resolvesPost)-Number(d.resolvesPost)||d.creationDate.valueOf()-e.creationDate.valueOf())}onChannelReferenceClicked(d){let e=this.metisService.getCourse();nt(e)&&(this.isCommunicationPage?this.metisConversationService.setActiveConversation(d):this.router.navigate(["courses",e.id,"communication"],{queryParams:{conversationId:d}}))}assignPostingToPost(){this.posting&&!(this.posting instanceof pt)&&(this.posting=Object.assign(new pt,this.posting))}onTriggerNavigateToPost(d){this.onNavigateToPost.emit(d)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=k({type:o,selectors:[["jhi-post"]],viewQuery:function(e,i){e&1&&(K(i.postFooterComponent,ys,5),K(i.reactionsBarComponent,Oe,5)),e&2&&oe(2)},hostBindings:function(e,i){e&1&&h("click",function(s){return i.onClickOutside(s)},!1,Ne)},inputs:{lastReadDate:[1,"lastReadDate"],readOnlyMode:[1,"readOnlyMode"],previewMode:[1,"previewMode"],modalRef:[1,"modalRef"],showAnswers:[1,"showAnswers"],isConsecutive:[1,"isConsecutive"],forwardedPosts:[1,"forwardedPosts"],forwardedAnswerPosts:[1,"forwardedAnswerPosts"]},outputs:{showAnswers:"showAnswersChange",openThread:"openThread",onNavigateToPost:"onNavigateToPost"},features:[J,I],decls:31,vars:37,consts:[["postFooter",""],["emojiPickerTrigger","cdkOverlayOrigin"],[1,"post","hover-container",3,"ngClass"],[1,"align-items-center"],[1,"post-context-information-wrap","post-content-padding",3,"ngClass"],[3,"openThread","userReferenceClicked","channelReferenceClicked","readOnlyMode","modalRef","previewMode","posting","showAnswers","isCommunicationPage","isThreadSidebar","sortedAnswerPosts","lastReadDate","hasChannelModerationRights"],["cdkOverlayOrigin","",3,"ngStyle"],["cdkConnectedOverlay","",3,"backdropClick","cdkConnectedOverlayHasBackdrop","cdkConnectedOverlayBackdropClass","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen"],[1,"post-is-saved-message","post-content-padding","fs-xx-small","py-1",3,"ngClass"],[1,"post-is-saved-message-content"],[3,"icon"],["jhiTranslate","artemisApp.metis.post.saved",1,"text-secondary"],[1,"post-time","fs-small",3,"ngbTooltip"],[1,"ps-3"],[3,"isModalOpen","onUserNameClicked","previewMode","readOnlyMode","posting","isDeleted","isCommunicationPage","lastReadDate"],["iconSize","xs",1,"pe-0","ms-1","announcement-icon",3,"icon","ngbTooltip"],["routerLinkActive","active",1,"linked-context-information","ms-1",3,"click","routerLink","queryParams"],[1,"context-information","ms-1"],[1,"post-title","ms-1"],[1,"message-container","post-content-padding",3,"contextmenu","ngClass"],[1,"message-content",3,"ngClass"],[3,"onUndoDeleteEvent","userReferenceClicked","channelReferenceClicked","previewMode","content","author","isEdited","posting","isReply","isDeleted","deleteTimerInSeconds"],[1,"hover-actions",3,"ngClass"],[3,"onNavigateToPost","originalPostDetails"],[3,"showAnswersChange","openPostingCreateEditModal","openThread","isModalOpen","mayEditOutput","mayDeleteOutput","canPinOutput","isDeleteEvent","onBookmarkClicked","lastReadDate","isReadOnlyMode","previewMode","course","posting","showAnswers","sortedAnswerPosts","isCommunicationPage","isThreadSidebar","originalPostDetails"],[1,"post-content-padding"],[3,"isModalOpen","posting"],[1,"post-content-padding","justify-content-between","post-reactions-bar",3,"ngClass"],[3,"showAnswersChange","openPostingCreateEditModal","closePostingCreateEditModal","openThread","isModalOpen","onBookmarkClicked","lastReadDate","isReadOnlyMode","previewMode","posting","showAnswers","sortedAnswerPosts","isCommunicationPage","isThreadSidebar","isEmojiCount","hoverBar"],[1,"dropdown-menu","show",3,"ngStyle"],[1,"dropdown-item","d-flex",3,"click"],[1,"item-icon",3,"icon"],["jhiTranslate","artemisApp.metis.post.addReaction"],["jhiTranslate","artemisApp.metis.post.replyMessage"],[3,"jhiTranslate"],[1,"dropdown-item","d-flex","forward",3,"click"],["jhiTranslate","artemisApp.metis.post.forwardMessage"],[1,"dropdown-item","d-flex","editIcon",3,"click"],["jhiTranslate","artemisApp.metis.post.editMessage"],[1,"dropdown-item","d-flex","deleteIcon",3,"click"],["jhiTranslate","artemisApp.metis.post.deleteMessage"],[3,"emojiSelect"]],template:function(e,i){if(e&1){let n=P();a(0,"div",2),t(1,`
    `),x(2,Os,11,4)(3,Ss,6,8)(4,As,6,6),a(5,"div",3),t(6,`
        `),a(7,"div"),t(8,`
            `),a(9,"div",4),t(10,`
                `),x(11,Es,4,4)(12,Ds,6,2)(13,Fs,5,1),l(),t(14,`
            `),x(15,Bs,14,21),l(),t(16,`
    `),l(),t(17,`
    `),x(18,Ns,6,1)(19,Hs,6,5),l(),t(20,`
`),a(21,"jhi-posting-footer",5,0),h("openThread",function(){return m(n),u(i.openThread.emit())})("userReferenceClicked",function(_){return m(n),u(i.onUserReferenceClicked(_))})("channelReferenceClicked",function(_){return m(n),u(i.onChannelReferenceClicked(_))}),l(),t(23,`

`),t(24,`
`),x(25,qs,35,12),g(26,"div",6,1),t(28,`

`),x(29,$s,2,1,"ng-template",7),h("backdropClick",function(){return m(n),u(i.toggleEmojiSelect())}),t(30,`
`)}if(e&2){let n=G(27);p("ngClass",Mn(27,Ts,!i.isThreadSidebar,i.isPinned(),!i.isConsecutive()&&i.posting.isSaved,!i.isConsecutive())),r(2),f(i.posting.isSaved?2:-1),r(),f(i.isConsecutive()?3:-1),r(),f(i.isConsecutive()?-1:4),r(5),p("ngClass",E(32,_n,i.isConsecutive()&&i.posting.isSaved)),r(2),f(i.showAnnouncementIcon?11:-1),r(),f(i.showChannelReference&&(i.pageType===i.PageType.OVERVIEW||i.previewMode())&&i.contextInformation.displayName!==""?12:-1),r(),f(i.pageType!==i.PageType.PLAGIARISM_CASE_INSTRUCTOR&&i.pageType!==i.PageType.PLAGIARISM_CASE_STUDENT?13:-1),r(2),f(i.displayInlineInput?-1:15),r(3),f(!i.isDeleted&&i.displayInlineInput&&!i.readOnlyMode()?18:-1),r(),f(i.isDeleted?-1:19),r(2),p("readOnlyMode",i.readOnlyMode())("modalRef",i.modalRef())("previewMode",i.previewMode()||i.pageType===i.PageType.PLAGIARISM_CASE_STUDENT)("posting",i.posting)("showAnswers",i.showAnswers())("isCommunicationPage",i.isCommunicationPage)("isThreadSidebar",i.isThreadSidebar)("sortedAnswerPosts",i.sortedAnswerPosts)("lastReadDate",i.lastReadDate())("hasChannelModerationRights",i.hasChannelModerationRights),r(4),f(i.showDropdown?25:-1),r(),p("ngStyle",ue(34,uo,i.clickPosition.y,i.clickPosition.x)),r(3),p("cdkConnectedOverlayHasBackdrop",!0)("cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop")("cdkConnectedOverlayOrigin",n)("cdkConnectedOverlayOpen",i.showReactionSelector)}},dependencies:[W,z,j,ae,tn,In,bt,ce,Oe,co,lo,Ce,ot,rt,at,Te,V,po],styles:[".post-result-information[_ngcontent-%COMP%]{font-size:small;font-style:italic}.post-separation-line[_ngcontent-%COMP%]{height:1px;background:var(--metis-light-gray)}.bold-line[_ngcontent-%COMP%]{height:2px;background:var(--metis-light-gray)}.icon[_ngcontent-%COMP%]{color:var(--metis-gray)}.resolved[_ngcontent-%COMP%]{color:var(--metis-green)}.post-header-author-date[_ngcontent-%COMP%]{line-height:1.1}.post-content-padding[_ngcontent-%COMP%]{padding-left:3.42rem}.post-authority-icon-student[_ngcontent-%COMP%]{display:none}.reference[_ngcontent-%COMP%]{font-weight:200;display:inline-flex}.hideAfter5Seconds[_ngcontent-%COMP%]{-webkit-animation:_ngcontent-%COMP%_cssAnimation 5s forwards;animation:_ngcontent-%COMP%_cssAnimation 5s forwards}@keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}@-webkit-keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}.card[_ngcontent-%COMP%]{border-radius:.25em}@media (max-width: 575.98px){.post-header-author-date[_ngcontent-%COMP%]{flex-direction:column;gap:0!important}.post-content-padding[_ngcontent-%COMP%]{margin-left:0}.post-header-date-separator[_ngcontent-%COMP%]{display:none}.post-header-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6c757d;font-size:.75rem!important}}.post-delete-button-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;z-index:0;background-color:#0d6efd4d;animation:_ngcontent-%COMP%_increaseWidth 6s forwards linear}@media (prefers-reduced-motion){.post-delete-button-background[_ngcontent-%COMP%]{animation:none}}.post-delete-button-label[_ngcontent-%COMP%]{position:relative;z-index:1}@keyframes _ngcontent-%COMP%_increaseWidth{0%{width:0}to{width:100%}}.linked-context-information[_ngcontent-%COMP%], .context-information[_ngcontent-%COMP%], .post-title[_ngcontent-%COMP%]{font-weight:600;color:var(--metis-blue)}.announcement-icon[_ngcontent-%COMP%]{color:var(--metis-blue)}.reference-hash[_ngcontent-%COMP%]{color:inherit}.hover-actions[_ngcontent-%COMP%]{position:absolute;top:-1.8rem;right:1%;display:flex;max-height:2.2rem;gap:10px;visibility:hidden;transition:opacity .2s ease-in-out,visibility .2s ease-in-out;background:var(--metis-selection-option-background);padding:5px;border-radius:5px;border:.01rem solid var(--metis-gray)}.hover-container[_ngcontent-%COMP%]{position:relative}.non-consecutive[_ngcontent-%COMP%]   .hover-actions[_ngcontent-%COMP%]{top:-2rem}.hover-container[_ngcontent-%COMP%]:hover{background:var(--metis-selection-option-hover-background);transition:background-color .2s ease-in-out}.hover-container[_ngcontent-%COMP%]:hover   .hover-actions[_ngcontent-%COMP%]{visibility:visible;opacity:1}.message-container[_ngcontent-%COMP%]{position:relative}.post-is-saved-message[_ngcontent-%COMP%], .message-container[_ngcontent-%COMP%], .post-reactions-bar[_ngcontent-%COMP%], .post-context-information-wrap[_ngcontent-%COMP%], .post[_ngcontent-%COMP%]{background-color:transparent;transition:background-color .2s ease-in-out}.post-is-saved-message.is-saved[_ngcontent-%COMP%], .message-container.is-saved[_ngcontent-%COMP%], .post-reactions-bar.is-saved[_ngcontent-%COMP%], .post-context-information-wrap.is-saved[_ngcontent-%COMP%], .post.is-saved[_ngcontent-%COMP%]{background-color:#0d6efd1a}.message-content[_ngcontent-%COMP%], .post-is-saved-message-content[_ngcontent-%COMP%]{padding-left:.25rem}.clickable[_ngcontent-%COMP%]{cursor:pointer}.item-icon[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:.2rem}.pinned-message[_ngcontent-%COMP%]{background-color:var(--artemis-alert-warning-background)}.post-time[_ngcontent-%COMP%]{position:absolute;top:5%;left:.5rem;margin-left:.7rem;visibility:hidden;opacity:0;transition:visibility .2s ease-in-out,opacity .2s ease-in-out;font-size:.75rem;color:var(--metis-gray-dark)}.hover-container[_ngcontent-%COMP%]:hover   .post-time[_ngcontent-%COMP%]{visibility:visible;opacity:1}",".post-result-information[_ngcontent-%COMP%]{font-size:small;font-style:italic}.post-separation-line[_ngcontent-%COMP%]{height:1px;background:var(--metis-light-gray)}.bold-line[_ngcontent-%COMP%]{height:2px;background:var(--metis-light-gray)}.icon[_ngcontent-%COMP%]{color:var(--metis-gray)}.resolved[_ngcontent-%COMP%]{color:var(--metis-green)}.post-header-author-date[_ngcontent-%COMP%]{line-height:1.1}.post-content-padding[_ngcontent-%COMP%]{padding-left:3.42rem}.post-authority-icon-student[_ngcontent-%COMP%]{display:none}.reference[_ngcontent-%COMP%]{font-weight:200;display:inline-flex}.hideAfter5Seconds[_ngcontent-%COMP%]{-webkit-animation:_ngcontent-%COMP%_cssAnimation 5s forwards;animation:_ngcontent-%COMP%_cssAnimation 5s forwards}@keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}@-webkit-keyframes _ngcontent-%COMP%_cssAnimation{0%{opacity:1}90%{opacity:1}to{opacity:0}}.card[_ngcontent-%COMP%]{border-radius:.25em}@media (max-width: 575.98px){.post-header-author-date[_ngcontent-%COMP%]{flex-direction:column;gap:0!important}.post-content-padding[_ngcontent-%COMP%]{margin-left:0}.post-header-date-separator[_ngcontent-%COMP%]{display:none}.post-header-date[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6c757d;font-size:.75rem!important}}.post-delete-button-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;z-index:0;background-color:#0d6efd4d;animation:_ngcontent-%COMP%_increaseWidth 6s forwards linear}@media (prefers-reduced-motion){.post-delete-button-background[_ngcontent-%COMP%]{animation:none}}.post-delete-button-label[_ngcontent-%COMP%]{position:relative;z-index:1}@keyframes _ngcontent-%COMP%_increaseWidth{0%{width:0}to{width:100%}}"],data:{animation:[Tt("fade",[$e(":enter",[xe({opacity:0}),Qe("300ms ease-in",xe({opacity:1}))]),$e(":leave",[Qe("300ms ease-out",xe({opacity:0}))])])]},changeDetection:0})};export{Xt as a,$t as b,Kt as c,ce as d,ct as e,en as f,Yi as g,co as h,mo as i};
//# sourceMappingURL=chunk-JZSZQ37X.js.map
