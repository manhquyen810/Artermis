import{f as j,g as L}from"./chunk-OPXCTAUV.js";import{K as D,L as I,c as v,h as V,m as _,w as k,x as E,z}from"./chunk-WA5GEAJB.js";import{a as O}from"./chunk-U54OSGNH.js";import{O as x}from"./chunk-IOA4DPXY.js";import{Db as d,Ea as w,Mc as g,Tb as c,U as A,Va as f,dd as n,f as F,fd as M,kc as u,ld as h,md as y,nd as C,vc as b,wc as T,xc as o,ya as S,yc as a,zc as p}from"./chunk-5LC5EQRR.js";var P=(()=>{class r{knowledgeAreaFilter;competencyTitleFilter="";knowledgeAreasForSelect=[];knowledgeAreaMap=new Map;dataSource=new L;treeControl=new j(e=>e.children);filterByKnowledgeArea(e,t=!0){if(e?.id===this.knowledgeAreaFilter?.id&&!t)return;this.knowledgeAreaFilter=e;let i=this.getKnowledgeAreaByIdIfExists(this.knowledgeAreaFilter?.id);i?(this.setVisibilityOfAllKnowledgeAreas(!1),this.setVisibilityOfSelfAndDescendants(i,!0),this.setVisibleAndExpandSelfAndAncestors(i)):this.setVisibilityOfAllKnowledgeAreas(!0)}filterByCompetencyTitle(e){if(e===this.competencyTitleFilter)return;this.competencyTitleFilter=e;let t=this.competencyTitleFilter?.trim();t?(this.treeControl.collapseAll(),this.dataSource.data.forEach(i=>this.filterCompetenciesForSelfAndChildren(i,t))):this.setVisibilityOfAllCompetencies(!0)}filterCompetenciesForSelfAndChildren(e,t){let i=!1;for(let l of e.competencies??[])this.competencyMatchesFilter(l,t)?(i=!0,l.isVisible=!0):l.isVisible=!1;for(let l of e.children??[])this.filterCompetenciesForSelfAndChildren(l,t)&&(i=!0);return i&&this.treeControl.expand(e),i}competencyMatchesFilter(e,t){if(!e.title)return!1;let i=e.title.toLowerCase(),l=t.toLowerCase();return i.includes(l)}setVisibleAndExpandSelfAndAncestors(e){e.isVisible=!0,this.treeControl.expand(e);let t=this.getKnowledgeAreaByIdIfExists(e.parentId);t&&this.setVisibleAndExpandSelfAndAncestors(t)}setVisibilityOfSelfAndDescendants(e,t){e.isVisible=!0,e.children?.forEach(i=>this.setVisibilityOfSelfAndDescendants(i,t))}setVisibilityOfAllKnowledgeAreas(e){this.knowledgeAreaMap.forEach(t=>t.isVisible=e)}setVisibilityOfAllCompetencies(e){for(let t of this.knowledgeAreaMap.values())t.competencies?.forEach(i=>i.isVisible=e)}getKnowledgeAreaByIdIfExists(e){if(e!==void 0)return this.knowledgeAreaMap.get(e)}addSelfAndDescendantsToMap(e){e.id!==void 0&&this.knowledgeAreaMap.set(e.id,e);for(let t of e.children??[])this.addSelfAndDescendantsToMap(t)}addSelfAndDescendantsToSelectArray(e){this.knowledgeAreasForSelect.push({id:e.id,title:"\xA0".repeat(e.level*2)+e.title});for(let t of e.children??[])this.addSelfAndDescendantsToSelectArray(t)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=c({type:r,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,i){},encapsulation:2})}return r})();var G=(()=>{class r{httpClient=w(x);resourceURL="api/atlas/standardized-competencies";getStandardizedCompetency(e){return this.httpClient.get(`${this.resourceURL}/${e}`,{observe:"response"})}getAllForTreeView(){return this.httpClient.get(`${this.resourceURL}/for-tree-view`,{observe:"response"})}getSources(){return this.httpClient.get(`${this.resourceURL}/sources`,{observe:"response"})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=S({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var B=(r,m)=>m.id;function N(r,m){if(r&1&&(n(0,`
                    `),o(1,"option",9),n(2),a(),n(3,`
                `)),r&2){let e=m.$implicit;d(),u("ngValue",e),d(),M(`
                        `,e.title,`
                    `)}}var re=(()=>{class r{competencyTitleFilter;knowledgeAreaFilter;knowledgeAreasForSelect=[];competencyTitleFilterChange=new f;knowledgeAreaFilterChange=new f;titleFilterSubject=new F;ngOnInit(){this.titleFilterSubject.pipe(A(500)).subscribe(()=>this.competencyTitleFilterChange.emit(this.competencyTitleFilter))}ngOnDestroy(){this.titleFilterSubject.unsubscribe()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=c({type:r,selectors:[["jhi-standardized-competency-filter"]],inputs:{competencyTitleFilter:"competencyTitleFilter",knowledgeAreaFilter:"knowledgeAreaFilter",knowledgeAreasForSelect:"knowledgeAreasForSelect"},outputs:{competencyTitleFilterChange:"competencyTitleFilterChange",knowledgeAreaFilterChange:"knowledgeAreaFilterChange"},decls:31,vars:3,consts:[[1,"card"],[1,"card-header"],["jhiTranslate","artemisApp.standardizedCompetency.manage.filter",1,"mb-0"],[1,"card-body","row","pb-0"],[1,"form-group","col"],["for","title-filter","jhiTranslate","artemisApp.standardizedCompetency.model.title"],["id","title-filter",1,"form-control",3,"ngModelChange","input","ngModel"],["for","knowledge-area-filter","jhiTranslate","artemisApp.standardizedCompetency.model.knowledgeArea"],["id","knowledge-area-filter",1,"form-select",3,"ngModelChange","ngModel"],[3,"ngValue"]],template:function(t,i){t&1&&(o(0,"div",0),n(1,`
    `),o(2,"div",1),n(3,`
        `),p(4,"h5",2),n(5,`
    `),a(),n(6,`
    `),o(7,"div",3),n(8,`
        `),o(9,"div",4),n(10,`
            `),o(11,"label",5),n(12," "),a(),n(13,`
            `),o(14,"input",6),C("ngModelChange",function(s){return y(i.competencyTitleFilter,s)||(i.competencyTitleFilter=s),s}),g("input",function(){return i.titleFilterSubject.next()}),a(),n(15,`
        `),a(),n(16,`
        `),o(17,"div",4),n(18,`
            `),p(19,"label",7),n(20,`
            `),o(21,"select",8),C("ngModelChange",function(s){return y(i.knowledgeAreaFilter,s)||(i.knowledgeAreaFilter=s),s}),g("ngModelChange",function(){return i.knowledgeAreaFilterChange.emit(i.knowledgeAreaFilter)}),n(22,`
                `),p(23,"option",9),n(24,`
                `),b(25,N,4,2,null,null,B),a(),n(27,`
        `),a(),n(28,`
    `),a(),n(29,`
`),a(),n(30,`
`)),t&2&&(d(14),h("ngModel",i.competencyTitleFilter),d(7),h("ngModel",i.knowledgeAreaFilter),d(2),u("ngValue",void 0),d(2),T(i.knowledgeAreasForSelect))},dependencies:[D,E,z,v,k,V,_,I,O],encapsulation:2})}return r})();export{P as a,G as b,re as c};
//# sourceMappingURL=chunk-E7BX3X6N.js.map
