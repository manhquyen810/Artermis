import{a as pe}from"./chunk-BCAUGGBR.js";import{a as xe}from"./chunk-UQAVYGM7.js";import"./chunk-HUX6AUUW.js";import"./chunk-PR2Y3QVB.js";import{a as de}from"./chunk-KOWVADWF.js";import{a as W}from"./chunk-GAUWMTOK.js";import"./chunk-VPHPBAVR.js";import{a as ce}from"./chunk-G4HSJ7ME.js";import{c as oe,d as se,e as re,f as le,g as me}from"./chunk-F3NFBBHK.js";import"./chunk-OTCBNILH.js";import{a as ae}from"./chunk-BIK4CL5A.js";import{d as te}from"./chunk-AR57MWOI.js";import"./chunk-A5PTZAPN.js";import"./chunk-AU6UEH3U.js";import"./chunk-FGAONQTL.js";import"./chunk-HQ6UGNQX.js";import"./chunk-ZLJ76G5I.js";import"./chunk-MLVGKM2P.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import{c as ee}from"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import"./chunk-CT44YL7Q.js";import{c as ie}from"./chunk-JNO6DNVW.js";import"./chunk-5YQ3ACZE.js";import{b as Z}from"./chunk-EELXLOHY.js";import{G as U,K as $,v as N}from"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import"./chunk-WA5GEAJB.js";import{m as ne}from"./chunk-VK7JPHFE.js";import{c as X}from"./chunk-BNDLMKXK.js";import"./chunk-BQNBT6PW.js";import"./chunk-5GXY5RYT.js";import{a as T}from"./chunk-K3W6YFKH.js";import{c as Y}from"./chunk-JXJXC4DZ.js";import{d as I}from"./chunk-EDXSOKK5.js";import{b as Q}from"./chunk-R5BZWVRQ.js";import{p as v}from"./chunk-DID2YGL7.js";import"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Ba as q,Ob as J,wd as y}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import"./chunk-HKBU2OOC.js";import{a as K}from"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as L}from"./chunk-U54OSGNH.js";import{f as z,i as G}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import"./chunk-IOA4DPXY.js";import{Db as i,Dc as E,Ea as g,Ma as _,Mc as u,Na as h,Oc as c,Rc as F,Sc as M,Tb as k,Uc as D,Zb as d,dd as t,ed as w,fd as R,gd as P,id as B,kc as p,qd as H,ra as j,sc as x,td as O,xc as s,yc as r,yd as f,zc as l,zd as S}from"./chunk-5LC5EQRR.js";import"./chunk-3E746U5Y.js";function Ee(n,o){if(n&1&&(t(0,`
        `),s(1,"div",1),t(2,`
            `),l(3,"fa-icon",2),t(4,`
            `),l(5,"span",3),t(6,`
        `),r(),t(7,`
    `)),n&2){let e=c();i(3),p("icon",e.faInfoCircle)}}function fe(n,o){if(n&1&&(t(0,`
            `),s(1,"div",4),t(2,`
                `),l(3,"fa-icon",5),f(4,"artemisTranslate"),t(5,`
                `),l(6,"span",6),t(7,`
            `),r(),t(8,`
        `)),n&2){let e=c(2);i(3),p("icon",e.faExclamationTriangle)("ngbTooltip",S(4,2,"artemisApp.studentExams.studentExamStatusWarningTooltip"))}}function Se(n,o){if(n&1&&(t(0,`
            `),s(1,"div",7),t(2,`
                `),l(3,"fa-icon",2),t(4,`
                `),l(5,"span",8),t(6,`
            `),r(),t(7,`
        `)),n&2){let e=c(2);i(3),p("icon",e.faCheckCircle)}}function Ce(n,o){if(n&1&&(t(0,`
        `),d(1,fe,9,4)(2,Se,8,1)),n&2){let e=c();i(),x(e.hasStudentsWithoutExam?1:2)}}var ue=(()=>{class n{hasStudentsWithoutExam;isTestExam;faExclamationTriangle=y;faCheckCircle=q;faInfoCircle=J;static \u0275fac=function(a){return new(a||n)};static \u0275cmp=k({type:n,selectors:[["jhi-student-exam-status"]],inputs:{hasStudentsWithoutExam:"hasStudentsWithoutExam",isTestExam:"isTestExam"},decls:5,vars:1,consts:[[1,"d-flex","mt-0","mb-0"],[1,"d-flex","badge","bg-info"],[1,"me-1","text-white",3,"icon"],["jhiTranslate","artemisApp.studentExams.studentExamStatusTestExam",1,"ms-1"],[1,"d-flex","badge","bg-warning"],[1,"me-1","text-white",3,"icon","ngbTooltip"],["jhiTranslate","artemisApp.studentExams.studentExamStatusWarning",1,"ms-1"],[1,"d-flex","badge","bg-success"],["jhiTranslate","artemisApp.studentExams.studentExamStatusSuccess",1,"ms-1"]],template:function(a,m){a&1&&(s(0,"h5",0),t(1,`
    `),d(2,Ee,8,1)(3,Ce,3,1),r(),t(4,`
`)),a&2&&(i(2),x(m.isTestExam?2:3))},dependencies:[I,L,$,T],encapsulation:2})}return n})();var be=()=>["user.login","user.name"],ve=(n,o,e)=>["/course-management",n,"exams",o,"student-exams",e];function Te(n,o){n&1&&(t(0,`
                        `),l(1,"span",9),t(2,`
                    `))}function Ae(n,o){n&1&&(t(0,`
                        `),l(1,"span",9),t(2,`
                    `))}function ke(n,o){n&1&&(t(0,`
                        `),l(1,"span",9),t(2,`
                    `))}function we(n,o){if(n&1){let e=E();t(0,`
                `),s(1,"button",3),u("click",function(){_(e);let m=c(2);return h(m.handleGenerateStudentExams())}),t(2,`
                    `),d(3,Te,3,0),l(4,"span",4),t(5,`
                `),r(),t(6,`
                `),s(7,"button",5),u("click",function(){_(e);let m=c(2);return h(m.generateMissingStudentExams())}),t(8,`
                    `),d(9,Ae,3,0),l(10,"span",6),t(11,`
                `),r(),t(12,`
                `),s(13,"button",7),u("click",function(){_(e);let m=c(2);return h(m.startExercises())}),t(14,`
                    `),d(15,ke,3,0),l(16,"span",8),t(17,`
                `),r(),t(18,`
            `)}if(n&2){let e=c(2);i(),p("disabled",e.isLoading||e.isExamStarted),i(2),x(e.isLoading?3:-1),i(4),p("disabled",e.isLoading||!e.hasStudentsWithoutExam||e.isExamStarted),i(2),x(e.isLoading?9:-1),i(4),p("disabled",e.isLoading||e.isExamStarted||e.exercisePreparationRunning),i(2),x(e.isLoading?15:-1)}}function Pe(n,o){if(n&1&&(t(0,`
            `),d(1,we,19,6)),n&2){let e=c();i(),x(e.course!=null&&e.course.isAtLeastInstructor?1:-1)}}function ye(n,o){n&1&&(t(0,`
                    `),l(1,"span",9),t(2,`
                `))}function Ie(n,o){n&1&&(t(0,`
                    `),l(1,"span",9),t(2,`
                `))}function Le(n,o){if(n&1){let e=E();t(0,`
            `),s(1,"button",10),u("click",function(){_(e);let m=c();return h(m.handleUnlockAllRepositories())}),t(2,`
                `),d(3,ye,3,0),l(4,"fa-icon",11),t(5,`
                `),l(6,"span",12),t(7,`
            `),r(),t(8,`
            `),s(9,"button",13),u("click",function(){_(e);let m=c();return h(m.handleLockAllRepositories())}),t(10,`
                `),d(11,Ie,3,0),l(12,"fa-icon",11),t(13,`
                `),l(14,"span",14),t(15,`
            `),r(),t(16,`
        `)}if(n&2){let e=c();i(),p("disabled",e.isLoading),i(2),x(e.isLoading?3:-1),i(),p("icon",e.faExclamationTriangle),i(5),p("disabled",e.isLoading),i(2),x(e.isLoading?11:-1),i(),p("icon",e.faExclamationTriangle)}}function We(n,o){if(n&1&&(t(0,`
            `),l(1,"jhi-student-exam-status",15),t(2,`
        `)),n&2){let e=c();i(),p("isTestExam",e.isTestExam)("hasStudentsWithoutExam",e.hasStudentsWithoutExam)}}function Fe(n,o){if(n&1&&(t(0,`
                            `),s(1,"span"),t(2),f(3,"artemisTranslate"),r(),t(4,`
                        `)),n&2){let e=c(2);i(2),P(" (",e.exercisePreparationStatus.failed," ",S(3,2,"artemisApp.studentExams.exercisePreparationProgress.failed"),") ")}}function Re(n,o){if(n&1&&(t(0,`
                            `),s(1,"span"),t(2),f(3,"artemisTranslate"),r(),t(4,`
                        `)),n&2){let e=c(2);i(2),P(`
                                `,e.exercisePreparationStatus.participationCount," ",S(3,2,"artemisApp.studentExams.exercisePreparationProgress.participations"),` |
                            `)}}function Ve(n,o){if(n&1&&(t(0,`
                            `),s(1,"span"),t(2),f(3,"artemisTranslate"),r(),t(4,`
                        `)),n&2){let e=c(2);i(2),P("",e.exercisePreparationEta," ",S(3,2,"artemisApp.studentExams.exercisePreparationProgress.remaining"),"")}}function je(n,o){n&1&&(t(0,`
                            `),l(1,"span",22),t(2,`
                        `))}function Me(n,o){n&1&&(t(0,`
                            `),l(1,"span",23),t(2,`
                        `))}function De(n,o){if(n&1&&(t(0,`
            `),s(1,"div",16),t(2,`
                `),l(3,"div",17),t(4,`
                `),s(5,"div",18),t(6,`
                    `),s(7,"div",19),t(8,`
                        `),l(9,"ngb-progressbar",20),t(10,`
                    `),r(),t(11,`
                    `),s(12,"div",21),t(13,`
                        `),s(14,"span"),t(15),f(16,"artemisTranslate"),r(),t(17,`
                        `),d(18,Fe,5,4),t(19,`
                        |
                        `),d(20,Re,5,4)(21,Ve,5,4)(22,je,3,0)(23,Me,3,0),r(),t(24,`
                `),r(),t(25,`
            `),r(),t(26,`
        `)),n&2){let e=c();i(9),p("value",e.exercisePreparationStatus.finished)("max",e.exercisePreparationStatus.overall?e.exercisePreparationStatus.overall-e.exercisePreparationStatus.failed:0)("animated",!0)("height","2em"),i(6),B("",e.exercisePreparationPercentage,"% ",e.exercisePreparationStatus.finished," / ",e.exercisePreparationStatus.overall,`
                            `,S(16,13,"artemisApp.studentExams.exercisePreparationProgress.exams"),""),i(3),x(e.exercisePreparationStatus.failed?18:-1),i(2),x(e.exercisePreparationStatus.participationCount?20:-1),i(),x(e.exercisePreparationEta?21:-1),i(),x(!e.exercisePreparationEta&&e.exercisePreparationPercentage===100?22:-1),i(),x(!e.exercisePreparationEta&&e.exercisePreparationPercentage<100?23:-1)}}function Be(n,o){if(n&1){let e=E();t(0,`
                    `),s(1,"span",35),u("click",function(){_(e);let m=c().controls;return h(m.onSort("id"))}),t(2,`
                        `),l(3,"span",36),t(4,`
                        `),l(5,"fa-icon",37),t(6,`
                    `),r(),t(7,`
                `)}if(n&2){let e=c().controls;i(5),p("icon",e.iconForSortPropField("id"))}}function He(n,o){if(n&1&&(t(0,`
                    `),s(1,"div"),t(2,`
                        `),s(3,"a",38),t(4),r(),t(5,`
                    `),r(),t(6,`
                `)),n&2){let e=o.value,a=c(2);i(3),D("routerLink","/course-management/",a.courseId,"/exams/",a.examId,"/student-exams/",e,""),i(),w(e)}}function Oe(n,o){if(n&1){let e=E();t(0,`
                    `),s(1,"span",39),u("click",function(){_(e);let m=c().controls;return h(m.onSort("user.name"))}),t(2,`
                        `),l(3,"span",40),t(4,`
                        `),l(5,"fa-icon",37),t(6,`
                    `),r(),t(7,`
                `)}if(n&2){let e=c().controls;i(5),p("icon",e.iconForSortPropField("user.name"))}}function ze(n,o){if(n&1&&(t(0,`
                        `),s(1,"a",38),t(2),r(),t(3,`
                    `)),n&2){let e=c().value;i(),M("routerLink","/admin/user-management/",e==null?null:e.login,""),i(),w(e==null?null:e.name)}}function Ge(n,o){if(n&1&&t(0),n&2){let e=c().value;R(`
                        `,e==null?null:e.name,`
                    `)}}function Ne(n,o){if(n&1&&(t(0,`
                    `),d(1,ze,4,3)(2,Ge,1,1)),n&2){let e=c(2);i(),x(e.isAdmin?1:2)}}function Ue(n,o){n&1&&(t(0,`
                            `),l(1,"span",41),t(2,`
                        `))}function $e(n,o){n&1&&(t(0,`
                            `),l(1,"span",42),t(2,`
                        `))}function Ke(n,o){if(n&1){let e=E();t(0,`
                    `),s(1,"span",35),u("click",function(){_(e);let m=c().controls;return h(m.onSort("workingTime"))}),t(2,`
                        `),d(3,Ue,3,0)(4,$e,3,0),l(5,"fa-icon",37),t(6,`
                    `),r(),t(7,`
                `)}if(n&2){let e=c().controls,a=c();i(3),x(a.isTestExam?-1:3),i(),x(a.isTestExam?4:-1),i(),p("icon",e.iconForSortPropField("workingTime"))}}function qe(n,o){if(n&1&&(t(0,`
                        `),l(1,"jhi-test-exam-working-time",43),t(2,`
                    `)),n&2){let e=c().row;i(),p("studentExam",e)}}function Je(n,o){if(n&1&&(t(0,`
                        `),l(1,"jhi-student-exam-working-time",43),t(2,`
                    `)),n&2){let e=c().row;i(),p("studentExam",e)}}function Qe(n,o){if(n&1&&(t(0,`
                    `),d(1,qe,3,1)(2,Je,3,1)),n&2){let e=c(2);i(),x(e.isTestExam?1:-1),i(),x(e.isTestExam?-1:2)}}function Xe(n,o){if(n&1){let e=E();t(0,`
                    `),s(1,"span",35),u("click",function(){_(e);let m=c().controls;return h(m.onSort("started"))}),t(2,`
                        `),l(3,"span",44),t(4,`
                        `),l(5,"fa-icon",37),t(6,`
                    `),r(),t(7,`
                `)}if(n&2){let e=c().controls;i(5),p("icon",e.iconForSortPropField("started"))}}function Ye(n,o){if(n&1&&(t(0,`
                    `),l(1,"span",45),t(2,`
                `)),n&2){let e=o.value;i(),F("jhiTranslate",e?"global.generic.yes":"global.generic.no")}}function Ze(n,o){if(n&1){let e=E();t(0,`
                    `),s(1,"span",35),u("click",function(){_(e);let m=c().controls;return h(m.onSort("submitted"))}),t(2,`
                        `),l(3,"span",46),t(4,`
                        `),l(5,"fa-icon",37),t(6,`
                    `),r(),t(7,`
                `)}if(n&2){let e=c().controls;i(5),p("icon",e.iconForSortPropField("submitted"))}}function et(n,o){if(n&1&&(t(0,`
                    `),l(1,"span",47),t(2,`
                `)),n&2){let e=o.value;i(),F("jhiTranslate",e?"global.generic.yes":"global.generic.no")}}function tt(n,o){if(n&1){let e=E();t(0,`
                    `),s(1,"span",35),u("click",function(){_(e);let m=c().controls;return h(m.onSort("submissionDate"))}),t(2,`
                        `),l(3,"span",48),t(4,`
                        `),l(5,"fa-icon",37),t(6,`
                    `),r(),t(7,`
                `)}if(n&2){let e=c().controls;i(5),p("icon",e.iconForSortPropField("submissionDate"))}}function nt(n,o){if(n&1&&(t(0,`
                    `),s(1,"span"),t(2),f(3,"artemisDate"),r(),t(4,`
                `)),n&2){let e=o.value;i(2),w(S(3,1,e))}}function it(n,o){if(n&1){let e=E();t(0,`
                    `),s(1,"span",35),u("click",function(){_(e);let m=c().controls;return h(m.onSort("numberOfExamSessions"))}),t(2,`
                        `),l(3,"span",49),t(4,`
                        `),l(5,"fa-icon",37),t(6,`
                    `),r(),t(7,`
                `)}if(n&2){let e=c().controls;i(5),p("icon",e.iconForSortPropField("numberOfExamSessions"))}}function at(n,o){if(n&1&&(t(0,`
                    `),s(1,"span"),t(2),r(),t(3,`
                `)),n&2){let e=o.value;i(2),R(" ",e," ")}}function ot(n,o){if(n&1&&(t(0,`
                            `),s(1,"div",51),t(2,`
                                `),s(3,"a",52),t(4,`
                                    `),l(5,"span",53),t(6,`
                                `),r(),t(7,`
                            `),r(),t(8,`
                        `)),n&2){let e=c().value,a=c(2);i(3),p("routerLink",O(1,ve,a.courseId,a.examId,e==null?null:e.id))}}function st(n,o){if(n&1&&(t(0,`
                    `),s(1,"div",50),t(2,`
                        `),d(3,ot,9,5),r(),t(4,`
                `)),n&2){let e=c(2);i(3),x(e.course!=null&&e.course.isAtLeastTutor?3:-1)}}function rt(n,o){if(n&1&&(t(0,`
        `),s(1,"ngx-datatable",24),t(2,`
            `),s(3,"ngx-datatable-column",25),t(4,`
                `),d(5,Be,8,1,"ng-template",26),t(6,`
                `),d(7,He,7,5,"ng-template",27),t(8,`
            `),r(),t(9,`
            `),s(10,"ngx-datatable-column",28),t(11,`
                `),d(12,Oe,8,1,"ng-template",26),t(13,`
                `),d(14,Ne,3,1,"ng-template",27),t(15,`
            `),r(),t(16,`
            `),s(17,"ngx-datatable-column",29),t(18,`
                `),d(19,Ke,8,3,"ng-template",26),t(20,`
                `),d(21,Qe,3,2,"ng-template",27),t(22,`
            `),r(),t(23,`
            `),s(24,"ngx-datatable-column",30),t(25,`
                `),d(26,Xe,8,1,"ng-template",26),t(27,`
                `),d(28,Ye,3,1,"ng-template",27),t(29,`
            `),r(),t(30,`
            `),s(31,"ngx-datatable-column",31),t(32,`
                `),d(33,Ze,8,1,"ng-template",26),t(34,`
                `),d(35,et,3,1,"ng-template",27),t(36,`
            `),r(),t(37,`
            `),s(38,"ngx-datatable-column",32),t(39,`
                `),d(40,tt,8,1,"ng-template",26),t(41,`
                `),d(42,nt,5,3,"ng-template",27),t(43,`
            `),r(),t(44,`
            `),s(45,"ngx-datatable-column",33),t(46,`
                `),d(47,it,8,1,"ng-template",26),t(48,`
                `),d(49,at,4,1,"ng-template",27),t(50,`
            `),r(),t(51,`
            `),s(52,"ngx-datatable-column",34),t(53,`
                `),d(54,st,5,1,"ng-template",27),t(55,`
            `),r(),t(56,`
        `),r(),t(57,`
    `)),n&2){let e=o.settings;i(),p("limit",e.limit)("sortType",e.sortType)("columnMode",e.columnMode)("headerHeight",e.headerHeight)("footerHeight",e.footerHeight)("rowHeight",e.rowHeight)("rows",e.rows)("rowClass",e.rowClass)("scrollbarH",e.scrollbarH),i(2),p("minWidth",60)("width",80)("maxWidth",100),i(7),p("minWidth",120)("width",120),i(7),p("minWidth",170)("width",170),i(7),p("minWidth",80)("width",80),i(7),p("minWidth",80)("width",80),i(7),p("minWidth",130)("width",130),i(7),p("minWidth",100)("width",100),i(7),p("minWidth",100)("width",100)}}var _e=n=>`/topic/exams/${n}/exercise-start-status`,zt=(()=>{class n{route=g(z);examManagementService=g(ae);studentExamService=g(de);courseService=g(te);alertService=g(Y);modalService=g(N);accountService=g(Q);artemisTranslatePipe=g(T);websocketService=g(K);profileService=g(X);courseId;examId;studentExams=[];course;exam;hasStudentsWithoutExam;isTestExam;eventSubscriber;paramSub;isLoading;filteredStudentExamsSize=0;isExamStarted=!1;isExamOver=!1;longestWorkingTime;isAdmin=!1;localVCEnabled=!1;exercisePreparationStatus;exercisePreparationRunning=!1;exercisePreparationPercentage=0;exercisePreparationEta;faExclamationTriangle=y;ngOnInit(){this.isLoading=!0,this.courseId=Number(this.route.snapshot.paramMap.get("courseId")),this.examId=Number(this.route.snapshot.paramMap.get("examId")),this.loadAll(),this.profileService.getProfileInfo().subscribe(a=>{this.localVCEnabled=a.activeProfiles.includes(ne)});let e=_e(this.examId);this.websocketService.subscribe(e),this.websocketService.receive(e).pipe(j(a=>a.startedAt=Z(a.startedAt))).subscribe(a=>this.setExercisePreparationStatus(a))}ngOnDestroy(){this.websocketService.unsubscribe(_e(this.examId))}loadAll(){this.paramSub=this.route.params.subscribe(()=>{this.isAdmin=this.accountService.isAdmin(),this.courseService.find(this.courseId).subscribe(e=>{this.course=e.body}),this.examManagementService.find(this.courseId,this.examId,!0).subscribe(e=>{this.exam=e.body,this.isTestExam=this.exam.testExam,this.isExamStarted=this.exam.startDate?this.exam.startDate.isBefore(v()):!1,this.studentExamService.findAllForExam(this.courseId,this.examId).subscribe(a=>{this.setStudentExams(a.body),this.longestWorkingTime=Math.max.apply(null,this.studentExams.map(m=>m.workingTime)),this.calculateIsExamOver(),this.isLoading=!1,this.exam.examUsers&&(this.hasStudentsWithoutExam=this.studentExams.length<this.exam.examUsers.length)})}),this.examManagementService.getExerciseStartStatus(this.courseId,this.examId).subscribe(e=>this.setExercisePreparationStatus(e.body??void 0))})}calculateIsExamOver(){if(this.longestWorkingTime&&this.exam){let a=v(this.exam.startDate).add(this.longestWorkingTime,"seconds");this.exam.gracePeriod&&(a=a.add(this.exam.gracePeriod,"seconds")),this.isExamOver=a.isBefore(v())}}handleGenerateStudentExams(){if(this.studentExams.length){let e=this.modalService.open(W,{keyboard:!0,size:"lg"});e.componentInstance.title="artemisApp.studentExams.generateStudentExams",e.componentInstance.text=this.artemisTranslatePipe.transform("artemisApp.studentExams.studentExamGenerationModalText"),e.result.then(()=>{this.generateStudentExams()})}else this.generateStudentExams()}generateStudentExams(){this.isLoading=!0,this.examManagementService.generateStudentExams(this.courseId,this.examId).subscribe({next:e=>{this.alertService.success("artemisApp.studentExams.studentExamGenerationSuccess",{number:e?.body?.length??0}),this.loadAll()},error:e=>{this.handleError("artemisApp.studentExams.studentExamGenerationError",e),this.isLoading=!1}})}generateMissingStudentExams(){this.isLoading=!0,this.examManagementService.generateMissingStudentExams(this.courseId,this.examId).subscribe({next:e=>{this.alertService.success("artemisApp.studentExams.missingStudentExamGenerationSuccess",{number:e?.body?.length??0}),this.loadAll()},error:e=>{this.handleError("artemisApp.studentExams.missingStudentExamGenerationError",e),this.isLoading=!1}})}startExercises(){this.isLoading=!0,this.examManagementService.startExercises(this.courseId,this.examId).subscribe({next:()=>{this.alertService.success("artemisApp.studentExams.startExerciseSuccess"),this.isLoading=!1},error:e=>{this.handleError("artemisApp.studentExams.startExerciseFailure",e),this.isLoading=!1}})}setExercisePreparationStatus(e){this.exercisePreparationStatus=e;let a=(e?.finished??0)+(e?.failed??0);if(this.exercisePreparationRunning=!!(e&&a<e.overall),this.exercisePreparationPercentage=e?e.overall?Math.round(a/e.overall*100):100:0,this.exercisePreparationEta=void 0,this.exercisePreparationRunning&&a){let m=e.overall-a,b=v().diff(e.startedAt,"s")/a*m,C=Math.floor(b/60/60),A=Math.floor((b-C*60*60)/60),V=Math.floor(b-C*60*60-A*60);this.exercisePreparationEta=(C?C+"h":"")+(A||C?A+"m":"")+(V||A||C?V+"s":"")}}handleUnlockAllRepositories(){let e=this.modalService.open(W,{keyboard:!0,size:"lg"});e.componentInstance.title="artemisApp.studentExams.unlockAllRepositories",e.componentInstance.text=this.artemisTranslatePipe.transform("artemisApp.studentExams.unlockAllRepositoriesModalText"),e.result.then(()=>{this.unlockAllRepositories()})}unlockAllRepositories(){this.isLoading=!0,this.examManagementService.unlockAllRepositories(this.courseId,this.examId).subscribe({next:e=>{this.alertService.success("artemisApp.studentExams.unlockAllRepositoriesSuccess",{number:e?.body}),this.isLoading=!1},error:e=>{this.handleError("artemisApp.studentExams.unlockAllRepositoriesFailure",e),this.isLoading=!1}})}handleLockAllRepositories(){let e=this.modalService.open(W,{keyboard:!0,size:"lg"});e.componentInstance.title="artemisApp.studentExams.lockAllRepositories",e.componentInstance.text=this.artemisTranslatePipe.transform("artemisApp.studentExams.lockAllRepositoriesModalText"),e.result.then(()=>{this.lockAllRepositories()})}lockAllRepositories(){this.isLoading=!0,this.examManagementService.lockAllRepositories(this.courseId,this.examId).subscribe({next:e=>{this.alertService.success("artemisApp.studentExams.lockAllRepositoriesSuccess",{number:e?.body}),this.isLoading=!1},error:e=>{this.handleError("artemisApp.studentExams.lockAllRepositoriesFailure",e),this.isLoading=!1}})}handleStudentExamsSizeChange=e=>{this.filteredStudentExamsSize=e};searchResultFormatter=e=>e.user?`${e.user.login} (${e.user.name})`:"";searchTextFromStudentExam=e=>e.user?.login||"";setStudentExams(e){e&&(this.studentExams=e,this.studentExams.forEach(a=>{a.exam=this.exam,a.numberOfExamSessions=a.examSessions?.length??0}))}handleError(e,a){let m;a?.error&&a.error.errorKey?m=this.artemisTranslatePipe.transform(a.error.errorKey):m=a?.error?.message,m?this.alertService.error(e,{message:m}):ee(this.alertService,a)}static \u0275fac=function(a){return new(a||n)};static \u0275cmp=k({type:n,selectors:[["jhi-student-exams"]],decls:25,vars:11,consts:[["jhiTranslate","artemisApp.studentExams.title"],[1,"d-flex","align-items-center","gap-3","mt-2","mb-3","flex-wrap"],["entityType","studentExam","id","student-exam","entitiesPerPageTranslation","artemisApp.exercise.resultsPerPage","showAllEntitiesTranslation","artemisApp.exercise.showAllResults",3,"entitiesSizeChange","isLoading","allEntities","searchPlaceholderTranslation","searchFields","searchTextFromEntity","searchResultFormatter"],["id","generateStudentExamsButton",1,"btn","btn-primary","mt-1",3,"click","disabled"],["jhiTranslate","artemisApp.studentExams.generateStudentExams"],["id","generateMissingStudentExamsButton",1,"btn","btn-primary","mt-1",3,"click","disabled"],["jhiTranslate","artemisApp.studentExams.generateMissingStudentExams"],["id","startExercisesButton",1,"btn","btn-primary","mt-1",3,"click","disabled"],["jhiTranslate","artemisApp.studentExams.startExercises"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["id","handleUnlockAllRepositoriesButton",1,"btn","btn-danger","mt-1",3,"click","disabled"],[1,"text-warning",3,"icon"],["jhiTranslate","artemisApp.studentExams.unlockAllRepositories"],["id","lockAllRepositoriesButton",1,"btn","btn-danger","mt-1",3,"click","disabled"],["jhiTranslate","artemisApp.studentExams.lockAllRepositories"],[3,"isTestExam","hasStudentsWithoutExam"],[1,"d-flex","flex-wrap","flex-grow-1","align-items-center","gap-1"],["jhiTranslate","artemisApp.studentExams.exercisePreparationProgress.label"],[1,"flex-grow-1","flex-basis-10","position-relative"],[1,"position-absolute","w-100","h-100","top-0"],["type","success",3,"value","max","animated","height"],[1,"d-flex","justify-content-center","gap-1","w-100","z-1","position-relative","ms-2","me-2"],["jhiTranslate","artemisApp.studentExams.exercisePreparationProgress.finished"],["jhiTranslate","artemisApp.studentExams.exercisePreparationProgress.noeta"],[1,"bootstrap",3,"limit","sortType","columnMode","headerHeight","footerHeight","rowHeight","rows","rowClass","scrollbarH"],["prop","id",3,"minWidth","width","maxWidth"],["ngx-datatable-header-template",""],["ngx-datatable-cell-template",""],["prop","user",3,"minWidth","width"],["prop","workingTime",3,"minWidth","width"],["prop","started",3,"minWidth","width"],["prop","submitted",3,"minWidth","width"],["prop","submissionDate",3,"minWidth","width"],["prop","numberOfExamSessions",3,"minWidth","width"],["prop","",3,"minWidth","width"],[1,"datatable-header-cell-wrapper",3,"click"],["jhiTranslate","artemisApp.studentExams.id",1,"datatable-header-cell-label","bold","sortable"],[3,"icon"],[3,"routerLink"],[1,"datatable-header-cell-wrapper","username",3,"click"],["jhiTranslate","artemisApp.studentExams.student",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.studentExams.workingTime",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.studentExams.usedWorkingTime",1,"datatable-header-cell-label","bold","sortable"],[3,"studentExam"],["jhiTranslate","artemisApp.studentExams.started",1,"datatable-header-cell-label","bold","sortable"],[3,"jhiTranslate"],["jhiTranslate","artemisApp.studentExams.submitted",1,"datatable-header-cell-label","bold","sortable"],[1,"submitted",3,"jhiTranslate"],["jhiTranslate","artemisApp.studentExams.submissionDate",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.studentExams.examSessions",1,"datatable-header-cell-label","bold","sortable"],[1,"w-100","text-end"],[1,"btn-group"],[1,"btn","btn-primary","btn-sm","me-1","mb-1","view-submission",3,"routerLink"],["jhiTranslate","artemisApp.studentExams.view"]],template:function(a,m){a&1&&(s(0,"div"),t(1,`
    `),s(2,"h2"),t(3,`
        `),l(4,"span",0),t(5,`
    `),r(),t(6,`
    `),l(7,"hr"),t(8,`
    `),s(9,"div"),t(10,`
        `),d(11,Pe,2,1)(12,Le,17,6),r(),t(13,`
    `),s(14,"div",1),t(15,`
        `),d(16,We,3,2)(17,De,27,15),r(),t(18,`
`),r(),t(19,`
`),s(20,"jhi-data-table",2),u("entitiesSizeChange",function(b){return m.handleStudentExamsSizeChange(b)}),t(21,`
    `),d(22,rt,58,26,"ng-template"),t(23,`
`),r(),t(24,`
`)),a&2&&(i(11),x(m.isTestExam?-1:11),i(),x(!m.localVCEnabled&&(m.course!=null&&m.course.isAtLeastInstructor)?12:-1),i(4),x(m.isLoading?-1:16),i(),x(m.exercisePreparationStatus?17:-1),i(3),p("isLoading",m.isLoading)("allEntities",m.studentExams)("searchPlaceholderTranslation","artemisApp.studentExams.searchForStudents")("searchFields",H(10,be))("searchTextFromEntity",m.searchTextFromStudentExam)("searchResultFormatter",m.searchResultFormatter))},dependencies:[L,I,ue,U,ce,me,le,re,oe,se,G,xe,pe,ie,T],encapsulation:2})}return n})();export{zt as StudentExamsComponent};
//# sourceMappingURL=student-exams.component-FYYALM2M.js.map
