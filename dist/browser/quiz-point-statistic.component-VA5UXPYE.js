import{a as W}from"./chunk-DHJSYRNR.js";import{c as B}from"./chunk-ITOSPRIX.js";import{a as U,c as X}from"./chunk-NTCPM4SY.js";import"./chunk-IJQAYIKN.js";import{a as V}from"./chunk-DMHWBHTD.js";import"./chunk-57BCHYEO.js";import"./chunk-IJRVZ46L.js";import"./chunk-SKB5UJGX.js";import"./chunk-SUUJN3EQ.js";import"./chunk-V7PDYRDZ.js";import"./chunk-EANMTTQG.js";import"./chunk-EGRHWZRV.js";import"./chunk-MBS3WUDO.js";import{f as j,g as N}from"./chunk-BDII35IB.js";import"./chunk-LARBQRTJ.js";import"./chunk-T77OIOZ4.js";import"./chunk-Z2YUBN6N.js";import"./chunk-5JBXU6VG.js";import{a as M}from"./chunk-QA7Y7QBM.js";import"./chunk-2CUFQLAH.js";import"./chunk-Z6NSEM73.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import{d as O}from"./chunk-CT44YL7Q.js";import"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import"./chunk-WA5GEAJB.js";import"./chunk-BQNBT6PW.js";import"./chunk-5GXY5RYT.js";import{a as Q}from"./chunk-K3W6YFKH.js";import{d as R}from"./chunk-EDXSOKK5.js";import{a as c,b as k}from"./chunk-R5BZWVRQ.js";import"./chunk-DID2YGL7.js";import"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Ka as L}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import"./chunk-HKBU2OOC.js";import{a as I}from"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as F}from"./chunk-U54OSGNH.js";import{f as y,h as P}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import"./chunk-IOA4DPXY.js";import{Db as o,Dc as b,Ea as u,Id as q,Ma as S,Mc as C,Na as f,Oc as p,Qa as _,Tb as g,Xb as w,Zb as d,cd as A,dd as t,ed as v,fd as z,kc as x,sc as h,sd as D,xc as a,yc as s,yd as E,zc as l,zd as T}from"./chunk-5LC5EQRR.js";import"./chunk-3E746U5Y.js";var H=(n,m)=>[n,m];function G(n,m){if(n&1){let e=b();t(0,`
                `),a(1,"button",14),C("click",function(){S(e);let r=p(2);return f(r.recalculate())}),t(2,`
                    `),l(3,"fa-icon",15),t(4),E(5,"artemisTranslate"),s(),t(6,`
            `)}if(n&2){let e=p(2);o(3),x("icon",e.faSync)("fixedWidth",!0),o(),z("\xA0",T(5,3,"artemisApp.showStatistic.recalculateStatistics"),`
                `)}}function J(n,m){n&1&&(t(0,`
                                `),l(1,"span",16),t(2,`
                            `))}function K(n,m){n&1&&(t(0,`
                                `),l(1,"span",17),t(2,`
                            `))}function Z(n,m){n&1&&(t(0,`
                            `),l(1,"span",18),t(2,`
                        `))}function $(n,m){n&1&&(t(0,`
                            `),l(1,"span",19),t(2,`
                        `))}function tt(n,m){if(n&1){let e=b();t(0,`
    `),a(1,"div",1),t(2,`
        `),a(3,"div",2),t(4,`
            `),a(5,"h3"),t(6),s(),t(7,`
            `),d(8,G,7,5),a(9,"div",3,0),t(11,`
                `),a(12,"p",4),t(13,`
                    `),l(14,"span",5),a(15,"span"),t(16),s(),t(17,`
                `),s(),t(18,`
                `),a(19,"div",1),t(20,`
                    `),a(21,"div",6),t(22,`
                        `),a(23,"p",4),t(24,`
                            `),d(25,J,3,0)(26,K,3,0),s(),t(27,`
                    `),s(),t(28,`
                    `),a(29,"div",7),t(30,`
                        `),a(31,"p",4),t(32,`
                            `),a(33,"span"),t(34),s(),l(35,"span",8),t(36,`
                        `),s(),t(37,`
                    `),s(),t(38,`
                `),s(),t(39,`
                `),l(40,"ngx-charts-bar-vertical",9),t(41,`
                `),a(42,"div",10),t(43,`
                    `),a(44,"button",11),C("click",function(){S(e);let r=p();return f(r.switchRated())}),t(45,`
                        `),l(46,"fa-icon",12),t(47,`\xA0
                        `),d(48,Z,3,0)(49,$,3,0),s(),t(50,`
                    `),a(51,"p"),t(52,"\xA0"),s(),t(53,`
                `),s(),t(54,`
            `),s(),t(55,`
        `),s(),t(56,`
        `),l(57,"jhi-quiz-statistics-footer",13),t(58,`
    `),s(),t(59,`
`)}if(n&2){let e=A(10),i=p();o(6),v(i.quizExercise.title),o(2),h(i.quizExercise.isAtLeastTutor?8:-1),o(8),v(i.maxScore),o(9),h(i.rated?25:-1),o(),h(i.rated?-1:26),o(8),z("",i.participants," "),o(6),x("view",D(25,H,e.offsetWidth,i.height))("results",i.ngxData)("scheme",i.ngxColor)("xAxisLabel",i.xAxisLabel)("yAxisLabel",i.yAxisLabel)("legend",!1)("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxis",!0)("yAxis",!0)("yScaleMax",i.maxScale)("roundEdges",!1)("showDataLabel",!0)("dataLabelFormatting",i.bindFormatting)("tooltipDisabled",!0),o(6),x("icon",i.faSync),o(2),h(i.rated?48:-1),o(),h(i.rated?-1:49),o(8),x("isQuizPointStatistic",!0)}}var _t=(()=>{class n extends U{route=u(y);router=u(P);accountService=u(k);quizExerciseService=u(V);websocketService=u(I);changeDetector=u(q);serverDateService=u(M);round=O;quizExercise;quizPointStatistic;labels=[];label=[];backgroundColor=[];maxScore;websocketChannelForData;quizExerciseChannel;legend=!1;showXAxisLabel=!0;showYAxisLabel=!0;xAxis=!0;yAxis=!0;roundEdges=!0;showDataLabel=!0;height=500;animations=!1;waitingForQuizStart=!1;remainingTimeText="?";remainingTimeSeconds=0;interval;faSync=L;ngOnInit(){this.translateService.onLangChange.subscribe(()=>{this.setAxisLabels("showStatistic.quizPointStatistic.xAxes","showStatistic.quizPointStatistic.yAxes")}),this.route.params.subscribe(e=>{this.accountService.hasAnyAuthorityDirect([c.ADMIN,c.INSTRUCTOR,c.EDITOR,c.TA])&&this.quizExerciseService.find(e.exerciseId).subscribe(i=>{this.loadQuizSuccess(i.body)}),this.websocketChannelForData="/topic/statistic/"+e.exerciseId,this.websocketService.subscribe(this.websocketChannelForData),this.quizExerciseChannel||(this.quizExerciseChannel="/topic/courses/"+e.courseId+"/quizExercises",this.websocketService.subscribe(this.quizExerciseChannel),this.websocketService.receive(this.quizExerciseChannel).subscribe(i=>{this.waitingForQuizStart&&e.exerciseId===i.id&&this.loadQuizSuccess(i)})),this.websocketService.receive(this.websocketChannelForData).subscribe(i=>{this.loadNewData(i.quizPointStatistic)})}),this.interval=setInterval(()=>{this.updateDisplayedTimes()},100),this.changeDetector.detectChanges()}updateDisplayedTimes(){let e="artemisApp.showStatistic.";if(this.quizExercise&&this.quizExercise.dueDate){let i=this.quizExercise.dueDate;i.isAfter(this.serverDateService.now())?(this.remainingTimeSeconds=i.diff(this.serverDateService.now(),"seconds"),this.remainingTimeText=this.relativeTimeText(this.remainingTimeSeconds)):(this.remainingTimeSeconds=-1,this.remainingTimeText=this.translateService.instant(e+"quizHasEnded"))}else this.remainingTimeSeconds=0,this.remainingTimeText="?"}relativeTimeText(e){return e>210?Math.ceil(e/60)+" min":e>59?Math.floor(e/60)+" min "+e%60+" s":e+" s"}ngOnDestroy(){clearInterval(this.interval),this.websocketService.unsubscribe(this.websocketChannelForData)}loadNewData(e){this.accountService.hasAnyAuthorityDirect([c.ADMIN,c.INSTRUCTOR,c.EDITOR,c.TA])||this.router.navigate(["courses"]),this.quizPointStatistic=e,this.loadData()}loadQuizSuccess(e){this.accountService.hasAnyAuthorityDirect([c.ADMIN,c.INSTRUCTOR,c.EDITOR,c.TA])||this.router.navigate(["courses"]),this.quizExercise=e,this.waitingForQuizStart=!this.quizExercise.quizStarted,this.quizPointStatistic=this.quizExercise.quizPointStatistic,this.maxScore=W(this.quizExercise),this.loadData()}loadData(){this.label=[],this.backgroundColor=[],this.ratedData=[],this.unratedData=[],this.order(this.quizPointStatistic.pointCounters).forEach((e,i)=>{let r="["+Math.max(e.points-.5,0)+" - "+Math.min(e.points+.5,this.maxScore);r+=i!==this.quizPointStatistic.pointCounters.length-1?")":"]",this.label.push(r),this.ratedData.push(e.ratedCounter),this.unratedData.push(e.unRatedCounter),this.backgroundColor.push(B)}),this.chartLabels=this.label,this.ngxColor.domain=this.backgroundColor,this.loadDataInDiagram()}loadDataInDiagram(){this.setData(this.quizPointStatistic),this.pushDataToNgxEntry(this.changeDetector),this.setAxisLabels("artemisApp.showStatistic.quizPointStatistic.xAxes","artemisApp.showStatistic.quizPointStatistic.yAxes")}recalculate(){this.quizExerciseService.recalculate(this.quizExercise.id).subscribe(e=>{this.loadQuizSuccess(e.body)})}order(e){return e.sort((i,r)=>i.points<r.points?-1:i.points>r.points?1:0)}static \u0275fac=(()=>{let e;return function(r){return(e||(e=_(n)))(r||n)}})();static \u0275cmp=g({type:n,selectors:[["jhi-quiz-point-statistic"]],features:[w],decls:1,vars:1,consts:[["containerRef",""],[1,"row"],[1,"col-md-8","offset-md-2","text-center"],[1,"text-center"],[1,"chart-title-text"],["jhiTranslate","artemisApp.showStatistic.quizPointStatistic.maxScore"],[1,"col-md-7","text-start"],[1,"col-md-5","text-end"],["jhiTranslate","artemisApp.showStatistic.participants"],[3,"view","results","scheme","xAxisLabel","yAxisLabel","legend","showXAxisLabel","showYAxisLabel","xAxis","yAxis","yScaleMax","roundEdges","showDataLabel","dataLabelFormatting","tooltipDisabled"],[1,"text-center","button-row"],["type","button",1,"btn","btn-primary",3,"click"],[3,"icon"],[3,"isQuizPointStatistic"],[1,"btn","btn-primary","btn-sm","float-end",3,"click"],[3,"icon","fixedWidth"],["jhiTranslate","artemisApp.showStatistic.quizPointStatistic.titleRated"],["jhiTranslate","artemisApp.showStatistic.quizPointStatistic.titleUnrated"],["jhiTranslate","artemisApp.showStatistic.switchToUnrated"],["jhiTranslate","artemisApp.showStatistic.switchToRated"]],template:function(i,r){i&1&&d(0,tt,60,28),i&2&&h(r.quizExercise?0:-1)},dependencies:[R,F,N,j,X,Q],styles:[".chart-title-text[_ngcontent-%COMP%]{font-size:large}.question-title[_ngcontent-%COMP%]{font-size:medium}.invalid-question[_ngcontent-%COMP%]{color:red}.button-row[_ngcontent-%COMP%]{padding-left:61px}@media (max-width: 575px){.button-row[_ngcontent-%COMP%]{padding-left:0}}@media (max-width: 430px){.show-solution[_ngcontent-%COMP%]{margin-bottom:.25rem}}","[_nghost-%COMP%]  .textDataLabel{font-weight:bolder;font-size:small!important;alignment-baseline:middle;text-anchor:start}@media (min-width: 1420px){[_nghost-%COMP%]  .textDataLabel{transform:rotate(0);font-size:medium!important;alignment-baseline:baseline;text-anchor:middle}}"]})}return n})();export{_t as QuizPointStatisticComponent};
//# sourceMappingURL=quiz-point-statistic.component-VA5UXPYE.js.map
