import{a as W}from"./chunk-LQRMY4JN.js";import"./chunk-J2B6GP6U.js";import{a as K}from"./chunk-7MKMUXV6.js";import{d as P,o as H,t as Q,u as G}from"./chunk-DOLVNMRR.js";import"./chunk-JRBFEQNN.js";import"./chunk-DIZEKHOC.js";import"./chunk-V7PDYRDZ.js";import"./chunk-EANMTTQG.js";import"./chunk-KYCCMZSV.js";import"./chunk-QA7Y7QBM.js";import{a as N}from"./chunk-HQ6UGNQX.js";import"./chunk-MLVGKM2P.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import{c as z}from"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import"./chunk-CT44YL7Q.js";import"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import"./chunk-WA5GEAJB.js";import"./chunk-5GXY5RYT.js";import{a as V}from"./chunk-K3W6YFKH.js";import{c as U}from"./chunk-JXJXC4DZ.js";import{d as B}from"./chunk-EDXSOKK5.js";import"./chunk-R5BZWVRQ.js";import"./chunk-DID2YGL7.js";import"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Sc as $,ic as J}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import{a as L,b as R}from"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as Y}from"./chunk-U54OSGNH.js";import{f as q}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import"./chunk-IOA4DPXY.js";import{Db as c,Dc as j,Ea as m,F as T,Ma as A,Mc as F,Na as E,Oc as d,Tb as k,Zb as f,dd as e,fd as D,gd as _,kc as g,rc as h,s as I,sc as C,vc as v,wc as x,xc as o,yc as r,yd as b,zc as a,zd as y}from"./chunk-5LC5EQRR.js";import"./chunk-3E746U5Y.js";function X(i,p){if(i&1&&(e(0,`
                        `),a(1,"jhi-competency-card",12),e(2,`
                    `)),i&2){let t=p.$implicit,n=d(2);c(),g("competency",t)("courseId",n.courseId)("hideProgress",n.judgementOfLearningEnabled&&t.id!==void 0&&(n.promptForJolRatingMap==null?null:n.promptForJolRatingMap[t.id])===!0&&(n.judgementOfLearningMap==null?null:n.judgementOfLearningMap[t.id])===void 0)}}function Z(i,p){if(i&1&&(e(0,`
            `),o(1,"div",10),e(2,`
                `),o(3,"div",11),e(4,`
                    `),v(5,X,3,3,null,null,h().identify,!0),r(),e(7,`
            `),r(),e(8,`
        `)),i&2){let t=d();c(5),x(t.competencies)}}function ee(i,p){if(i&1&&(e(0,`
                                `),a(1,"jhi-competency-card",16),e(2,`
                            `)),i&2){let t=p.$implicit;c(),g("competency",t)("courseId",t.linkedCourseCompetency==null||t.linkedCourseCompetency.course==null?null:t.linkedCourseCompetency.course.id)("isPrerequisite",!0)}}function te(i,p){if(i&1&&(e(0,`
                        `),o(1,"div"),e(2,`
                            `),v(3,ee,3,3,null,null,h().identify,!0),r(),e(5,`
                    `)),i&2){let t=d(2);c(3),x(t.prerequisites)}}function ne(i,p){if(i&1){let t=j();e(0,`
            `),o(1,"div",10),e(2,`
                `),o(3,"div",11),e(4,`
                    `),o(5,"div",13),F("click",function(){A(t);let s=d();return E(s.isCollapsed=!s.isCollapsed)}),e(6,`
                        `),a(7,"fa-icon",14),e(8,`
                        `),o(9,"span"),e(10),b(11,"artemisTranslate"),r(),e(12,`
                    `),r(),e(13,`
                    `),f(14,te,6,0),a(15,"div",15),e(16,`
                `),r(),e(17,`
            `),r(),e(18,`
        `)}if(i&2){let t=d();c(7),g("icon",t.isCollapsed?t.faAngleDown:t.faAngleUp),c(3),_("",y(11,4,"artemisApp.prerequisite.title"),": ",t.countPrerequisites,""),c(4),C(t.isCollapsed?-1:14)}}var _e=(()=>{class i{featureToggleService=m(R);activatedRoute=m(q);alertService=m(U);courseStorageService=m(N);courseCompetencyService=m(K);courseId;isLoading=!1;course;competencies=[];prerequisites=[];parentParamSubscription;judgementOfLearningMap={};promptForJolRatingMap={};isCollapsed=!0;faAngleDown=J;faAngleUp=$;dashboardFeatureToggleActiveSubscription;dashboardFeatureActive=!1;ngOnInit(){let t=this.activatedRoute.parent?.parent?.params;t&&(this.parentParamSubscription=t.subscribe(n=>{this.courseId=Number(n.courseId)})),this.course=this.courseStorageService.getCourse(this.courseId),this.dashboardFeatureToggleActiveSubscription=this.featureToggleService.getFeatureToggleActive(L.StudentCourseAnalyticsDashboard).subscribe(n=>{this.dashboardFeatureActive=n,this.loadData()})}ngOnDestroy(){this.dashboardFeatureToggleActiveSubscription?.unsubscribe(),this.parentParamSubscription?.unsubscribe()}get countCompetencies(){return this.competencies.length}get countMasteredCompetencies(){return this.competencies.filter(t=>Q(t.userProgress?.first())>=(t.masteryThreshold??100)).length}get countPrerequisites(){return this.prerequisites.length}get judgementOfLearningEnabled(){return(this.course?.studentCourseAnalyticsDashboardEnabled??!1)&&this.dashboardFeatureActive}loadData(){this.isLoading=!0;let t=this.courseCompetencyService.getAllForCourse(this.courseId,!0),n=this.judgementOfLearningEnabled?this.courseCompetencyService.getJoLAllForCourse(this.courseId):I(void 0);T([t,n]).subscribe({next:([s,O])=>{let M=s.body??[];if(this.competencies=M.filter(u=>u.type===P.COMPETENCY).sort(G),this.prerequisites=M.filter(u=>u.type===P.PREREQUISITE),O!==void 0){let u=Object.fromEntries(this.competencies.map(l=>[l.id,l]));this.judgementOfLearningMap=Object.fromEntries(Object.entries(O.body??{}).filter(([l,w])=>{let S=u[Number(l)]?.userProgress?.first();return w.current.competencyProgress===(S?.progress??0)&&w.current.competencyConfidence===(S?.confidence??1)})),this.promptForJolRatingMap=Object.fromEntries(this.competencies.map(l=>[l.id,H.shouldPromptForJol(l,l.userProgress?.first(),this.competencies)]))}this.course&&(this.course.competencies=this.competencies,this.course.prerequisites=this.prerequisites),this.isLoading=!1},error:s=>z(this.alertService,s)})}identify(t,n){return`${t}-${n.id}`}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=k({type:i,selectors:[["jhi-course-competencies"]],inputs:{courseId:"courseId"},decls:28,vars:7,consts:[[1,"row"],[1,"col-12","col-lg-8"],[1,"col-12","col-lg-3","offset-lg-1"],["jhiTranslate","artemisApp.competency.table.panelHeader",1,"mt-3"],[1,"badge","bg-dark"],[1,"mt-3"],["jhiTranslate","artemisApp.competency.progress"],["jhiTranslate","artemisApp.competency.progressDescription"],["jhiTranslate","artemisApp.competency.mastery"],["jhiTranslate","artemisApp.competency.masteryDescription"],[1,"mt-3","position-relative"],[1,"exercise-row-container","mb-3"],[3,"competency","courseId","hideProgress"],[1,"control-label",3,"click"],[1,"pe-3",3,"icon"],[1,"collapsed"],[3,"competency","courseId","isPrerequisite"]],template:function(n,s){n&1&&(o(0,"div",0),e(1,`
    `),o(2,"div",1),e(3,`
        `),f(4,Z,9,0)(5,ne,19,6),r(),e(6,`
    `),o(7,"div",2),e(8,`
        `),a(9,"h3",3),e(10,`
        `),o(11,"span",4),e(12),r(),e(13),b(14,"artemisTranslate"),o(15,"dl",5),e(16,`
            `),a(17,"dt",6),e(18,`
            `),a(19,"dd",7),e(20,`
            `),a(21,"dt",8),e(22,`
            `),a(23,"dd",9),e(24,`
        `),r(),e(25,`
    `),r(),e(26,`
`),r(),e(27,`
`)),n&2&&(c(4),C(s.countCompetencies>0?4:-1),c(),C(s.countPrerequisites>0?5:-1),c(7),_("",s.countMasteredCompetencies," / ",s.countCompetencies,""),c(),D(" ",y(14,5,"artemisApp.competency.mastered"),`
        `))},dependencies:[W,B,Y,V],styles:[".course-body-container[_ngcontent-%COMP%]{position:relative}.refresh-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;justify-content:center;align-items:flex-start;opacity:0;pointer-events:none;transition:.1s ease-out opacity}.refresh-overlay.active[_ngcontent-%COMP%]{background-color:var(--overview-refresh-overlay-bg-color);opacity:1;pointer-events:auto;transition:.2s ease-in opacity}.refresh-overlay[_ngcontent-%COMP%]   .ng-fa-icon[_ngcontent-%COMP%]{position:relative;top:calc(47.5vh - 150px);transform:translateY(-50%);color:var(--overview-refresh-overlay-color)}.back-button[_ngcontent-%COMP%]{cursor:pointer}.current-week-row[_ngcontent-%COMP%]    >div{background-color:var(--overview-light-primary-background-color)}.statistic-summary[_ngcontent-%COMP%]{margin-top:25px}.statistic-summary[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:flex-end;margin-bottom:20px}.statistic-summary[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-text[_ngcontent-%COMP%]{position:absolute;width:350px}.statistic-summary[_ngcontent-%COMP%]   .color-legend-container[_ngcontent-%COMP%]{margin-bottom:40px}.statistic-summary[_ngcontent-%COMP%]   .color-legend-container[_ngcontent-%COMP%]   .color-legend-entry[_ngcontent-%COMP%]{display:inline-flex;align-items:center;width:100%}.exercise-row-container[_ngcontent-%COMP%]   .control-label[_ngcontent-%COMP%]{cursor:pointer}.exercise-row-container[_ngcontent-%COMP%]   .collapsed[_ngcontent-%COMP%]{margin-top:1rem;border-bottom:1px solid var(--overview-light-border-color)}.icon-container[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;horiz-align:center}.course-information[_ngcontent-%COMP%]{padding-top:29px}.course-information[_ngcontent-%COMP%]   .exercise-panel[_ngcontent-%COMP%]   .row.has-exercises[_ngcontent-%COMP%]{cursor:pointer;border-radius:3px}.course-information[_ngcontent-%COMP%]   .exercise-panel[_ngcontent-%COMP%]   .row.has-exercises[_ngcontent-%COMP%]:hover{background-color:var(--overview-light-background-color)}.course-information[_ngcontent-%COMP%]   .exercise-panel[_ngcontent-%COMP%]   .row.has-exercises[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{color:var(--primary)}.exercise-divider[_ngcontent-%COMP%]{height:0;width:100%;margin:1rem 0 .5rem;border-top:1px solid var(--overview-light-border-color)}.color-indicator[_ngcontent-%COMP%]{height:20px;width:20px;background-color:#0f6ab4;position:relative;top:-4px;margin-right:5px;border-radius:3px}canvas#complete-chart[_ngcontent-%COMP%]{z-index:99}.dev-button[_ngcontent-%COMP%]{text-align:left;color:#fff;background-color:#3e8acc;border:none;border-radius:1px}.dev-button[_ngcontent-%COMP%]:hover{background-color:#0f6ab4}.dev-button[_ngcontent-%COMP%]:active{box-shadow:0 2px 0 var(--artemis-dark)}.dev-button[_ngcontent-%COMP%]:disabled{background-color:gray}.btn-primary[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:disabled, .btn-info[_ngcontent-%COMP%], .btn-info[_ngcontent-%COMP%]:hover, .btn-success[_ngcontent-%COMP%], .btn-success[_ngcontent-%COMP%]:hover{color:#fff}@media (max-width: 768px){.col-12[_ngcontent-%COMP%]{width:100%!important}}.fadeInIcon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s;animation-iteration-count:initial}@media (max-width: 655px){.horizontal-scroll[_ngcontent-%COMP%]{overflow-x:auto}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}50%{opacity:.5}to{visibility:visible;opacity:1}}.exercise-content-sidebar-width[_ngcontent-%COMP%]{width:calc(100% - 263px)!important;transition:width .1s 0s ease-in-out}.exercise-content-width[_ngcontent-%COMP%]{width:100%;transition:width .1s 0s ease-in-out}"]})}return i})();export{_e as CourseCompetenciesComponent};
//# sourceMappingURL=course-competencies.component-7OLAXLU6.js.map
