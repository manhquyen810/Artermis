import{a as Ne}from"./chunk-CWEZ7BG4.js";import{a as l,b as Re}from"./chunk-LFOGFBTL.js";import{a as Fe}from"./chunk-2OQEG3U2.js";import{a as Pe}from"./chunk-BIKLNSC4.js";import{a as Ie}from"./chunk-QZKVSIAC.js";import{a as ke}from"./chunk-DIZEKHOC.js";import{d as E}from"./chunk-O4VJ5OXY.js";import{b as j,h as Oe,i as Le,j as we,k as Me}from"./chunk-BDII35IB.js";import{x as Ee}from"./chunk-LARBQRTJ.js";import{a as ye}from"./chunk-ZK23IHB5.js";import{a as Ae}from"./chunk-2QXIMOEO.js";import{d as F}from"./chunk-AR57MWOI.js";import{c as ge}from"./chunk-5MVJAZRV.js";import{e as Y,f as Te}from"./chunk-CT44YL7Q.js";import{c as De}from"./chunk-JNO6DNVW.js";import{K as te}from"./chunk-VZRSC3LP.js";import{r as Se,s as ve,t as _e}from"./chunk-VK7JPHFE.js";import{c as xe}from"./chunk-BNDLMKXK.js";import{a as R}from"./chunk-K3W6YFKH.js";import{a as Ce,c as fe}from"./chunk-JXJXC4DZ.js";import{d as N}from"./chunk-EDXSOKK5.js";import{b as he}from"./chunk-R5BZWVRQ.js";import{p as O}from"./chunk-DID2YGL7.js";import{A as re,Db as me,H as ae,Oc as pe,Vb as de,Zc as P,cb as le,hb as ce,nb as ue,qa as oe,wa as se}from"./chunk-Z4VHWOB5.js";import{a as U,b as ne}from"./chunk-HKBU2OOC.js";import{a as be}from"./chunk-U54OSGNH.js";import{f as J,h as ee,i as I}from"./chunk-M6Z6DKZQ.js";import{c as ie}from"./chunk-E2KBL4LX.js";import{n as Q}from"./chunk-IOA4DPXY.js";import{Ac as B,Ad as z,Bc as W,Db as a,Dc as G,Ea as x,Ed as H,La as w,Ma as b,Mc as f,Na as T,Oc as c,Rc as M,Tb as D,Xb as K,Zb as C,cd as q,dd as t,ed as v,fd as X,gd as A,kc as m,qd as _,rd as k,sc as h,sd as Z,x as L,xc as o,yc as s,yd as g,zc as d,zd as y}from"./chunk-5LC5EQRR.js";import{j as $}from"./chunk-3E746U5Y.js";var Ue=()=>[160,160],Ye=(i,u)=>["/course-management",i,u];function $e(i,u){if(i&1&&(t(0,`
        `),o(1,"a",4),t(2,`
            `),o(3,"div",5),t(4),g(5,"artemisTranslate"),s(),t(6,`
        `),s(),t(7,`
    `)),i&2){let e=c();a(),m("routerLink",Z(4,Ye,e.course.id,e.titleLink)),a(3),v(y(5,2,"artemisApp.course.detail."+e.doughnutChartTitle+"Title"))}}function Ke(i,u){if(i&1&&(t(0,`
        `),o(1,"h5",6),t(2),g(3,"artemisTranslate"),s(),t(4,`
    `)),i&2){let e=c();a(2),v(y(3,1,"artemisApp.course.detail."+e.doughnutChartTitle+"Title"))}}function qe(i,u){if(i&1&&(t(0,`
                    `),o(1,"div",7),t(2),s(),t(3,`
                `)),i&2){let e=c(2);a(2),X("",e.currentPercentage,"%")}}function Xe(i,u){if(i&1&&(t(0,`
                    `),o(1,"div",7),t(2),s(),t(3,`
                `)),i&2){let e=c(2);a(2),v(e.showText)}}function Ze(i,u){if(i&1&&(t(0,`
                    `),o(1,"div",8),t(2),s(),t(3,`
                `)),i&2){let e=c(2);a(2),A("",e.currentAbsolute," / ",e.currentMax,"")}}function Qe(i,u){if(i&1&&(t(0,`
                    `),o(1,"div",8),t(2),s(),t(3,`
                `)),i&2){let e=c(2);a(2),v(e.showText)}}function Je(i,u){if(i&1&&(t(0,`
                `),C(1,qe,4,1)(2,Xe,4,1)(3,Ze,4,2)(4,Qe,4,1)),i&2){let e=c();a(),h(e.currentPercentage!==void 0?1:e.showText?2:-1),a(2),h(e.showText?e.currentPercentage!==void 0?4:-1:3)}}function et(i,u){if(i&1&&(t(0,`
                `),o(1,"div",9),t(2,`
                    `),d(3,"fa-icon",10),t(4,`
                `),s(),t(5,`
            `)),i&2){let e=c();a(3),m("icon",e.faSpinner)}}var je=[0,0,1],Be=(()=>{class i{router=x(ee);contentType;currentPercentage;currentAbsolute;currentMax;course;showText;receivedStats=!1;doughnutChartTitle;stats;titleLink;faSpinner=P;ngxData=[{name:"Done",value:0},{name:"Not done",value:0},{name:"N/A",value:0}];ngxColor={name:"vivid",selectable:!0,group:j.Ordinal,domain:[E.GREEN,E.RED,E.LIGHT_GREY]};bindFormatting=this.valueFormatting.bind(this);ngOnChanges(){if(this.currentAbsolute==null&&!this.receivedStats&&!this.showText)this.updatePieChartData(je);else{this.receivedStats=!0;let e=Te(this.currentMax-this.currentAbsolute,this.course);return this.stats=[this.currentAbsolute,e,0],this.currentMax===0?this.updatePieChartData(je):this.updatePieChartData(this.stats)}}ngOnInit(){switch(this.contentType){case S.ASSESSMENT:this.doughnutChartTitle="assessments",this.titleLink="assessment-dashboard";break;case S.COMPLAINTS:this.doughnutChartTitle="complaints",this.titleLink="complaints";break;case S.FEEDBACK:this.doughnutChartTitle="moreFeedback",this.titleLink="more-feedback-requests";break;case S.AVERAGE_COURSE_SCORE:this.doughnutChartTitle="averageStudentScore",this.titleLink=void 0,this.course.isAtLeastInstructor&&(this.titleLink="scores"),this.ngxData[0].name="Average score";break;case S.CURRENT_LLM_COST:this.doughnutChartTitle="currentTotalLLMCost",this.titleLink=void 0;break;default:this.doughnutChartTitle="",this.titleLink=void 0}this.ngxData=[...this.ngxData]}openCorrespondingPage(){this.course.id&&this.titleLink&&this.router.navigate(["/course-management",this.course.id,this.titleLink])}updatePieChartData(e){this.ngxData.forEach((n,r)=>n.value=e[r]),this.ngxData=[...this.ngxData]}valueFormatting(e){return this.currentMax===0?"0":e.value}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=D({type:i,selectors:[["jhi-course-detail-doughnut-chart"]],inputs:{contentType:"contentType",currentPercentage:"currentPercentage",currentAbsolute:"currentAbsolute",currentMax:"currentMax",course:"course",showText:"showText"},features:[w],decls:15,vars:10,consts:[[1,"doughnut","mx-3"],[1,"doughnut-chart-container",3,"click","ngClass"],[1,"doughnut-chart-text"],[3,"view","results","scheme","doughnut","tooltipText"],[3,"routerLink"],[1,"text-center","h5","m-0"],[1,"text-center"],[1,"h4"],[1,"h6"],[1,"h3"],["animation","spin",3,"icon"]],template:function(n,r){n&1&&(o(0,"div",0),t(1,`
    `),C(2,$e,8,7)(3,Ke,5,3),o(4,"div",1),f("click",function(){return r.openCorrespondingPage()}),t(5,`
        `),o(6,"div",2),t(7,`
            `),C(8,Je,5,2)(9,et,6,1),s(),t(10,`
        `),d(11,"ngx-charts-pie-chart",3),t(12,`
    `),s(),t(13,`
`),s(),t(14,`
`)),n&2&&(a(2),h(r.titleLink?2:-1),a(),h(r.titleLink?-1:3),a(),m("ngClass",r.titleLink?"clickable":""),a(4),h(r.receivedStats?8:9),a(3),m("view",_(9,Ue))("results",r.ngxData)("scheme",r.ngxColor)("doughnut",!0)("tooltipText",r.bindFormatting))},dependencies:[I,Q,N,Me,we,R],styles:[".doughnut[_ngcontent-%COMP%]{min-width:200px;display:flex;flex-wrap:wrap;justify-content:center;height:100%}.doughnut[_ngcontent-%COMP%]   .doughnut-chart-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%}.doughnut[_ngcontent-%COMP%]   .doughnut-chart-container[_ngcontent-%COMP%]   .doughnut-chart-text[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;justify-content:center;align-items:center;min-height:50px}.doughnut[_ngcontent-%COMP%]   .clickable[_ngcontent-%COMP%]{cursor:pointer}"]})}return i})();var tt=i=>["/course-management",i,"course-statistics"],We=()=>({amount:4}),Ge=()=>({amount:8}),it=i=>[i,320],nt=i=>[i];function rt(i,u){if(i&1){let e=G();t(0,`
                        `),o(1,"div",13),t(2,`
                            `),o(3,"button",14),g(4,"artemisTranslate"),f("click",function(){b(e);let r=c(2);return T(r.displayPeriodOverview(4))}),s(),t(5,`
                            `),o(6,"button",14),g(7,"artemisTranslate"),f("click",function(){b(e);let r=c(2);return T(r.displayPeriodOverview(8))}),s(),t(8,`
                            `),o(9,"button",15),g(10,"artemisTranslate"),f("click",function(){b(e);let r=c(2);return T(r.displayLifetimeOverview())}),s(),t(11,`
                        `),s(),t(12,`
                        `),o(13,"span",16),t(14,"|"),s(),t(15,`
                    `)}if(i&2){let e=c(2);a(3),M("ngbTooltip",z(4,8,"artemisApp.courseStatistics.scopeButton.periodTooltip",_(16,We))),m("disabled",!e.showLifetimeOverview&&e.displayedNumberOfWeeks===4)("translateValues",_(17,We)),a(3),M("ngbTooltip",z(7,11,"artemisApp.courseStatistics.scopeButton.periodTooltip",_(18,Ge))),m("disabled",!e.showLifetimeOverview&&e.displayedNumberOfWeeks===8)("translateValues",_(19,Ge)),a(3),M("ngbTooltip",y(10,14,"artemisApp.courseStatistics.scopeButton.overviewTooltip")),m("disabled",e.showLifetimeOverview)}}function at(i,u){if(i&1&&(t(0,`
                                `),o(1,"span"),t(2),s(),d(3,"br"),t(4,`
                                `),o(5,"b",18),t(6),s(),t(7,`
                            `)),i&2){let e=u.model,n=c(3);a(2),A("",e.series," in ",e.name,": "),a(4),A("",n.findAbsoluteValue(e)," (",e.value,"%)")}}function ot(i,u){if(i&1&&(t(0,`
                                    `),o(1,"span"),t(2),s(),t(3,`
                                `)),i&2){let e=c().model,n=c(3);a(2),A(" ",e[0].name,": ",n.findAbsoluteValue(e[0])," ")}}function st(i,u){if(i&1&&(t(0,`
                                `),C(1,ot,4,2)),i&2){let e=u.model;a(),h(e.length?1:-1)}}function lt(i,u){if(i&1&&(t(0,`
                        `),o(1,"ngx-charts-line-chart",17),t(2,`
                            `),C(3,at,8,4,"ng-template",null,1,H),t(5,`
                            `),C(6,st,2,1,"ng-template",null,2,H),t(8,`
                        `),s(),t(9,`
                    `)),i&2){c();let e=q(23),n=c();a(),m("view",k(14,it,e.offsetWidth))("scheme",n.chartColor)("showXAxisLabel",!0)("xAxis",!0)("yAxis",!0)("xAxisLabel",n.xAxisLabel)("results",n.data)("yScaleMin",0)("yScaleMax",100)("yAxisTickFormatting",n.formatYAxis)("curve",n.curve)("referenceLines",k(16,nt,n.average))("showRefLines",!0)("showRefLabels",!0)}}function ct(i,u){if(i&1&&(t(0,`
                        `),o(1,"h1",19),t(2,`
                            `),d(3,"fa-icon",20),t(4,`
                        `),s(),t(5,`
                    `)),i&2){let e=c(2);a(3),m("icon",e.faSpinner)}}function ut(i,u){if(i&1){let e=G();t(0,`
        `),B(1),t(2,`
            `),o(3,"div"),t(4,`
                `),o(5,"div",8),t(6,`
                    `),C(7,rt,16,20),o(8,"div",9),t(9,`
                        `),o(10,"button",10),f("click",function(){b(e);let r=c();return T(r.switchTimeSpan(r.SwitchTimeSpanDirection.LEFT))}),t(11,`
                            `),d(12,"fa-icon",11),t(13,`
                        `),s(),t(14,`
                        `),o(15,"button",10),f("click",function(){b(e);let r=c();return T(r.switchTimeSpan(r.SwitchTimeSpanDirection.RIGHT))}),t(16,`
                            `),d(17,"fa-icon",11),t(18,`
                        `),s(),t(19,`
                    `),s(),t(20,`
                `),s(),t(21,`
                `),o(22,"div",12,0),t(24,`
                    `),C(25,lt,10,18)(26,ct,6,1),s(),t(27,`
            `),s(),t(28,`
        `),W(),t(29,`
    `)}if(i&2){let e=c();a(7),h(e.course.startDate?7:-1),a(3),m("disabled",e.startDateDisplayed),a(2),m("icon",e.faArrowLeft),a(3),m("disabled",e.showsCurrentWeek),a(2),m("icon",e.faArrowRight),a(8),h(e.loading?26:25)}}function mt(i,u){if(i&1&&(t(0,`
        `),B(1),t(2,`
            `),d(3,"h4",21),t(4,`
            `),o(5,"h3",22),t(6),g(7,"artemisDate"),s(),t(8,`
        `),W(),t(9,`
    `)),i&2){let e=c();a(6),v(y(7,1,e.course.startDate))}}var V=function(i){return i[i.LEFT=0]="LEFT",i[i.RIGHT=1]="RIGHT",i}(V||{}),ze=(()=>{class i extends Fe{service=x(F);translateService=x(ie);course;numberOfStudentsInCourse;initialStats;loading=!0;displayedNumberOfWeeks=8;showsCurrentWeek=!0;chartTime;amountOfStudents;showLifetimeOverview=!1;overviewStats;currentPeriod=0;chartColor={name:"vivid",selectable:!0,group:j.Ordinal,domain:[E.DARK_BLUE]};xAxisLabel;data;dataCopy=[{name:"",series:[{}]}];absoluteSeries=[{}];curve=Ee;average={name:"Mean",value:0};startDateDisplayed=!1;faSpinner=P;faArrowLeft=me;faArrowRight=le;constructor(){super(),this.translateService.onLangChange.subscribe(()=>{this.loadTranslations()})}ngOnChanges(){this.amountOfStudents=this.translateService.instant("artemisApp.courseStatistics.amountOfStudents"),this.loadTranslations(),this.determineDisplayedPeriod(this.course,this.displayedNumberOfWeeks),this.course.startDate&&this.currentOffsetToEndDate?(this.showLifetimeOverview=!0,this.displayLifetimeOverview()):this.displayPeriodOverview(this.displayedNumberOfWeeks)}reloadChart(){this.loading=!0,this.createLabels(),this.service.getStatisticsData(this.course.id,this.currentPeriod,this.displayedNumberOfWeeks).subscribe(e=>{this.processDataAndCreateChart(e),this.data=[...this.dataCopy]})}processDataAndCreateChart(e){let n=0;if(this.numberOfStudentsInCourse>0){let r=[];for(let p=0;p<e.length;p++)r.push(Y(e[p]/this.numberOfStudentsInCourse,this.course)),this.dataCopy[0].series[p].value=Y(e[p]/this.numberOfStudentsInCourse,this.course),this.absoluteSeries[p].absoluteValue=e[p];n=r.length>0?Ne(r):0}else for(let r=0;r<this.currentSpanSize;r++)this.dataCopy[0].series[r].value=0,this.absoluteSeries[r].absoluteValue=0;this.average.name=this.translateService.instant("artemisApp.courseStatistics.average")+n.toFixed(2)+"%",this.average.value=n,this.loading=!1}createLabels(){this.dataCopy[0].series=[{}],this.absoluteSeries=[{}];let e,n;if(this.showLifetimeOverview)e=this.course.startDate,n=O().subtract(this.currentOffsetToEndDate,"weeks"),this.currentSpanSize=this.determineDifferenceBetweenIsoWeeks(this.course.startDate,n)+1;else{let r=this.currentOffsetToEndDate-this.displayedNumberOfWeeks*this.currentPeriod;n=O().subtract(r,"weeks");let p=this.course.startDate?this.determineDifferenceBetweenIsoWeeks(this.course.startDate,n)+1:this.displayedNumberOfWeeks;this.currentSpanSize=Math.min(p,this.displayedNumberOfWeeks),e=O().subtract(r+this.currentSpanSize-1,"weeks"),this.startDateDisplayed=!!this.course.startDate&&p<=this.displayedNumberOfWeeks}this.assignLabelsToDataObjects(),this.chartTime=e.isoWeekday(1).format("DD.MM.YYYY")+" - "+n.isoWeekday(7).format("DD.MM.YYYY"),this.dataCopy[0].name=this.amountOfStudents}switchTimeSpan(e){e===V.RIGHT?this.currentPeriod+=1:e===V.LEFT&&(this.currentPeriod-=1),this.showsCurrentWeek=this.currentPeriod===0,this.reloadChart()}formatYAxis(e){return e.toLocaleString()+" %"}findAbsoluteValue(e){let n=this.absoluteSeries.find(r=>r.name===e.name);return n?n.absoluteValue:"/"}displayPeriodOverview(e){this.currentPeriod=0,this.displayedNumberOfWeeks=e,this.showLifetimeOverview=!1,this.loading=!0,this.createLabels(),this.initialStats?(this.processDataAndCreateChart(this.initialStats.slice(Math.max(this.initialStats.length-this.displayedNumberOfWeeks,0))),this.data=[...this.dataCopy]):this.reloadChart()}displayLifetimeOverview(){this.course.startDate&&(this.showLifetimeOverview=!0,this.loading=!0,this.currentPeriod=0,this.startDateDisplayed=!0,this.showsCurrentWeek=!0,this.createLabels(),this.overviewStats?(this.processDataAndCreateChart(this.overviewStats),this.data=[...this.dataCopy]):this.fetchLifetimeOverviewData())}assignLabelsToDataObjects(){let e;for(let n=0;n<this.currentSpanSize;n++)e=O().subtract(this.currentOffsetToEndDate+this.currentSpanSize-1-this.displayedNumberOfWeeks*this.currentPeriod-n,"weeks").isoWeekday(1).isoWeek(),this.dataCopy[0].series[n]={},this.dataCopy[0].series[n].name=e.toString(),this.absoluteSeries[n]={},this.absoluteSeries[n].name=e.toString()}fetchLifetimeOverviewData(){this.service.getStatisticsForLifetimeOverview(this.course.id).subscribe(e=>{this.overviewStats=e,this.processDataAndCreateChart(this.overviewStats),this.data=[...this.dataCopy]})}loadTranslations(){this.xAxisLabel=this.translateService.instant("artemisApp.courseStatistics.calendarWeek"),this.average.name=this.translateService.instant("artemisApp.courseStatistics.average")+this.average.value.toFixed(2)+"%"}SwitchTimeSpanDirection=V;static \u0275fac=function(n){return new(n||i)};static \u0275cmp=D({type:i,selectors:[["jhi-course-detail-line-chart"]],inputs:{course:"course",numberOfStudentsInCourse:"numberOfStudentsInCourse",initialStats:"initialStats"},features:[K,w],decls:15,vars:4,consts:[["containerRef",""],["tooltipTemplate",""],["seriesTooltipTemplate",""],[1,"course-detail-parent-container","col"],[1,"d-flex","flex-nowrap","justify-content-center","gap-2","mt-3"],[1,"text-center",3,"routerLink"],["jhiTranslate","artemisApp.courseStatistics.activeStudents"],["placement","right auto","text","artemisApp.courseStatistics.activeStudentsExplanation",1,"chart-explanation-tooltip"],[1,"d-flex","gap-3","justify-content-end","me-3"],[1,"d-flex","gap-1"],[1,"btn",3,"click","disabled"],[3,"icon"],[1,"d-flex","mt-1","justify-content-center","align-items-center","h-99"],[1,"d-flex"],["jhiTranslate","artemisApp.courseStatistics.scopeButton.period",1,"btn",3,"click","disabled","ngbTooltip","translateValues"],["jhiTranslate","artemisApp.courseStatistics.scopeButton.overview",1,"btn",3,"click","disabled","ngbTooltip"],[1,"pt-1"],[3,"view","scheme","showXAxisLabel","xAxis","yAxis","xAxisLabel","results","yScaleMin","yScaleMax","yAxisTickFormatting","curve","referenceLines","showRefLines","showRefLabels"],[1,"tooltip-header"],[1,"spinner"],["animation","spin",3,"icon"],["jhiTranslate","artemisApp.course.notStartedYet",1,"text-center","mt-3"],[1,"text-center"]],template:function(n,r){n&1&&(o(0,"div",3),t(1,`
    `),o(2,"div",4),t(3,`
        `),o(4,"a",5),t(5,`
            `),d(6,"h5",6),t(7,`
        `),s(),t(8,`
        `),d(9,"jhi-help-icon",7),t(10,`
    `),s(),t(11,`
    `),C(12,ut,30,6)(13,mt,10,3),s(),t(14,`
`)),n&2&&(a(4),m("routerLink",k(2,tt,r.course.id)),a(8),h(r.startDateAlreadyPassed?12:13))},dependencies:[I,be,Ae,te,N,Le,Oe,De,R],styles:["button[_ngcontent-%COMP%]{border:none}"]})}return i})();function dt(i,u){if(i&1&&(t(0,`
                            `),d(1,"jhi-course-detail-doughnut-chart",4),t(2,`
                        `)),i&2){let e=c(2);a(),m("course",e.course)("contentType",e.DoughnutChartType.COMPLAINTS)("currentPercentage",e.courseDTO==null?null:e.courseDTO.currentPercentageComplaints)("currentAbsolute",e.courseDTO==null?null:e.courseDTO.currentAbsoluteComplaints)("currentMax",e.courseDTO==null?null:e.courseDTO.currentMaxComplaints)}}function pt(i,u){if(i&1&&(t(0,`
                            `),d(1,"jhi-course-detail-doughnut-chart",4),t(2,`
                        `)),i&2){let e=c(2);a(),m("course",e.course)("contentType",e.DoughnutChartType.FEEDBACK)("currentPercentage",e.courseDTO==null?null:e.courseDTO.currentPercentageMoreFeedbacks)("currentAbsolute",e.courseDTO==null?null:e.courseDTO.currentAbsoluteMoreFeedbacks)("currentMax",e.courseDTO==null?null:e.courseDTO.currentMaxMoreFeedbacks)}}function ht(i,u){if(i&1&&(t(0,`
                            `),d(1,"jhi-course-detail-doughnut-chart",6),t(2,`
                        `)),i&2){let e=c(2);a(),m("course",e.course)("contentType",e.DoughnutChartType.CURRENT_LLM_COST)("showText",(e.courseDTO==null?null:e.courseDTO.currentTotalLlmCostInEur)+" \u20AC")("currentMax",0)}}function xt(i,u){if(i&1&&(t(0,`
        `),o(1,"div",1),t(2,`
            `),o(3,"div",2),t(4,`
                `),o(5,"div",3),t(6,`
                    `),o(7,"div",2),t(8,`
                        `),d(9,"jhi-course-detail-doughnut-chart",4),t(10,`
                        `),C(11,dt,3,5)(12,pt,3,5),d(13,"jhi-course-detail-doughnut-chart",4),t(14,`
                        `),C(15,ht,3,4),s(),t(16,`
                `),s(),t(17,`
                `),d(18,"jhi-course-detail-line-chart",5),t(19,`
            `),s(),t(20,`
        `),s(),t(21,`
    `)),i&2){let e=c();a(9),m("course",e.course)("contentType",e.DoughnutChartType.ASSESSMENT)("currentPercentage",e.courseDTO==null?null:e.courseDTO.currentPercentageAssessments)("currentAbsolute",e.courseDTO==null?null:e.courseDTO.currentAbsoluteAssessments)("currentMax",e.courseDTO==null?null:e.courseDTO.currentMaxAssessments),a(2),h(e.course.complaintsEnabled?11:-1),a(),h(e.course.requestMoreFeedbackEnabled?12:-1),a(),m("course",e.course)("contentType",e.DoughnutChartType.AVERAGE_COURSE_SCORE)("currentPercentage",e.courseDTO==null?null:e.courseDTO.currentPercentageAverageScore)("currentAbsolute",e.courseDTO==null?null:e.courseDTO.currentAbsoluteAverageScore)("currentMax",e.courseDTO==null?null:e.courseDTO.currentMaxAverageScore),a(2),h(e.irisChatEnabled||e.isAthenaEnabled?15:-1),a(3),m("course",e.course)("numberOfStudentsInCourse",e.course.numberOfStudents)("initialStats",e.activeStudents)}}function Ct(i,u){if(i&1&&(t(0,`
        `),d(1,"jhi-detail-overview-list",7),t(2,`
    `)),i&2){let e=c();a(),m("sections",e.courseDetailSections)}}var S=function(i){return i.ASSESSMENT="ASSESSMENT",i.COMPLAINTS="COMPLAINTS",i.FEEDBACK="FEEDBACK",i.AVERAGE_COURSE_SCORE="AVERAGE_COURSE_SCORE",i.AVERAGE_EXERCISE_SCORE="AVERAGE_EXERCISE_SCORE",i.PARTICIPATIONS="PARTICIPATIONS",i.QUESTIONS="QUESTIONS",i.CURRENT_LLM_COST="LLM_COST",i}(S||{}),bi=(()=>{class i{eventManager=x(Ce);courseManagementService=x(F);organizationService=x(ye);route=x(J);alertService=x(fe);profileService=x(xe);accountService=x(he);irisSettingsService=x(Ie);markdownService=x(ke);featureToggleService=x(ne);DoughnutChartType=S;FeatureToggle=U;courseDTO;activeStudents;course;courseDetailSections;messagingEnabled;communicationEnabled;irisEnabled=!1;irisChatEnabled=!1;ltiEnabled=!1;isAthenaEnabled=!1;tutorialEnabled=!1;isAdmin=!1;eventSubscriber;paramSub;faTimes=pe;faEye=ue;faWrench=ce;faTable=re;faFlag=ae;faListAlt=de;faChartBar=se;faClipboard=oe;ngOnInit(){return $(this,null,function*(){this.tutorialEnabled=yield L(this.featureToggleService.getFeatureToggleActive(U.TutorialGroups));let e=yield L(this.profileService.getProfileInfo());if(this.ltiEnabled=e?.activeProfiles.includes(ve),this.isAthenaEnabled=e?.activeProfiles.includes(_e),this.irisEnabled=e?.activeProfiles.includes(Se),this.irisEnabled){let n=yield L(this.irisSettingsService.getGlobalSettings());this.irisChatEnabled=n?.irisChatSettings?.enabled??!1}this.route.data.subscribe(({course:n})=>{n&&(this.course=n,this.messagingEnabled=!!this.course.courseInformationSharingConfiguration?.includes("MESSAGING"),this.communicationEnabled=!!this.course.courseInformationSharingConfiguration?.includes("COMMUNICATION"),this.fetchOrganizations(n.id)),this.isAdmin=this.accountService.isAdmin(),this.getCourseDetailSections()}),this.paramSub=this.route.params.subscribe(n=>{let r=n.courseId;this.fetchCourseStatistics(r),this.registerChangeInCourses(r)})})}getGeneralDetailSection(){let e=[{type:l.Text,title:"artemisApp.course.title",data:{text:this.course.title}},{type:l.Text,title:"artemisApp.course.shortName",data:{text:this.course.shortName}},{type:l.Link,title:"artemisApp.course.studentGroupName",data:{text:`${this.course.studentGroupName} (${this.course.numberOfStudents??0})`,routerLink:this.course.isAtLeastInstructor?["/course-management",this.course.id,"groups","students"]:void 0}},{type:l.Link,title:"artemisApp.course.teachingAssistantGroupName",data:{text:`${this.course.teachingAssistantGroupName} (${this.course.numberOfTeachingAssistants??0})`,routerLink:this.course.isAtLeastInstructor?["/course-management",this.course.id,"groups","tutors"]:void 0}},{type:l.Link,title:"artemisApp.course.editorGroupName",data:{text:`${this.course.editorGroupName} (${this.course.numberOfEditors??0})`,routerLink:this.course.isAtLeastInstructor?["/course-management",this.course.id,"groups","editors"]:void 0}},{type:l.Link,title:"artemisApp.course.instructorGroupName",data:{text:`${this.course.instructorGroupName} (${this.course.numberOfInstructors??0})`,routerLink:this.course.isAtLeastInstructor?["/course-management",this.course.id,"groups","instructors"]:void 0}},{type:l.Date,title:"artemisApp.course.startDate",data:{date:this.course.startDate}},{type:l.Date,title:"artemisApp.course.endDate",data:{date:this.course.endDate}},{type:l.Text,title:"artemisApp.course.semester",data:{text:this.course.semester}}];return this.course.organizations?.length&&e.splice(2,0,{type:l.Text,title:"artemisApp.course.organizations",data:{text:this.course.organizations.map(n=>n.name).join(", ")}}),{headline:"artemisApp.course.detail.sections.general",details:e}}getComplaintsDetails(){return this.course.complaintsEnabled?[{type:l.Text,title:"artemisApp.course.maxComplaints.title",data:{text:this.course.maxComplaints}},{type:l.Text,title:"artemisApp.course.maxTeamComplaints.title",data:{text:this.course.maxTeamComplaints}},{type:l.Text,title:"artemisApp.course.maxComplaintTimeDays.title",data:{text:this.course.maxComplaintTimeDays}},{type:l.Text,title:"artemisApp.course.maxComplaintTextLimit.title",data:{text:this.course.maxComplaintTextLimit}},{type:l.Text,title:"artemisApp.course.maxComplaintResponseTextLimit.title",data:{text:this.course.maxComplaintResponseTextLimit}}]:[]}getAthenaDetails(){let e=[];return this.isAthenaEnabled&&e.push({type:l.Boolean,title:"artemisApp.course.restrictedAthenaModulesAccess.label",data:{boolean:this.course.restrictedAthenaModulesAccess}}),e}getIrisDetails(){let e=[];return this.irisEnabled&&this.irisChatEnabled&&e.push({type:l.ProgrammingIrisEnabled,title:"artemisApp.iris.settings.subSettings.enabled.chat",data:{course:this.course,disabled:!this.isAdmin,subSettingsType:Pe.CHAT}}),e}getModeDetailSection(){let e=this.getComplaintsDetails(),n=this.getAthenaDetails(),r=this.getIrisDetails(),p=[{type:l.Text,title:"artemisApp.course.maxPoints.title",data:{text:this.course.maxPoints}},{type:l.Text,title:"artemisApp.course.accuracyOfScores",data:{text:this.course.accuracyOfScores}},{type:l.Text,title:"artemisApp.course.defaultProgrammingLanguage",data:{text:this.course.defaultProgrammingLanguage}},{type:l.Boolean,title:"artemisApp.course.testCourse.title",data:{boolean:this.course.testCourse}},...e,...n,...r];return this.course.requestMoreFeedbackEnabled&&p.splice(4+e.length,0,{type:l.Text,title:"artemisApp.course.maxRequestMoreFeedbackTimeDays.title",data:{text:this.course.maxRequestMoreFeedbackTimeDays}}),this.tutorialEnabled&&p.splice(4,0,{type:l.Text,title:"artemisApp.forms.configurationForm.timeZoneInput.label",titleHelpText:"artemisApp.forms.configurationForm.timeZoneInput.beta",data:{text:this.course.timeZone}}),this.ltiEnabled&&p.splice(4,0,{type:l.Boolean,title:"artemisApp.course.onlineCourse.title",data:{boolean:this.course.onlineCourse}}),{headline:"artemisApp.course.detail.sections.mode",details:p}}getEnrollmentDetailSection(){let e=[{type:l.Boolean,title:"artemisApp.course.enrollmentEnabled.title",data:{boolean:this.course.enrollmentEnabled}},{type:l.Boolean,title:"artemisApp.course.unenrollmentEnabled.title",data:{boolean:this.course.unenrollmentEnabled}}];return this.course.enrollmentEnabled&&e.splice(1,0,{type:l.Date,title:"artemisApp.course.enrollmentStartDate",data:{date:this.course.enrollmentStartDate}},{type:l.Date,title:"artemisApp.course.enrollmentEndDate",data:{date:this.course.enrollmentEndDate}},{type:l.Markdown,title:"artemisApp.course.enrollmentConfirmationMessage",data:{innerHtml:this.markdownService.safeHtmlForMarkdown(this.course.enrollmentConfirmationMessage)}}),this.course.unenrollmentEnabled&&e.push({type:l.Date,title:"artemisApp.course.unenrollmentEndDate",data:{date:this.course.unenrollmentEndDate}}),{headline:"artemisApp.course.detail.sections.enrollment",details:e}}getMessagingDetailSection(){return{headline:"artemisApp.course.detail.sections.messaging",details:[{type:l.Boolean,title:"artemisApp.course.courseCommunicationSetting.communicationEnabled.label",data:{boolean:this.communicationEnabled}},{type:l.Boolean,title:"artemisApp.course.courseCommunicationSetting.messagingEnabled.label",data:{boolean:this.messagingEnabled}},{type:l.Markdown,title:"artemisApp.course.courseCommunicationSetting.messagingEnabled.codeOfConduct",data:{innerHtml:this.markdownService.safeHtmlForMarkdown(this.course.courseInformationSharingMessagingCodeOfConduct)}}]}}getCourseDetailSections(){let e=this.getGeneralDetailSection(),n=this.getModeDetailSection(),r=this.getEnrollmentDetailSection(),p=this.getMessagingDetailSection();this.courseDetailSections=[e,n,r,p]}registerChangeInCourses(e){this.eventSubscriber=this.eventManager.subscribe("courseListModification",()=>{this.courseManagementService.find(e).subscribe(n=>{this.course=n.body,this.getCourseDetailSections()}),this.fetchCourseStatistics(e)})}ngOnDestroy(){this.paramSub&&this.paramSub.unsubscribe(),this.eventManager?.destroy(this.eventSubscriber)}fetchCourseStatistics(e){this.courseManagementService.getCourseStatisticsForDetailView(e).subscribe({next:n=>{this.courseDTO=n.body,this.activeStudents=n.body.activeStudents},error:n=>ge(this.alertService,n)})}fetchOrganizations(e){this.organizationService.getOrganizationsByCourse(e).subscribe(n=>{this.course.organizations=n,this.getCourseDetailSections()})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=D({type:i,selectors:[["jhi-course-detail"]],decls:5,vars:2,consts:[[1,"row","justify-content-center"],[1,"col-12"],[1,"row"],[1,"col-xxl-4"],[1,"doughnut-container","col-sm-6","my-3",3,"course","contentType","currentPercentage","currentAbsolute","currentMax"],[1,"col-xxl-8",3,"course","numberOfStudentsInCourse","initialStats"],[1,"doughnut-container","col-sm-6","my-3",3,"course","contentType","showText","currentMax"],[1,"col-12",3,"sections"]],template:function(n,r){n&1&&(o(0,"div",0),t(1,`
    `),C(2,xt,22,16)(3,Ct,3,1),s(),t(4,`
`)),n&2&&(a(2),h(r.course?2:-1),a(),h(r.courseDetailSections?3:-1))},dependencies:[Be,ze,Re],styles:["jhi-secured-image[_ngcontent-%COMP%]{padding-right:20px}jhi-secured-image[_ngcontent-%COMP%]     img{border-radius:50%;height:100px;width:auto;margin-bottom:10px}jhi-secured-image[_ngcontent-%COMP%] + h2[_ngcontent-%COMP%]{display:inline}.doughnut-container[_ngcontent-%COMP%]{min-width:200px}.fullscreen[_ngcontent-%COMP%]{margin-top:4px}@media (min-width: 1400px){.col-xxl-4[_ngcontent-%COMP%]{width:1/3%}.col-xxl-8[_ngcontent-%COMP%]{width:2/3%}}"]})}return i})();export{S as a,bi as b};
//# sourceMappingURL=chunk-I5BNMRWY.js.map
