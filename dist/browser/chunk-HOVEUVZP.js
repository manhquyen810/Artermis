import{r as R}from"./chunk-RTOKZMYN.js";import{a as J,b as X,c as Y,d as Z,e as ee,f as te,g as F}from"./chunk-D6LEDP6W.js";import{k as z}from"./chunk-VWRLJYRR.js";import{a as G}from"./chunk-R75LTV62.js";import{K as N,L as P,c as B,h as D,l as H,r as K}from"./chunk-WA5GEAJB.js";import{a as U}from"./chunk-K3W6YFKH.js";import{d as W}from"./chunk-EDXSOKK5.js";import{Oc as $}from"./chunk-Z4VHWOB5.js";import{s as Q,u as q}from"./chunk-IOA4DPXY.js";import{Db as s,Dc as A,La as L,Ma as m,Mc as d,Na as p,Oc as C,Tb as k,Va as M,Yc as y,Zc as f,_c as _,cd as E,dd as r,fd as T,kc as g,na as V,rd as j,uc as v,vc as x,wc as w,xc as n,yc as c,yd as I,z as h,zc as O,zd as b}from"./chunk-5LC5EQRR.js";var oe=["categoryInput"],ie=a=>({backgroundColor:a});function re(a,S){if(a&1){let e=A();r(0,`
            `),n(1,"mat-chip-row",8),d("removed",function(){let o=m(e).$implicit,i=C();return p(i.onItemRemove(o))}),r(2,`
                `),n(3,"div",9),r(4,`
                    `),n(5,"span",10),d("click",function(o){let i=m(e).$implicit,l=C();return p(l.openColorSelector(o,i))}),r(6),c(),r(7,`
                    `),n(8,"button",11),r(9,`
                        `),O(10,"fa-icon",12),r(11,`
                    `),c(),r(12,`
                `),c(),r(13,`
            `),c(),r(14,`
        `)}if(a&2){let e=S.$implicit,t=C();s(3),g("ngStyle",j(3,ie,e.color)),s(3),T(`
                        `,e.category,`
                    `),s(4),g("icon",t.faTimes)}}function ae(a,S){if(a&1&&(r(0,`
            `),n(1,"mat-option",13),r(2),c(),r(3,`
        `)),a&2){let e=S.$implicit;s(),g("value",e),s(),T(`
                `,e,`
            `)}}var ne=["#6ae8ac","#9dca53","#94a11c","#691b0b","#ad5658","#1b97ca","#0d3cc2","#0ab84f"],Ve=(()=>{class a{faTimes=$;separatorKeysCodes=[13,188,9];COLOR_SELECTOR_HEIGHT=150;categories;existingCategories;colorSelector;categoryInput;autocompleteTrigger;selectedCategories=new M;categoryColors=ne;selectedCategory;uniqueCategoriesForAutocomplete;categoryCtrl=new H(void 0);ngOnChanges(){this.uniqueCategoriesForAutocomplete=this.categoryCtrl.valueChanges.pipe(V(void 0),h(e=>e?this.filterCategories(e):this.existingCategoriesAsStringArray().slice()),h(e=>[...new Set(e)]),h(e=>e.filter(t=>!this.categoriesAsStringArray().includes(t.toLowerCase()))))}categoriesAsStringArray(){return this.categories?this.categories.map(e=>e.category?.toLowerCase()??""):[]}existingCategoriesAsStringArray(){return this.existingCategories?this.existingCategories.map(e=>e.category?.toLowerCase()??""):[]}filterCategories(e){let t=e.toLowerCase();return this.existingCategories.filter(o=>o.category.toLowerCase().includes(t)).map(o=>o.category.toLowerCase())}openColorSelector(e,t){this.selectedCategory=t,this.colorSelector.openColorSelector(e,void 0,this.COLOR_SELECTOR_HEIGHT)}onSelectedColor(e){this.selectedCategory.color=e,this.categories=this.categories.map(t=>t.category===this.selectedCategory.category?this.selectedCategory:t),this.selectedCategories.emit(this.categories)}onItemAdd(e){let t=(e.value||"").trim(),o=this.categoriesAsStringArray();if(t&&!o.includes(t)&&o.length<2){let i=this.findExistingCategory(t);i||(i=this.createCategory(t)),i.category=t,i.color||(i.color=this.chooseRandomColor()),this.categories?this.categories.push(i):this.categories=[i],this.selectedCategories.emit(this.categories)}e.chipInput.clear(),this.categoryCtrl.setValue(null),this.autocompleteTrigger.closePanel()}createCategory(e){return new G(e,this.chooseRandomColor())}chooseRandomColor(){let e=Math.floor(Math.random()*this.categoryColors.length);return this.categoryColors[e]}onItemSelect(e){let t=(e.option.value||"").trim(),o=this.categoriesAsStringArray();if(t&&!o.includes(t)&&o.length<2){let i=this.findExistingCategory(t);i||(i=this.createCategory(t)),this.categories.push(i),this.selectedCategories.emit(this.categories)}this.categoryInput.nativeElement.value="",this.categoryCtrl.setValue(null)}findExistingCategory(e){return this.existingCategories.find(t=>t.category?.toLowerCase()===e.toLowerCase())}onItemRemove(e){this.colorSelector.cancelColorSelector(),this.categories=this.categories.filter(t=>t.category!==e.category),this.selectedCategories.emit(this.categories)}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=k({type:a,selectors:[["jhi-category-selector"]],viewQuery:function(t,o){if(t&1&&(y(R,5),y(oe,5),y(F,5)),t&2){let i;f(i=_())&&(o.colorSelector=i.first),f(i=_())&&(o.categoryInput=i.first),f(i=_())&&(o.autocompleteTrigger=i.first)}},inputs:{categories:"categories",existingCategories:"existingCategories"},outputs:{selectedCategories:"selectedCategories"},features:[L],decls:22,vars:11,consts:[["chipList",""],["categoryInput",""],["auto","matAutocomplete"],["appearance","outline",1,"category-chip-list"],["aria-label","Category selection"],["id","field_categories",1,"category-chip-input",3,"matChipInputTokenEnd","hidden","placeholder","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes"],[3,"optionSelected"],[3,"selectedColor","tagColors"],[1,"category-chip",3,"removed"],[1,"custom-tag",3,"ngStyle"],[1,"category-name",3,"click"],["matChipRemove","",1,"remove-button"],[1,"category-chip-remove",3,"icon"],[1,"tag-option",3,"value"]],template:function(t,o){if(t&1){let i=A();n(0,"mat-form-field",3),r(1,`
    `),n(2,"mat-chip-grid",4,0),r(4,`
        `),x(5,re,15,5,null,null,v),n(7,"input",5,1),I(9,"artemisTranslate"),d("matChipInputTokenEnd",function(u){return m(i),p(o.onItemAdd(u))}),c(),r(10,`
    `),c(),r(11,`
    `),n(12,"mat-autocomplete",6,2),d("optionSelected",function(u){return m(i),p(o.onItemSelect(u))}),r(14,`
        `),x(15,ae,4,2,null,null,v),I(17,"async"),c(),r(18,`
`),c(),r(19,`
`),n(20,"jhi-color-selector",7),d("selectedColor",function(u){return m(i),p(o.onSelectedColor(u))}),c(),r(21,`
`)}if(t&2){let i=E(3),l=E(13);s(5),w(o.categories),s(2),g("hidden",o.categories&&o.categories.length>=2)("placeholder",b(9,7,"artemisApp.exercise.tagPlaceholder"))("formControl",o.categoryCtrl)("matAutocomplete",l)("matChipInputFor",i)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes),s(8),w(b(17,9,o.uniqueCategoriesForAutocomplete)),s(5),g("tagColors",o.categoryColors)}},dependencies:[J,Z,Y,Q,X,W,N,B,D,F,ee,P,K,te,z,R,q,U],styles:[`jhi-category-selector .category-chip-list{width:100%}jhi-category-selector .category-chip-list .category-chip{padding:0!important;height:30px!important;border-radius:.25rem!important;background:transparent!important}jhi-category-selector .category-chip-list .category-chip .custom-tag{padding:.15rem .45rem;background:#ccc;border-radius:.25rem;color:#fff;display:flex;align-items:center}jhi-category-selector .category-chip-list .category-chip .custom-tag:hover{opacity:.8}jhi-category-selector .category-chip-list .category-chip .custom-tag .category-chip-remove{color:#fff}jhi-category-selector .category-chip-input{color:var(--text-editor-color)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding, .5rem)!important;padding-bottom:var(--mat-form-field-container-vertical-padding, .5rem)!important;min-height:var(--mat-form-field-container-height, 1.75rem)!important}.mat-mdc-standard-chip.mdc-evolution-chip--with-trailing-action .mdc-evolution-chip__action--primary{padding-left:0!important;padding-right:0!important}.mat-mdc-standard-chip .mdc-evolution-chip__action--primary:before{border-style:none!important}.remove-button:before{position:absolute}.tag-option{background:#fff}.tag-option:hover{background:#ccc}
`],encapsulation:2})}return a})();export{Ve as a};
//# sourceMappingURL=chunk-HOVEUVZP.js.map
