import{f as S}from"./chunk-FAFORKWV.js";import{a as v}from"./chunk-OTCBNILH.js";import{c as n}from"./chunk-CK7FH6VF.js";import{a}from"./chunk-G3JOQOSD.js";import{a as y,b as $}from"./chunk-EELXLOHY.js";import{v as d}from"./chunk-5GXY5RYT.js";import{L as m,O as f}from"./chunk-IOA4DPXY.js";import{Ea as h,ya as b,z as i}from"./chunk-5LC5EQRR.js";import{a as l,b as g}from"./chunk-3E746U5Y.js";var I=(()=>{class c{http=h(f);exerciseService=h(n);sortService=h(v);resourceUrl="api/programming/programming-exercises";automaticSetup(e){let t=this.convertDataFromClient(e);return t=n.setBonusPointsConstrainedByIncludedInOverallScore(t),t.categories=n.stringifyExerciseCategories(t),this.http.post(this.resourceUrl+"/setup",t,{observe:"response"}).pipe(i(s=>this.processProgrammingExerciseEntityResponse(s)))}generateStructureOracle(e){return this.http.put(`${this.resourceUrl}/${e}/generate-tests`,{responseType:"text"})}reset(e,t){return this.http.put(`${this.resourceUrl}/${e}/reset`,t,{responseType:"text"})}checkPlagiarism(e,t){return this.http.get(`${this.resourceUrl}/${e}/check-plagiarism`,{observe:"response",params:l({},t?.toParams())}).pipe(i(s=>s.body))}checkPlagiarismJPlagReport(e,t){return this.http.get(`${this.resourceUrl}/${e}/check-plagiarism-jplag-report`,{observe:"response",responseType:"blob",params:l({},t?.toParams())})}getLatestPlagiarismResult(e){return this.http.get(`${this.resourceUrl}/${e}/plagiarism-result`,{observe:"response"}).pipe(i(t=>t.body))}combineTemplateRepositoryCommits(e){return this.http.put(`${this.resourceUrl}/${e}/combine-template-commits`,{responseType:"text"})}importExercise(e,t){let s=a(t),r=n.setBonusPointsConstrainedByIncludedInOverallScore(e);return r.categories=n.stringifyExerciseCategories(r),this.http.post(`${this.resourceUrl}/import/${e.id}`,r,{params:s,observe:"response"}).pipe(i(o=>this.processProgrammingExerciseEntityResponse(o)))}update(e,t){let s=a(t),r=this.convertDataFromClient(e);return r=n.setBonusPointsConstrainedByIncludedInOverallScore(r),r.categories=n.stringifyExerciseCategories(r),this.http.put(this.resourceUrl,r,{params:s,observe:"response"}).pipe(i(o=>this.processProgrammingExerciseEntityResponse(o)))}updateTimeline(e,t){let s=a(t),r=this.convertDataFromClient(e);return this.http.put(`${this.resourceUrl}/timeline`,r,{params:s,observe:"response"}).pipe(i(o=>this.processProgrammingExerciseEntityResponse(o)))}updateProblemStatement(e,t,s){let r=a(s);return this.http.patch(`${this.resourceUrl}/${e}/problem-statement`,t,{params:r,observe:"response"}).pipe(i(o=>this.processProgrammingExerciseEntityResponse(o)))}find(e,t=!1){return this.http.get(`${this.resourceUrl}/${e}`,{observe:"response",params:{withPlagiarismDetectionConfig:t}}).pipe(i(s=>this.processProgrammingExerciseEntityResponse(s)))}findWithTemplateAndSolutionParticipationAndResults(e){return this.http.get(`${this.resourceUrl}/${e}/with-participations`,{observe:"response"}).pipe(i(t=>this.processProgrammingExerciseEntityResponse(t)))}findWithTemplateAndSolutionParticipation(e,t=!1,s=!1){let r=new m;return r=r.set("withSubmissionResults",t.toString()).set("withGradingCriteria",s.toString()),this.http.get(`${this.resourceUrl}/${e}/with-template-and-solution-participation`,{params:r,observe:"response"}).pipe(i(o=>{if(o.body&&t){let p=o.body.templateParticipation?.submissions;this.reconnectSubmissionAndResult(p);let u=o.body.solutionParticipation?.submissions;this.reconnectSubmissionAndResult(u),this.processProgrammingExerciseEntityResponse(o)}return o}))}findWithTemplateAndSolutionParticipationAndLatestResults(e){return this.findWithTemplateAndSolutionParticipation(e,!0).pipe(i(t=>(t.body&&this.setLatestResultForTemplateAndSolution(t.body),t)))}findWithAuxiliaryRepository(e){return this.http.get(`${this.resourceUrl}/${e}/with-auxiliary-repository`,{observe:"response"})}setLatestResultForTemplateAndSolution(e){if(e.templateParticipation){let t=this.getLatestResult(e.templateParticipation);t&&(e.templateParticipation.results=[t]),e.templateParticipation.programmingExercise=e}if(e.solutionParticipation){let t=this.getLatestResult(e.solutionParticipation);t&&(e.solutionParticipation.results=[t]),e.solutionParticipation.programmingExercise=e}}getLatestResult(e){let t=e.submissions;if(!t||t.length===0)return;this.sortService.sortByProperty(t,"submissionDate",!0);let s=t.sort().last()?.results;if(s&&s.length>0)return s.last()}reconnectSubmissionAndResult(e){e&&e.forEach(t=>{t.results&&t.results.forEach(s=>{s.submission=t})})}getProgrammingExerciseTestCaseState(e){return this.http.get(`${this.resourceUrl}/${e}/test-case-state`,{observe:"response"})}query(e){let t=a(e);return this.http.get(this.resourceUrl,{params:t,observe:"response"}).pipe(i(s=>this.exerciseService.processExerciseEntityArrayResponse(s)))}delete(e,t,s){let r=new m;return s!=null&&t!=null&&(r=r.set("deleteStudentReposBuildPlans",t.toString()),r=r.set("deleteBaseReposBuildPlans",s.toString())),this.http.delete(`${this.resourceUrl}/${e}`,{params:r,observe:"response"})}convertDataFromClient(e){let t=g(l({},n.convertExerciseDatesFromClient(e)),{buildAndTestStudentSubmissionsAfterDueDate:y(e.buildAndTestStudentSubmissionsAfterDueDate)});return t.templateParticipation&&(t.templateParticipation=d(t.templateParticipation,["exercise","results"])),t.solutionParticipation&&(t.solutionParticipation=d(t.solutionParticipation,["exercise","results"])),t}static convertProgrammingExerciseResponseDatesFromServer(e){let t=n.convertExerciseResponseDatesFromServer(e);return t.body&&(t.body.buildAndTestStudentSubmissionsAfterDueDate=$(t.body.buildAndTestStudentSubmissionsAfterDueDate)),t}unlockAllRepositories(e){return this.http.post(`${this.resourceUrl}/${e}/unlock-all-repositories`,{},{observe:"response"})}lockAllRepositories(e){return this.http.post(`${this.resourceUrl}/${e}/lock-all-repositories`,{},{observe:"response"})}exportInstructorRepository(e,t,s){return t===S.AUXILIARY&&s!==void 0?this.http.get(`${this.resourceUrl}/${e}/export-instructor-auxiliary-repository/${s}`,{observe:"response",responseType:"blob"}):this.http.get(`${this.resourceUrl}/${e}/export-instructor-repository/${t}`,{observe:"response",responseType:"blob"})}exportStudentRepository(e,t){return this.http.get(`${this.resourceUrl}/${e}/export-student-repository/${t}`,{observe:"response",responseType:"blob"})}exportInstructorExercise(e){return this.http.get(`${this.resourceUrl}/${e}/export-instructor-exercise`,{observe:"response",responseType:"blob"})}exportStudentRequestedRepository(e,t){let s=new m;return s=s.set("includeTests",t.toString()),this.http.get(`${this.resourceUrl}/${e}/export-student-requested-repository`,{params:s,observe:"response",responseType:"blob"})}reevaluateAndUpdate(e,t){let s=a(t),r=this.convertDataFromClient(e);return r=n.setBonusPointsConstrainedByIncludedInOverallScore(r),r.categories=n.stringifyExerciseCategories(r),this.http.put(`${this.resourceUrl}/${e.id}/re-evaluate`,r,{params:s,observe:"response"}).pipe(i(o=>this.exerciseService.processExerciseEntityResponse(o)))}processProgrammingExerciseEntityResponse(e){return c.convertProgrammingExerciseResponseDatesFromServer(e),n.convertExerciseCategoriesFromServer(e),this.exerciseService.setAccessRightsExerciseEntityResponseType(e),this.exerciseService.sendExerciseTitleToTitleService(e?.body??void 0),e}getDiffReport(e){return this.http.get(`${this.resourceUrl}/${e}/diff-report`,{observe:"response"}).pipe(i(t=>t.body??void 0))}getDiffReportForSubmissions(e,t,s){return this.http.get(`${this.resourceUrl}/${e}/submissions/${t}/diff-report/${s}`,{observe:"response"}).pipe(i(r=>r.body??void 0))}getDiffReportForSubmissionWithTemplate(e,t){return this.http.get(`${this.resourceUrl}/${e}/submissions/${t}/diff-report-with-template`,{observe:"response"}).pipe(i(s=>s.body??void 0))}getDiffReportForCommits(e,t,s,r,o){let p={};return o!==void 0&&(p.repositoryType=o),t!==void 0&&!isNaN(t)&&(p.participationId=t),this.http.get(`${this.resourceUrl}/${e}/commits/${s}/diff-report/${r}`,{observe:"response",params:p}).pipe(i(u=>u.body??void 0))}getSolutionRepositoryTestFilesWithContent(e){return this.http.get(`${this.resourceUrl}/${e}/solution-files-content?omitBinaries=true`).pipe(i(t=>t&&new Map(Object.entries(t))))}getTemplateRepositoryTestFilesWithContent(e){return this.http.get(`${this.resourceUrl}/${e}/template-files-content?omitBinaries=true`).pipe(i(t=>t&&new Map(Object.entries(t))))}getBuildLogStatistics(e){return this.http.get(`${this.resourceUrl}/${e}/build-log-statistics`)}importFromFile(e,t){let s=this.convertDataFromClient(e);s=n.setBonusPointsConstrainedByIncludedInOverallScore(s),s.categories=n.stringifyExerciseCategories(s);let r=new FormData;r.append("file",e.zipFileForImport);let o=new Blob([JSON.stringify(s)],{type:"application/json"});r.append("programmingExercise",o);let p=`api/programming/courses/${t}/programming-exercises/import-from-file`;return this.http.post(p,r,{observe:"response"}).pipe(i(u=>this.processProgrammingExerciseEntityResponse(u)))}getCheckoutDirectoriesForProgrammingLanguage(e,t){return this.http.get(`${this.resourceUrl}/repository-checkout-directories`,{params:{programmingLanguage:e,checkoutSolution:t}})}static \u0275fac=function(t){return new(t||c)};static \u0275prov=b({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();export{I as a};
//# sourceMappingURL=chunk-SLVT6IA5.js.map
