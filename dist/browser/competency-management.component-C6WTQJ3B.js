import{a as Zt}from"./chunk-CNZ75VIL.js";import{a as Jt,b as en}from"./chunk-EWZHEKEG.js";import{a as Yt}from"./chunk-QE5JM26C.js";import{a as ue,b as Xt}from"./chunk-NV4PYWIT.js";import"./chunk-7MKMUXV6.js";import{b as he,d as H,q as Ge}from"./chunk-DOLVNMRR.js";import{a as Kt}from"./chunk-QZKVSIAC.js";import{a as Ut}from"./chunk-JRBFEQNN.js";import"./chunk-DIZEKHOC.js";import"./chunk-V7PDYRDZ.js";import"./chunk-EANMTTQG.js";import{a as We}from"./chunk-VTF2OQPK.js";import"./chunk-LARBQRTJ.js";import"./chunk-OTNXTVPX.js";import"./chunk-OTCBNILH.js";import{a as de}from"./chunk-W7RIOT23.js";import{a as $t,b as Qt}from"./chunk-VRAVBLUK.js";import{b as Bt}from"./chunk-T624HJJL.js";import"./chunk-HQTS6JOY.js";import"./chunk-HMZID6NQ.js";import{d as Vt}from"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import{a as zt,c as Wt,d as Gt,e as qt,f as Ht}from"./chunk-HK7MJBP6.js";import"./chunk-2CUFQLAH.js";import"./chunk-MKPB4JKY.js";import"./chunk-I76AVIQH.js";import"./chunk-H2ETPEH6.js";import"./chunk-Z6NSEM73.js";import"./chunk-MLVGKM2P.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import{c as ce}from"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import{c as Nt}from"./chunk-JNO6DNVW.js";import"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import{D as je,G as bt,K as ke,L as Pe,M as Fe,O as Oe,i as _t,q as Tt,r as St,s as vt,u as pe,v as De}from"./chunk-VZRSC3LP.js";import{c as we}from"./chunk-5SKDOIBQ.js";import{K as J,b as yt,c as Re,h as le,i as ft,k as gt,m as se,n as ht,w as xt,x as Ae,z as Me}from"./chunk-WA5GEAJB.js";import{r as Lt}from"./chunk-VK7JPHFE.js";import{c as Ot}from"./chunk-BNDLMKXK.js";import"./chunk-BQNBT6PW.js";import"./chunk-5GXY5RYT.js";import{a as V}from"./chunk-K3W6YFKH.js";import{c as q}from"./chunk-JXJXC4DZ.js";import{d as P,f as F}from"./chunk-EDXSOKK5.js";import"./chunk-R5BZWVRQ.js";import"./chunk-DID2YGL7.js";import"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Bb as Ne,Bd as Ft,Da as me,Lc as Ve,Nc as Be,Q as At,Qa as Mt,Zc as ze,_c as Pt,i as wt,j as Rt,jb as Dt,kb as jt,q as Le,vb as kt}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import{a as Et,b as It}from"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as E}from"./chunk-U54OSGNH.js";import{f as Ct,i as Ee,m as Ie}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import{A as dt,E as Z,O as ut,n as ve,t as be}from"./chunk-IOA4DPXY.js";import{Cc as ie,Db as l,Dc as b,Ea as f,Ed as Y,L as Je,Ma as h,Mb as rt,Mc as C,Na as x,Oa as _e,Oc as u,Pa as et,Pb as G,Pd as ge,Qa as tt,Qd as S,Rd as z,Tb as v,Va as nt,Xb as at,Ya as oe,Za as j,Zb as g,_a as it,ab as _,ad as st,bd as pt,cd as re,dd as e,ed as N,f as fe,fd as ae,jc as Te,kc as m,lc as lt,ld as M,mc as Se,md as w,nd as k,od as mt,pd as ct,rd as K,sc as I,sd as $,td as X,uc as U,vc as O,w as Ye,wb as ot,wc as L,x as Ze,xc as r,ya as xe,yc as a,yd as R,z as ne,zc as s,zd as A}from"./chunk-5LC5EQRR.js";import{a as W,b as Q,j as T}from"./chunk-3E746U5Y.js";var un=(i,c)=>({sortedColumn:"ID",currentSortedColumn:i,sortingOrder:c}),Cn=(i,c,t)=>({sortedColumn:i,currentSortedColumn:c,sortingOrder:t}),yn=(i,c)=>c.id;function fn(i,c){if(i&1&&(e(0,`
                `),s(1,"fa-icon",12),e(2,`
            `)),i&2){let t=u();l(),m("icon",t.faSpinner)}}function gn(i,c){i&1&&ie(0)}function hn(i,c){i&1&&ie(0)}function xn(i,c){if(i&1){let t=b();e(0,`
                    `),r(1,"th",13),C("click",function(){let n=h(t).$implicit,p=u();return x(p.setSortedColumn(n.name))}),e(2,`
                        `),r(3,"div",3),e(4,`
                            `),s(5,"span",14),e(6,`
                            `),g(7,hn,1,0,"ng-container",10),e(8,`
                        `),a(),e(9,`
                    `),a(),e(10,`
                `)}if(i&2){let t=c.$implicit,o=u(),n=re(53);l(5),m("jhiTranslate",o.columnBaseTranslationKey()+".table.columns."+t.name),l(2),m("ngTemplateOutlet",n)("ngTemplateOutletContext",X(3,Cn,t.name,o.sortedColumn(),o.sortingOrder()))}}function _n(i,c){if(i&1&&(e(0,`
                        `),r(1,"td",18),e(2,`
                            `),s(3,"ngb-highlight",19),e(4,`
                        `),a(),e(5,`
                    `)),i&2){let t=c.$implicit,o=u().$implicit,n=u();l(3),m("result",t.getProperty(o))("term",n.searchTerm())}}function Tn(i,c){if(i&1){let t=b();e(0,`
                `),r(1,"tr",15),e(2,`
                    `),r(3,"td",16),e(4,`
                        `),r(5,"span"),e(6),a(),e(7,`
                    `),a(),e(8,`
                    `),O(9,_n,6,2,null,null,U),r(11,"td",16),e(12,`
                        `),r(13,"button",17),C("click",function(){let n=h(t).$implicit,p=u();return x(p.selectRow(n))}),e(14,"Select"),a(),e(15,`
                    `),a(),e(16,`
                `),a(),e(17,`
            `)}if(i&2){let t=c.$implicit,o=u();l(6),N(t.id),l(3),L(o.columns())}}function Sn(i,c){if(i&1&&(e(0,`
                `),r(1,"tr"),e(2,`
                    `),r(3,"td",20),s(4,"em",21),a(),e(5,`
                `),a(),e(6,`
            `)),i&2){let t=u();l(3),m("colSpan",t.numberOfColumns())}}function vn(i,c){if(i&1&&(e(0,`
        `),s(1,"fa-icon",22),e(2,`
    `)),i&2){let t=u(2);l(),m("icon",t.faSort)}}function bn(i,c){if(i&1&&(e(0,`
        `),s(1,"fa-icon",22),e(2,`
    `)),i&2){let t=u().sortingOrder,o=u();l(),m("icon",t===o.SortingOrder.DESCENDING?o.faSortDown:o.faSortUp)}}function En(i,c){if(i&1&&(e(0,`
    `),g(1,vn,3,1)(2,bn,3,1)),i&2){let t=c.sortedColumn,o=c.currentSortedColumn;l(),I(t!==o?1:2)}}var nn=(()=>{class i{SortingOrder=de;faSort=Mt;faSortUp=kt;faSortDown=Rt;faSpinner=ze;alertService=f(q);pagingService=f(ue);columns=j.required();columnBaseTranslationKey=j.required();disabledIds=j([]);numberOfColumns=S(()=>this.columns().length+2);onRowSelection=oe();isLoading=_(!1);searchResult=_(void 0);resultsOnPage=S(()=>this.searchResult()?.resultsOnPage??[]);DEFAULT_SORTING_ORDER=de.ASCENDING;PAGE_SIZE=10;searchTerm=_("");sortingOrder=_(this.DEFAULT_SORTING_ORDER);sortedColumn=_("ID");page=_(1);pageSize=_(this.PAGE_SIZE).asReadonly();collectionSize=S(()=>{let t=this.searchResult()?.numberOfPages??1;return t===1?this.resultsOnPage().length:t*this.pageSize()});constructor(){z(()=>{ge(()=>T(this,null,function*(){return yield this.loadData()}))})}loadData(){return T(this,null,function*(){try{this.isLoading.set(!0);let t={searchTerm:this.searchTerm(),page:this.page(),sortedColumn:this.sortedColumn(),sortingOrder:this.sortingOrder(),pageSize:this.pageSize()},o=yield Ye(this.pagingService.search(t)),n=this.filterSearchResult(o);this.searchResult.set(n)}catch(t){ce(this.alertService,t)}finally{this.isLoading.set(!1)}})}debouncedDataLoad=We.debounce(this.loadData.bind(this),300);filterSearchResult(t){return Q(W({},t),{resultsOnPage:t.resultsOnPage?.filter(o=>!this.disabledIds().includes(o.id))})}setSortedColumn(t){return T(this,null,function*(){let o=this.sortingOrder()===de.ASCENDING?de.DESCENDING:de.ASCENDING;this.sortingOrder.set(this.sortedColumn()===t?o:this.DEFAULT_SORTING_ORDER),this.sortedColumn.set(t),yield this.loadData()})}setPage(t){return T(this,null,function*(){this.page.set(t),yield this.loadData()})}search(){this.debouncedDataLoad()}selectRow(t){this.onRowSelection.emit(t)}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-import-table"]],inputs:{columns:[1,"columns"],columnBaseTranslationKey:[1,"columnBaseTranslationKey"],disabledIds:[1,"disabledIds"]},outputs:{onRowSelection:"onRowSelection"},decls:55,vars:15,consts:[["sortIcon",""],[1,"d-flex","align-items-center","justify-content-between"],[1,"m-0",3,"jhiTranslate"],[1,"d-flex","align-items-center"],["id","import-objects-search","type","search","aria-label","Search",1,"form-control","ms-2","rounded",3,"ngModelChange","placeholder","ngModel"],[1,"my-2"],[1,"import-table-container"],[1,"table","align-middle","table-striped"],[1,"col-1","clickable"],[1,"d-flex","align-items-center",3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["size","sm",1,"d-flex","justify-content-end","mt-2","pagination",3,"pageChange","collectionSize","pageSize","page"],["animation","spin",3,"icon"],[1,"col-4","clickable",3,"click"],[3,"jhiTranslate"],[1,"flex-row"],[1,"col-1"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"text-break","col-4"],[3,"result","term"],[1,"text-center","text-secondary",3,"colSpan"],["jhiTranslate","global.generic.emptyList"],[1,"ms-1",3,"icon"]],template:function(o,n){if(o&1){let p=b();r(0,"div",1),e(1,`
    `),s(2,"h5",2),e(3,`
    `),r(4,"div"),e(5,`
        `),r(6,"div",3),e(7,`
            `),g(8,fn,3,1),r(9,"input",4),R(10,"artemisTranslate"),k("ngModelChange",function(y){return h(p),w(n.searchTerm,y)||(n.searchTerm=y),x(y)}),C("ngModelChange",function(){return h(p),x(n.search())}),a(),e(11,`
        `),a(),e(12,`
    `),a(),e(13,`
`),a(),e(14,`
`),s(15,"hr",5),e(16,`
`),r(17,"div",6),e(18,`
    `),r(19,"table",7),e(20,`
        `),r(21,"thead"),e(22,`
            `),r(23,"tr"),e(24,`
                `),r(25,"th",8),e(26,`
                    `),r(27,"div",9),C("click",function(){return h(p),x(n.setSortedColumn("ID"))}),e(28,`
                        `),r(29,"span"),e(30,"#"),a(),e(31,`
                        `),g(32,gn,1,0,"ng-container",10),e(33,`
                    `),a(),e(34,`
                `),a(),e(35,`
                `),O(36,xn,11,7,null,null,U),s(38,"th"),e(39,`
            `),a(),e(40,`
        `),a(),e(41,`
        `),r(42,"tbody"),e(43,`
            `),O(44,Tn,18,1,null,null,yn,!1,Sn,7,1),a(),e(47,`
    `),a(),e(48,`
`),a(),e(49,`
`),r(50,"ngb-pagination",11),C("pageChange",function(y){return h(p),x(n.setPage(y))}),a(),e(51,`

`),g(52,En,3,1,"ng-template",null,0,Y),e(54,`
`)}if(o&2){let p=re(53);l(2),m("jhiTranslate",n.columnBaseTranslationKey()+".table.title"),l(6),I(n.isLoading()?8:-1),l(),m("placeholder",A(10,10,"global.importTable.searchPlaceholder")),M("ngModel",n.searchTerm),l(23),m("ngTemplateOutlet",p)("ngTemplateOutletContext",$(12,un,n.sortedColumn(),n.sortingOrder())),l(4),L(n.columns()),l(8),L(n.resultsOnPage()),l(6),m("collectionSize",n.collectionSize())("pageSize",n.pageSize())("page",n.page())}},dependencies:[je,V,E,F,P,J,Re,le,se,Oe,Fe,Z,be],styles:[".import-table-container[_ngcontent-%COMP%]{height:280px;overflow-y:scroll}.import-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1;background-color:var(--bs-modal-bg)}"]})}return i})();var qe=(()=>{class i extends ue{http=f(ut);RESOURCE_URL="api/core/courses";constructor(){super()}search(t){let o=this.createHttpParams(t);return this.http.get(`${this.RESOURCE_URL}/for-import`,{params:o,observe:"response"}).pipe(ne(n=>n&&n.body))}static \u0275fac=function(o){return new(o||i)};static \u0275prov=xe({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var In=(i,c,t)=>({value:i,setting:"importRelations",label:c,tooltip:t}),wn=(i,c,t)=>({value:i,setting:"importExercises",label:c,tooltip:t}),Rn=(i,c,t)=>({value:i,setting:"importLectures",label:c,tooltip:t});function An(i,c){i&1&&ie(0)}function Mn(i,c){i&1&&ie(0)}function Dn(i,c){i&1&&ie(0)}function jn(i,c){if(i&1){let t=b();e(0,`
    `),r(1,"div",22),e(2,`
        `),r(3,"input",23),C("click",function(){let n=h(t).setting,p=u();return x(p.toggleImportSetting(n))}),a(),e(4,`
        `),s(5,"label",24),e(6,`
        `),s(7,"fa-icon",9),R(8,"artemisTranslate"),e(9,`
    `),a(),e(10,`
`)}if(i&2){let t=c.value,o=c.setting,n=c.label,p=c.tooltip,d=u();l(3),m("id",o+"-checkbox")("checked",t),l(2),m("for",o+"-checkbox")("jhiTranslate",n),l(2),m("icon",d.faQuestionCircle)("ngbTooltip",A(8,6,p))}}var He=class{importRelations=!1;importExercises=!1;importLectures=!1;referenceDate=void 0;isReleaseDate=void 0},on=(()=>{class i{faQuestionCircle=jt;faCalendarAlt=wt;faCircleXmark=Ft;importSettings=G.required();importRelations=S(()=>this.importSettings().importRelations);importExercises=S(()=>this.importSettings().importExercises);importLectures=S(()=>this.importSettings().importLectures);referenceDate=S(()=>this.importSettings().referenceDate);isReleaseDate=S(()=>this.importSettings().isReleaseDate);toggleImportSetting(t){this.importSettings.update(o=>Q(W({},o),{[t]:!o[t]}))}setReferenceDate(t){this.importSettings.update(o=>Q(W({},o),{referenceDate:t?new Date(t.value):void 0,isReleaseDate:t?o.referenceDate?o.isReleaseDate:!0:void 0}))}setReferenceDateType(t){let o=t.target;this.importSettings.update(n=>Q(W({},n),{isReleaseDate:JSON.parse(o.value)}))}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-import-course-competencies-settings"]],inputs:{importSettings:[1,"importSettings"]},outputs:{importSettings:"importSettingsChange"},decls:74,vars:38,consts:[["dt",""],["importSettingTemplate",""],[1,"import-settings-container","p-3"],[1,"row","m-0"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"my-3"],[1,"col","p-0","pe-2"],[1,"d-flex","align-items-center"],["for","reference-date-field","jhiTranslate","artemisApp.courseCompetency.importSettings.referenceDateLabel"],["size","sm",1,"ms-1","text-secondary",3,"icon","ngbTooltip"],[1,"d-flex"],["id","reference-date-field","type","text","name","datePicker",1,"form-control","position-relative","ps-5",3,"dateTimeChange","value","owlDateTime","owlDateTimeTrigger"],["type","button",1,"btn","position-absolute",3,"owlDateTimeTrigger"],[3,"icon"],[1,"position-relative"],["type","button",1,"btn","position-absolute",2,"right","0",3,"click"],[1,"col","p-0","ps-2","align-items-center"],["for","reference-date-type-select","jhiTranslate","artemisApp.courseCompetency.importSettings.referenceDateTypeLabel"],["id","reference-date-type-select","name","dateTypes",1,"form-select",3,"change","required","disabled","value"],["disabled","","jhiTranslate","artemisApp.courseCompetency.importSettings.referenceDateType.noSelection",3,"selected"],["value","true","jhiTranslate","artemisApp.courseCompetency.importSettings.referenceDateType.releaseDate"],["value","false","jhiTranslate","artemisApp.courseCompetency.importSettings.referenceDateType.dueDate"],[1,"col","p-0","d-flex","align-items-center"],["type","checkbox",3,"click","id","checked"],[1,"ms-2",3,"for","jhiTranslate"]],template:function(o,n){if(o&1){let p=b();r(0,"div",2),e(1,`
    `),r(2,"div",3),e(3,`
        `),mt(4),e(5,`
        `),g(6,An,1,0,"ng-container",4),e(7,`
        `),g(8,Mn,1,0,"ng-container",4),e(9,`
        `),g(10,Dn,1,0,"ng-container",4),e(11,`
    `),a(),e(12,`
    `),s(13,"hr",5),e(14,`
    `),r(15,"div",3),e(16,`
        `),r(17,"div",6),e(18,`
            `),r(19,"div",7),e(20,`
                `),s(21,"label",8),e(22,`
                `),s(23,"fa-icon",9),R(24,"artemisTranslate"),e(25,`
            `),a(),e(26,`
            `),r(27,"div",10),e(28,`
                `),r(29,"input",11),C("dateTimeChange",function(y){return h(p),x(n.setReferenceDate(y))}),a(),e(30,`
                `),r(31,"button",12),e(32,`
                    `),s(33,"fa-icon",13),e(34,`
                `),a(),e(35,`
                `),r(36,"div",14),e(37,`
                    `),r(38,"button",15),C("click",function(){return h(p),x(n.setReferenceDate(void 0))}),e(39,`
                        `),s(40,"fa-icon",13),e(41,`
                    `),a(),e(42,`
                `),a(),e(43,`
                `),s(44,"owl-date-time",null,0),e(46,`
            `),a(),e(47,`
        `),a(),e(48,`
        `),r(49,"div",16),e(50,`
            `),r(51,"div",7),e(52,`
                `),s(53,"label",17),e(54,`
                `),s(55,"fa-icon",9),R(56,"artemisTranslate"),e(57,`
            `),a(),e(58,`
            `),r(59,"select",18),C("change",function(y){return h(p),x(n.setReferenceDateType(y))}),e(60,`
                `),s(61,"option",19),e(62,`
                `),s(63,"option",20),e(64,`
                `),s(65,"option",21),e(66,`
            `),a(),e(67,`
        `),a(),e(68,`
    `),a(),e(69,`
`),a(),e(70,`

`),g(71,jn,11,8,"ng-template",null,1,Y),e(73,`
`)}if(o&2){let p=re(45),d=re(72),y="artemisApp.courseCompetency.importSettings";l(6),m("ngTemplateOutlet",d)("ngTemplateOutletContext",X(26,In,n.importRelations(),y+".importRelationsLabel",y+".importRelationsTooltip")),l(2),m("ngTemplateOutlet",d)("ngTemplateOutletContext",X(30,wn,n.importExercises(),y+".importExercisesLabel",y+".importExercisesTooltip")),l(2),m("ngTemplateOutlet",d)("ngTemplateOutletContext",X(34,Rn,n.importLectures(),y+".importLecturesLabel",y+".importLecturesTooltip")),l(13),m("icon",n.faQuestionCircle)("ngbTooltip",A(24,22,"artemisApp.courseCompetency.importSettings.referenceDateTooltip")),l(6),m("value",n.referenceDate())("owlDateTime",p)("owlDateTimeTrigger",p),l(2),m("owlDateTimeTrigger",p),l(2),m("icon",n.faCalendarAlt),l(7),Se("text-secondary",!n.referenceDate()),m("icon",n.faCircleXmark),l(15),m("icon",n.faQuestionCircle)("ngbTooltip",A(56,24,"artemisApp.courseCompetency.importSettings.referenceDateTypeTooltip")),l(4),m("required",n.referenceDate())("disabled",!n.referenceDate())("value",n.isReleaseDate()),l(2),m("selected",n.isReleaseDate()===void 0)}},dependencies:[Pe,ke,J,Ae,Me,Z,be,F,P,qt,zt,Gt,Wt,Ht,V,E],styles:[".import-settings-container[_ngcontent-%COMP%]{background-color:var(--bs-body-bg);border-radius:var(--bs-border-radius-lg)}"]})}return i})();var kn=[{name:"TITLE",getProperty:i=>i.title},{name:"SHORT_NAME",getProperty:i=>i.shortName},{name:"SEMESTER",getProperty:i=>i.semester}],rn=(()=>{class i{tableColumns=kn;closeIcon=Be;activeModal=f(pe);courseId=j.required();disabledIds=S(()=>[+this.courseId()]);importSettings=_(new He);selectCourse(t){let o=W({sourceCourseId:t.id},this.importSettings());this.activeModal.close({course:t,courseCompetencyImportOptions:o})}closeModal(){this.activeModal.close()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-import-all-course-competencies-modal"]],inputs:{courseId:[1,"courseId"]},features:[ct([{provide:ue,useClass:qe}])],decls:25,vars:4,consts:[[1,"col","p-3"],[1,"d-flex","justify-content-between"],["jhiTranslate","artemisApp.courseCompetency.importAll.title",1,"m-0"],["id","close-button","size","lg","aria-label","Close",1,"clickable",3,"click","icon"],[1,"m-0"],[1,"p-3"],[3,"importSettingsChange","importSettings"],[1,"mt-4"],["columnBaseTranslationKey","artemisApp.courseCompetency.importAll","title","artemisApp.courseCompetency.importAll.table.title",3,"onRowSelection","columns","disabledIds"]],template:function(o,n){o&1&&(r(0,"div"),e(1,`
    `),r(2,"div",0),e(3,`
        `),r(4,"div",1),e(5,`
            `),s(6,"h5",2),e(7,`
            `),r(8,"fa-icon",3),C("click",function(){return n.closeModal()}),a(),e(9,`
        `),a(),e(10,`
    `),a(),e(11,`
    `),s(12,"hr",4),e(13,`
    `),r(14,"div",5),e(15,`
        `),r(16,"jhi-import-course-competencies-settings",6),k("importSettingsChange",function(d){return w(n.importSettings,d)||(n.importSettings=d),d}),a(),e(17,`
        `),r(18,"div",7),e(19,`
            `),r(20,"jhi-import-table",8),C("onRowSelection",function(d){return n.selectCourse(d)}),a(),e(21,`
        `),a(),e(22,`
    `),a(),e(23,`
`),a(),e(24,`
`)),o&2&&(l(8),m("icon",n.closeIcon),l(8),M("importSettings",n.importSettings),l(4),m("columns",n.tableColumns)("disabledIds",n.disabledIds()))},dependencies:[nn,on,P,E],encapsulation:2})}return i})();var ye=(()=>{class i extends We{basePath="atlas/courses/$courseId/course-competencies";getPath(t){return this.basePath.replace("$courseId",t.toString())}importAllByCourseId(t,o){return T(this,null,function*(){return yield this.post(`${this.getPath(t)}/import-all`,o)})}createCourseCompetencyRelation(t,o){return T(this,null,function*(){return yield this.post(`${this.getPath(t)}/relations`,o)})}updateCourseCompetencyRelation(t,o,n){return T(this,null,function*(){return yield this.patch(`${this.getPath(t)}/relations/${o}`,n)})}deleteCourseCompetencyRelation(t,o){return T(this,null,function*(){return yield this.delete(`${this.getPath(t)}/relations/${o}`)})}getCourseCompetencyRelationsByCourseId(t){return T(this,null,function*(){return yield this.get(`${this.getPath(t)}/relations`)})}getCourseCompetencyRelations(t){return T(this,null,function*(){return yield this.get(`${this.getPath(t)}/relations`)})}getCourseCompetenciesByCourseId(t){return T(this,null,function*(){return yield this.get(`${this.getPath(t)}`)})}static \u0275fac=(()=>{let t;return function(n){return(t||(t=tt(i)))(n||i)}})();static \u0275prov=xe({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Pn(i,c){i&1&&(e(0,`
                `),s(1,"span",17),e(2,`
            `))}function Fn(i,c){if(i&1&&(e(0,`
                        `),r(1,"th",18),e(2,`
                            `),r(3,"span"),e(4),R(5,"artemisTranslate"),a(),e(6,`
                            `),s(7,"fa-icon",13),e(8,`
                        `),a(),e(9,`
                    `)),i&2){let t=c.$implicit,o=u();l(),m("jhiSortBy",t.name),l(3),N(A(5,3,"artemisApp.competency.importAll.table."+t.name)),l(3),m("icon",o.faSort)}}function On(i,c){if(i&1&&(e(0,`
                            `),r(1,"td",21),e(2,`
                                `),s(3,"ngb-highlight",22),e(4,`
                            `),a(),e(5,`
                        `)),i&2){let t=c.$implicit,o=u().$implicit,n=u();l(3),m("result",t.getProperty(o))("term",n.searchTerm)}}function Ln(i,c){if(i&1){let t=b();e(0,`
                    `),r(1,"tr",19),e(2,`
                        `),r(3,"td",14),e(4,`
                            `),r(5,"span"),e(6),a(),e(7,`
                        `),a(),e(8,`
                        `),O(9,On,6,2,null,null,U),r(11,"td",14),e(12,`
                            `),r(13,"jhi-button",20),C("onClick",function(){let n=h(t).$implicit,p=u();return x(p.selectImport(n))}),a(),e(14,`
                        `),a(),e(15,`
                    `),a(),e(16,`
                `)}if(i&2){let t=c.$implicit,o=u();l(6),N(t.id),l(3),L(o.columns),l(4),m("disabled",o.disabledIds.includes(t.id))("title","artemisApp.competency.importAll.table.doImport")}}var Nn=[{name:"TITLE",getProperty(i){return i.title}},{name:"SHORT_NAME",getProperty(i){return i.shortName}},{name:"SEMESTER",getProperty(i){return i.semester}}],an=(()=>{class i extends Xt{importRelations=!0;competencyType=H.COMPETENCY;constructor(){let t=f(qe);super(t),this.columns=Nn}selectImport(t){this.activeModal.close({courseForImportDTO:t,importRelations:this.importRelations})}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-import-all-competencies"]],inputs:{competencyType:"competencyType"},features:[at],decls:57,vars:12,consts:[[1,"modal-header"],[1,"modal-title",3,"jhiTranslate"],["aria-hidden","true","data-dismiss","modal","type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"form-group","form-inline"],["jhiTranslate","artemisApp.competency.importAll.search"],["name","searchCourse","type","text",1,"form-control","ms-2",3,"ngModelChange","ngModel"],["jhiTranslate","artemisApp.competency.import.importRelations",1,"ms-3"],["type","checkbox","name","importRelations",1,"ms-2",3,"ngModelChange","ngModel"],[1,"table","table-striped","align-middle","flex"],[1,"thead-dark"],["jhiSort","",1,"flex-row",3,"sortChange","ascendingChange","predicateChange","ascending","predicate"],["jhiSortBy","ID",1,"col-1"],[3,"icon"],[1,"col-1"],[1,"d-flex","justify-content-between","p-2"],[3,"pageChange","page","collectionSize","maxSize","pageSize","rotate"],["jhiTranslate","loading",1,"ms-3"],[1,"col-4",3,"jhiSortBy"],[1,"flex-row"],[3,"onClick","disabled","title"],[1,"text-break","col-4"],[3,"result","term"]],template:function(o,n){o&1&&(r(0,"form"),e(1,`
    `),r(2,"div",0),e(3,`
        `),s(4,"h4",1),e(5,`
        `),r(6,"button",2),C("click",function(){return n.clear()}),a(),e(7,`
    `),a(),e(8,`
    `),r(9,"div",3),e(10,`
        `),r(11,"div",4),e(12,`
            `),s(13,"span",5),e(14,`
            `),r(15,"input",6),k("ngModelChange",function(d){return w(n.searchTerm,d)||(n.searchTerm=d),d}),a(),e(16,`
            `),s(17,"span",7),e(18,`
            `),r(19,"input",8),k("ngModelChange",function(d){return w(n.importRelations,d)||(n.importRelations=d),d}),a(),e(20,`
            `),g(21,Pn,3,0),a(),e(22,`
        `),r(23,"table",9),e(24,`
            `),r(25,"thead",10),e(26,`
                `),e(27,`
                `),r(28,"tr",11),C("sortChange",function(){return n.sortRows()}),k("ascendingChange",function(d){return w(n.listSorting,d)||(n.listSorting=d),d})("predicateChange",function(d){return w(n.sortedColumn,d)||(n.sortedColumn=d),d}),e(29,`
                    `),r(30,"th",12),e(31,`
                        `),r(32,"span"),e(33,"#"),a(),e(34,`
                        `),s(35,"fa-icon",13),e(36,`
                    `),a(),e(37,`
                    `),O(38,Fn,10,5,null,null,U),s(40,"th",14),e(41,`
                `),a(),e(42,`
            `),a(),e(43,`
            `),r(44,"tbody"),e(45,`
                `),O(46,Ln,17,3,null,null,n.trackId,!0),a(),e(48,`
        `),a(),e(49,`
        `),r(50,"div",15),e(51,`
            `),r(52,"ngb-pagination",16),C("pageChange",function(d){return n.onPageChange(d)}),k("pageChange",function(d){return w(n.state.page,d)||(n.state.page=d),d}),a(),e(53,`
        `),a(),e(54,`
    `),a(),e(55,`
`),a(),e(56,`
`)),o&2&&(l(4),m("jhiTranslate","artemisApp."+n.competencyType+".importAll.title"),l(11),M("ngModel",n.searchTerm),l(4),M("ngModel",n.importRelations),l(2),I(n.loading?21:-1),l(7),M("ascending",n.listSorting)("predicate",n.sortedColumn),l(7),m("icon",n.faSort),l(3),L(n.columns),l(8),L(n.content.resultsOnPage),l(6),M("page",n.state.page),m("collectionSize",n.total)("maxSize",10)("pageSize",n.state.pageSize)("rotate",!0))},dependencies:[je,Vt,E,V,Qt,$t,F,P,J,ht,Re,yt,le,ft,se,gt,Z,Oe,Fe],encapsulation:2})}return i})();var Bn=(i,c)=>["/course-management",i,c,"import"],zn=(i,c)=>["/course-management",i,c,"create"],Wn=(i,c)=>["/course-management",i,c,"import-standardized"],Gn=(i,c)=>["/courses",i,"competencies",c],qn=(i,c,t)=>["/course-management",i,c,t,"edit"],Hn=(i,c)=>c.id;function $n(i,c){if(i&1&&(e(0,`
                    `),r(1,"a",8),e(2,`
                        `),s(3,"fa-icon",5),e(4,`
                        `),s(5,"span",1),e(6,`
                    `),a(),e(7,`
                `)),i&2){let t=u();l(),m("routerLink",$(3,Wn,t.courseId,t.competencyType+"-management")),l(2),m("icon",t.faFileImport),l(2),m("jhiTranslate","artemisApp."+t.competencyType+".manage.importStandardizedButton")}}function Qn(i,c){if(i&1){let t=b();e(0,`
                    `),r(1,"tr"),e(2,`
                        `),r(3,"td",12),e(4,`
                            `),r(5,"a",20),e(6),a(),e(7,`
                        `),a(),e(8,`
                        `),s(9,"td",21),R(10,"htmlForMarkdown"),e(11,`
                        `),r(12,"td",12),e(13,`
                            `),r(14,"div"),e(15,`
                                `),s(16,"fa-icon",22),e(17),R(18,"artemisTranslate"),a(),e(19,`
                        `),a(),e(20,`
                        `),r(21,"td",16),e(22),R(23,"artemisDate"),a(),e(24,`
                        `),r(25,"td",16),e(26,`
                            `),s(27,"ngb-progressbar",23),e(28,`
                        `),a(),e(29,`
                        `),r(30,"td",12),e(31,`
                            `),s(32,"span",1),e(33,`
                        `),a(),e(34,`
                        `),r(35,"td",12),e(36,`
                            `),r(37,"div",24),e(38,`
                                `),r(39,"a",25),e(40,`
                                    `),s(41,"fa-icon",5),e(42,`
                                    `),s(43,"span",26),e(44,`
                                `),a(),e(45,`
                                `),r(46,"button",27),C("delete",function(){let n=h(t).$implicit,p=u(2);return x(p.deleteCompetency(n.id))}),e(47,`
                                    `),s(48,"fa-icon",5),e(49,`
                                `),a(),e(50,`
                            `),a(),e(51,`
                        `),a(),e(52,`
                    `),a(),e(53,`
                `)}if(i&2){let t,o,n,p,d=c.$implicit,y=u(2);l(5),m("routerLink",$(24,Gn,y.courseId,d.id)),l(),N(d.title),l(3),m("innerHTML",A(10,18,d.description),ot),l(7),m("icon",y.getIcon(d.taxonomy))("fixedWidth",!0),l(),ae(`
                                `,A(18,20,"artemisApp.courseCompetency.taxonomies."+((t=d.taxonomy)!==null&&t!==void 0?t:"none")),`
                            `),l(5),ae(`
                            `,A(23,22,d.softDueDate),`
                        `),l(5),m("showValue",!0)("value",(o=d.courseProgress==null?null:d.courseProgress.numberOfMasteredStudents)!==null&&o!==void 0?o:0)("max",(n=d.courseProgress==null?null:d.courseProgress.numberOfStudents)!==null&&n!==void 0?n:0),l(5),m("jhiTranslate","global.generic."+(d.optional?"yes":"no")),l(7),m("routerLink",X(27,qn,y.courseId,y.competencyType+"-management",d.id)),l(2),m("icon",y.faPencilAlt),l(5),m("entityTitle",(p=d.title)!==null&&p!==void 0?p:"")("deleteQuestion","artemisApp."+y.competencyType+".competencyCard.delete.question")("deleteConfirmationText","artemisApp."+y.competencyType+".competencyCard.delete.typeNameToConfirm")("dialogError",y.dialogError),l(2),m("icon",y.faTrash)}}function Un(i,c){if(i&1&&(e(0,`
        `),r(1,"table",11),e(2,`
            `),r(3,"thead"),e(4,`
                `),r(5,"tr"),e(6,`
                    `),r(7,"th",12),e(8,`
                        `),s(9,"span",13),e(10,`
                    `),a(),e(11,`
                    `),r(12,"th",12),e(13,`
                        `),s(14,"span",14),e(15,`
                    `),a(),e(16,`
                    `),r(17,"th",12),e(18,`
                        `),s(19,"span",15),e(20,`
                    `),a(),e(21,`
                    `),r(22,"th",16),e(23,`
                        `),s(24,"span",17),e(25,`
                    `),a(),e(26,`
                    `),r(27,"th",16),e(28,`
                        `),s(29,"span",18),e(30,`
                    `),a(),e(31,`
                    `),r(32,"th",16),e(33,`
                        `),s(34,"span",19),e(35,`
                    `),a(),e(36,`
                    `),s(37,"th",12),e(38,`
                `),a(),e(39,`
            `),a(),e(40,`
            `),r(41,"tbody"),e(42,`
                `),O(43,Qn,54,31,null,null,Hn),a(),e(45,`
        `),a(),e(46,`
    `)),i&2){let t=u();l(43),L(t.courseCompetencies)}}function Kn(i,c){if(i&1&&(e(0,`
        `),s(1,"span",1),e(2,`
    `)),i&2){let t=u();l(),m("jhiTranslate","artemisApp."+t.competencyType+".manage.empty")}}var ln=(()=>{class i{courseId;courseCompetencies=[];competencyType;standardizedCompetenciesEnabled;allCompetencies=G.required();competencyDeleted=new nt;service;dialogErrorSource=new fe;dialogError=this.dialogErrorSource.asObservable();competencyService=f(Yt);prerequisiteService=f(Zt);alertService=f(q);modalService=f(De);faFileImport=me;faPlus=Ve;faPencilAlt=Le;faTrash=Ne;getIcon=Ge;ngOnInit(){this.competencyType===H.COMPETENCY?this.service=this.competencyService:this.service=this.prerequisiteService}ngOnDestroy(){this.dialogErrorSource.unsubscribe()}openImportAllModal(){let t=this.modalService.open(an,{size:"lg",backdrop:"static"});t.componentInstance.disabledIds=[+this.courseId],t.componentInstance.competencyType=this.competencyType,t.result.then(o=>{let n=o.courseForImportDTO.title??"";this.service.importAll(this.courseId,o.courseForImportDTO.id,o.importRelations).pipe(Je(p=>p.ok),ne(p=>p.body)).subscribe({next:p=>{p.length>0?(this.alertService.success(`artemisApp.${this.competencyType}.importAll.success`,{noOfCompetencies:p.length,courseTitle:n}),this.updateDataAfterImportAll(p)):this.alertService.warning(`artemisApp.${this.competencyType}.importAll.warning`,{courseTitle:n})},error:p=>ce(this.alertService,p)})})}updateDataAfterImportAll(t){let o=t.map(p=>p.competency).filter(p=>!!p),n=o.filter(p=>!this.courseCompetencies.some(d=>d.id===p.id));this.courseCompetencies.push(...n),this.allCompetencies.update(p=>p.concat(o))}deleteCompetency(t){this.service.delete(t,this.courseId).subscribe({next:()=>{this.dialogErrorSource.next(""),this.competencyDeleted.next(t)},error:o=>this.dialogErrorSource.next(o.message)})}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-competency-management-table"]],inputs:{courseId:"courseId",courseCompetencies:"courseCompetencies",competencyType:"competencyType",standardizedCompetenciesEnabled:"standardizedCompetenciesEnabled",allCompetencies:[1,"allCompetencies"]},outputs:{allCompetencies:"allCompetenciesChange",competencyDeleted:"competencyDeleted"},decls:47,vars:21,consts:[[1,"d-flex","flex-wrap","mt-4"],[3,"jhiTranslate"],[1,"ms-auto","justify-content-end"],["ngbDropdown","",1,"d-inline"],["id","importCompetenciesDropdown","ngbDropdownToggle","",1,"btn","btn-primary"],[3,"icon"],["ngbDropdownMenu","","aria-labelledby","importCompetenciesDropdown"],["id","competencyImportAllButton","ngbDropdownItem","",1,"btn",3,"click"],["ngbDropdownItem","",1,"btn",3,"routerLink"],[1,"btn","btn-primary",3,"routerLink"],[1,"container-fluid","overflow-auto"],[1,"table","table-striped"],[1,"col"],["jhiTranslate","artemisApp.competency.title"],["jhiTranslate","artemisApp.competency.description"],["jhiTranslate","artemisApp.competency.taxonomy"],[1,"d-none","col-lg","d-lg-table-cell"],["jhiTranslate","artemisApp.competency.softDueDate"],["jhiTranslate","artemisApp.competency.masteredStudents"],["jhiTranslate","artemisApp.competency.optional"],[3,"routerLink"],[1,"col","markdown-preview",3,"innerHTML"],["container","body",3,"icon","fixedWidth"],["type","primary",3,"showValue","value","max"],[1,"d-flex","justify-content-end"],[1,"btn","btn-sm","btn-primary","me-1",3,"routerLink"],["jhiTranslate","entity.action.edit",1,"d-none","d-md-inline"],["jhiDeleteButton","",3,"delete","entityTitle","deleteQuestion","deleteConfirmationText","dialogError"]],template:function(o,n){o&1&&(r(0,"div",0),e(1,`
    `),s(2,"h2",1),e(3,`
    `),r(4,"div",2),e(5,`
        `),r(6,"div",3),e(7,`
            `),r(8,"button",4),e(9,`
                `),s(10,"fa-icon",5),e(11),R(12,"artemisTranslate"),a(),e(13,`
            `),r(14,"div",6),e(15,`
                `),r(16,"button",7),C("click",function(){return n.openImportAllModal()}),e(17,`
                    `),s(18,"fa-icon",5),e(19,`
                    `),s(20,"span",1),e(21,`
                `),a(),e(22,`
                `),r(23,"a",8),e(24,`
                    `),s(25,"fa-icon",5),e(26,`
                    `),s(27,"span",1),e(28,`
                `),a(),e(29,`
                `),g(30,$n,8,6),a(),e(31,`
        `),a(),e(32,`
        `),r(33,"a",9),e(34,`
            `),s(35,"fa-icon",5),e(36,`
            `),s(37,"span",1),e(38,`
        `),a(),e(39,`
    `),a(),e(40,`
`),a(),e(41,`
`),r(42,"div",10),e(43,`
    `),g(44,Un,47,0)(45,Kn,3,1),a(),e(46,`
`)),o&2&&(l(2),m("jhiTranslate","artemisApp."+n.competencyType+".title"),l(8),m("icon",n.faFileImport),l(),ae(`
                `,A(12,13,"artemisApp."+n.competencyType+".manage.importButton"),`
            `),l(7),m("icon",n.faFileImport),l(2),m("jhiTranslate","artemisApp."+n.competencyType+".manage.importAllButton"),l(3),m("routerLink",$(15,Bn,n.courseId,n.competencyType+"-management")),l(2),m("icon",n.faFileImport),l(2),m("jhiTranslate","artemisApp."+n.competencyType+".manage.importFromCoursesButton"),l(3),I(n.standardizedCompetenciesEnabled?30:-1),l(3),m("routerLink",$(18,zn,n.courseId,n.competencyType+"-management")),l(2),m("icon",n.faPlus),l(2),m("jhiTranslate","artemisApp."+n.competencyType+".manage.createButton"),l(7),I(n.courseCompetencies.length?44:45))},dependencies:[bt,vt,Tt,St,Ut,E,F,P,Bt,V,Ie,Ee,Nt],encapsulation:2})}return i})();var Ke=i=>({"border-danger":i}),sn=(i,c)=>c.id;function Xn(i,c){if(i&1&&(e(0,`
                `),r(1,"option",13),e(2),a(),e(3,`
            `)),i&2){let t=c.$implicit;l(),m("ngValue",t.id),l(),N(t.title)}}function Yn(i,c){if(i&1&&(e(0,`
                `),s(1,"option",14),e(2,`
            `)),i&2){let t=c.$implicit;l(),m("value",t.value)("jhiTranslate","artemisApp.courseCompetency.relations.relationTypes."+t.value)}}function Zn(i,c){if(i&1&&(e(0,`
                `),r(1,"option",15),e(2),a(),e(3,`
            `)),i&2){let t=c.$implicit,o=u();l(),m("disabled",!o.isCourseCompetencySelectable(t.id))("ngValue",t.id),l(),N(t.title)}}function Jn(i,c){if(i&1&&(e(0,`
                    `),s(1,"fa-icon",18),e(2,`
                `)),i&2){let t=u(2);l(),m("icon",t.faSpinner)}}function ei(i,c){if(i&1){let t=b();e(0,`
            `),r(1,"button",16),C("click",function(){h(t);let n=u();return x(n.deleteRelation())}),e(2,`
                `),g(3,Jn,3,1),s(4,"span",17),e(5,`
            `),a(),e(6,`
        `)}if(i&2){let t=u();l(3),I(t.isLoading()?3:-1)}}function ti(i,c){if(i&1&&(e(0,`
                    `),s(1,"fa-icon",18),e(2,`
                `)),i&2){let t=u(2);l(),m("icon",t.faSpinner)}}function ni(i,c){if(i&1){let t=b();e(0,`
            `),r(1,"button",19),C("click",function(){h(t);let n=u();return x(n.updateRelation())}),e(2,`
                `),g(3,ti,3,1),s(4,"span",20),e(5,`
            `),a(),e(6,`
        `)}if(i&2){let t=u();l(),m("disabled",t.showCircularDependencyError()),l(2),I(t.isLoading()?3:-1)}}function ii(i,c){if(i&1&&(e(0,`
                    `),s(1,"fa-icon",18),e(2,`
                `)),i&2){let t=u(2);l(),m("icon",t.faSpinner)}}function oi(i,c){if(i&1){let t=b();e(0,`
            `),r(1,"button",21),C("click",function(){h(t);let n=u();return x(n.createRelation())}),e(2,`
                `),g(3,ii,3,1),s(4,"span",22),e(5,`
            `),a(),e(6,`
        `)}if(i&2){let t=u();l(),m("disabled",t.showCircularDependencyError()||!t.tailCompetencyId()||!t.headCompetencyId()||!t.relationType()),l(2),I(t.isLoading()?3:-1)}}function ri(i,c){i&1&&(e(0,`
        `),s(1,"small",23),e(2,`
    `))}var $e=(()=>{class i{faSpinner=ze;competencyRelationType=he;courseCompetencyApiService=f(ye);alertService=f(q);courseId=j.required();courseCompetencies=j.required();relations=G.required();selectedRelationId=G.required();headCompetencyId=_(void 0);tailCompetencyId=_(void 0);relationType=G(void 0);isLoading=_(!1);relationAlreadyExists=S(()=>this.getRelation(this.headCompetencyId(),this.tailCompetencyId())!==void 0);exactRelationAlreadyExists=S(()=>this.getExactRelation(this.headCompetencyId(),this.tailCompetencyId(),this.relationType())!==void 0);selectableTailCourseCompetencyIds=S(()=>this.headCompetencyId()&&this.relationType()?this.getSelectableTailCompetencyIds(this.headCompetencyId(),this.relationType()):this.courseCompetencies().map(({id:t})=>t));showCircularDependencyError=S(()=>this.tailCompetencyId()&&!this.selectableTailCourseCompetencyIds().includes(this.tailCompetencyId()));constructor(){z(()=>this.selectRelation(this.selectedRelationId()))}isCourseCompetencySelectable(t){return this.selectableTailCourseCompetencyIds().includes(t)}selectRelation(t){let o=this.relations().find(({id:n})=>n===t);o&&(this.headCompetencyId.set(o?.headCompetencyId),this.tailCompetencyId.set(o?.tailCompetencyId),this.relationType.set(o?.relationType))}selectCourseCompetency(t){this.headCompetencyId()?this.tailCompetencyId()?this.selectHeadCourseCompetency(t):this.selectTailCourseCompetency(t):this.selectHeadCourseCompetency(t)}selectHeadCourseCompetency(t){this.headCompetencyId.set(t),this.tailCompetencyId.set(void 0),this.selectedRelationId.set(void 0)}selectTailCourseCompetency(t){this.tailCompetencyId.set(t);let o=this.getRelation(this.headCompetencyId(),this.tailCompetencyId());o?this.selectedRelationId.set(o.id):this.selectedRelationId.set(void 0)}createRelation(){return T(this,null,function*(){try{this.isLoading.set(!0);let t=yield this.courseCompetencyApiService.createCourseCompetencyRelation(this.courseId(),{headCompetencyId:this.headCompetencyId(),tailCompetencyId:Number(this.tailCompetencyId()),relationType:this.relationType()});this.relations.update(o=>[...o,t]),this.selectedRelationId.set(t.id)}catch(t){this.alertService.error(t.message)}finally{this.isLoading.set(!1)}})}getExactRelation(t,o,n){return this.relations().find(p=>p.headCompetencyId===t&&p.tailCompetencyId===o&&p.relationType===n)}getRelation(t,o){return this.relations().find(n=>n.headCompetencyId===t&&n.tailCompetencyId===o)}updateRelation(){return T(this,null,function*(){try{this.isLoading.set(!0);let t=this.relationType();yield this.courseCompetencyApiService.updateCourseCompetencyRelation(this.courseId(),this.selectedRelationId(),{newRelationType:t}),this.relations.update(o=>o.map(n=>n.id===this.selectedRelationId()?Q(W({},n),{relationType:t}):n))}catch(t){this.alertService.error(t.message)}finally{this.isLoading.set(!1)}})}deleteRelation(){return T(this,null,function*(){try{this.isLoading.set(!0);let t=this.relations().find(({headCompetencyId:o,tailCompetencyId:n,relationType:p})=>o==this.headCompetencyId()&&n==this.tailCompetencyId()&&p===this.relationType());yield this.courseCompetencyApiService.deleteCourseCompetencyRelation(this.courseId(),t.id),this.relations.update(o=>o.filter(({id:n})=>n!==t.id)),this.selectedRelationId.set(void 0)}catch(t){this.alertService.error(t.message)}finally{this.isLoading.set(!1)}})}getSelectableTailCompetencyIds(t,o){return this.courseCompetencies().map(({id:n})=>n).filter(n=>n!==t).filter(n=>{let p=this.relations(),d=this.getRelation(t,n);d&&(p=p.filter(D=>D.id!==d.id));let y={headCompetencyId:t,tailCompetencyId:n,relationType:o};return!this.detectCycleInRelations(p.concat(y),this.courseCompetencies().length)})}detectCycleInRelations(t,o){let n=new Map,p=0;t.forEach(D=>{let ee=D.tailCompetencyId,te=D.headCompetencyId;n.has(ee)||n.set(ee,p++),n.has(te)||n.set(te,p++)});let d=new Xe(o);t.forEach(D=>{if(D.relationType===he.MATCHES){let ee=n.get(D.tailCompetencyId),te=n.get(D.headCompetencyId);ee!==void 0&&te!==void 0&&d.union(ee,te)}});let y=Array.from({length:o},()=>[]);return t.forEach(D=>{let ee=d.find(n.get(D.tailCompetencyId)),te=d.find(n.get(D.headCompetencyId));(D.relationType===he.EXTENDS||D.relationType===he.ASSUMES)&&y[ee].push(te)}),this.hasCycle(y,o)}hasCycle(t,o){let n=Array(o).fill(!1),p=Array(o).fill(!1),d=y=>{n[y]=!0,p[y]=!0;for(let D of t[y]||[])if(n[D]){if(p[D])return!0}else if(d(D))return!0;return p[y]=!1,!1};for(let y=0;y<o;y++)if(!n[y]&&d(y))return!0;return!1}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-course-competency-relation-form"]],inputs:{courseId:[1,"courseId"],courseCompetencies:[1,"courseCompetencies"],relations:[1,"relations"],selectedRelationId:[1,"selectedRelationId"],relationType:[1,"relationType"]},outputs:{relations:"relationsChange",selectedRelationId:"selectedRelationIdChange",relationType:"relationTypeChange"},decls:47,vars:19,consts:[[1,"course-competency-relation-form-container","row","m-0","p-3","align-items-end"],[1,"form-group","col","m-0","ps-0"],["for","head","jhiTranslate","artemisApp.courseCompetency.relations.form.headCourseCompetencyLabel"],["id","head","name","head",1,"form-select","mt-1",3,"ngModelChange","ngClass","ngModel"],["disabled","","jhiTranslate","artemisApp.courseCompetency.relations.form.headCourseCompetencyDefaultOption",3,"value"],[1,"form-group","col","m-0"],["for","type","jhiTranslate","artemisApp.courseCompetency.relations.form.relationTypeLabel"],["id","type","name","type",1,"form-select","mt-1",3,"ngModelChange","ngClass","ngModel"],["disabled","","jhiTranslate","artemisApp.courseCompetency.relations.form.relationTypeDefaultOption",3,"value"],["for","tail","jhiTranslate","artemisApp.courseCompetency.relations.form.tailCourseCompetencyLabel"],["id","tail","name","tail",1,"form-select","mt-1",3,"ngModelChange","ngClass","ngModel"],["disabled","","jhiTranslate","artemisApp.courseCompetency.relations.form.tailCourseCompetencyDefaultOption",3,"value"],[1,"col-2","pe-0","d-flex","justify-content-end"],[3,"ngValue"],[3,"value","jhiTranslate"],[3,"disabled","ngValue"],[1,"btn","btn-danger",3,"click"],["jhiTranslate","artemisApp.courseCompetency.relations.form.deleteRelationButtonLabel"],["animation","spin",3,"icon"],[1,"btn","btn-info",3,"click","disabled"],["jhiTranslate","artemisApp.courseCompetency.relations.form.updateRelationButtonLabel"],[1,"btn","btn-primary",3,"click","disabled"],["jhiTranslate","artemisApp.courseCompetency.relations.form.createRelationButtonLabel"],["jhiTranslate","artemisApp.courseCompetency.relations.form.cyclicDependencyError",1,"p-0","mt-2","text-danger"]],template:function(o,n){o&1&&(r(0,"div",0),e(1,`
    `),r(2,"div",1),e(3,`
        `),s(4,"label",2),e(5,`
        `),r(6,"select",3),C("ngModelChange",function(d){return n.selectHeadCourseCompetency(d)}),e(7,`
            `),s(8,"option",4),e(9,`
            `),O(10,Xn,4,2,null,null,sn),a(),e(12,`
    `),a(),e(13,`
    `),r(14,"div",5),e(15,`
        `),s(16,"label",6),e(17,`
        `),r(18,"select",7),k("ngModelChange",function(d){return w(n.relationType,d)||(n.relationType=d),d}),e(19,`
            `),s(20,"option",8),e(21,`
            `),O(22,Yn,3,2,null,null,U),R(24,"keyvalue"),a(),e(25,`
    `),a(),e(26,`
    `),r(27,"div",5),e(28,`
        `),s(29,"label",9),e(30,`
        `),r(31,"select",10),C("ngModelChange",function(d){return n.selectTailCourseCompetency(d)}),e(32,`
            `),s(33,"option",11),e(34,`
            `),O(35,Zn,4,3,null,null,sn),a(),e(37,`
    `),a(),e(38,`
    `),r(39,"div",12),e(40,`
        `),g(41,ei,7,1)(42,ni,7,2)(43,oi,7,2),a(),e(44,`
    `),g(45,ri,3,0),a(),e(46,`
`)),o&2&&(l(6),m("ngClass",K(13,Ke,n.showCircularDependencyError()))("ngModel",n.headCompetencyId()),l(2),m("value",void 0),l(2),L(n.courseCompetencies()),l(8),m("ngClass",K(15,Ke,n.showCircularDependencyError())),M("ngModel",n.relationType),l(2),m("value",void 0),l(2),L(A(24,11,n.competencyRelationType)),l(9),m("ngClass",K(17,Ke,n.showCircularDependencyError()))("ngModel",n.tailCompetencyId()),l(2),m("value",void 0),l(2),L(n.courseCompetencies()),l(6),I(n.exactRelationAlreadyExists()?41:n.relationAlreadyExists()?42:43),l(4),I(n.showCircularDependencyError()?45:-1))},dependencies:[E,Z,ve,dt,F,P,J,Ae,Me,xt,le,se],styles:[".course-competency-relation-form-container[_ngcontent-%COMP%]{background-color:var(--bs-body-bg);border-radius:var(--bs-border-radius-lg)}"]})}return i})(),Xe=class{parent;rank;constructor(c){this.parent=Array.from({length:c},(t,o)=>o),this.rank=Array(c).fill(1)}find(c){return this.parent[c]!==c&&(this.parent[c]=this.find(this.parent[c])),this.parent[c]}union(c,t){let o=this.find(c),n=this.find(t);o!==n&&(this.rank[o]>this.rank[n]?this.parent[n]=o:this.rank[o]<this.rank[n]?this.parent[o]=n:(this.parent[n]=o,this.rank[o]+=1))}};var ai=(i,c)=>({"competency-container":i,"prerequisite-container":c}),pn=(()=>{class i{CourseCompetencyType=H;nodeHeight=45.59;element=f(it);courseCompetencyNode=j.required();courseCompetencyType=S(()=>this.courseCompetencyNode().data.type);onSizeSet=oe();ngAfterViewInit(){this.setDimensions(this.element)}setDimensions(t){let o=t.nativeElement.offsetWidth,n=this.nodeHeight;this.onSizeSet.emit({id:`${this.courseCompetencyNode().id}`,dimension:{height:n,width:o}})}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-course-competency-relation-node"]],inputs:{courseCompetencyNode:[1,"courseCompetencyNode"]},outputs:{onSizeSet:"onSizeSet"},decls:16,vars:9,consts:[[1,"d-inline-block","competency-node"],[1,"progress-container","d-inline-block",3,"ngClass","ngbTooltip"],[3,"jhiTranslate"],[1,"d-inline-block","ms-1"]],template:function(o,n){o&1&&(r(0,"div",0),e(1,`
    `),r(2,"div",1),R(3,"artemisTranslate"),e(4,`
        `),r(5,"small"),e(6,`
            `),s(7,"strong",2),e(8,`
        `),a(),e(9,`
    `),a(),e(10,`
    `),r(11,"span",3)(12,"strong"),e(13),a()(),e(14,`
`),a(),e(15,`
`)),o&2&&(l(2),m("ngClass",$(6,ai,n.courseCompetencyType()===n.CourseCompetencyType.COMPETENCY,n.courseCompetencyType()===n.CourseCompetencyType.PREREQUISITE))("ngbTooltip",A(3,4,"artemisApp.courseCompetency.relations.graph.tooltips."+n.courseCompetencyType())),l(5),m("jhiTranslate","artemisApp.courseCompetency.relations.graph.nodeTypes."+n.courseCompetencyType()),l(6),N(n.courseCompetencyNode().label))},dependencies:[ve,E,Pe,ke,V],styles:[".competency-node[_ngcontent-%COMP%]{white-space:nowrap;background-color:var(--bs-body-bg);border-radius:calc(var(--bs-border-radius-lg) + 6px);padding:10px 12px}.competency-node[_ngcontent-%COMP%]   .progress-container[_ngcontent-%COMP%]{color:var(--bs-white);padding:2px 8px;border-radius:var(--bs-border-radius-lg)}.competency-node[_ngcontent-%COMP%]   .competency-container[_ngcontent-%COMP%]{background-color:var(--bs-green)}.competency-node[_ngcontent-%COMP%]   .prerequisite-container[_ngcontent-%COMP%]{background-color:var(--bs-yellow)}"]})}return i})();function li(i,c){i&1&&(e(0,`
            `),_e(),r(1,"marker",5),e(2,`
                `),s(3,"path",6),e(4,`
            `),a(),e(5,`
        `))}function si(i,c){if(i&1){let t=b();e(0,`
            `),_e(),r(1,"g",7),C("click",function(){let n=h(t).$implicit,p=u();return x(p.onCourseCompetencySelection.emit(n.data.id))}),e(2,`
                `),r(3,"foreignObject",8),e(4,`
                    `),et(),r(5,"jhi-course-competency-relation-node",9),C("onSizeSet",function(n){h(t);let p=u();return x(p.setNodeDimension(n))}),a(),e(6,`
                `),a(),e(7,`
            `),a(),e(8,`
        `)}if(i&2){let t=c.$implicit;l(),Te("width",t.dimension.width)("height",t.dimension.height),l(2),Te("width",t.dimension.width)("height",t.dimension.height),l(2),m("courseCompetencyNode",t)}}function pi(i,c){if(i&1){let t=b();e(0,`
            `),_e(),r(1,"g",10),C("click",function(){let n=h(t).$implicit,p=u();return x(p.selectRelation(n.data.id))}),e(2,`
                `),s(3,"path",11),e(4,`
                `),r(5,"text",12),e(6,`
                    `),r(7,"textPath",13),e(8),R(9,"artemisTranslate"),a(),e(10,`
                `),a(),e(11,`
            `),a(),e(12,`
        `)}if(i&2){let t=c.$implicit,o=u();l(3),Se("selected",o.selectedRelationId()===t.data.id),l(4),lt("dominant-baseline",t.dominantBaseline),Te("href","#"+t.id),l(),ae(`
                        `,A(9,6,"artemisApp.courseCompetency.relations.relationTypes."+t.label).toUpperCase(),`
                    `)}}var mn=(()=>{class i{faFileImport=me;courseCompetencies=j.required();relations=j.required();selectedRelationId=G.required();onCourseCompetencySelection=oe();update$=new fe;center$=new fe;nodes=_([]);edges=S(()=>this.relations().map(t=>({id:`edge-${t.id}`,source:`${t.headCompetencyId}`,target:`${t.tailCompetencyId}`,label:t.relationType,data:{id:t.id}})));constructor(){z(()=>this.nodes.set(this.courseCompetencies().map(t=>({id:t.id.toString(),label:t.title,data:{id:t.id,type:t.type}}))))}selectRelation(t){this.selectedRelationId.set(t)}setNodeDimension(t){this.nodes.update(o=>o.map(n=>(n.id===t.id&&(n.dimension=t.dimension),n)))}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-course-competencies-relation-graph"]],inputs:{courseCompetencies:[1,"courseCompetencies"],relations:[1,"relations"],selectedRelationId:[1,"selectedRelationId"]},outputs:{selectedRelationId:"selectedRelationIdChange",onCourseCompetencySelection:"onCourseCompetencySelection"},decls:15,vars:8,consts:[["defsTemplate",""],["nodeTemplate",""],["linkTemplate",""],[0,"xmlns","svg","http://www.w3.org/2000/svg",1,"course-competencies-graph-container","h-100"],["layout","dagreCluster",3,"nodes","links","draggingEnabled","showMiniMap","miniMapMaxWidth","miniMapMaxHeight","update$","center$"],["id","arrow","viewBox","0 -5 10 10","refX","8","refY","0","markerWidth","4","markerHeight","4","orient","auto"],["d","M0,-5L10,0L0,5",1,"arrow-head"],[3,"click"],[1,"node"],[3,"onSizeSet","courseCompetencyNode"],[1,"edge",3,"click"],["stroke-width","2","marker-end","url(#arrow)",1,"line"],["text-anchor","middle",1,"edge-label"],["startOffset","50%",1,"text-path"]],template:function(o,n){o&1&&(r(0,"div",3),e(1,`
    `),r(2,"ngx-graph",4),e(3,`
        `),g(4,li,6,0,"ng-template",null,0,Y),e(6,`
        `),g(7,si,9,5,"ng-template",null,1,Y),e(9,`
        `),g(10,pi,13,8,"ng-template",null,2,Y),e(12,`
    `),a(),e(13,`
`),a(),e(14,`
`)),o&2&&(l(2),m("nodes",n.nodes())("links",n.edges())("draggingEnabled",!1)("showMiniMap",!0)("miniMapMaxWidth",200)("miniMapMaxHeight",150)("update$",n.update$)("center$",n.center$))},dependencies:[F,_t,en,Jt,pn,V],styles:[".course-competencies-graph-container[_ngcontent-%COMP%]   #arrow[_ngcontent-%COMP%]{stroke:var(--body-color);fill:var(--body-color)}.course-competencies-graph-container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{stroke:var(--bs-primary)}.course-competencies-graph-container[_ngcontent-%COMP%]   .text-path[_ngcontent-%COMP%]{fill:var(--body-color)}"]})}return i})();function mi(i,c){i&1&&(e(0,`
            `),r(1,"div",7),e(2,`
                `),r(3,"div",8),e(4,`
                    `),s(5,"span",9),e(6,`
                `),a(),e(7,`
            `),a(),e(8,`
        `))}function ci(i,c){if(i&1){let t=b();e(0,`
            `),r(1,"div",10),e(2,`
                `),r(3,"jhi-course-competency-relation-form",11),k("selectedRelationIdChange",function(n){h(t);let p=u();return w(p.selectedRelationId,n)||(p.selectedRelationId=n),x(n)})("relationsChange",function(n){h(t);let p=u();return w(p.relations,n)||(p.relations=n),x(n)}),a(),e(4,`
            `),a(),e(5,`
            `),r(6,"jhi-course-competencies-relation-graph",12),k("selectedRelationIdChange",function(n){h(t);let p=u();return w(p.selectedRelationId,n)||(p.selectedRelationId=n),x(n)}),C("onCourseCompetencySelection",function(n){h(t);let p=u();return x(p.selectCourseCompetency(n))}),a(),e(7,`
        `)}if(i&2){let t=u();l(3),M("selectedRelationId",t.selectedRelationId),m("courseId",t.courseId()),M("relations",t.relations),m("courseCompetencies",t.courseCompetencies()),l(3),M("selectedRelationId",t.selectedRelationId),m("relations",t.relations())("courseCompetencies",t.courseCompetencies())}}var cn=(()=>{class i{courseCompetencyApiService=f(ye);alertService=f(q);activeModal=f(pe);courseCompetencyRelationFormComponent=rt.required($e);courseId=j.required();courseCompetencies=j.required();selectedRelationId=_(void 0);isLoading=_(!1);relations=_([]);constructor(){z(()=>this.loadRelations(this.courseId()))}loadRelations(t){return T(this,null,function*(){try{this.isLoading.set(!0);let o=yield this.courseCompetencyApiService.getCourseCompetencyRelationsByCourseId(t);this.relations.set(o)}catch(o){ce(this.alertService,o)}finally{this.isLoading.set(!1)}})}selectCourseCompetency(t){this.courseCompetencyRelationFormComponent().selectCourseCompetency(t)}closeModal(){this.activeModal.close()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-course-competencies-relation-modal"]],viewQuery:function(o,n){o&1&&st(n.courseCompetencyRelationFormComponent,$e,5),o&2&&pt()},inputs:{courseId:[1,"courseId"],courseCompetencies:[1,"courseCompetencies"]},decls:20,vars:1,consts:[[1,"course-competencies-graph-modal"],[1,"col","p-3"],[1,"row","m-0"],["jhiTranslate","artemisApp.courseCompetency.relations.modalTitle",1,"col","p-0","h5","m-0","align-self-center"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"m-0"],[1,"course-competencies-graph-modal-body","h-100"],[1,"row","justify-content-center","m-4"],["role","status",1,"spinner-border","text-primary"],["jhiTranslate","loading",1,"sr-only"],[1,"p-3"],[3,"selectedRelationIdChange","relationsChange","selectedRelationId","courseId","relations","courseCompetencies"],[3,"selectedRelationIdChange","onCourseCompetencySelection","selectedRelationId","relations","courseCompetencies"]],template:function(o,n){o&1&&(r(0,"div",0),e(1,`
    `),r(2,"div",1),e(3,`
        `),r(4,"div",2),e(5,`
            `),s(6,"span",3),e(7,`
            `),r(8,"button",4),C("click",function(){return n.closeModal()}),a(),e(9,`
        `),a(),e(10,`
    `),a(),e(11,`
    `),s(12,"hr",5),e(13,`
    `),r(14,"div",6),e(15,`
        `),g(16,mi,9,0)(17,ci,8,7),a(),e(18,`
`),a(),e(19,`
`)),o&2&&(l(16),I(n.isLoading()?16:17))},dependencies:[mn,$e,E],styles:[".course-competencies-graph-modal[_ngcontent-%COMP%]{height:90vh;max-height:700px;overflow:hidden}"]})}return i})();var di=i=>({link:i}),dn=(()=>{class i{closeIcon=Be;DOCUMENTATION_LINK="https://docs.artemis.cit.tum.de/user/adaptive-learning/";activeModal=f(pe);closeModal(){this.activeModal.close()}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-course-competency-explanation-modal"]],decls:136,vars:4,consts:[[1,"course-competency-explanation-modal"],[1,"col","p-3"],[1,"row","m-0"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.title",1,"col","p-0","h5","m-0","align-self-center"],["id","close-button",1,"col-md-auto","h5","clickable","m-0","p-1","pe-0",3,"click","icon"],[1,"m-0"],[1,"h-100","p-3"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.adaptiveLearning.title1"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.adaptiveLearning.paragraph1"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.adaptiveLearning.paragraph2"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.adaptiveLearning.title2"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.adaptiveLearning.paragraph3"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.adaptiveLearning.paragraph4"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyCreation.title"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyCreation.paragraph1"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyCreation.paragraph2"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyCreation.paragraph3"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyCreation.paragraph4"],[1,"explanation-model-gif"],["controls","","preload","metadata","aria-label","Tutorial: Creating course competencies","poster","public/videos/course-competencies/create-competencies-poster.jpg"],["src","public/videos/course-competencies/create-competencies.mp4","type","video/mp4"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationVideoParagraph.first"],["href","public/videos/course-competencies/create-competencies.mp4"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationVideoParagraph.link"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationVideoParagraph.last"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyCreation.paragraph5",3,"translateValues"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.title"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.paragraph1"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.paragraph2"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.paragraph3"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.paragraph4"],["controls","","preload","metadata","aria-label","Tutorial: Creating course competency relations","poster","public/videos/course-competencies/create-course-competency-relations-poster.jpg"],["src","public/videos/course-competencies/create-course-competency-relations.mp4","type","video/mp4"],[1,"mt-3"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationTitle1"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationParagraph1"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.exampleLabel"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationParagraph2"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationTitle2"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationParagraph3"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationParagraph4"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationTitle3"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationParagraph5"],["jhiTranslate","artemisApp.courseCompetency.featureExplanation.courseCompetencyRelations.relationParagraph6",1,"mb-0"]],template:function(o,n){o&1&&(r(0,"div",0),e(1,`
    `),r(2,"div",1),e(3,`
        `),r(4,"div",2),e(5,`
            `),s(6,"span",3),e(7,`
            `),r(8,"fa-icon",4),C("click",function(){return n.closeModal()}),a(),e(9,`
        `),a(),e(10,`
    `),a(),e(11,`
    `),s(12,"hr",5),e(13,`
    `),r(14,"div",6),e(15,`
        `),r(16,"div"),e(17,`
            `),s(18,"h5",7),e(19,`
            `),s(20,"p",8),e(21,`
            `),s(22,"p",9),e(23,`

            `),s(24,"h5",10),e(25,`
            `),s(26,"p",11),e(27,`
            `),s(28,"p",12),e(29,`
        `),a(),e(30,`
        `),s(31,"hr"),e(32,`
        `),r(33,"div"),e(34,`
            `),s(35,"h5",13),e(36,`
            `),s(37,"p",14),e(38,`
            `),s(39,"p",15),e(40,`
            `),s(41,"p",16),e(42,`
            `),s(43,"p",17),e(44,`
            `),r(45,"div",18),e(46,`
                `),r(47,"video",19),e(48,`
                    `),s(49,"source",20),e(50,`
                    `),s(51,"p",21),e(52,`
                    `),r(53,"a",22),s(54,"p",23),a(),e(55,`
                    `),s(56,"p",24),e(57,`
                `),a(),e(58,`
            `),a(),e(59,`
            `),s(60,"p",25),e(61,`
        `),a(),e(62,`
        `),s(63,"hr"),e(64,`
        `),r(65,"div"),e(66,`
            `),s(67,"h5",26),e(68,`
            `),s(69,"p",27),e(70,`

            `),r(71,"strong"),s(72,"p",28),e(73," "),a(),e(74,`
            `),s(75,"p",29),e(76,`
            `),s(77,"p",30),e(78,`
            `),r(79,"div",18),e(80,`
                `),r(81,"video",31),e(82,`
                    `),s(83,"source",32),e(84,`
                    `),s(85,"p",21),e(86,`
                    `),r(87,"a",22),s(88,"p",23),a(),e(89,`
                    `),s(90,"p",24),e(91,`
                `),a(),e(92,`
            `),a(),e(93,`
            `),r(94,"div",33),e(95,`
                `),s(96,"h6",34),e(97,`
                `),s(98,"p",35),e(99,`
                `),r(100,"strong"),s(101,"p",36),e(102," "),a(),e(103,`
                `),s(104,"p",37),e(105,`
            `),a(),e(106,`
            `),r(107,"div"),e(108,`
                `),s(109,"h6",38),e(110,`
                `),s(111,"p",39),e(112,`
                `),r(113,"strong"),s(114,"p",36),e(115," "),a(),e(116,`
                `),s(117,"p",40),e(118,`
            `),a(),e(119,`
            `),r(120,"div"),e(121,`
                `),s(122,"h6",41),e(123,`
                `),s(124,"p",42),e(125,`
                `),r(126,"strong"),s(127,"p",36),e(128," "),a(),e(129,`
                `),s(130,"p",43),e(131,`
            `),a(),e(132,`
        `),a(),e(133,`
    `),a(),e(134,`
`),a(),e(135,`
`)),o&2&&(l(8),m("icon",n.closeIcon),l(52),m("translateValues",K(2,di,n.DOCUMENTATION_LINK)))},dependencies:[E,F,P],styles:[".explanation-model-gif[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{display:block;max-width:800px;margin:0 auto}.explanation-model-gif[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;display:block;margin:0 auto}"]})}return i})();var ui=i=>["/course-management",i,"competency-management","generate"];function Ci(i,c){if(i&1&&(e(0,`
                `),r(1,"a",12),e(2,`
                    `),s(3,"fa-icon",4),e(4,`
                    `),s(5,"span",13),e(6,`
                `),a(),e(7,`
            `)),i&2){let t=u();l(),m("routerLink",K(2,ui,t.courseId())),l(2),m("icon",t.faRobot)}}function yi(i,c){i&1&&(e(0,`
        `),r(1,"div",14),e(2,`
            `),r(3,"div",15),e(4,`
                `),s(5,"span",16),e(6,`
            `),a(),e(7,`
        `),a(),e(8,`
    `))}var ua=(()=>{class i{faEdit=At;faPlus=Ve;faFileImport=me;faTrash=Ne;faPencilAlt=Le;faRobot=Pt;faCircleQuestion=Dt;getIcon=Ge;documentationType="Competencies";CourseCompetencyType=H;activatedRoute=f(Ct);courseCompetencyApiService=f(ye);alertService=f(q);modalService=f(De);profileService=f(Ot);irisSettingsService=f(Kt);featureToggleService=f(It);courseId=we(this.activatedRoute.parent.params.pipe(ne(t=>Number(t.courseId))),{requireSync:!0});isLoading=_(!1);courseCompetencies=_([]);competencies=S(()=>this.courseCompetencies().filter(t=>t.type===H.COMPETENCY));prerequisites=S(()=>this.courseCompetencies().filter(t=>t.type===H.PREREQUISITE));irisEnabled=we(this.profileService.getProfileInfo().pipe(ne(t=>t?.activeProfiles?.includes(Lt))),{initialValue:!1});irisCompetencyGenerationEnabled=_(!1);standardizedCompetenciesEnabled=we(this.featureToggleService.getFeatureToggleActive(Et.StandardizedCompetencies),{requireSync:!0});constructor(){z(()=>{let t=this.courseId();ge(()=>T(this,null,function*(){return yield this.loadCourseCompetencies(t)}))}),z(()=>{let t=this.irisEnabled();ge(()=>T(this,null,function*(){t&&(yield this.loadIrisEnabled())}))})}ngOnInit(){sessionStorage.getItem("lastTimeVisitedCourseCompetencyExplanation")||this.openCourseCompetencyExplanation(),sessionStorage.setItem("lastTimeVisitedCourseCompetencyExplanation",Date.now().toString())}loadIrisEnabled(){return T(this,null,function*(){try{let t=yield Ze(this.irisSettingsService.getCombinedCourseSettings(this.courseId()));this.irisCompetencyGenerationEnabled.set(t?.irisCompetencyGenerationSettings?.enabled??!1)}catch(t){this.alertService.error(t)}})}loadCourseCompetencies(t){return T(this,null,function*(){try{this.isLoading.set(!0);let o=yield this.courseCompetencyApiService.getCourseCompetenciesByCourseId(t);this.courseCompetencies.set(o)}catch(o){this.alertService.error(o)}finally{this.isLoading.set(!1)}})}openCourseCompetenciesRelationModal(){let t=this.modalService.open(cn,{size:"xl",backdrop:"static",windowClass:"course-competencies-relation-graph-modal"});t.componentInstance.courseId=_(this.courseId()),t.componentInstance.courseCompetencies=_(this.courseCompetencies())}openImportAllModal(){return T(this,null,function*(){let t=this.modalService.open(rn,{size:"lg",backdrop:"static"});t.componentInstance.courseId=_(this.courseId());let o=yield t.result;if(!o)return;let n=o.course.title??"";try{let p=yield this.courseCompetencyApiService.importAllByCourseId(this.courseId(),o.courseCompetencyImportOptions);p.length?(this.alertService.success("artemisApp.courseCompetency.importAll.success",{noOfCompetencies:p.length,courseTitle:n}),this.updateDataAfterImportAll(p)):this.alertService.warning("artemisApp.courseCompetency.importAll.warning",{courseTitle:n})}catch(p){this.alertService.error(p)}})}updateDataAfterImportAll(t){let n=t.map(p=>p.competency).filter(p=>!this.courseCompetencies().some(d=>d.id===p.id));this.courseCompetencies.update(p=>p.concat(n))}onRemoveCompetency(t){this.courseCompetencies.update(o=>o.filter(n=>n.id!==t))}openCourseCompetencyExplanation(){this.modalService.open(dn,{size:"xl",backdrop:"static",windowClass:"course-competency-explanation-modal"})}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=v({type:i,selectors:[["jhi-competency-management"]],decls:41,vars:15,consts:[[1,"d-flex","flex-wrap","mt-4"],[1,"d-flex","justify-content-center","align-items-center"],["jhiTranslate","artemisApp.competency.manage.title",1,"m-0"],[1,"ms-3","btn","btn-sm","btn-warning",3,"click"],[3,"icon"],["jhiTranslate","artemisApp.courseCompetency.manage.helpButton"],[1,"ms-auto","justify-content-end"],["id","openCourseCompetencyRelationsButton",1,"btn","btn-primary",3,"click"],["jhiTranslate","artemisApp.courseCompetency.manage.editRelationsButton"],["id","courseCompetencyImportAllButton",1,"btn","btn-primary",3,"click"],["jhiTranslate","artemisApp.courseCompetency.manage.importAllButton"],[3,"allCompetenciesChange","competencyDeleted","courseId","allCompetencies","courseCompetencies","competencyType","standardizedCompetenciesEnabled"],["id","generateButton",1,"btn","btn-primary",3,"routerLink"],["jhiTranslate","artemisApp.competency.manage.generateButton"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],["jhiTranslate","loading",1,"sr-only"]],template:function(o,n){o&1&&(r(0,"div"),e(1,`
    `),r(2,"div",0),e(3,`
        `),r(4,"div",1),e(5,`
            `),s(6,"h2",2),e(7,`
            `),r(8,"button",3),C("click",function(){return n.openCourseCompetencyExplanation()}),e(9,`
                `),s(10,"fa-icon",4),e(11,`
                `),s(12,"span",5),e(13,`
            `),a(),e(14,`
        `),a(),e(15,`
        `),r(16,"div",6),e(17,`
            `),g(18,Ci,8,4),r(19,"button",7),C("click",function(){return n.openCourseCompetenciesRelationModal()}),e(20,`
                `),s(21,"fa-icon",4),e(22,`
                `),s(23,"span",8),e(24,`
            `),a(),e(25,`
            `),r(26,"button",9),C("click",function(){return n.openImportAllModal()}),e(27,`
                `),s(28,"fa-icon",4),e(29,`
                `),s(30,"span",10),e(31,`
            `),a(),e(32,`
        `),a(),e(33,`
    `),a(),e(34,`
    `),g(35,yi,9,0),r(36,"jhi-competency-management-table",11),k("allCompetenciesChange",function(d){return w(n.courseCompetencies,d)||(n.courseCompetencies=d),d}),C("competencyDeleted",function(d){return n.onRemoveCompetency(d)}),a(),e(37,`
    `),r(38,"jhi-competency-management-table",11),k("allCompetenciesChange",function(d){return w(n.courseCompetencies,d)||(n.courseCompetencies=d),d}),C("competencyDeleted",function(d){return n.onRemoveCompetency(d)}),a(),e(39,`
`),a(),e(40,`
`)),o&2&&(l(10),m("icon",n.faCircleQuestion),l(8),I(n.irisCompetencyGenerationEnabled()?18:-1),l(3),m("icon",n.faEdit),l(7),m("icon",n.faFileImport),l(7),I(n.isLoading()?35:-1),l(),m("courseId",n.courseId()),M("allCompetencies",n.courseCompetencies),m("courseCompetencies",n.competencies())("competencyType",n.CourseCompetencyType.COMPETENCY)("standardizedCompetenciesEnabled",n.standardizedCompetenciesEnabled()),l(2),m("courseId",n.courseId()),M("allCompetencies",n.courseCompetencies),m("courseCompetencies",n.prerequisites())("competencyType",n.CourseCompetencyType.PREREQUISITE)("standardizedCompetenciesEnabled",n.standardizedCompetenciesEnabled()))},dependencies:[ln,E,F,P,Ie,Ee],encapsulation:2})}return i})();export{ua as CompetencyManagementComponent};
//# sourceMappingURL=competency-management.component-C6WTQJ3B.js.map
