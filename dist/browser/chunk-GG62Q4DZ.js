import{q as c}from"./chunk-VK7JPHFE.js";import{c as u}from"./chunk-BNDLMKXK.js";import{a as s,c as l}from"./chunk-TL3DYXRE.js";import{a}from"./chunk-XUCCGZJR.js";import{Ea as r,h as o,ya as g}from"./chunk-5LC5EQRR.js";var n="artemisapp.science.settings",j=(()=>{class t{userSettingsService=r(l);localStorageService=r(a);profileService=r(u);currentScienceSettingsSubject=new o(1);constructor(){this.profileService.getProfileInfo().subscribe(e=>{e.activeProfiles.includes(c)&&(this.initialize(),this.listenForScienceSettingsChanges())})}initialize(){addEventListener("storage",e=>{e.key==="jhi-"+n&&this.currentScienceSettingsSubject.next(this.getStoredScienceSettings())}),this.currentScienceSettingsSubject.next(this.getStoredScienceSettings())}getStoredScienceSettings(){let e=this.localStorageService.retrieve(n);return e?JSON.parse(e):[]}storeScienceSettings(e){e?this.localStorageService.store(n,JSON.stringify(e)):this.localStorageService.clear(n),this.currentScienceSettingsSubject.next(this.getStoredScienceSettings())}refreshScienceSettings(){this.profileService.getProfileInfo().subscribe(e=>{e.activeProfiles.includes(c)&&this.userSettingsService.loadSettings(s.SCIENCE_SETTINGS).subscribe({next:i=>{let S=this.userSettingsService.loadSettingsSuccessAsIndividualSettings(i.body,s.SCIENCE_SETTINGS);this.storeScienceSettings(S),this.currentScienceSettingsSubject.next(S)}})})}getScienceSettings(){return this.getStoredScienceSettings()}getScienceSettingsUpdates(){return this.currentScienceSettingsSubject.asObservable()}listenForScienceSettingsChanges(){this.userSettingsService.userSettingsChangeEvent.subscribe(()=>{this.refreshScienceSettings()})}eventLoggingAllowed(){return this.getStoredScienceSettings().find(i=>i.key==="activity")?.active??!0}static \u0275fac=function(i){return new(i||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();export{j as a};
//# sourceMappingURL=chunk-GG62Q4DZ.js.map
