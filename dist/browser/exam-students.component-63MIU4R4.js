import{a as Re}from"./chunk-KOWVADWF.js";import{a as Ue}from"./chunk-YNY5IUYO.js";import{a as G}from"./chunk-G4HSJ7ME.js";import{c as Ie,d as Ae,e as Fe,f as ke,g as De}from"./chunk-F3NFBBHK.js";import"./chunk-OTCBNILH.js";import{a as we}from"./chunk-ST7GO324.js";import"./chunk-MYJYCKA4.js";import"./chunk-WL6UHE7V.js";import{a as H}from"./chunk-BIK4CL5A.js";import{b as Te}from"./chunk-T624HJJL.js";import"./chunk-HQTS6JOY.js";import{a as L}from"./chunk-HMZID6NQ.js";import{a as O,b as A,d as be}from"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import"./chunk-UQ4R3Q4B.js";import{a as ye}from"./chunk-2QXIMOEO.js";import{a as Ee}from"./chunk-AZBLKUAM.js";import"./chunk-AR57MWOI.js";import"./chunk-A5PTZAPN.js";import"./chunk-AU6UEH3U.js";import"./chunk-FGAONQTL.js";import"./chunk-HQ6UGNQX.js";import"./chunk-ZLJ76G5I.js";import"./chunk-MLVGKM2P.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import{c as ve}from"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import"./chunk-CT44YL7Q.js";import"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import{u as de,v as pe}from"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import{K as me,i as re,k as le,n as se}from"./chunk-WA5GEAJB.js";import"./chunk-5GXY5RYT.js";import{a as N}from"./chunk-K3W6YFKH.js";import{c as B}from"./chunk-JXJXC4DZ.js";import{d as W}from"./chunk-EDXSOKK5.js";import{b as Ce}from"./chunk-R5BZWVRQ.js";import{p as q}from"./chunk-DID2YGL7.js";import"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Lc as P,Ob as fe,Oc as he,Zc as Se,c as ce,cb as _e,fa as ue,gc as U,ob as ge,sd as V,y as xe}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as z}from"./chunk-U54OSGNH.js";import{f as ae,i as oe}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import{n as ie}from"./chunk-IOA4DPXY.js";import{Db as i,Dc as S,Ea as b,Ma as f,Mc as _,Na as h,Oc as m,P as X,Rc as T,Sc as $,Tb as w,Va as ee,Yc as D,Zb as c,Zc as R,_c as j,dd as e,ed as C,f as F,fd as y,kc as d,oa as Z,qd as M,ra as k,s as Q,sc as x,sd as ne,xb as te,xc as o,yc as r,yd as v,z as J,zc as p,zd as E}from"./chunk-5LC5EQRR.js";import{a as I,b as Y}from"./chunk-3E746U5Y.js";var We=["importForm"];function ze(n,s){if(n&1&&(e(0,`
                    `),p(1,"fa-icon",18),e(2,`
                `)),n&2){let t=m();i(),d("icon",t.faSpinner)}}function Oe(n,s){if(n&1&&(e(0,`
                    `),o(1,"div"),e(2,`
                        `),o(3,"div",20),e(4,`
                            `),p(5,"strong",21),e(6,`
                            `),o(7,"span")(8,"b",22),e(9),r()(),e(10,`
                        `),r(),e(11,`
                        `),o(12,"div",20),e(13,`
                            `),o(14,"strong"),e(15),v(16,"artemisTranslate"),r(),e(17,`
                            `),o(18,"span")(19,"b",23),e(20),r()(),e(21,`
                        `),r(),e(22,`
                    `),r(),e(23,`
                `)),n&2){let t=m(2);i(9),C(t.notFoundUsers==null?null:t.notFoundUsers.numberOfUsersNotFound),i(6),y("",E(16,3,"artemisApp.exam.examUsers.numberOfImagesSaved"),":"),i(5),C(t.notFoundUsers==null?null:t.notFoundUsers.numberOfImagesSaved)}}function Le(n,s){if(n&1&&(e(0,`
            `),o(1,"div",19),e(2,`
                `),c(3,Oe,24,5),r(),e(4,`
        `)),n&2){let t=m();i(3),x(t.hasParsed?3:-1)}}function He(n,s){n&1&&(e(0,`
                    `),o(1,"div"),e(2,`
                        `),o(3,"div",20),e(4,`
                            `),p(5,"strong",24),e(6,`
                        `),r(),e(7,`
                    `),r(),e(8,`
                `))}function Qe(n,s){if(n&1&&(e(0,`
            `),o(1,"div",19),e(2,`
                `),c(3,He,9,0),r(),e(4,`
        `)),n&2){let t=m();i(3),x(t.hasParsed?3:-1)}}function $e(n,s){if(n&1){let t=S();e(0,`
                `),o(1,"button",25),_("click",function(){f(t);let a=m();return h(a.clear())}),e(2,`
                    `),p(3,"fa-icon",26),e(4,"\xA0"),p(5,"span",27),e(6,`
                `),r(),e(7,`
            `)}if(n&2){let t=m();i(3),d("icon",t.faBan)}}function qe(n,s){if(n&1){let t=S();e(0,`
                `),o(1,"button",28),_("click",function(){f(t);let a=m();return h(a.parsePDFFile())}),e(2,`
                    `),p(3,"fa-icon",29),e(4,`
                    `),p(5,"span",30),e(6,`
                    `),p(7,"fa-icon",31),e(8,`
                `),r(),e(9,`
            `)}if(n&2){let t=m();i(),d("disabled",!t.file||t.isParsing),i(2),d("icon",t.faUpload),i(4),d("hidden",!t.isParsing)("icon",t.faCircleNotch)}}function Ge(n,s){if(n&1){let t=S();e(0,`
                `),o(1,"button",32),_("click",function(){f(t);let a=m();return h(a.onFinish())}),e(2,`
                    `),p(3,"fa-icon",29),e(4,`
                    `),p(5,"span",33),e(6,`
                `),r(),e(7,`
            `)}if(n&2){let t=m();i(),d("ngClass",t.hasParsed&&(t.notFoundUsers==null?null:t.notFoundUsers.numberOfUsersNotFound)===0?"btn btn-success":"btn btn-danger"),i(2),d("icon",t.faCheck)}}var Me=(()=>{class n{activeModal=b(de);alertService=b(B);examManagementService=b(H);ActionType=L;importForm;notFoundUsers;file;courseId;exam;isParsing=!1;hasParsed=!1;dialogErrorSource=new F;dialogError$=this.dialogErrorSource.asObservable();faBan=ue;faSpinner=Se;faCheck=V;faCircleNotch=xe;faUpload=U;faArrowRight=_e;ngOnDestroy(){this.dialogErrorSource.unsubscribe()}clear(){this.activeModal.dismiss("cancel")}onFinish(){this.activeModal.close()}resetDialog(){this.isParsing=!1,this.notFoundUsers=void 0,this.hasParsed=!1}onPDFFileSelect(t){t.target.files.length>0&&(this.resetDialog(),this.file=t.target.files[0])}parsePDFFile(){if(this.isParsing=!0,this.exam?.id){let t=new FormData;t.append("file",this.file),this.examManagementService.saveImages(this.courseId,this.exam.id,t).subscribe({next:l=>{l&&(this.notFoundUsers=l.body,this.isParsing=!1,this.hasParsed=!0)},error:l=>{l.error.params==="file"&&l?.error?.title?this.alertService.error(l.error.title):ve(this.alertService,l),this.isParsing=!1,this.hasParsed=!1}})}}static \u0275fac=function(l){return new(l||n)};static \u0275cmp=w({type:n,selectors:[["jhi-student-upload-images-dialog"]],viewQuery:function(l,a){if(l&1&&D(We,5),l&2){let u;R(u=j())&&(a.importForm=u.first)}},inputs:{courseId:"courseId",exam:"exam"},decls:59,vars:6,consts:[["id","userImportDialogForm","name","importForm","role","form","novalidate",""],[1,"modal-header"],[1,"modal-title"],[3,"jhiTranslate"],["type","button","data-dismiss","modal","aria-hidden","true",1,"btn-close",3,"click"],[1,"modal-body"],[1,"form-group"],["jhiTranslate","artemisApp.exam.examUsers.introText",1,"intro-text"],["jhiTranslate","artemisApp.exam.examUsers.pdfExampleText",1,"intro-text"],[1,"d-flex","justify-content-center","align-items-center"],["width","300","src","/content/images/upload_student_images_pdf_example_img.png",1,"border"],[1,"d-flex","align-items-end"],["for","importPDF","jhiTranslate","artemisApp.exam.examUsers.pdfFile.label",1,"label-narrow","font-weight-bold"],["text","artemisApp.exam.examUsers.pdfFile.tooltip",1,"me-1"],[1,"mt-2"],["id","importPDF","type","file","accept",".pdf",3,"change"],[1,"modal-footer","justify-content-between"],[1,"flex-grow-1","d-flex","justify-content-end"],["animation","spin",1,"loading-spinner","ms-1",3,"icon"],[1,"flex-shrink-0","me-2","d-flex"],[1,"ms-2"],["jhiTranslate","artemisApp.importUsers.numberOfUsersNotImported"],[2,"color","red"],[2,"color","green"],["jhiTranslate","artemisApp.exam.examUsers.allImagesSaved",2,"color","green"],["type","button","data-dismiss","modal",1,"btn","btn-secondary","cancel","me-2",3,"click"],[3,"icon"],["jhiTranslate","entity.action.cancel"],["type","submit","id","import","name","importButton",1,"btn","btn-primary",3,"click","disabled"],[1,"me-2",3,"icon"],["jhiTranslate","artemisApp.exam.examUsers.saveImages"],["animation","spin",1,"ms-1",3,"hidden","icon"],["id","finish-button",3,"click","ngClass"],["jhiTranslate","entity.action.finish"]],template:function(l,a){if(l&1&&(o(0,"form",0),e(1,`
    `),o(2,"div",1),e(3,`
        `),o(4,"h4",2),e(5,`
            `),o(6,"span",3),e(7," Upload images for registered students: "),r(),e(8,`
        `),r(),e(9,`
        `),o(10,"button",4),_("click",function(){return a.clear()}),r(),e(11,`
    `),r(),e(12,`
    `),o(13,"div",5),e(14,`
        `),o(15,"div",6),e(16,`
            `),p(17,"p",7),e(18,`
            `),p(19,"p",8),e(20,`
        `),r(),e(21,`
        `),o(22,"div",9),e(23,`
            `),p(24,"img",10),e(25,`
        `),r(),e(26,`
        `),o(27,"div",6),e(28,`
            `),o(29,"div",11),e(30,`
                `),o(31,"div"),e(32,`
                    `),p(33,"label",12),e(34,`
                    `),p(35,"jhi-help-icon",13),e(36,`
                `),r(),e(37,`
                `),c(38,ze,3,1),r(),e(39,`
            `),o(40,"div",14),e(41,`
                `),o(42,"input",15),_("change",function(g){return a.onPDFFileSelect(g)}),r(),e(43,`
            `),r(),e(44,`
        `),r(),e(45,`
    `),r(),e(46,`
    `),o(47,"div",16),e(48,`
        `),c(49,Le,5,1)(50,Qe,5,1),o(51,"div",17),e(52,`
            `),c(53,$e,8,1)(54,qe,10,4)(55,Ge,8,2),r(),e(56,`
    `),r(),e(57,`
`),r(),e(58,`
`)),l&2){let u,g;i(6),d("jhiTranslate","artemisApp.exam.examUsers.dialogTitle"),i(32),x(a.isParsing?38:-1),i(11),x((u=a.notFoundUsers==null?null:a.notFoundUsers.numberOfUsersNotFound)!==null&&u!==void 0&&u||(a.notFoundUsers==null?null:a.notFoundUsers.numberOfImagesSaved)===0?49:-1),i(),x((g=a.notFoundUsers==null?null:a.notFoundUsers.numberOfImagesSaved)!==null&&g!==void 0&&g&&(a.notFoundUsers==null?null:a.notFoundUsers.numberOfUsersNotFound)===0?50:-1),i(3),x(a.hasParsed?-1:53),i(),x(a.hasParsed?55:54)}},dependencies:[me,se,re,le,z,ye,W,ie,N],encapsulation:2})}return n})();var Pe=(()=>{class n{modalService=b(pe);ButtonType=O;ButtonSize=A;courseId;exam;buttonSize=A.MEDIUM;uploadDone=new ee;faPlus=P;faUpload=U;openUploadImagesDialog(t){t.stopPropagation();let l=this.modalService.open(Me,{keyboard:!0,size:"lg",backdrop:"static"});l.componentInstance.courseId=this.courseId,l.componentInstance.exam=this.exam,l.result.then(()=>this.uploadDone.emit(),()=>{})}static \u0275fac=function(l){return new(l||n)};static \u0275cmp=w({type:n,selectors:[["jhi-student-upload-images-button"]],inputs:{courseId:"courseId",exam:"exam",buttonSize:"buttonSize"},outputs:{uploadDone:"uploadDone"},decls:3,vars:4,consts:[[3,"onClick","btnType","btnSize","icon","title"]],template:function(l,a){l&1&&(e(0,`
        `),o(1,"jhi-button",0),_("onClick",function(g){return a.openUploadImagesDialog(g)}),r(),e(2,`
    `)),l&2&&(i(),d("btnType",a.ButtonType.PRIMARY)("btnSize",a.buttonSize)("icon",a.faUpload)("title","artemisApp.exam.examUsers.uploadImage"))},dependencies:[be],encapsulation:2})}return n})();var Ke=()=>["login","name"],Ye=(n,s)=>["/course-management",n,"exams",s,"students","verify-attendance"],Be=()=>({deleteParticipationsAndSubmission:"artemisApp.examManagement.examStudents.removeFromExam.deleteParticipationsAndSubmission"});function Je(n,s){if(n&1&&(e(0,`
                `),o(1,"span",3),e(2,`
                    (`),o(3,"span",4),e(4,"search results"),r(),e(5),r(),e(6,`
            `)),n&2){let t=m();i(3),d("jhiTranslate","artemisApp.examManagement.examStudents.searchResults"),i(2),y(": ",t.filteredUsersSize,`
                    )
                `)}}function Xe(n,s){if(n&1){let t=S();e(0,`
                `),o(1,"jhi-user-import-button",7),_("importDone",function(){f(t);let a=m();return h(a.reloadExamWithRegisteredUsers())}),r(),e(2,`
            `)}if(n&2){let t=m();i(),d("courseId",t.courseId)("exam",t.exam)("examUserMode",!0)}}function Ze(n,s){if(n&1){let t=S();e(0,`
                `),o(1,"jhi-student-upload-images-button",8),_("uploadDone",function(){f(t);let a=m();return h(a.reloadExamWithRegisteredUsers())}),r(),e(2,`
            `)}if(n&2){let t=m();i(),d("courseId",t.courseId)("exam",t.exam)}}function et(n,s){if(n&1){let t=S();e(0,`
                `),o(1,"button",9),v(2,"artemisTranslate"),_("click",function(){f(t);let a=m();return h(a.registerAllStudentsFromCourse())}),e(3,`
                    `),p(4,"fa-icon",10),e(5,`\xA0
                    `),p(6,"span",11),e(7,`
                `),r(),e(8,`
            `)}if(n&2){let t=m();i(),T("title",E(2,3,"artemisApp.examManagement.examStudents.registerAllFromCourseTooltip")),i(3),d("icon",t.faPlus)("fixedWidth",!0)}}function tt(n,s){if(n&1&&(e(0,`
                `),o(1,"a",12),v(2,"artemisTranslate"),e(3,`
                    `),p(4,"fa-icon",13),e(5,`
                    `),p(6,"span",14),e(7,`
                `),r(),e(8,`
            `)),n&2){let t=m();i(),T("title",E(2,3,"artemisApp.examManagement.examStudents.verifyAttendanceTooltip")),d("routerLink",ne(5,Ye,t.courseId,t.exam.id)),i(3),d("icon",t.faCheck)}}function nt(n,s){if(n&1){let t=S();e(0,`
                `),o(1,"button",15),_("delete",function(a){f(t);let u=m();return h(u.removeAllStudents(a))}),e(2,`
                    `),p(3,"span",16),e(4,`
                    `),p(5,"fa-icon",13),e(6,`
                `),r(),e(7,`
            `)}if(n&2){let t=m();i(),d("disabled",t.isLoading)("actionType",t.ActionType.Remove)("entityTitle",t.exam.title||"")("renderButtonText",!1)("buttonSize",t.ButtonSize.MEDIUM)("dialogError",t.dialogError$)("additionalChecks",M(8,Be)),i(4),d("icon",t.faUserSlash)}}function it(n,s){if(n&1){let t=S();e(0,`
                        `),o(1,"span",25),_("click",function(){f(t);let a=m().controls;return h(a.onSort("id"))}),e(2,`
                            `),p(3,"span",26),e(4,`
                            `),p(5,"fa-icon",13),e(6,`
                        `),r(),e(7,`
                    `)}if(n&2){let t=m().controls;i(5),d("icon",t.iconForSortPropField("id"))}}function at(n,s){if(n&1&&(e(0,`
                            `),o(1,"a",27),e(2),r(),e(3,`
                        `)),n&2){let t=m().value;i(),$("routerLink","/admin/user-management/",t==null?null:t.login,""),i(),C(t==null?null:t.id)}}function ot(n,s){if(n&1&&e(0),n&2){let t=m().value;y(`
                            `,t==null?null:t.id,`
                        `)}}function rt(n,s){if(n&1&&(e(0,`
                        `),c(1,at,4,3)(2,ot,1,1)),n&2){let t=m(2);i(),x(t.isAdmin?1:2)}}function lt(n,s){}function st(n,s){if(n&1&&(e(0,`
                        `),p(1,"img",28),e(2,`
                    `)),n&2){let t=s.value,l=m(2);i(),d("id",t==null?null:t.id)("src",t!=null&&t.studentImagePath?t==null?null:t.studentImagePath:l.missingImage,te)}}function mt(n,s){if(n&1){let t=S();e(0,`
                        `),o(1,"span",25),_("click",function(){f(t);let a=m().controls;return h(a.onSort("login"))}),e(2,`
                            `),p(3,"span",29),e(4,`
                            `),p(5,"fa-icon",13),e(6,`
                        `),r(),e(7,`
                    `)}if(n&2){let t=m().controls;i(5),d("icon",t.iconForSortPropField("login"))}}function dt(n,s){if(n&1&&(e(0,`
                            `),o(1,"a",27),e(2),r(),e(3,`
                        `)),n&2){let t=m().value;i(),$("routerLink","/admin/user-management/",t==null?null:t.login,""),i(),C(t==null?null:t.login)}}function pt(n,s){if(n&1&&e(0),n&2){let t=m().value;y(`
                            `,t==null?null:t.login,`
                        `)}}function ct(n,s){if(n&1&&(e(0,`
                        `),c(1,dt,4,3)(2,pt,1,1)),n&2){let t=m(2);i(),x(t.isAdmin?1:2)}}function xt(n,s){if(n&1){let t=S();e(0,`
                        `),o(1,"span",25),_("click",function(){f(t);let a=m().controls;return h(a.onSort("name"))}),e(2,`
                            `),p(3,"span",30),e(4,`
                            `),p(5,"fa-icon",13),e(6,`
                        `),r(),e(7,`
                    `)}if(n&2){let t=m().controls;i(5),d("icon",t.iconForSortPropField("name"))}}function ut(n,s){if(n&1&&(e(0,`
                        `),o(1,"span"),e(2),r(),e(3,`
                    `)),n&2){let t=s.value;i(2),C(t)}}function _t(n,s){if(n&1){let t=S();e(0,`
                        `),o(1,"span",25),_("click",function(){f(t);let a=m().controls;return h(a.onSort("email"))}),e(2,`
                            `),p(3,"span",31),e(4,`
                            `),p(5,"fa-icon",13),e(6,`
                        `),r(),e(7,`
                    `)}if(n&2){let t=m().controls;i(5),d("icon",t.iconForSortPropField("email"))}}function gt(n,s){if(n&1&&(e(0,`
                        `),o(1,"span"),e(2),r(),e(3,`
                    `)),n&2){let t=s.value;i(2),C(t)}}function ft(n,s){if(n&1){let t=S();e(0,`
                        `),o(1,"span",25),_("click",function(){f(t);let a=m().controls;return h(a.onSort("visibleRegistrationNumber"))}),e(2,`
                            `),p(3,"span",32),e(4,`
                            `),p(5,"fa-icon",13),e(6,`
                        `),r(),e(7,`
                    `)}if(n&2){let t=m().controls;i(5),d("icon",t.iconForSortPropField("visibleRegistrationNumber"))}}function ht(n,s){if(n&1&&(e(0,`
                        `),o(1,"span"),e(2),r(),e(3,`
                    `)),n&2){let t=s.value;i(2),C(t)}}function St(n,s){n&1&&(e(0,`
                        `),o(1,"span",33),e(2,`
                            `),p(3,"span",34),e(4,`
                        `),r(),e(5,`
                    `))}function Ct(n,s){if(n&1&&(e(0,`
                            `),o(1,"div"),e(2,`
                                `),o(3,"del",35),v(4,"artemisTranslate"),e(5),r(),e(6,`
                                `),o(7,"span",36),v(8,"artemisTranslate"),e(9),r(),e(10,`
                            `),r(),e(11,`
                        `)),n&2){let t=m().value;i(3),T("title",E(4,4,"artemisApp.exam.examUsers.plannedRoom")),i(2),C(t.plannedRoom),i(2),T("title",E(8,6,"artemisApp.exam.examUsers.actualRoom")),i(2),C(t.actualRoom)}}function vt(n,s){if(n&1&&(e(0,`
                            `),o(1,"div"),e(2,`
                                `),o(3,"span",36),v(4,"artemisTranslate"),e(5),r(),e(6,`
                            `),r(),e(7,`
                        `)),n&2){let t=m().value;i(3),T("title",E(4,2,"artemisApp.exam.examUsers.plannedRoom")),i(2),C(t.plannedRoom)}}function Et(n,s){if(n&1&&(e(0,`
                        `),c(1,Ct,12,8)(2,vt,8,4)),n&2){let t=s.value;i(),x(t.actualRoom?1:-1),i(),x(t.plannedRoom&&!t.actualRoom?2:-1)}}function bt(n,s){n&1&&(e(0,`
                        `),o(1,"span",33),e(2,`
                            `),p(3,"span",37),e(4,`
                        `),r(),e(5,`
                    `))}function Tt(n,s){if(n&1&&(e(0,`
                            `),o(1,"div"),e(2,`
                                `),o(3,"del",35),v(4,"artemisTranslate"),e(5),r(),e(6,`
                                `),o(7,"span",36),v(8,"artemisTranslate"),e(9),r(),e(10,`
                            `),r(),e(11,`
                        `)),n&2){let t=m().value;i(3),T("title",E(4,4,"artemisApp.exam.examUsers.plannedSeat")),i(2),C(t.plannedSeat),i(2),T("title",E(8,6,"artemisApp.exam.examUsers.actualSeat")),i(2),C(t.actualSeat)}}function yt(n,s){if(n&1&&(e(0,`
                            `),o(1,"div"),e(2,`
                                `),o(3,"span",36),v(4,"artemisTranslate"),e(5),r(),e(6,`
                            `),r(),e(7,`
                        `)),n&2){let t=m().value;i(3),T("title",E(4,2,"artemisApp.exam.examUsers.plannedSeat")),i(2),C(t.plannedSeat)}}function wt(n,s){if(n&1&&(e(0,`
                        `),c(1,Tt,12,8)(2,yt,8,4)),n&2){let t=s.value;i(),x(t.actualSeat?1:-1),i(),x(t.plannedSeat&&!t.actualSeat?2:-1)}}function Ut(n,s){n&1&&(e(0,`
                            `),o(1,"span",38),v(2,"artemisTranslate"),e(3,`
                                `),p(4,"span",39),e(5,`
                            `),r(),e(6,`
                        `)),n&2&&(i(),T("title",E(2,1,"artemisApp.exam.examUsers.attendanceStatusTitle")))}function It(n,s){if(n&1&&(e(0,`
                                `),o(1,"div",35),v(2,"artemisTranslate"),e(3,`
                                    `),p(4,"fa-icon",40),e(5,`
                                `),r(),e(6,`
                            `)),n&2){let t=m(4);i(),T("title",E(2,2,"artemisApp.exam.examUsers.attendanceCheckFailed")),i(3),d("icon",t.faTimes)}}function At(n,s){if(n&1&&(e(0,`
                                `),o(1,"div",35),v(2,"artemisTranslate"),e(3,`
                                    `),p(4,"fa-icon",41),e(5,`
                                `),r(),e(6,`
                            `)),n&2){let t=m(4);i(),T("title",E(2,2,"artemisApp.exam.examUsers.attendanceCheckPassed")),i(3),d("icon",t.faCheck)}}function Ft(n,s){if(n&1&&(e(0,`
                                `),o(1,"div",35),v(2,"artemisTranslate"),e(3,`
                                    `),p(4,"fa-icon",42),e(5,`
                                `),r(),e(6,`
                            `)),n&2){let t=m(4);i(),T("title",E(2,2,"artemisApp.exam.examUsers.didNotAttend")),i(3),d("icon",t.faUserTimes)}}function kt(n,s){if(n&1&&(e(0,`
                            `),c(1,It,7,4)(2,At,7,4)(3,Ft,7,4)),n&2){let t=s.value,l=m(3);i(),x(t.didExamUserAttendExam&&l.hasExamEnded&&(!t.didCheckLogin||!t.didCheckImage||!t.didCheckName||!t.didCheckRegistrationNumber||!t.signingImagePath)?1:-1),i(),x(t.didExamUserAttendExam&&t.didCheckLogin&&t.didCheckImage&&t.didCheckName&&t.didCheckRegistrationNumber&&t.signingImagePath&&l.hasExamEnded?2:-1),i(),x(t.didExamUserAttendExam?-1:3)}}function Dt(n,s){n&1&&(e(0,`
                    `),o(1,"ngx-datatable-column",21),e(2,`
                        `),c(3,Ut,7,3,"ng-template",19),e(4,`
                        `),c(5,kt,4,3,"ng-template",20),e(6,`
                    `),r(),e(7,`
                `)),n&2&&(i(),d("minWidth",70)("width",70))}function Rt(n,s){}function jt(n,s){if(n&1){let t=S();e(0,`
                            `),o(1,"div",43),e(2,`
                                `),o(3,"button",44),_("delete",function(a){let u=f(t).value,g=m(3);return h(g.removeFromExam(u,a))}),e(4,`
                                    `),p(5,"fa-icon",45),e(6,`
                                `),r(),e(7,`
                            `),r(),e(8,`
                        `)}if(n&2){let t=s.value,l=m(3);i(3),d("actionType",l.ActionType.Remove)("entityTitle",t.login)("additionalChecks",M(6,Be))("dialogError",l.dialogError$)("requireConfirmationOnlyForAdditionalChecks",!0),i(2),d("icon",l.faUserSlash)}}function Mt(n,s){n&1&&(e(0,`
                    `),o(1,"ngx-datatable-column",21),e(2,`
                        `),c(3,Rt,0,0,"ng-template",19),e(4,`
                        `),c(5,jt,9,7,"ng-template",20),e(6,`
                    `),r(),e(7,`
                `)),n&2&&(i(),d("minWidth",100)("width",100))}function Pt(n,s){if(n&1&&(e(0,`
            `),o(1,"ngx-datatable",17),e(2,`
                `),o(3,"ngx-datatable-column",18),e(4,`
                    `),c(5,it,8,1,"ng-template",19),e(6,`
                    `),c(7,rt,3,1,"ng-template",20),e(8,`
                `),r(),e(9,`
                `),o(10,"ngx-datatable-column",18),e(11,`
                    `),c(12,lt,0,0,"ng-template",19),e(13,`
                    `),c(14,st,3,2,"ng-template",20),e(15,`
                `),r(),e(16,`
                `),o(17,"ngx-datatable-column",21),e(18,`
                    `),c(19,mt,8,1,"ng-template",19),e(20,`
                    `),c(21,ct,3,1,"ng-template",20),e(22,`
                `),r(),e(23,`
                `),o(24,"ngx-datatable-column",22),e(25,`
                    `),c(26,xt,8,1,"ng-template",19),e(27,`
                    `),c(28,ut,4,1,"ng-template",20),e(29,`
                `),r(),e(30,`
                `),o(31,"ngx-datatable-column",23),e(32,`
                    `),c(33,_t,8,1,"ng-template",19),e(34,`
                    `),c(35,gt,4,1,"ng-template",20),e(36,`
                `),r(),e(37,`
                `),o(38,"ngx-datatable-column",24),e(39,`
                    `),c(40,ft,8,1,"ng-template",19),e(41,`
                    `),c(42,ht,4,1,"ng-template",20),e(43,`
                `),r(),e(44,`
                `),o(45,"ngx-datatable-column",21),e(46,`
                    `),c(47,St,6,0,"ng-template",19),e(48,`
                    `),c(49,Et,3,2,"ng-template",20),e(50,`
                `),r(),e(51,`
                `),o(52,"ngx-datatable-column",21),e(53,`
                    `),c(54,bt,6,0,"ng-template",19),e(55,`
                    `),c(56,wt,3,2,"ng-template",20),e(57,`
                `),r(),e(58,`
                `),c(59,Dt,8,2)(60,Mt,8,2),r(),e(61,`
        `)),n&2){let t=s.settings,l=m();i(),d("limit",t.limit)("sortType",t.sortType)("columnMode",t.columnMode)("headerHeight",t.headerHeight)("footerHeight",t.footerHeight)("rowHeight",t.rowHeight)("rows",t.rows)("rowClass",t.rowClass)("scrollbarH",t.scrollbarH),i(2),d("minWidth",60)("width",80)("maxWidth",100),i(7),d("minWidth",60)("width",80)("maxWidth",100),i(7),d("minWidth",150)("width",150),i(7),d("minWidth",120)("width",120),i(7),d("minWidth",150)("width",150),i(7),d("minWidth",100)("width",100),i(7),d("minWidth",100)("width",100),i(7),d("minWidth",100)("width",100),i(7),x(l.hasExamEnded?59:-1),i(),x(l.isTestExam?-1:60)}}var Ve={alreadyRegistered:"already-registered",newlyRegistered:"newly-registered"},Ln=(()=>{class n{route=b(ae);alertService=b(B);examManagementService=b(H);userService=b(Ee);accountService=b(Ce);studentExamService=b(Re);dataTable;ButtonType=O;ButtonSize=A;ActionType=L;missingImage="/content/images/missing_image.png";courseId;exam;isTestExam;allRegisteredUsers=[];filteredUsersSize=0;paramSub;dialogErrorSource=new F;dialogError$=this.dialogErrorSource.asObservable();isLoading=!1;hasExamStarted=!1;hasExamEnded=!1;isSearching=!1;searchFailed=!1;searchNoResults=!1;isTransitioning=!1;rowClass=void 0;isAdmin=!1;faPlus=P;faUserSlash=ge;faUserTimes=ce;faInfoCircle=fe;faUpload=U;faCheck=V;faTimes=he;ngOnInit(){this.isLoading=!0,this.courseId=Number(this.route.snapshot.paramMap.get("courseId")),this.isAdmin=this.accountService.isAdmin(),this.route.data.subscribe(({exam:t})=>{this.setUpExamInformation(t)})}reloadExamWithRegisteredUsers(){this.isLoading=!0,this.examManagementService.find(this.courseId,this.exam.id,!0).subscribe(t=>{this.setUpExamInformation(t.body)})}setUpExamInformation(t){this.exam=t,this.hasExamStarted=t.startDate?.isBefore(q())||!1,this.hasExamEnded=t.endDate?.isBefore(q())||!1,this.hasExamEnded?this.studentExamService.findAllForExam(this.courseId,t.id).subscribe(l=>{let a=l.body;this.allRegisteredUsers=t.examUsers?.map(u=>{let g=a?.filter(K=>K.user?.id===u.user.id).first();return Y(I(I({},u.user),u),{didExamUserAttendExam:!!g?.started})})||[]}):this.allRegisteredUsers=t.examUsers?.map(l=>I(I({},l.user),l))||[],this.isTestExam=this.exam.testExam,this.isLoading=!1}ngOnDestroy(){this.dialogErrorSource.unsubscribe()}searchAllUsers=t=>t.pipe(Z(({text:l})=>(this.searchFailed=!1,this.searchNoResults=!1,l.length<3?Q([]):(this.isSearching=!0,this.userService.search(l).pipe(J(a=>a.body)).pipe(k(a=>{a.length===0&&(this.searchNoResults=!0)}),X(()=>(this.searchFailed=!0,Q([]))))))),k(()=>{this.isSearching=!1}),k(l=>{setTimeout(()=>{for(let a=0;a<this.dataTable.typeaheadButtons.length;a++){let u=this.allRegisteredUsers.map(Ne=>Ne.id).includes(l[a].id),g=this.dataTable.typeaheadButtons[a];g.querySelector("fa-icon")||g.insertAdjacentHTML("beforeend",Ue[u?"users":"users-plus"]),u&&g.classList.add(Ve.alreadyRegistered)}})}));onAutocompleteSelect=(t,l)=>{!this.allRegisteredUsers.map(a=>a.user.id).includes(t.id)&&t.login?(this.isTransitioning=!0,this.examManagementService.addStudentToExam(this.courseId,this.exam.id,t.login).subscribe({next:()=>{this.isTransitioning=!1,this.reloadExamWithRegisteredUsers(),this.flashRowClass(Ve.newlyRegistered)},error:a=>{a.status===403&&this.onError(`artemisApp.exam.error.${a.error.errorKey}`),this.isTransitioning=!1}})):l(t)};removeFromExam(t,l){this.examManagementService.removeStudentFromExam(this.courseId,this.exam.id,t.user.login,l.deleteParticipationsAndSubmission).subscribe({next:()=>{this.allRegisteredUsers=this.allRegisteredUsers.filter(a=>a.user.login!==t.user.login),this.dialogErrorSource.next("")},error:a=>this.dialogErrorSource.next(a.message)})}removeAllStudents(t){this.examManagementService.removeAllStudentsFromExam(this.courseId,this.exam.id,t.deleteParticipationsAndSubmission).subscribe({next:()=>{this.allRegisteredUsers=[],this.dialogErrorSource.next("")},error:l=>this.dialogErrorSource.next(l.message)})}handleUsersSizeChange=t=>{this.filteredUsersSize=t};searchResultFormatter=t=>{let{name:l,login:a}=t;return`${l} (${a})`};searchTextFromUser=t=>t.login||"";flashRowClass=t=>{this.rowClass=t,setTimeout(()=>this.rowClass=void 0,500)};onError(t){this.alertService.error(t),this.isTransitioning=!1}registerAllStudentsFromCourse(){this.exam?.id&&this.examManagementService.addAllStudentsOfCourseToExam(this.courseId,this.exam.id).subscribe({next:()=>{this.reloadExamWithRegisteredUsers()},error:t=>this.dialogErrorSource.next(t.message)})}static \u0275fac=function(l){return new(l||n)};static \u0275cmp=w({type:n,selectors:[["jhi-exam-students"]],viewQuery:function(l,a){if(l&1&&D(G,5),l&2){let u;R(u=j())&&(a.dataTable=u.first)}},decls:37,vars:21,consts:[[1,"d-flex","justify-content-between","align-items-center","border-bottom","pb-2","mb-3"],[1,"mb-0"],["jhiTranslate","artemisApp.examManagement.students"],[1,"text-body-secondary"],[3,"jhiTranslate"],["id","#registered-users",1,"badge","bg-primary","text-white"],["entityType","examStudents","entitiesPerPageTranslation","artemisApp.examManagement.examStudents.usersPerPage","showAllEntitiesTranslation","artemisApp.examManagement.examStudents.showAllUsers","searchNoResultsTranslation","artemisApp.examManagement.examStudents.searchNoResults","searchPlaceholderTranslation","artemisApp.examManagement.examStudents.searchForUsers",3,"entitiesSizeChange","isLoading","isSearching","searchFailed","searchNoResults","isTransitioning","allEntities","searchFields","searchTextFromEntity","searchResultFormatter","onSearchWrapper","onAutocompleteSelectWrapper"],[1,"ms-4",3,"importDone","courseId","exam","examUserMode"],[3,"uploadDone","courseId","exam"],["id","register-course-students",1,"btn","btn","btn-primary","ms-auto",3,"click","title"],[3,"icon","fixedWidth"],["jhiTranslate","artemisApp.examManagement.examStudents.registerAllFromCourse"],[1,"btn","btn-info","ms-auto",3,"routerLink","title"],[3,"icon"],["jhiTranslate","artemisApp.examManagement.examStudents.verifyAttendanceBtn",1,"d-none","d-md-inline"],["jhiDeleteButton","","deleteQuestion","artemisApp.studentExams.removeAllStudents.question","deleteConfirmationText","artemisApp.studentExams.removeAllStudents.confirmationText",1,"btn","btn-primary","ms-auto",3,"delete","disabled","actionType","entityTitle","renderButtonText","buttonSize","dialogError","additionalChecks"],["jhiTranslate","artemisApp.studentExams.removeAllStudents.title"],["id","registered-students",1,"bootstrap",3,"limit","sortType","columnMode","headerHeight","footerHeight","rowHeight","rows","rowClass","scrollbarH"],["prop","",3,"minWidth","width","maxWidth"],["ngx-datatable-header-template",""],["ngx-datatable-cell-template",""],["prop","",3,"minWidth","width"],["prop","name",3,"minWidth","width"],["prop","email",3,"minWidth","width"],["prop","visibleRegistrationNumber",3,"minWidth","width"],[1,"datatable-header-cell-wrapper",3,"click"],["jhiTranslate","global.field.id",1,"datatable-header-cell-label","bold","sortable"],[3,"routerLink"],[1,"img-fluid",3,"id","src"],["jhiTranslate","artemisApp.examManagement.examStudents.login",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.examManagement.examStudents.name",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.examManagement.examStudents.email",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.examManagement.examStudents.registrationNumber",1,"datatable-header-cell-label","bold","sortable"],[1,"datatable-header-cell-wrapper"],["jhiTranslate","artemisApp.exam.examUsers.room",1,"datatable-header-cell-label","bold"],[3,"title"],[1,"ml-1",3,"title"],["jhiTranslate","artemisApp.exam.examUsers.seat",1,"datatable-header-cell-label","bold"],[1,"datatable-header-cell-wrapper",3,"title"],["jhiTranslate","artemisApp.exam.examUsers.attendanceStatus",1,"datatable-header-cell-label","bold"],[1,"fa-2x",2,"color","red",3,"icon"],[1,"fa-2x",2,"color","green",3,"icon"],[1,"fa-2x",3,"icon"],[1,"w-100","text-end"],["jhiDeleteButton","","deleteQuestion","artemisApp.examManagement.examStudents.removeFromExam.modalQuestion","deleteConfirmationText","artemisApp.examManagement.examStudents.removeFromExam.typeNameToConfirm",3,"delete","actionType","entityTitle","additionalChecks","dialogError","requireConfirmationOnlyForAdditionalChecks"],[1,"me-1",3,"icon"]],template:function(l,a){l&1&&(o(0,"div"),e(1,`
    `),o(2,"div",0),e(3,`
        `),o(4,"div",1),e(5,`
            `),o(6,"h3"),e(7,`
                `),p(8,"span",2),e(9,`
                `),o(10,"span",3),e(11),r(),e(12,`
            `),r(),e(13,`
        `),r(),e(14,`
        `),o(15,"div"),e(16,`
            `),o(17,"span",4),e(18,"Registered students"),r(),e(19,`:
            `),o(20,"span",5),e(21),r(),e(22,`
            `),c(23,Je,7,2)(24,Xe,3,3)(25,Ze,3,2)(26,et,9,5)(27,tt,9,8)(28,nt,8,9),r(),e(29,`
    `),r(),e(30,`
    `),o(31,"jhi-data-table",6),_("entitiesSizeChange",function(g){return a.handleUsersSizeChange(g)}),e(32,`
        `),c(33,Pt,62,29,"ng-template"),e(34,`
    `),r(),e(35,`
`),r(),e(36,`
`)),l&2&&(i(11),y("(",a.exam.title,")"),i(6),d("jhiTranslate","artemisApp.examManagement.examStudents.registeredStudents"),i(4),y(" ",a.allRegisteredUsers.length,""),i(2),x(a.filteredUsersSize<a.allRegisteredUsers.length?23:-1),i(),x(a.isTestExam?-1:24),i(),x(a.isTestExam?-1:25),i(),x(a.isTestExam?-1:26),i(),x(!a.isTestExam&&a.hasExamStarted?27:-1),i(),x(a.isTestExam?-1:28),i(3),d("isLoading",a.isLoading)("isSearching",a.isSearching)("searchFailed",a.searchFailed)("searchNoResults",a.searchNoResults)("isTransitioning",a.isTransitioning)("allEntities",a.allRegisteredUsers)("searchFields",M(20,Ke))("searchTextFromEntity",a.searchTextFromUser)("searchResultFormatter",a.searchResultFormatter)("onSearchWrapper",a.searchAllUsers)("onAutocompleteSelectWrapper",a.onAutocompleteSelect))},dependencies:[z,we,Pe,W,oe,Te,G,De,ke,Fe,Ie,Ae,N],styles:[`jhi-exam-students ngb-typeahead-window{min-width:400px}jhi-exam-students ngb-typeahead-window .dropdown-item{display:flex;justify-content:space-between}jhi-exam-students ngb-typeahead-window .dropdown-item.active{background-color:var(--exam-students-dropdown-item-active)}jhi-exam-students ngb-typeahead-window .dropdown-item.already-registered{color:var(--exam-students-dropdown-item-already-registered-color);background-color:var(--exam-students-dropdown-item-already-registered-background-color);opacity:.5}jhi-exam-students ngb-typeahead-window .dropdown-item.already-registered.active{background-color:var(--exam-students-dropdown-item-already-registered-background-hover-color);opacity:.8}jhi-exam-students .datatable-body-row.newly-registered{animation-name:flash-animation;animation-delay:.15s;animation-duration:1.5s;animation-timing-function:ease-out}@keyframes flash-animation{30%{background-color:var(--exam-students-datatable-row-newly-registered-background-color)}}
`],encapsulation:2})}return n})();export{Ln as ExamStudentsComponent};
//# sourceMappingURL=exam-students.component-63MIU4R4.js.map
