import{a as _e,b as Ye}from"./chunk-2ZSCKKMJ.js";import{a as x}from"./chunk-XFUIAIWN.js";import{a as We}from"./chunk-GRLLGFUW.js";import{b as qe}from"./chunk-PTO7UATL.js";import{d as T}from"./chunk-O4VJ5OXY.js";import{b as q,e as He,g as Xe,h as ze,i as Qe,j as Ze,k as $e}from"./chunk-BDII35IB.js";import"./chunk-LARBQRTJ.js";import{a as ke}from"./chunk-UDBRF4PR.js";import"./chunk-2CUFQLAH.js";import{a as pe}from"./chunk-DRMCDU75.js";import"./chunk-Z6NSEM73.js";import{a as Ve}from"./chunk-A5PTZAPN.js";import{a as je}from"./chunk-HQ6UGNQX.js";import{c as Ge}from"./chunk-5MVJAZRV.js";import{a as he}from"./chunk-G4I63THF.js";import{d as V,f as X}from"./chunk-CT44YL7Q.js";import{K as Ne,q as ie,r as ne,s as re}from"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import"./chunk-WA5GEAJB.js";import{e as me,z as $}from"./chunk-5GXY5RYT.js";import{a as ae}from"./chunk-K3W6YFKH.js";import{c as Ue}from"./chunk-JXJXC4DZ.js";import{d as ce}from"./chunk-EDXSOKK5.js";import{p as Q}from"./chunk-DID2YGL7.js";import{c,f as Z}from"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Sa as se,kb as Be,qa as Fe}from"./chunk-Z4VHWOB5.js";import"./chunk-NOBD5HSR.js";import{a as le}from"./chunk-U54OSGNH.js";import{f as te,i as Le}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import{c as oe}from"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import{A as Re,O as we}from"./chunk-IOA4DPXY.js";import{Db as o,Dc as M,Ea as C,Ed as G,La as Te,Ma as P,Mc as I,Na as O,Oc as u,Rc as R,Sc as Oe,Tb as K,Va as ye,Yc as Ie,Zb as S,Zc as Ae,_c as De,aa as ve,cd as ee,dd as t,ed as U,f as Ee,fd as H,gd as A,kc as m,lc as be,mc as J,qd as ue,rd as f,sc as _,sd as y,tc as Pe,uc as z,ud as Me,vc as F,wc as B,xc as s,ya as fe,yc as a,yd as g,z as Ce,zc as p,zd as E}from"./chunk-5LC5EQRR.js";import{a as Y}from"./chunk-3E746U5Y.js";var Je=(()=>{class i{http=C(we);resourceUrl="api/exercise";getExerciseScoresForCourse(e){if(e==null||e<1)throw new Error("Invalid courseId provided: "+e);return this.http.get(`${this.resourceUrl}/courses/${e}/charts/exercise-scores`,{observe:"response"}).pipe(Ce(n=>{if(n.body)for(let r of n.body)r.releaseDate=r.releaseDate?Q(r.releaseDate):void 0;return n}))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=fe({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var lt=i=>[i,350],pt=i=>({num:i});function dt(i,l){if(i&1){let e=M();t(0,`
                    `),s(1,"li"),t(2,`
                        `),s(3,"label"),t(4,`
                            `),s(5,"input",14),I("change",function(){let r=P(e).$implicit,d=u(2);return O(d.toggleType(r))}),a(),t(6,`
                            `),s(7,"span",15),t(8),g(9,"artemisTranslate"),a(),t(10,`
                        `),a(),t(11,`
                    `),a(),t(12,`
                `)}if(i&2){let e=l.$implicit,n=u(2);o(5),m("checked",n.exerciseTypeFilter.getCurrentFilterState(n.convertToMapKey(e))),o(3),U(E(9,2,"artemisApp.exercise-scores-chart."+e.toLowerCase()+"Plural"))}}function xt(i,l){if(i&1&&(t(0,`
        `),s(1,"div",8),t(2,`
            `),s(3,"button",9),t(4,`
                `),p(5,"fa-icon",10),t(6,`
                `),p(7,"span",11),t(8,`
            `),a(),t(9,`
            `),s(10,"ul",12),t(11,`
                `),s(12,"li"),t(13,`
                    `),p(14,"b",13),t(15,`
                `),a(),t(16,`
                `),F(17,dt,13,4,null,null,z),a(),t(19,`
        `),a(),t(20,`
    `)),i&2){let e=u();o(3),J("btn-secondary",e.exerciseTypeFilter.numberOfActiveFilters===0)("btn-success",e.exerciseTypeFilter.numberOfActiveFilters>0),o(2),m("icon",e.faFilter),o(2),m("translateValues",f(6,pt,e.exerciseTypeFilter.numberOfActiveFilters)),o(10),B(e.exerciseTypeFilter.typeSet)}}function ut(i,l){if(i&1&&(t(0,`
                `),s(1,"b"),t(2),a(),t(3," "),p(4,"br"),t(5,`
                `),s(6,"span"),t(7),a(),t(8,`
            `)),i&2){let e=l.model,n=u();o(2),U(e.name),o(5),A("",e.series,": ",n.Math.max(e.value,0)," %")}}function mt(i,l){if(i&1&&(t(0,`
                        `),s(1,"div"),t(2),a(),t(3,`
                    `)),i&2){let e=l.$implicit,n=u(3);o(2),A("",e.series,": ",n.Math.max(e.value,0),"%")}}function ht(i,l){if(i&1&&(t(0,`
                    `),s(1,"h6"),t(2),a(),t(3,`
                    `),F(4,mt,4,2,null,null,z),s(6,"b"),t(7),g(8,"artemisTranslate"),g(9,"artemisTranslate"),a(),t(10,`
                `)),i&2){let e=u().model;o(2),U(e[0].name),o(2),B(e),o(3),A(`
                        `,E(8,3,"artemisApp.exercise-scores-chart.exerciseType"),`
                        `,E(9,5,"artemisApp.exercise-scores-chart."+e[0].exerciseType.toLowerCase()),"")}}function _t(i,l){if(i&1&&(t(0,`
                `),S(1,ht,11,7)),i&2){let e=l.model;o(),_(e.length?1:-1)}}var et=(()=>{class i{navigationUtilService=C(pe);activatedRoute=C(te);alertService=C(Ue);exerciseScoresChartService=C(Je);exerciseTypeFilter=C(_e);translateService=C(oe);filteredExerciseIDs;courseId;isLoading=!1;exerciseScores=[];excludedExerciseScores=[];visibleExerciseScores=[];Math=Math;ExerciseType=c;convertToMapKey=_e.convertToMapKey;faFilter=se;ngxData=[];backUpData=[];xAxisLabel;yAxisLabel;ngxColor={name:"Performance in Exercises",selectable:!0,group:q.Ordinal,domain:[T.BLUE,T.YELLOW,T.GREEN]};colorBase=[T.BLUE,T.YELLOW,T.GREEN];yourScoreLabel;averageScoreLabel;maximumScoreLabel;maxScale=101;constructor(){this.translateService.onLangChange.subscribe(()=>{this.setTranslations()})}ngAfterViewInit(){this.activatedRoute.parent?.parent?.params.subscribe(e=>{this.courseId=+e.courseId,this.courseId&&this.loadDataAndInitializeChart()})}ngOnChanges(){this.initializeChart()}loadDataAndInitializeChart(){this.isLoading=!0,this.exerciseScoresChartService.getExerciseScoresForCourse(this.courseId).pipe(ve(()=>{this.isLoading=!1})).subscribe({next:e=>{this.exerciseScores=e.body,this.initializeChart()},error:e=>Ge(this.alertService,e)})}initializeChart(){this.setTranslations(),this.exerciseScores=this.exerciseScores.concat(this.excludedExerciseScores),this.excludedExerciseScores=this.exerciseScores.filter(n=>this.filteredExerciseIDs.includes(n.exerciseId)),this.exerciseScores=this.exerciseScores.filter(n=>!this.filteredExerciseIDs.includes(n.exerciseId)),this.visibleExerciseScores=Array.of(...this.exerciseScores);let e=$(this.exerciseScores,n=>n.releaseDate);this.exerciseTypeFilter.initializeFilterOptions(e),this.addData(e)}addData(e){this.ngxData=[];let n=[],r=[],d=[];e.forEach(v=>{let D={exerciseId:v.exerciseId,exerciseType:v.exerciseType};this.maxScale=Math.max(V(v.scoreOfStudent),V(v.averageScoreAchieved),V(v.maxScoreAchieved),this.maxScale),n.push(Y({name:v.exerciseTitle,value:V(v.scoreOfStudent)},D)),r.push(Y({name:v.exerciseTitle,value:V(v.averageScoreAchieved)},D)),d.push(Y({name:v.exerciseTitle,value:V(v.maxScoreAchieved)},D))});let h={name:this.yourScoreLabel,series:n},b={name:this.averageScoreLabel,series:r},N={name:this.maximumScoreLabel,series:d};this.ngxData.push(h),this.ngxData.push(b),this.ngxData.push(N),this.ngxData=[...this.ngxData],this.backUpData=me(this.ngxData)}onSelect(e){if(typeof e=="string"){let n=e,r=this.ngxData.findIndex(d=>d.name===n);this.ngxColor.domain[r]!=="rgba(255,255,255,0)"?(this.ngxData[r].series=[],this.ngxColor.domain[r]="rgba(255,255,255,0)"):(this.ngxData[r].series=me(this.backUpData[r].series),this.ngxColor.domain[r]=this.colorBase[r]),this.ngxData=[...this.ngxData]}else this.navigateToExercise(e.exerciseId)}navigateToExercise(e){this.navigationUtilService.routeInNewTab(["courses",this.courseId,"exercises",e])}toggleType(e){this.visibleExerciseScores=this.exerciseTypeFilter.toggleExerciseType(e,this.exerciseScores);let n=$(this.visibleExerciseScores,r=>r.releaseDate);this.addData(n)}setTranslations(){this.xAxisLabel=this.translateService.instant("artemisApp.exercise-scores-chart.xAxis"),this.yAxisLabel=this.translateService.instant("artemisApp.exercise-scores-chart.yAxis"),this.yourScoreLabel=this.translateService.instant("artemisApp.exercise-scores-chart.yourScoreLabel"),this.averageScoreLabel=this.translateService.instant("artemisApp.exercise-scores-chart.averageScoreLabel"),this.maximumScoreLabel=this.translateService.instant("artemisApp.exercise-scores-chart.maximumScoreLabel"),this.ngxData.length>0&&([this.yourScoreLabel,this.averageScoreLabel,this.maximumScoreLabel].forEach((n,r)=>{this.ngxData[r].name=n}),this.ngxData=[...this.ngxData])}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=K({type:i,selectors:[["jhi-exercise-scores-chart"]],inputs:{filteredExerciseIDs:"filteredExerciseIDs"},features:[Te],decls:22,vars:18,consts:[["containerRef",""],["tooltipTemplate",""],["seriesTooltipTemplate",""],[1,"d-flex"],["jhiTranslate","artemisApp.exercise-scores-chart.title",1,"col-9"],[1,"d-flex","mt-2","justify-content-center"],[1,"line-chart-container"],[3,"select","view","results","scheme","yAxisLabel","xAxisLabel","legend","legendTitle","xAxis","yAxis","showYAxisLabel","showXAxisLabel","yScaleMax","yScaleMin","maxXAxisTickLength","id"],["aria-label","Filter Dropdown","ngbDropdown","",1,"filter","mb-2"],["ngbDropdownToggle","","id","filter-dropdown-button",1,"btn"],[3,"icon"],["jhiTranslate","artemisApp.courseOverview.exerciseList.filter",3,"translateValues"],["ngbDropdownMenu","","aria-labelledby","filter-dropdown-button",1,"checkbox-menu","text-nowrap","pe-2"],["jhiTranslate","artemisApp.exercise-scores-chart.includeType",1,"ms-2"],["type","checkbox",1,"ms-2","form-check-input",3,"change","checked"],[1,"ms-2"]],template:function(n,r){if(n&1){let d=M();s(0,"div",3),t(1,`
    `),p(2,"h2",4),t(3,`
    `),S(4,xt,21,8),a(),t(5,`
`),s(6,"div",5),t(7,`
    `),s(8,"div",6,0),t(10,`
        `),s(11,"ngx-charts-line-chart",7),I("select",function(b){return P(d),O(r.onSelect(b))}),t(12,`
            `),S(13,ut,9,3,"ng-template",null,1,G),t(15,`
            `),S(16,_t,2,1,"ng-template",null,2,G),t(18,`
        `),a(),t(19,`
    `),a(),t(20,`
`),a(),t(21,`
`)}if(n&2){let d=ee(9);o(4),_(r.exerciseTypeFilter.typeSet.size>0?4:-1),o(7),m("view",f(16,lt,d.offsetWidth))("results",r.ngxData)("scheme",r.ngxColor)("yAxisLabel",r.yAxisLabel)("xAxisLabel",r.xAxisLabel)("legend",!0)("legendTitle","")("xAxis",!0)("yAxis",!0)("showYAxisLabel",!0)("showXAxisLabel",!0)("yScaleMax",r.maxScale)("yScaleMin",1)("maxXAxisTickLength",15)("id","scores-line-chart")}},dependencies:[le,re,ne,ce,ie,Qe,ze,ae],styles:[".chart-wrapper[_ngcontent-%COMP%]{width:90%}.filter[_ngcontent-%COMP%]{margin-left:.5rem}.chart[_ngcontent-%COMP%]{height:350px}.line-chart-container[_ngcontent-%COMP%]{width:75%}[_nghost-%COMP%]  .ngx-charts-axis-label{font-weight:bolder}[_nghost-%COMP%]  .chart-legend{padding-top:104px}[_nghost-%COMP%]  .chart-legend .legend-labels{overflow:visible;background-color:transparent!important}[_nghost-%COMP%]  .chart-legend .legend-label{color:var(--artemis-dark)}[_nghost-%COMP%]  .chart-legend .legend-label :hover{color:var(--primary)!important}[_nghost-%COMP%]  .chart-legend .legend-label .legend-label-color{width:20px;height:20px}[_nghost-%COMP%]  .chart-legend .legend-label-text{font-weight:bolder;font-size:1.125rem;line-height:21px}[_nghost-%COMP%]  .line-series path{stroke-width:2px}@media (max-width: 1300px){.line-chart-container[_ngcontent-%COMP%]{width:100%!important}[_nghost-%COMP%]  .ngx-charts-outer{display:flex;flex-direction:column}[_nghost-%COMP%]  .ngx-charts-outer{margin-bottom:10rem}[_nghost-%COMP%]  .chart-legend{padding:0!important}[_nghost-%COMP%]  .chart-legend>div:first-child{width:100%!important}[_nghost-%COMP%]  .chart-legend .legend-labels{max-width:100%;display:flex;justify-content:center;flex-direction:column;overflow:visible}}"]})}return i})();var St=["controls"],gt=i=>({num:i}),k=i=>({number:i}),de=(i,l)=>({number:i,relative:l}),Et=()=>[350,350],Ct=()=>["grading-key"],vt=i=>({grade:i}),ft=(i,l)=>({number:i,type:l}),Tt=(i,l)=>[i,l],yt=(i,l,e,n)=>[i,l,e,n],st=(i,l)=>({points:i,percentage:l}),at=(i,l)=>({tests:i,percentage:l}),ge=i=>({exercise:i});function bt(i,l){return this.ngxDoughnutData.indexOf(l)}function Pt(i,l){if(i&1){let e=M();t(0,`
                    `),s(1,"li"),t(2,`
                        `),s(3,"label"),t(4,`
                            `),s(5,"input",12),I("change",function(){P(e);let r=u(2);return O(r.toggleExercisesWithNoCategory())}),a(),t(6,`
                            `),p(7,"span",17),t(8,`
                        `),a(),t(9,`
                    `),a(),t(10,`
                `)}if(i&2){let e=u(2);o(5),m("checked",e.categoryFilter.includeExercisesWithNoCategory)}}function Ot(i,l){if(i&1){let e=M();t(0,`
                    `),s(1,"li"),t(2,`
                        `),s(3,"label"),t(4,`
                            `),s(5,"input",12),I("change",function(){let r=P(e).$implicit,d=u(2);return O(d.toggleCategory(r))}),a(),t(6,`
                            `),s(7,"span",18),t(8),a(),t(9,`
                        `),a(),t(10,`
                    `),a(),t(11,`
                `)}if(i&2){let e=l.$implicit,n=u(2);o(5),m("checked",n.categoryFilter.getCurrentFilterState(e)),o(3),U(e)}}function It(i,l){if(i&1){let e=M();t(0,`
    `),s(1,"div",4),t(2,`
        `),s(3,"div",5),t(4,`
            `),s(5,"button",6),t(6,`
                `),p(7,"fa-icon",7),t(8,`
                `),p(9,"span",8),t(10,`
            `),a(),t(11,`
            `),s(12,"ul",9),t(13,`
                `),s(14,"li",10),t(15,`
                    `),p(16,"b",11),t(17,`
                `),a(),t(18,`
                `),s(19,"li"),t(20,`
                    `),s(21,"input",12),I("change",function(){P(e);let r=u();return O(r.toggleNotIncludedInScoreExercises())}),a(),t(22,`
                    `),p(23,"span",13),t(24,`
                `),a(),t(25,`
                `),s(26,"li",14),t(27,`
                    `),p(28,"b",15),t(29,`
                `),a(),t(30,`
                `),s(31,"li"),t(32,`
                    `),s(33,"label",10),t(34,`
                        `),s(35,"input",12),I("change",function(){P(e);let r=u();return O(r.toggleAllCategories())}),a(),t(36,`
                        `),p(37,"b",16),t(38,`
                    `),a(),t(39,`
                `),a(),t(40,`
                `),S(41,Pt,11,1),F(42,Ot,12,2,null,null,z),a(),t(44,`
        `),a(),t(45,`
    `),a(),t(46,`
`)}if(i&2){let e=u();o(5),J("btn-secondary",!e.numberOfAppliedFilters)("btn-success",!!e.numberOfAppliedFilters),o(2),m("icon",e.faFilter),o(2),m("translateValues",f(9,gt,e.numberOfAppliedFilters)),o(12),m("checked",e.currentlyHidingNotIncludedInScoreExercises),o(14),m("checked",e.categoryFilter.allCategoriesSelected),o(6),_(e.categoryFilter.exercisesWithoutCategoriesPresent?41:-1),o(),B(e.categoryFilter.exerciseCategories)}}function At(i,l){if(i&1&&(t(0,`
                                        `),s(1,"span"),t(2),g(3,"artemisTranslate"),a(),t(4,`
                                    `)),i&2){let e=l.model;o(2),A("",E(3,2,e.name),": ",e.value,"")}}function Dt(i,l){if(i&1&&(t(0,`
                                `),s(1,"ngx-charts-pie-chart",40),t(2,`
                                    `),S(3,At,5,4,"ng-template",null,2,G),t(5,`
                                `),a(),t(6,`
                            `)),i&2){let e=u(3);o(),m("view",ue(4,Et))("results",e.ngxDoughnutData)("scheme",e.ngxDoughnutColor)("doughnut",!0)}}function Mt(i,l){if(i&1&&(t(0,`
                                `),s(1,"div",41),t(2,`
                                    `),p(3,"div",42),t(4,`
                                    `),s(5,"h5",43),t(6),g(7,"artemisTranslate"),a(),t(8,`
                                `),a(),t(9,`
                            `)),i&2){let e=l.$implicit;o(3),be("background",e.color),o(3),U(E(7,3,e.name))}}function Rt(i,l){if(i&1&&(t(0,`
                                        `),s(1,"h5",43),t(2),g(3,"artemisTranslate"),a(),t(4,`
                                    `)),i&2){let e=u(4);o(2),A("",E(3,2,"artemisApp.courseOverview.statistics.grade"),": ",e.gradeDTO==null?null:e.gradeDTO.gradeName,"")}}function wt(i,l){if(i&1&&(t(0,`
                                        `),s(1,"h5",43),t(2),g(3,"artemisTranslate"),a(),t(4,`
                                    `)),i&2){let e=u(4);o(2),A("",E(3,2,"artemisApp.courseOverview.statistics.bonus"),": ",e.gradeDTO==null?null:e.gradeDTO.gradeName,"")}}function Lt(i,l){if(i&1&&(t(0,`
                                `),s(1,"div",44),t(2,`
                                    `),S(3,Rt,5,4)(4,wt,5,4),s(5,"h6"),t(6),g(7,"artemisTranslate"),p(8,"fa-icon",33),g(9,"artemisTranslate"),g(10,"artemisTranslate"),t(11,`
                                    `),a(),t(12,`
                                    `),s(13,"div",45),t(14,`
                                        `),s(15,"a",46),t(16,`
                                            `),p(17,"fa-icon",7),t(18,`
                                            `),p(19,"span",47),t(20,`
                                        `),a(),t(21,`
                                    `),a(),t(22,`
                                `),a(),t(23,`
                            `)),i&2){let e=u(3);o(3),_(e.isBonus?4:3),o(3),H(`
                                        `,E(7,8,"artemisApp.courseOverview.statistics.gradeInfo"),`
                                        `),o(2),R("ngbTooltip",e.isBonus?E(9,10,"artemisApp.courseOverview.statistics.bonusHelp"):E(10,12,"artemisApp.courseOverview.statistics.gradeHelp")),m("icon",e.faQuestionCircle),o(7),m("routerLink",ue(14,Ct))("queryParams",f(15,vt,e.gradeDTO==null?null:e.gradeDTO.gradeName)),o(2),m("icon",e.faClipboard),o(2),R("jhiTranslate",e.isBonus?"artemisApp.exam.examSummary.gradeKeyButtonBonus":"artemisApp.exam.examSummary.gradeKeyButton")}}function Nt(i,l){if(i&1&&(t(0,`
                                `),s(1,"div"),t(2,`
                                    `),p(3,"h5",48),t(4,`
                                    `),p(5,"h5",49),t(6,`
                                `),a(),t(7,`
                            `)),i&2){let e=u(3);o(3),m("translateValues",f(2,k,e.overallPresentationScore)),o(2),m("translateValues",f(4,k,e.course==null?null:e.course.presentationScore))}}function Ft(i,l){if(i&1&&(t(0,`
                                `),s(1,"div"),t(2,`
                                    `),p(3,"h5",50),t(4,`
                                    `),p(5,"h5",51),t(6,`
                                    `),s(7,"h6"),t(8),g(9,"artemisTranslate"),p(10,"fa-icon",33),g(11,"artemisTranslate"),t(12,`
                                    `),a(),t(13,`
                                `),a(),t(14,`
                            `)),i&2){let e=u(3);o(3),m("translateValues",f(9,k,e.overallPresentationScore)),o(2),m("translateValues",f(11,k,e.reachablePresentationPoints)),o(3),H(`
                                        `,E(9,5,"artemisApp.courseOverview.statistics.gradeInfo"),`
                                        `),o(2),R("ngbTooltip",E(11,7,"artemisApp.courseOverview.statistics.presentationHelp")),m("icon",e.faQuestionCircle)}}function Bt(i,l){if(i&1&&(t(0,`
                                                        `),p(1,"span",57),t(2,`
                                                    `)),i&2){let e=u(2).model,n=u(5);o(),m("translateValues",y(1,st,e.absoluteValue,n.roundScoreSpecifiedByCourseSettings(e.value,n.course)))}}function Ut(i,l){if(i&1&&(t(0,`
                                                        `),p(1,"span",58),t(2,`
                                                    `)),i&2){let e=u(2).model,n=u(5);o(),m("translateValues",y(1,at,e.absoluteValue,n.roundScoreSpecifiedByCourseSettings(e.value,n.course)))}}function Gt(i,l){i&1&&(t(0,`
                                                        `),s(1,"span"),t(2,`
                                                            `),s(3,"span"),t(4),g(5,"artemisTranslate"),a(),t(6,`
                                                        `),a(),t(7,`
                                                    `)),i&2&&(o(4),H("| ",E(5,1,"artemisApp.courseOverview.statistics.bonusPointTooltip"),""))}function Vt(i,l){i&1&&(t(0,`
                                                        `),s(1,"span"),t(2,`
                                                            `),s(3,"span"),t(4),g(5,"artemisTranslate"),a(),t(6,`
                                                        `),a(),t(7,`
                                                    `)),i&2&&(o(4),H("| ",E(5,1,"artemisApp.courseOverview.statistics.notIncludedTooltip"),""))}function jt(i,l){if(i&1&&(t(0,`
                                                `),s(1,"div"),t(2,`
                                                    `),S(3,Bt,3,4)(4,Ut,3,4)(5,Gt,8,3)(6,Vt,8,3),a(),t(7,`
                                            `)),i&2){let e=u().model,n=u(5);o(3),_(e.isProgrammingExercise?-1:3),o(),_(e.isProgrammingExercise?4:-1),o(),_(e.name===n.barChartTitle.BONUS?5:-1),o(),_(e.name===n.barChartTitle.NOT_INCLUDED?6:-1)}}function kt(i,l){if(i&1&&(t(0,`
                                                                `),p(1,"span",59),t(2,`
                                                            `)),i&2){let e=u(2).model,n=u(5);o(),m("translateValues",y(1,st,e.absoluteValue,n.roundScoreSpecifiedByCourseSettings(e.value,n.course)))}}function Ht(i,l){if(i&1&&(t(0,`
                                                                `),p(1,"span",60),t(2,`
                                                            `)),i&2){let e=u(2).model;o(),m("translateValues",f(1,ge,e.exerciseTitle))}}function Xt(i,l){if(i&1&&(t(0,`
                                                                `),p(1,"span",61),t(2,`
                                                            `)),i&2){let e=u(2).model;o(),m("translateValues",f(1,ge,e.exerciseTitle))}}function zt(i,l){if(i&1&&(t(0,`
                                                                `),p(1,"span",62),t(2,`
                                                            `)),i&2){let e=u(2).model,n=u(5);o(),m("translateValues",y(1,at,e.absoluteValue,n.roundScoreSpecifiedByCourseSettings(e.value,n.course)))}}function Qt(i,l){if(i&1&&(t(0,`
                                                        `),s(1,"div"),t(2,`
                                                            `),S(3,kt,3,4)(4,Ht,3,3)(5,Xt,3,3)(6,zt,3,4),a(),t(7,`
                                                    `)),i&2){let e=u().model;o(3),_(!e.afterDueDate&&!e.notParticipated&&!e.isProgrammingExercise?3:-1),o(),_(e.notParticipated?4:-1),o(),_(e.afterDueDate?5:-1),o(),_(e.isProgrammingExercise&&!e.notParticipated?6:-1)}}function Zt(i,l){if(i&1&&(t(0,`
                                                        `),s(1,"div"),t(2,`
                                                            `),p(3,"span",63),t(4,`
                                                        `),a(),t(5,`
                                                    `)),i&2){let e=u().model;o(3),m("translateValues",f(1,ge,e.exerciseTitle))}}function $t(i,l){if(i&1&&(t(0,`
                                            `),S(1,jt,8,4),s(2,"div"),t(3,`
                                                `),S(4,Qt,8,4)(5,Zt,6,3),t(6,`
                                            `),a(),t(7,`
                                        `)),i&2){let e,n=l.model,r=u(5);o(),_(Me(2,yt,r.barChartTitle.INCLUDED,r.barChartTitle.BONUS,r.barChartTitle.NOT_INCLUDED,r.barChartTitle.NO_DUE_DATE).includes(n.name)?1:-1),o(3),_((e=n.name)===r.barChartTitle.MISSED?4:e===r.barChartTitle.NOT_GRADED?5:-1)}}function qt(i,l){if(i&1&&(t(0,`
                                            `),p(1,"h5",68),t(2,`
                                        `)),i&2){let e=u(3).$implicit;o(),m("translateValues",f(1,k,e.value[0].presentationScore))}}function Wt(i,l){if(i&1&&(t(0,`
                                    `),s(1,"div",64),t(2,`
                                        `),p(3,"h5",65),t(4,`
                                        `),s(5,"h5",66),t(6,`
                                            `),p(7,"span",32),t(8,`
                                            `),p(9,"fa-icon",33),g(10,"artemisTranslate"),t(11,`
                                        `),a(),t(12,`
                                        `),s(13,"h5",67),t(14,`
                                            `),p(15,"span",35),t(16,`
                                            `),p(17,"fa-icon",36),g(18,"artemisTranslate"),t(19,`
                                        `),a(),t(20,`
                                        `),S(21,qt,3,3),a(),t(22,`
                                `)),i&2){let e=u(2).$implicit,n=u(3);o(3),m("translateValues",f(12,k,e.value[0].absoluteScore)),o(4),m("translateValues",y(14,de,e.value[0].reachablePoints,e.value[0].currentRelativeScore)),o(2),R("ngbTooltip",E(10,8,"artemisApp.courseOverview.statistics.reachableHelpExerciseGroup")),m("icon",n.faQuestionCircle),o(6),m("translateValues",y(17,de,e.value[0].overallMaxPoints,e.value[0].relativeScore)),o(2),R("ngbTooltip",E(18,10,"artemisApp.courseOverview.statistics.totalHelpExerciseGroup")),m("icon",n.faQuestionCircle),o(4),_(e.value[0].presentationScoreEnabled&&(n.course!=null&&n.course.presentationScore)?21:-1)}}function Yt(i,l){if(i&1){let e=M();t(0,`
                            `),s(1,"div",52),t(2,`
                                `),s(3,"div",53),t(4,`
                                    `),p(5,"h4",54),t(6,`
                                `),a(),t(7,`
                                `),s(8,"div",55,3),t(10,`
                                    `),s(11,"ngx-charts-bar-horizontal-stacked",56),I("select",function(r){P(e);let d=u(4);return O(d.onSelect(r))}),t(12,`
                                        `),t(13,`
                                        `),S(14,$t,8,7,"ng-template",null,2,G),t(16,`
                                    `),a(),t(17,`
                                `),a(),t(18,`
                                `),S(19,Wt,23,20),a(),t(20,`
                        `)}if(i&2){let e=ee(9),n=u().$implicit,r=u(3);o(),Oe("id","",n.value[0]==null?null:n.value[0].type,"-wrapper"),o(4),m("translateValues",y(12,ft,n.value.length,n.key)),o(6),m("view",y(15,Tt,e.offsetWidth,n.value[0].height))("scheme",r.ngxBarColor)("results",n.value)("xAxis",!0)("yAxis",!0)("xScaleMax",n.value[0].xScaleMax)("barPadding",r.BAR_PADDING)("maxXAxisTickLength",15),o(8),_(n.value&&n.value.length?19:-1)}}function Kt(i,l){if(i&1&&(t(0,`
                        `),S(1,Yt,21,18)),i&2){let e=l.$implicit;o(),_(e.value[0]?1:-1)}}function Jt(i,l){if(i&1&&(t(0,`
            `),s(1,"div",19),t(2,`
                `),s(3,"div",20),t(4,`
                    `),s(5,"div",21),t(6,`
                        `),p(7,"h2",22),t(8,`
                        `),p(9,"jhi-documentation-button",23),t(10,`
                    `),a(),t(11,`
                    `),s(12,"div",24),t(13,`
                        `),s(14,"div",25,1),t(16,`
                            `),s(17,"div",26),t(18,`
                                `),s(19,"h2",27),t(20),a(),t(21,`
                                `),s(22,"h4",27),t(23),a(),t(24,`
                            `),a(),t(25,`

                            `),S(26,Dt,7,5),a(),t(27,`
                        `),s(28,"div",28),t(29,`
                            `),F(30,Mt,10,5,null,null,bt,!0),a(),t(32,`
                        `),s(33,"div",29),t(34,`
                            `),p(35,"h5",30),t(36,`
                            `),s(37,"h5",31),t(38,`
                                `),p(39,"span",32),t(40,`
                                `),p(41,"fa-icon",33),g(42,"artemisTranslate"),t(43,`
                            `),a(),t(44,`
                            `),s(45,"h5",34),t(46,`
                                `),p(47,"span",35),t(48,`
                                `),p(49,"fa-icon",36),g(50,"artemisTranslate"),t(51,`
                            `),a(),t(52,`
                            `),S(53,Lt,24,17)(54,Nt,8,6)(55,Ft,15,13),a(),t(56,`
                    `),a(),t(57,`
                    `),p(58,"hr"),t(59,`
                `),a(),t(60,`
                `),p(61,"jhi-exercise-scores-chart",37),t(62,`
                `),p(63,"hr"),t(64,`
                `),s(65,"div",38),t(66,`
                    `),p(67,"h2",39),t(68,`
                    `),F(69,Kt,2,1,null,null,Pe),g(71,"keyvalue"),a(),t(72,`
            `),a(),t(73,`
        `)),i&2){let e=u(2);o(9),m("type",e.documentationType),o(11),H("",e.currentRelativeScore," %"),o(3),A("",e.overallPoints," / ",e.reachablePoints," Pts"),o(3),_(e.ngxDoughnutData&&e.ngxDoughnutColor?26:-1),o(4),B(e.ngxDoughnutData),o(5),m("translateValues",f(22,k,e.overallPoints)),o(4),m("translateValues",y(24,de,e.reachablePoints,e.currentRelativeScore)),o(2),R("ngbTooltip",E(42,16,"artemisApp.courseOverview.statistics.reachableHelp")),m("icon",e.faQuestionCircle),o(6),m("translateValues",y(27,de,e.overallMaxPoints,e.totalRelativeScore)),o(2),R("ngbTooltip",E(50,18,"artemisApp.courseOverview.statistics.totalHelp")),m("icon",e.faQuestionCircle),o(4),_(e.gradingScaleExists?53:-1),o(),_(e.course!=null&&e.course.presentationScore?54:-1),o(),_(e.reachablePresentationPoints?55:-1),o(6),m("filteredExerciseIDs",e.filteredExerciseIDs),o(8),B(E(71,20,e.ngxExerciseGroups))}}function ei(i,l){i&1&&(t(0,`
            `),s(1,"div",19),t(2,`
                `),p(3,"div",69),t(4,`
            `),a(),t(5,`
        `))}function ti(i,l){if(i&1&&(t(0,`
    `),s(1,"div"),t(2,`
        `),S(3,Jt,74,30)(4,ei,6,0),a(),t(5,`
`)),i&2){let e=u();o(3),_(e.course.exercises&&e.course.exercises.length>0?3:4)}}var tt="#17a2b8",it="#fd7e14",nt="#6610f2",rt="#B00B6B",ot="#2D9C88",L=class{name;value=0;absoluteValue=0;afterDueDate=!1;notParticipated=!1;exerciseTitle="";exerciseId=0;isProgrammingExercise=!1;constructor(l){this.name=l}},Se=class{name;series;presentationScoreEnabled=!1;type;absoluteScore=0;relativeScore=0;reachablePoints=0;currentRelativeScore=0;overallMaxPoints=0;presentationScore=0;xScaleMax=0;height=0;constructor(l,e,n){this.name=l,this.series=e,this.type=n}},j=class{name;color;constructor(l,e){this.name=l,this.color=e}},w=function(i){return i.NO_DUE_DATE="No due date",i.INCLUDED="Achieved (included)",i.NOT_INCLUDED="Achieved (not included)",i.BONUS="Achieved bonus",i.NOT_GRADED="Not graded",i.MISSED="Missed points",i}(w||{}),an=(()=>{class i{controlsRendered=new ye;courseStorageService=C(je);scoresStorageService=C(Ve);translateService=C(oe);route=C(te);gradingSystemService=C(We);navigationUtilService=C(pe);categoryFilter=C(Ye);documentationType="Statistics";courseId;courseExercises;paramSubscription;courseUpdatesSubscription;translateSubscription;course;numberOfAppliedFilters;courseExercisesNotIncludedInScore;courseExercisesFilteredByCategories;currentlyHidingNotIncludedInScoreExercises;filteredExerciseIDs;faFilter=se;overallPoints=0;overallPointsPerExercise=new Map;totalRelativeScore=0;relativeScoresPerExercise=new Map;overallMaxPoints=0;overallMaxPointsPerExercise=new Map;reachablePoints=0;reachablePointsPerExercise=new Map;currentRelativeScore=0;currentRelativeScoresPerExercise=new Map;overallPresentationScore=0;presentationScoresPerExercise=new Map;reachablePresentationPoints=0;doughnutChartColors=[it,tt,nt,rt,ot,T.LIGHT_BLUE,T.RED];exerciseTitles=new Map;ngxDoughnutData=[];programmingPointLabel="programmingPointLabel";quizPointLabel="quizPointLabel";modelingPointLabel="modelingPointLabel";textPointLabel="textPointLabel";fileUploadPointLabel="fileUploadPointLabel";presentationPointsLabel="presentationPointsLabel";missingPointsLabel="missingPointsLabel";labels=[this.programmingPointLabel,this.quizPointLabel,this.modelingPointLabel,this.textPointLabel,this.fileUploadPointLabel,this.presentationPointsLabel,this.missingPointsLabel];ngxDoughnutColor={name:"Your overall points color",selectable:!0,group:q.Ordinal,domain:[]};presentationScoreEnabled=new Map;ngxBarColor={name:"Score per exercise group",selectable:!0,group:q.Ordinal,domain:[T.LIGHT_GREY,T.GREEN,T.LIGHT_GREY,T.YELLOW,T.BLUE,T.RED]};roundScoreSpecifiedByCourseSettings=X;barChartTitle=w;CHART_HEIGHT=25;BAR_PADDING=4;DEFAULT_SIZE=50;ngxExerciseGroups=new Map;gradingScaleExists=!1;isBonus=!1;gradeDTO;faQuestionCircle=Be;faClipboard=Fe;controls;controlConfiguration={subject:new Ee};ngOnInit(){this.paramSubscription=this.route.parent?.parent?.params.subscribe(e=>{this.courseId=parseInt(e.courseId,10)}),this.course=this.courseStorageService.getCourse(this.courseId),this.onCourseLoad(),this.courseUpdatesSubscription=this.courseStorageService.subscribeToCourseUpdates(this.courseId).subscribe(e=>{this.course=e,this.onCourseLoad()}),this.updateExerciseTitles(),this.translateSubscription=this.translateService.onLangChange.subscribe(()=>{this.updateExerciseTitles(),this.groupExercisesByType(this.courseExercises)}),this.calculateCourseGrade()}updateExerciseTitles(){this.exerciseTitles.set(c.QUIZ,new j(this.translateService.instant("artemisApp.course.quizExercises"),tt)),this.exerciseTitles.set(c.MODELING,new j(this.translateService.instant("artemisApp.course.modelingExercises"),nt)),this.exerciseTitles.set(c.PROGRAMMING,new j(this.translateService.instant("artemisApp.course.programmingExercises"),it)),this.exerciseTitles.set(c.TEXT,new j(this.translateService.instant("artemisApp.course.textExercises"),rt)),this.exerciseTitles.set(c.FILE_UPLOAD,new j(this.translateService.instant("artemisApp.course.fileUploadExercises"),ot))}ngAfterViewInit(){this.controls&&(this.controlConfiguration.subject.next(this.controls),this.controlsRendered.emit())}ngOnDestroy(){this.translateSubscription?.unsubscribe(),this.courseUpdatesSubscription?.unsubscribe(),this.paramSubscription?.unsubscribe()}calculateCourseGrade(){this.gradingSystemService.matchPercentageToGradeStep(this.totalRelativeScore,this.courseId).subscribe(e=>{e&&(this.gradingScaleExists=!0,this.gradeDTO=e,this.isBonus=e.gradeType===qe.BONUS)})}onCourseLoad(){this.course?.exercises&&(this.courseExercises=this.course.exercises,this.calculateAndFilterNotIncludedInScore(),this.calculateMaxPoints(),this.calculateReachablePoints(),this.calculateReachablePresentationPoints(),this.calculateAbsoluteScores(),this.calculateRelativeScores(),this.calculatePresentationScores(),this.calculateCurrentRelativeScores(),this.groupExercisesByType(this.courseExercises))}groupExercisesByType(e){this.ngxExerciseGroups=new Map,Object.values(c).forEach(n=>{this.ngxExerciseGroups.set(n,[]),this.presentationScoreEnabled.set(n,!1)}),e=$(e,[n=>(n.dueDate||Q().add(5,"year")).valueOf()]),e.forEach(n=>{if(!n.dueDate||n.dueDate.isBefore(Q())||n.type===c.PROGRAMMING){let r=i.generateDefaultSeries();!n.studentParticipations||n.studentParticipations.length===0?(r[5].value=100,r[5].afterDueDate=!1,r[5].notParticipated=!0,r[5].exerciseTitle=n.title,r[5].exerciseId=n.id,this.pushToData(n,r)):n.studentParticipations.forEach(d=>{if(d.id&&d.results?.length){let h=this.scoresStorageService.getStoredParticipationResult(d.id);if(h?.rated){let b=X(h.score,this.course),N=Math.min(b,100),v=X(h.score*n.maxPoints/100,this.course),D=X(100-N,this.course),W=X(Math.max(n.maxPoints-v,0),this.course);r[5].value=D,r[5].absoluteValue=W,r[5].afterDueDate=!1,r[5].notParticipated=!1,r[5].exerciseId=n.id,this.identifyBar(n,r,b,v),this.pushToData(n,r)}}else d.initializationState===he.FINISHED&&(!n.dueDate||d.initializationDate?.isBefore(n.dueDate))?(r[4].value=100,r[4].exerciseTitle=n.title,r[4].exerciseId=n.id,this.pushToData(n,r)):(r[5].value=100,d.initializationState===he.INITIALIZED?(r[5].afterDueDate=!1,r[5].notParticipated=!0):r[5].afterDueDate=!0,r[5].exerciseTitle=n.title,r[5].exerciseId=n.id,this.pushToData(n,r))})}}),this.pushExerciseGroupsToData()}toggleNotIncludedInScoreExercises(){this.currentlyHidingNotIncludedInScoreExercises?(this.courseExercises=this.courseExercises.concat(this.courseExercisesNotIncludedInScore),this.filteredExerciseIDs=[]):(this.courseExercises=this.courseExercises.filter(e=>!this.courseExercisesNotIncludedInScore.includes(e)),this.filteredExerciseIDs=this.courseExercisesNotIncludedInScore.map(e=>e.id)),this.currentlyHidingNotIncludedInScoreExercises=!this.currentlyHidingNotIncludedInScoreExercises,this.categoryFilter.setupCategoryFilter(this.courseExercises),this.groupExercisesByType(this.courseExercises)}static generateDefaultSeries(){return[new L(w.NO_DUE_DATE),new L(w.INCLUDED),new L(w.NOT_INCLUDED),new L(w.BONUS),new L(w.NOT_GRADED),new L(w.MISSED)]}calculateAbsoluteScores(){let e=this.retrieveScoreByExerciseTypeAndScoreType(c.QUIZ,x.ABSOLUTE_SCORE),n=this.retrieveScoreByExerciseTypeAndScoreType(c.PROGRAMMING,x.ABSOLUTE_SCORE),r=this.retrieveScoreByExerciseTypeAndScoreType(c.MODELING,x.ABSOLUTE_SCORE),d=this.retrieveScoreByExerciseTypeAndScoreType(c.TEXT,x.ABSOLUTE_SCORE),h=this.retrieveScoreByExerciseTypeAndScoreType(c.FILE_UPLOAD,x.ABSOLUTE_SCORE);this.overallPoints=this.retrieveTotalScoreByScoreType(x.ABSOLUTE_SCORE);let b=this.course?.presentationScore?0:this.retrieveTotalScoreByScoreType(x.PRESENTATION_SCORE),N=this.reachablePoints-this.overallPoints;N<0&&(N=0);let v=[n,e,r,d,h,b,N];this.overallPointsPerExercise.set(c.QUIZ,e),this.overallPointsPerExercise.set(c.PROGRAMMING,n),this.overallPointsPerExercise.set(c.MODELING,r),this.overallPointsPerExercise.set(c.TEXT,d),this.overallPointsPerExercise.set(c.FILE_UPLOAD,h);let D=[];v.forEach((W,xe)=>{W>0&&(D.push({name:"artemisApp.courseOverview.statistics."+this.labels[xe],value:this.roundScoreSpecifiedByCourseSettings(W,this.course),color:this.doughnutChartColors[xe]}),this.ngxDoughnutColor.domain.push(this.doughnutChartColors[xe]))}),this.ngxDoughnutData=[...D]}calculateMaxPoints(){let e=this.retrieveScoreByExerciseTypeAndScoreType(c.QUIZ,x.MAX_POINTS),n=this.retrieveScoreByExerciseTypeAndScoreType(c.PROGRAMMING,x.MAX_POINTS),r=this.retrieveScoreByExerciseTypeAndScoreType(c.MODELING,x.MAX_POINTS),d=this.retrieveScoreByExerciseTypeAndScoreType(c.TEXT,x.MAX_POINTS),h=this.retrieveScoreByExerciseTypeAndScoreType(c.FILE_UPLOAD,x.MAX_POINTS);this.overallMaxPointsPerExercise.set(c.QUIZ,e),this.overallMaxPointsPerExercise.set(c.PROGRAMMING,n),this.overallMaxPointsPerExercise.set(c.MODELING,r),this.overallMaxPointsPerExercise.set(c.TEXT,d),this.overallMaxPointsPerExercise.set(c.FILE_UPLOAD,h),this.overallMaxPoints=this.retrieveTotalScoreByScoreType(x.MAX_POINTS)}calculateRelativeScores(){let e=this.retrieveScoreByExerciseTypeAndScoreType(c.QUIZ,x.RELATIVE_SCORE),n=this.retrieveScoreByExerciseTypeAndScoreType(c.PROGRAMMING,x.RELATIVE_SCORE),r=this.retrieveScoreByExerciseTypeAndScoreType(c.MODELING,x.RELATIVE_SCORE),d=this.retrieveScoreByExerciseTypeAndScoreType(c.TEXT,x.RELATIVE_SCORE),h=this.retrieveScoreByExerciseTypeAndScoreType(c.FILE_UPLOAD,x.RELATIVE_SCORE);this.relativeScoresPerExercise.set(c.QUIZ,e),this.relativeScoresPerExercise.set(c.PROGRAMMING,n),this.relativeScoresPerExercise.set(c.MODELING,r),this.relativeScoresPerExercise.set(c.TEXT,d),this.relativeScoresPerExercise.set(c.FILE_UPLOAD,h),this.totalRelativeScore=this.retrieveTotalScoreByScoreType(x.RELATIVE_SCORE)}calculateReachablePoints(){let e=this.retrieveScoreByExerciseTypeAndScoreType(c.QUIZ,x.REACHABLE_POINTS),n=this.retrieveScoreByExerciseTypeAndScoreType(c.PROGRAMMING,x.REACHABLE_POINTS),r=this.retrieveScoreByExerciseTypeAndScoreType(c.MODELING,x.REACHABLE_POINTS),d=this.retrieveScoreByExerciseTypeAndScoreType(c.TEXT,x.REACHABLE_POINTS),h=this.retrieveScoreByExerciseTypeAndScoreType(c.FILE_UPLOAD,x.REACHABLE_POINTS);this.reachablePointsPerExercise.set(c.QUIZ,e),this.reachablePointsPerExercise.set(c.PROGRAMMING,n),this.reachablePointsPerExercise.set(c.MODELING,r),this.reachablePointsPerExercise.set(c.TEXT,d),this.reachablePointsPerExercise.set(c.FILE_UPLOAD,h),this.reachablePoints=this.retrieveTotalScoreByScoreType(x.REACHABLE_POINTS)}calculateCurrentRelativeScores(){let e=this.retrieveScoreByExerciseTypeAndScoreType(c.QUIZ,x.CURRENT_RELATIVE_SCORE),n=this.retrieveScoreByExerciseTypeAndScoreType(c.PROGRAMMING,x.CURRENT_RELATIVE_SCORE),r=this.retrieveScoreByExerciseTypeAndScoreType(c.MODELING,x.CURRENT_RELATIVE_SCORE),d=this.retrieveScoreByExerciseTypeAndScoreType(c.TEXT,x.CURRENT_RELATIVE_SCORE),h=this.retrieveScoreByExerciseTypeAndScoreType(c.FILE_UPLOAD,x.CURRENT_RELATIVE_SCORE);this.currentRelativeScoresPerExercise.set(c.QUIZ,e),this.currentRelativeScoresPerExercise.set(c.PROGRAMMING,n),this.currentRelativeScoresPerExercise.set(c.MODELING,r),this.currentRelativeScoresPerExercise.set(c.TEXT,d),this.currentRelativeScoresPerExercise.set(c.FILE_UPLOAD,h),this.currentRelativeScore=this.retrieveTotalScoreByScoreType(x.CURRENT_RELATIVE_SCORE)}calculatePresentationScores(){let e=this.retrieveScoreByExerciseTypeAndScoreType(c.PROGRAMMING,x.PRESENTATION_SCORE),n=this.retrieveScoreByExerciseTypeAndScoreType(c.MODELING,x.PRESENTATION_SCORE),r=this.retrieveScoreByExerciseTypeAndScoreType(c.TEXT,x.PRESENTATION_SCORE),d=this.retrieveScoreByExerciseTypeAndScoreType(c.FILE_UPLOAD,x.PRESENTATION_SCORE);this.presentationScoresPerExercise.set(c.QUIZ,0),this.presentationScoresPerExercise.set(c.PROGRAMMING,e),this.presentationScoresPerExercise.set(c.MODELING,n),this.presentationScoresPerExercise.set(c.TEXT,r),this.presentationScoresPerExercise.set(c.FILE_UPLOAD,d),this.overallPresentationScore=this.retrieveTotalScoreByScoreType(x.PRESENTATION_SCORE)}calculateReachablePresentationPoints(){this.reachablePresentationPoints=this.retrieveTotalScoreByScoreType(x.REACHABLE_PRESENTATION_POINTS)}retrieveScoreByExerciseTypeAndScoreType(e,n){let r=this.scoresStorageService.getStoredScoresPerExerciseType(this.courseId),d=r?r.get(e):void 0;return this.getScoreByScoreType(d,n)}retrieveTotalScoreByScoreType(e){let n=this.scoresStorageService.getStoredTotalScores(this.courseId);return this.getScoreByScoreType(n,e)}getScoreByScoreType(e,n){if(!e)return NaN;switch(n){case x.MAX_POINTS:return e.maxPoints;case x.REACHABLE_POINTS:return e.reachablePoints;case x.ABSOLUTE_SCORE:return e.studentScores.absoluteScore;case x.RELATIVE_SCORE:return e.studentScores.relativeScore;case x.CURRENT_RELATIVE_SCORE:return e.studentScores.currentRelativeScore;case x.PRESENTATION_SCORE:return e.studentScores.presentationScore;case x.REACHABLE_PRESENTATION_POINTS:return e.reachablePresentationPoints}}calculateAndFilterNotIncludedInScore(){this.currentlyHidingNotIncludedInScoreExercises=!0,this.courseExercisesNotIncludedInScore=this.courseExercises.filter(e=>e.includedInOverallScore===Z.NOT_INCLUDED),this.courseExercises=this.courseExercises.filter(e=>!this.courseExercisesNotIncludedInScore.includes(e)),this.courseExercisesFilteredByCategories=this.courseExercises,this.filteredExerciseIDs=this.courseExercisesNotIncludedInScore.map(e=>e.id),this.categoryFilter.setupCategoryFilter(this.courseExercises),this.calculateNumberOfAppliedFilters()}pushToData(e,n){let r=e.type,d=new Se(e.title,n,r);this.ngxExerciseGroups.get(r).push(d),this.presentationScoreEnabled.set(r,(this.presentationScoreEnabled.get(r)??!1)||(e.presentationScoreEnabled??!1)),r==c.PROGRAMMING&&n.forEach(h=>{h.isProgrammingExercise=!0})}pushExerciseGroupsToData(){Object.values(c).forEach(e=>{let n=this.ngxExerciseGroups.get(e);if(n.length>0){let r=n[0];r.absoluteScore=this.overallPointsPerExercise.get(e),r.relativeScore=this.relativeScoresPerExercise.get(e),r.reachablePoints=this.reachablePointsPerExercise.get(e),r.currentRelativeScore=this.currentRelativeScoresPerExercise.get(e),r.overallMaxPoints=this.overallMaxPointsPerExercise.get(e),r.presentationScore=this.presentationScoresPerExercise.get(e),r.presentationScoreEnabled=this.presentationScoreEnabled.get(e),r.xScaleMax=this.setXScaleMax(n),r.height=this.calculateChartHeight(n.length)}else this.ngxExerciseGroups.delete(e)})}identifyBar(e,n,r,d){let h=0;e.dueDate&&(h=[Z.INCLUDED_COMPLETELY,Z.NOT_INCLUDED,Z.INCLUDED_AS_BONUS].indexOf(e.includedInOverallScore)+1),n[h].value=r,n[h].absoluteValue=d,n[h].exerciseId=e.id}setXScaleMax(e){let n=100;return e.forEach(r=>{let d=Math.max(r.series[0].value,r.series[1].value,r.series[2].value,r.series[3].value);n=n>d?n:Math.ceil(d)}),n}onSelect(e){this.navigationUtilService.routeInNewTab(["courses",this.course.id,"exercises",e.exerciseId])}toggleCategory(e){let n=this.categoryFilter.getCurrentFilterState(e);this.courseExercisesFilteredByCategories=this.categoryFilter.toggleCategory(this.courseExercises,e),this.setupFilteredChart(!n)}toggleAllCategories(){this.courseExercisesFilteredByCategories=this.categoryFilter.toggleAllCategories(this.courseExercises),this.setupFilteredChart(this.categoryFilter.allCategoriesSelected)}toggleExercisesWithNoCategory(){this.courseExercisesFilteredByCategories=this.categoryFilter.toggleExercisesWithNoCategory(this.courseExercises),this.setupFilteredChart(this.categoryFilter.includeExercisesWithNoCategory)}filterExerciseIDsForCategorySelection(e){if(e)this.filteredExerciseIDs=this.filteredExerciseIDs.filter(n=>!this.courseExercisesFilteredByCategories.find(r=>r.id===n));else{let n=this.courseExercises.filter(r=>!this.courseExercisesFilteredByCategories.includes(r)).map(r=>r.id).filter(r=>!this.filteredExerciseIDs.includes(r));this.filteredExerciseIDs=this.filteredExerciseIDs.concat(n)}}calculateNumberOfAppliedFilters(){this.numberOfAppliedFilters=this.categoryFilter.numberOfActiveFilters+(this.currentlyHidingNotIncludedInScoreExercises?1:0)}calculateChartHeight(e){return e*this.CHART_HEIGHT+this.BAR_PADDING*(e-1)+this.DEFAULT_SIZE}setupFilteredChart(e){this.calculateNumberOfAppliedFilters(),this.groupExercisesByType(this.courseExercisesFilteredByCategories),this.filterExerciseIDsForCategorySelection(e)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=K({type:i,selectors:[["jhi-course-statistics"]],viewQuery:function(n,r){if(n&1&&Ie(St,5),n&2){let d;Ae(d=De())&&(r.controls=d.first)}},decls:4,vars:1,consts:[["controls",""],["doughnutref",""],["tooltipTemplate",""],["containerRef",""],[1,"d-flex","row","course-overview-controls","text-end"],["aria-label","Filter Dropdown","ngbDropdown","",1,"col"],["ngbDropdownToggle","","id","filter-dropdown-button",1,"btn"],[3,"icon"],["jhiTranslate","artemisApp.courseOverview.exerciseList.filter",3,"translateValues"],["ngbDropdownMenu","","aria-labelledby","filter-dropdown-button",1,"checkbox-menu","text-nowrap","pe-2"],[1,"mb-1"],["jhiTranslate","artemisApp.courseOverview.statistics.includeStandardCategories",1,"ms-2"],["type","checkbox",1,"ms-2","form-check-input",3,"change","checked"],["jhiTranslate","artemisApp.courseOverview.statistics.hideNotIncludedInScoreExercises",1,"ms-2"],[1,"mt-1","mb-1"],["jhiTranslate","artemisApp.courseOverview.statistics.includeIndividualCategories",1,"ms-2"],["jhiTranslate","artemisApp.courseOverview.statistics.includeAllCategories",1,"ms-2"],["jhiTranslate","artemisApp.courseOverview.statistics.exercisesWithNoCategories",1,"ms-2"],[1,"ms-2"],[1,"row"],[1,"statistic-summary"],[1,"d-flex","align-items-center"],["jhiTranslate","artemisApp.courseOverview.statistics.totalScore"],[3,"type"],[1,"row","d-flex","justify-content-center","align-items-start"],[1,"chart-container","col-md-6"],[1,"chart-text"],[1,"text-center"],[1,"col-md-3","d-flex","flex-column","align-self-end","color-legend-container"],[1,"col-md-3"],["id","absolute-course-score","jhiTranslate","artemisApp.courseOverview.statistics.yourPoints",1,"fw-bolder",3,"translateValues"],["id","reachable-course-score",1,"fw-bolder"],["jhiTranslate","artemisApp.courseOverview.statistics.reachablePoints",3,"translateValues"],["id","reachable-help",1,"me-1",3,"icon","ngbTooltip"],["id","max-course-score",1,"mb-4","statistics-legend"],["jhiTranslate","artemisApp.courseOverview.statistics.totalPoints",3,"translateValues"],["id","total-help",1,"me-1",3,"icon","ngbTooltip"],[1,"col-12",3,"filteredExerciseIDs"],[1,"col-12","mb-3"],["jhiTranslate","artemisApp.courseOverview.statistics.pointsPerExercise"],[3,"view","results","scheme","doughnut"],[1,"color-legend-entry"],[1,"color-indicator"],[1,"fw-bolder"],[1,"mb-5"],[1,"mt-3"],[1,"btn","btn-primary",3,"routerLink","queryParams"],[3,"jhiTranslate"],["jhiTranslate","artemisApp.courseOverview.statistics.totalPresentationScore",1,"fw-bolder",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.presentationScoreBonus",1,"fw-bolder",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.totalPresentationPoints",1,"fw-bolder",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.achievablePresentationPoints",1,"fw-bolder",3,"translateValues"],[1,"row","mt-3","d-flex","justify-content-end",3,"id"],[1,"col-12","mb-1","d-flex","align-items-center"],["jhiTranslate","artemisApp.courseOverview.statistics.exerciseCount",3,"translateValues"],[1,"col-12","col-md-8"],[3,"select","view","scheme","results","xAxis","yAxis","xScaleMax","barPadding","maxXAxisTickLength"],["jhiTranslate","artemisApp.courseOverview.statistics.exerciseAchievedScore",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.programmingExercisePassedTests",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.exerciseMissedScore",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.exerciseNotParticipated",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.exerciseParticipatedAfterDueDate",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.programmingExerciseFailedTests",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.exerciseNotGraded",3,"translateValues"],[1,"col-12","col-md-3","align-self-top","mt-2"],["id","absolute-score","jhiTranslate","artemisApp.courseOverview.statistics.yourPoints",1,"fw-bolder",3,"translateValues"],["id","reachable-score",1,"fw-bolder"],["id","max-score",1,"fw-bolder"],["id","presentation-score","jhiTranslate","artemisApp.courseOverview.statistics.presentationScore",1,"fw-bolder",3,"translateValues"],["jhiTranslate","artemisApp.courseOverview.statistics.noStatistics",1,"col","mt-3"]],template:function(n,r){n&1&&(S(0,It,47,11,"ng-template",null,0,G),t(2,`
`),S(3,ti,6,1)),n&2&&(o(3),_(r.course?3:-1))},dependencies:[re,ne,ce,le,ie,ke,$e,Ze,Ne,Le,et,Xe,He,Re,ae],styles:[".course-body-container[_ngcontent-%COMP%]{position:relative}.refresh-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;justify-content:center;align-items:flex-start;opacity:0;pointer-events:none;transition:.1s ease-out opacity}.refresh-overlay.active[_ngcontent-%COMP%]{background-color:var(--overview-refresh-overlay-bg-color);opacity:1;pointer-events:auto;transition:.2s ease-in opacity}.refresh-overlay[_ngcontent-%COMP%]   .ng-fa-icon[_ngcontent-%COMP%]{position:relative;top:calc(47.5vh - 150px);transform:translateY(-50%);color:var(--overview-refresh-overlay-color)}.back-button[_ngcontent-%COMP%]{cursor:pointer}.current-week-row[_ngcontent-%COMP%]    >div{background-color:var(--overview-light-primary-background-color)}.statistic-summary[_ngcontent-%COMP%]{margin-top:25px}.statistic-summary[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:flex-end;margin-bottom:20px}.statistic-summary[_ngcontent-%COMP%]   .chart-container[_ngcontent-%COMP%]   .chart-text[_ngcontent-%COMP%]{position:absolute;width:350px}.statistic-summary[_ngcontent-%COMP%]   .color-legend-container[_ngcontent-%COMP%]{margin-bottom:40px}.statistic-summary[_ngcontent-%COMP%]   .color-legend-container[_ngcontent-%COMP%]   .color-legend-entry[_ngcontent-%COMP%]{display:inline-flex;align-items:center;width:100%}.exercise-row-container[_ngcontent-%COMP%]   .control-label[_ngcontent-%COMP%]{cursor:pointer}.exercise-row-container[_ngcontent-%COMP%]   .collapsed[_ngcontent-%COMP%]{margin-top:1rem;border-bottom:1px solid var(--overview-light-border-color)}.icon-container[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;horiz-align:center}.course-information[_ngcontent-%COMP%]{padding-top:29px}.course-information[_ngcontent-%COMP%]   .exercise-panel[_ngcontent-%COMP%]   .row.has-exercises[_ngcontent-%COMP%]{cursor:pointer;border-radius:3px}.course-information[_ngcontent-%COMP%]   .exercise-panel[_ngcontent-%COMP%]   .row.has-exercises[_ngcontent-%COMP%]:hover{background-color:var(--overview-light-background-color)}.course-information[_ngcontent-%COMP%]   .exercise-panel[_ngcontent-%COMP%]   .row.has-exercises[_ngcontent-%COMP%]:hover   .icon[_ngcontent-%COMP%]{color:var(--primary)}.exercise-divider[_ngcontent-%COMP%]{height:0;width:100%;margin:1rem 0 .5rem;border-top:1px solid var(--overview-light-border-color)}.color-indicator[_ngcontent-%COMP%]{height:20px;width:20px;background-color:#0f6ab4;position:relative;top:-4px;margin-right:5px;border-radius:3px}canvas#complete-chart[_ngcontent-%COMP%]{z-index:99}.dev-button[_ngcontent-%COMP%]{text-align:left;color:#fff;background-color:#3e8acc;border:none;border-radius:1px}.dev-button[_ngcontent-%COMP%]:hover{background-color:#0f6ab4}.dev-button[_ngcontent-%COMP%]:active{box-shadow:0 2px 0 var(--artemis-dark)}.dev-button[_ngcontent-%COMP%]:disabled{background-color:gray}.btn-primary[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:disabled, .btn-info[_ngcontent-%COMP%], .btn-info[_ngcontent-%COMP%]:hover, .btn-success[_ngcontent-%COMP%], .btn-success[_ngcontent-%COMP%]:hover{color:#fff}@media (max-width: 768px){.col-12[_ngcontent-%COMP%]{width:100%!important}}.fadeInIcon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s;animation-iteration-count:initial}@media (max-width: 655px){.horizontal-scroll[_ngcontent-%COMP%]{overflow-x:auto}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}50%{opacity:.5}to{visibility:visible;opacity:1}}.exercise-content-sidebar-width[_ngcontent-%COMP%]{width:calc(100% - 263px)!important;transition:width .1s 0s ease-in-out}.exercise-content-width[_ngcontent-%COMP%]{width:100%;transition:width .1s 0s ease-in-out}"]})}return i})();export{an as CourseStatisticsComponent,j as ExerciseTitle,Se as NgxExercise,L as Series};
//# sourceMappingURL=course-statistics.component-BPVT45LE.js.map
