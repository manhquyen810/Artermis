import{Tb as h,Va as r,Yc as c,Zc as d,_c as C,f as l,zc as o}from"./chunk-5LC5EQRR.js";var u=["starMain"],v=(()=>{class a{stars=[];_checkedColor;_unCheckedColor;_value;_size;_readOnly=!1;_totalStars=5;onStarsCountChange;onValueChange;onCheckedColorChange;onUnCheckedColorChange;onSizeChange;onReadOnlyChange;static VAR_CHECKED_COLOR="--checkedColor";static VAR_UNCHECKED_COLOR="--unCheckedColor";static VAR_SIZE="--size";static VAR_HALF_WIDTH="--halfWidth";static CLS_CHECKED_STAR="on";static CLS_DEFAULT_STAR="star";static CLS_HALF_STAR="half";mainElement;constructor(){this.onStarsCountChange=new l,this.onStarsCountChange.subscribe(()=>{this.setStars(),this.generateRating(!0),this.applySizeAllStars(),this.applyColorStyleAllStars(!1),this.addEvents()}),this.onValueChange=new l,this.onValueChange.subscribe(()=>{this.generateRating(),this.applySizeAllStars()}),this.onCheckedColorChange=new l,this.onCheckedColorChange.subscribe(()=>{this.applyColorStyleAllStars(!0)}),this.onUnCheckedColorChange=new l,this.onUnCheckedColorChange.subscribe(()=>{this.applyColorStyleAllStars(!1)}),this.onSizeChange=new l,this.onSizeChange.subscribe(()=>{this.applySizeAllStars()}),this.onReadOnlyChange=new l,this.onReadOnlyChange.subscribe(()=>{this.readOnly?this.makeReadOnly():this.makeEditable()})}rate=new r;set checkedColor(e){this._checkedColor=e,this._checkedColor&&this.onCheckedColorChange.next(this._checkedColor)}get checkedColor(){return this._checkedColor}set uncheckedColor(e){this._unCheckedColor=e,this._unCheckedColor&&this.onUnCheckedColorChange.next(this._unCheckedColor)}get uncheckedColor(){return this._unCheckedColor}set value(e){e=e||0,this._value=e,this._value>=0&&this.onValueChange.next(this._value)}get value(){return this._value}set size(e){e=!e||e==="0px"?"24px":e,this._size=e,this.onSizeChange.next(this._size)}get size(){return this._size.concat(this._size.includes("px")?"":"px")}set readOnly(e){this._readOnly=e,this.onReadOnlyChange.next(e)}get readOnly(){return this._readOnly}set totalStars(e){this._totalStars=e<=0?5:Math.round(e),this.onStarsCountChange.next(this._totalStars)}get totalStars(){return this._totalStars}makeEditable(){this.mainElement&&(this.mainElement.nativeElement.style.cursor="pointer",this.mainElement.nativeElement.title=this.value,this.stars.forEach(e=>{e.style.cursor="pointer",e.title=e.dataset.index}))}makeReadOnly(){this.mainElement&&(this.mainElement.nativeElement.style.cursor="default",this.mainElement.nativeElement.title=this.value,this.stars.forEach(e=>{e.style.cursor="default",e.title=""}))}addEvents(){!this.mainElement||this.readOnly||(this.mainElement.nativeElement.addEventListener("mouseleave",this.offStar.bind(this)),this.mainElement.nativeElement.style.cursor="pointer",this.mainElement.nativeElement.title=this.value,this.stars.forEach(e=>{e.addEventListener("click",this.onRate.bind(this)),e.addEventListener("mouseenter",this.onStar.bind(this)),e.style.cursor="pointer",e.title=e.dataset.index}))}onRate(e){if(this.readOnly)return;let s=e.target,i=this.value;this.value=parseInt(s.dataset.index,10);let t={oldValue:i,newValue:this.value,starRating:this};this.rate.emit(t)}onStar(e){if(this.readOnly)return;let s=e.target,i=parseInt(s.dataset.index,10);for(let t=0;t<i;t++)this.stars[t].className="",a.addDefaultClass(this.stars[t]),a.addCheckedStarClass(this.stars[t]);for(let t=i;t<this.stars.length;t++)this.stars[t].className="",a.addDefaultClass(this.stars[t])}offStar(){this.generateRating()}static addDefaultClass(e){e.classList.add(a.CLS_DEFAULT_STAR)}static addCheckedStarClass(e){e.classList.add(a.CLS_CHECKED_STAR)}static addHalfStarClass(e){e.classList.add(a.CLS_HALF_STAR)}setStars(){if(!this.mainElement)return;let e=this.mainElement.nativeElement,s=[...Array(this._totalStars).keys()];this.stars.length=0,e.innerHTML="",s.forEach(i=>{let t=document.createElement("span");t.dataset.index=(i+1).toString(),t.title=t.dataset.index,e.appendChild(t),this.stars.push(t)})}applySizeAllStars(){if(this._size){this.stars.length===0&&this.setStars();let e=this.size.match(/\d+/)[0],s=Number(e)*(1-(this.value-Math.floor(this.value)));this.stars.forEach(i=>{i.style.setProperty(a.VAR_SIZE,this.size),i.classList.contains(a.CLS_HALF_STAR)&&i.style.setProperty(a.VAR_HALF_WIDTH,`${s}px`)})}}applyColorStyleAllStars(e){this.stars.length===0&&this.setStars(),this.stars.forEach(s=>{e?this.applyCheckedColorStyle(s):this.applyUnCheckedColorStyle(s)})}applyColorStyle(e){this.applyCheckedColorStyle(e),this.applyUnCheckedColorStyle(e)}applyCheckedColorStyle(e){e.style.setProperty(a.VAR_CHECKED_COLOR,this._checkedColor)}applyUnCheckedColorStyle(e){e.style.setProperty(a.VAR_UNCHECKED_COLOR,this._unCheckedColor)}generateRating(e=!1){if(!this.mainElement||this.readOnly&&!e)return;this.stars.length===0&&this.setStars(),this.mainElement.nativeElement.title=this.value;let s=this.value%1!==0,i=Math.floor(this.value);this.stars.forEach((t,n)=>{t.className="",this.applyColorStyle(t),a.addDefaultClass(t),n<i?a.addCheckedStarClass(t):n===i&&s&&s&&(a.addHalfStarClass(t),s=!1)})}static \u0275fac=function(s){return new(s||a)};static \u0275cmp=h({type:a,selectors:[["star-rating"]],viewQuery:function(s,i){if(s&1&&c(u,7),s&2){let t;d(t=C())&&(i.mainElement=t.first)}},inputs:{checkedColor:"checkedColor",uncheckedColor:"uncheckedColor",value:"value",size:"size",readOnly:"readOnly",totalStars:"totalStars"},outputs:{rate:"rate"},decls:2,vars:0,consts:[["starMain",""]],template:function(s,i){s&1&&o(0,"div",null,0)},styles:[`@charset "UTF-8";:root{--checkedcolor: gold;--uncheckedcolor: gray;--size: 24px;--halfWidth: 12px}.star{color:var(--unCheckedColor);font-size:var(--size);width:var(--size);display:inline-block;position:relative}.star:last-child{margin-right:0}.star:before{content:"\\2605"}.star.on{color:var(--checkedColor)}.star.half:after{content:"\\2605";color:var(--checkedColor);position:absolute;left:0;top:0;bottom:0;right:var(--halfWidth);overflow:hidden}
`],encapsulation:3})}return a})();export{v as a};
//# sourceMappingURL=chunk-NPMFKF37.js.map
