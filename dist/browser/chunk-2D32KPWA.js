import{a as le}from"./chunk-7MKMUXV6.js";import{f as ee,g as h,h as te,i as ie,j as ne,m as oe,q as ce}from"./chunk-DOLVNMRR.js";import{a as $}from"./chunk-HQ6UGNQX.js";import{K as j}from"./chunk-VZRSC3LP.js";import{K as V,a as G,b as w,h as K,m as Y,w as D,x as U,z as A}from"./chunk-WA5GEAJB.js";import{q as Q}from"./chunk-VK7JPHFE.js";import{c as R}from"./chunk-BNDLMKXK.js";import{a as q}from"./chunk-K3W6YFKH.js";import{b as B,c as J,d as X}from"./chunk-EDXSOKK5.js";import{kb as z}from"./chunk-Z4VHWOB5.js";import{a as Z}from"./chunk-U54OSGNH.js";import{f as F}from"./chunk-M6Z6DKZQ.js";import{Db as c,Dc as g,Ea as _,Id as H,Ma as u,Mc as f,Na as x,Oc as l,Rc as N,Sc as E,Tb as S,Va as b,Zb as y,aa as L,dd as i,fd as T,kc as a,pd as O,sc as d,uc as k,vc as M,wc as v,xa as I,xc as r,yc as s,yd as W,zc as C,zd as P}from"./chunk-5LC5EQRR.js";function se(n,p){if(n&1&&(i(0,`
            `),r(1,"label",0),i(2),s(),i(3,`
        `)),n&2){let e=l(2);c(2),T(`
                `,e.labelName,`
            `)}}function ae(n,p){if(n&1&&(i(0,`
            `),r(1,"fa-stack",1),i(2,`
                `),C(3,"fa-icon",2),i(4,`
            `),s(),i(5,`
        `)),n&2){let e=l(2);c(),a("ngbTooltip",e.labelTooltip),c(2),a("icon",e.faQuestionCircle)}}function pe(n,p){n&1&&(i(0,`
            `),r(1,"div"),i(2,`
                `),r(3,"div",3),i(4,`
                    `),r(5,"span",4),i(6,"Loading..."),s(),i(7,`
                `),s(),i(8,`
            `),s(),i(9,`
        `))}function me(n,p){if(n&1){let e=g();i(0,`
                                `),r(1,"select",9),W(2,"artemisTranslate"),f("ngModelChange",function(o){u(e);let m=l(2).$implicit,re=l(3);return x(re.updateLinkWeight(m,o))}),i(3,`
                                    `),C(4,"option",10),i(5,`
                                    `),C(6,"option",10),i(7,`
                                    `),C(8,"option",10),i(9,`
                                `),s(),i(10,`
                            `)}if(n&2){let e=l(2).$implicit,t=l(3);c(),N("ngbTooltip",P(2,8,"artemisApp.competency.link.weightTooltip")),a("ngModel",e.weight<t.LOW_COMPETENCY_LINK_WEIGHT_CUT_OFF?t.LOW_COMPETENCY_LINK_WEIGHT:e.weight<t.MEDIUM_COMPETENCY_LINK_WEIGHT_CUT_OFF?t.MEDIUM_COMPETENCY_LINK_WEIGHT:t.HIGH_COMPETENCY_LINK_WEIGHT),c(3),a("ngValue",t.LOW_COMPETENCY_LINK_WEIGHT)("jhiTranslate","artemisApp.competency.link.weightLabels.low"),c(2),a("ngValue",t.MEDIUM_COMPETENCY_LINK_WEIGHT)("jhiTranslate","artemisApp.competency.link.weightLabels.medium"),c(2),a("ngValue",t.HIGH_COMPETENCY_LINK_WEIGHT)("jhiTranslate","artemisApp.competency.link.weightLabels.high")}}function de(n,p){if(n&1){let e=g();i(0,`
                        `),r(1,"div"),i(2,`
                            `),r(3,"input",6),f("ngModelChange",function(){u(e);let o=l().$implicit,m=l(3);return x(m.toggleCompetency(o))}),s(),i(4,`
                            `),r(5,"label",7),i(6,`
                                `),C(7,"fa-icon",8),i(8),s(),i(9,`
                            `),y(10,me,11,10),s(),i(11,`
                    `)}if(n&2){let e=l().$implicit,t=l(3);c(3),E("id","competency-",e.competency.id,""),a("ngModel",t.checkboxStates[e.competency.id])("disabled",t.disabled),c(2),E("for","competency-",e.competency.id,""),c(2),a("icon",t.getIcon(e.competency.taxonomy))("fixedWidth",!0),c(),T(`
                                `,e.competency.title,`
                            `),c(2),d(t.checkboxStates[e.competency.id]?10:-1)}}function _e(n,p){if(n&1&&(i(0,`
                    `),y(1,de,12,10)),n&2){let e=p.$implicit;c(),d(e&&e.competency&&e.competency.id?1:-1)}}function Ce(n,p){if(n&1&&(i(0,`
            `),r(1,"div",5),i(2,`
                `),M(3,_e,2,1,null,null,k),s(),i(5,`
        `)),n&2){let e=l(2);c(3),v(e.competencyLinks)}}function ye(n,p){if(n&1&&(i(0,`
    `),r(1,"div"),i(2,`
        `),y(3,se,4,1)(4,ae,6,2)(5,pe,10,0)(6,Ce,6,0),s(),i(7,`
`)),n&2){let e=l();c(3),d(e.labelName?3:-1),c(),d(e.labelTooltip?4:-1),c(),d(e.isLoading?5:6)}}var Fe=(()=>{class n{route=_(F);courseStorageService=_($);courseCompetencyService=_(le);changeDetector=_(H);profileService=_(R);labelName;labelTooltip;valueChange=new b;disabled;selectedCompetencyLinks;competencyLinks;isLoading=!1;checkboxStates;getIcon=ce;faQuestionCircle=z;_onChange=e=>{};HIGH_COMPETENCY_LINK_WEIGHT=ee;MEDIUM_COMPETENCY_LINK_WEIGHT=h;LOW_COMPETENCY_LINK_WEIGHT=te;LOW_COMPETENCY_LINK_WEIGHT_CUT_OFF=ie;MEDIUM_COMPETENCY_LINK_WEIGHT_CUT_OFF=ne;profileSubscription=void 0;ngOnInit(){this.profileSubscription=this.profileService.getProfileInfo().subscribe(e=>{e.activeProfiles.includes(Q)&&this.initialize()})}ngOnDestroy(){this.profileSubscription?.unsubscribe()}initialize(){let e=Number(this.route.snapshot.paramMap.get("courseId"));if(!this.competencyLinks&&e){let t=this.courseStorageService.getCourse(e);t?.competencies?.length||t?.prerequisites?.length?this.setCompetencyLinks([...t.competencies??[],...t.prerequisites??[]]):(this.isLoading=!0,this.courseCompetencyService.getAllForCourse(e).pipe(L(()=>{this.isLoading=!1,this.changeDetector.detectChanges()})).subscribe({next:o=>{this.setCompetencyLinks(o.body),this.writeValue(this.selectedCompetencyLinks)},error:()=>{this.disabled=!0}}))}}setCompetencyLinks(e){this.competencyLinks=e.map(t=>(t.course=void 0,t.userProgress=void 0,new oe(t,h))),this.checkboxStates=this.competencyLinks.reduce((t,o)=>(o.competency?.id&&(t[o.competency.id]=!!this.selectedCompetencyLinks?.find(m=>m.competency?.id===o.competency?.id)),t),{})}toggleCompetency(e){e.competency?.id&&(this.checkboxStates[e.competency.id]?this.selectedCompetencyLinks=this.selectedCompetencyLinks?.filter(t=>t.competency?.id!==e.competency?.id):this.selectedCompetencyLinks=[...this.selectedCompetencyLinks??[],e],this.checkboxStates[e.competency.id]=!this.checkboxStates[e.competency.id],this.selectedCompetencyLinks?.length||(this.selectedCompetencyLinks=void 0),this._onChange(this.selectedCompetencyLinks),this.valueChange.emit(this.selectedCompetencyLinks))}updateLinkWeight(e,t){e.weight=t,this._onChange(this.selectedCompetencyLinks),this.valueChange.emit(this.selectedCompetencyLinks)}writeValue(e){if(this.competencyLinks?.forEach(t=>{let o=e?.find(m=>m.competency?.id===t.competency?.id);t.weight=o?.weight??h}),e&&this.competencyLinks){let t=e.map(o=>o.competency?.id);this.selectedCompetencyLinks=this.competencyLinks.filter(o=>t.includes(o.competency?.id))}else this.selectedCompetencyLinks=e??[]}registerOnChange(e){this._onChange=e}registerOnTouched(e){}setDisabledState(e){this.disabled=e}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=S({type:n,selectors:[["jhi-competency-selection"]],inputs:{labelName:"labelName",labelTooltip:"labelTooltip"},outputs:{valueChange:"valueChange"},features:[O([{provide:G,multi:!0,useExisting:I(()=>n)}])],decls:1,vars:1,consts:[["for","competency-selector"],[1,"text-secondary","icon-full-size",3,"ngbTooltip"],["stackItemSize","1x",3,"icon"],["role","status",1,"spinner-border"],[1,"sr-only"],["id","competency-selector",1,"competency-selector","p-2"],["type","checkbox",3,"ngModelChange","id","ngModel","disabled"],[3,"for"],[3,"icon","fixedWidth"],[3,"ngModelChange","ngModel","ngbTooltip"],[3,"ngValue","jhiTranslate"]],template:function(t,o){t&1&&y(0,ye,8,3),t&2&&d(o.isLoading||o.competencyLinks!=null&&o.competencyLinks.length?0:-1)},dependencies:[J,j,X,B,V,U,A,w,D,K,Y,Z,q],styles:[".competency-selector[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:wrap;column-gap:24px;max-height:200px;overflow-x:auto;border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius)}.competency-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:contents}"]})}return n})();export{Fe as a};
//# sourceMappingURL=chunk-2D32KPWA.js.map
