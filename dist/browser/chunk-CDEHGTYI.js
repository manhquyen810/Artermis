import{a as bt}from"./chunk-H7UNTMXY.js";import{a as vt}from"./chunk-4P7M5PJP.js";import{a as Ct}from"./chunk-COI3ESZV.js";import{a as Tt}from"./chunk-V55WZ52P.js";import{a as St}from"./chunk-SLVT6IA5.js";import{b as ft}from"./chunk-22YQSX6Z.js";import{b as _t}from"./chunk-5AQXEKLE.js";import{a as gt}from"./chunk-KYCCMZSV.js";import{e as xt,f as ht}from"./chunk-DXTZ4GAW.js";import{c as lt,d as mt,e as ct,f as dt,g as ut}from"./chunk-F3NFBBHK.js";import{b as pt}from"./chunk-T624HJJL.js";import{a as st}from"./chunk-HMZID6NQ.js";import{b as rt}from"./chunk-O26CMRR4.js";import{c as Z,d as tt,e as it}from"./chunk-CK7FH6VF.js";import{b as C}from"./chunk-G4I63THF.js";import{c as ot}from"./chunk-JNO6DNVW.js";import{c as X}from"./chunk-BNDLMKXK.js";import{a as et}from"./chunk-K3W6YFKH.js";import{a as Y}from"./chunk-JXJXC4DZ.js";import{d as nt}from"./chunk-EDXSOKK5.js";import{p as E}from"./chunk-DID2YGL7.js";import{c as I}from"./chunk-CXQURQM5.js";import{Bb as K}from"./chunk-Z4VHWOB5.js";import{a as at}from"./chunk-U54OSGNH.js";import{f as Q}from"./chunk-M6Z6DKZQ.js";import{c as q}from"./chunk-E2KBL4LX.js";import{n as z}from"./chunk-IOA4DPXY.js";import{A as L,Bd as j,Db as a,Dc as w,Ea as _,Ma as y,Mc as B,Na as D,Oc as c,P as H,Rc as V,Tb as k,Zb as p,dd as t,ed as S,f as U,fd as f,gd as R,kc as m,qd as $,rd as J,s as M,sc as h,sd as G,uc as v,vc as T,wc as P,xb as N,xc as r,yc as s,yd as x,z as W,zc as u,zd as g}from"./chunk-5LC5EQRR.js";var Pt=(e,n)=>({participant:e,exercise:n}),Et=()=>({prop:"id",dir:"asc"}),It=e=>[e];function At(e,n){if(e&1&&(t(0,`
            `),r(1,"h4"),t(2,`
                `),r(3,"span",1),t(4),x(5,"artemisTranslate"),x(6,"artemisDate"),s(),t(7,`
                `),r(8,"span",2),t(9),x(10,"artemisTimeAgo"),s(),t(11,`
            `),s(),t(12,`
        `)),e&2){let i=c(2);a(4),R(" ",g(5,4,"artemisApp.exercise.releaseDate"),": ",g(6,6,i.exercise.releaseDate)||"N/A"," "),a(4),m("ngClass",i.exerciseStatusBadge),a(),f("",g(10,8,i.exercise.releaseDate)," ")}}function yt(e,n){if(e&1&&(t(0,`
            `),r(1,"h4"),t(2,`
                `),r(3,"span",1),t(4),x(5,"artemisTranslate"),x(6,"artemisDate"),s(),t(7,`
                `),r(8,"span",2),t(9),x(10,"artemisTimeAgo"),s(),t(11,`
            `),s(),t(12,`
        `)),e&2){let i=c(2);a(4),R(" ",g(5,4,"artemisApp.exercise.dueDate"),": ",g(6,6,i.dueDate)||"N/A"," "),a(4),m("ngClass",i.exerciseStatusBadge),a(),f(" ",g(10,8,i.dueDate)," ")}}function Dt(e,n){if(e&1&&(t(0,`
            `),r(1,"h4"),t(2,`
                `),r(3,"span",1),t(4),x(5,"artemisTranslate"),x(6,"artemisDate"),s(),t(7,`
                `),r(8,"span",2),t(9),x(10,"artemisTimeAgo"),s(),t(11,`
            `),s(),t(12,`
        `)),e&2){let i=c(2);a(4),R(" ",g(5,4,"artemisApp.exercise.assessmentDueDate"),": ",g(6,6,i.exercise.assessmentDueDate)||"N/A"," "),a(4),m("ngClass",i.exerciseStatusBadge),a(),S(g(10,8,i.exercise.assessmentDueDate))}}function wt(e,n){if(e&1&&(t(0,`
    `),r(1,"div"),t(2,`
        `),u(3,"h2",0),t(4,`
        `),p(5,At,13,10)(6,yt,13,10)(7,Dt,13,10),s(),t(8,`
`)),e&2){let i=c();a(3),m("translateValues",G(4,Pt,i.getName(),i.exercise==null?null:i.exercise.title)),a(2),h(i.exercise!=null&&i.exercise.releaseDate?5:-1),a(),h(i.dueDate?6:-1),a(),h(i.exercise!=null&&i.exercise.assessmentDueDate?7:-1)}}function Bt(e,n){if(e&1&&t(0),e&2){let i=n.value;f(`
                    `,i,`
                `)}}function Rt(e,n){e&1&&(t(0,`
                    `),u(1,"span",11),t(2,`
                `))}function Mt(e,n){if(e&1&&t(0),e&2){let i=n.value;f(`
                    `,i,`
                `)}}function Lt(e,n){e&1&&(t(0,`
                    `),u(1,"span",12),t(2,`
                `))}function jt(e,n){if(e&1&&(t(0),x(1,"artemisDate")),e&2){let i=n.value;f(`
                    `,j(1,1,i,"long",!0),`
                `)}}function Ft(e,n){e&1&&(t(0,`
                    `),u(1,"span",13),t(2,`
                `))}function Ot(e,n){if(e&1&&t(0),e&2){let i=n.value;f(`
                    `,i.length||0,`
                `)}}function Ut(e,n){e&1&&(t(0,`
                    `),u(1,"span",14),t(2,`
                `))}function Wt(e,n){if(e&1){let i=w();t(0,`
                                        `),r(1,"a",19),B("click",function(){y(i);let l=c(2).$implicit,d=c(3);return D(d.viewBuildLogs(l.buildJobId))}),s(),t(2,`
                                    `)}}function Ht(e,n){if(e&1){let i=w();t(0,`
                                    `),r(1,"span",17),B("delete",function(){y(i);let l=c().$implicit,d=c(3);return D(d.deleteResult(l.submission,l))}),t(2,`
                                        `),u(3,"fa-icon",18),t(4),x(5,"artemisTranslate"),s(),t(6,`
                                    `),p(7,Wt,3,0)}if(e&2){let i=c().$implicit,o=c(3);a(),m("buttonSize",o.buttonSizeSmall)("actionType",o.actionTypeEmpty)("entityTitle","deleteResultButton")("dialogError",o.dialogError$),a(2),m("icon",o.faTrash),a(),f(`
                                        `,g(5,7,"artemisApp.result.delete.buttonText"),`
                                    `),a(3),h(i!=null&&i.buildJobId?7:-1)}}function Nt(e,n){if(e&1&&(t(0,`
                            `),r(1,"div"),t(2,`
                                `),u(3,"jhi-result",16),t(4,`
                                `),p(5,Ht,8,9),s(),t(6,`
                        `)),e&2){let i=n.$implicit,o=c(3);a(3),m("exercise",o.exercise)("result",i)("participation",o.participation)("showUngradedResults",!o.isTmpOrSolutionProgrParticipation)("showBadge",!o.isTmpOrSolutionProgrParticipation),a(2),h(o.exercise!=null&&o.exercise.isAtLeastInstructor?5:-1)}}function kt(e,n){if(e&1&&(t(0,`
                    `),r(1,"div",15),t(2,`
                        `),T(3,Nt,7,6,null,null,v),s(),t(5,`
                `)),e&2){let i=n.value;a(3),P(i)}}function Vt(e,n){e&1&&(t(0,`
                        `),u(1,"span",21),t(2,`
                    `))}function $t(e,n){if(e&1&&(t(0,`
                                    `),r(1,"a",22),t(2),s(),t(3,`
                                `)),e&2){let i=c(2),o=i.row,l=i.value,d=c(3);a(),V("href",d.getCommitUrl(o),N),a(),S(l.slice(0,11))}}function Jt(e,n){if(e&1&&t(0),e&2){let i=c(2).value;f(`
                                    `,i.slice(0,11),`
                                `)}}function Gt(e,n){if(e&1&&(t(0,`
                            `),r(1,"div"),t(2,`
                                `),p(3,$t,4,2)(4,Jt,1,1),s(),t(5,`
                        `)),e&2){let i=c().row,o=c(3);a(3),h(o.getCommitUrl(i)?3:4)}}function zt(e,n){e&1&&t(0),e&2&&f(`
                            `,"n.a",`
                        `)}function Qt(e,n){if(e&1&&(t(0,`
                        `),p(1,Gt,6,1)(2,zt,1,1)),e&2){let i=n.value;a(),h(i?1:2)}}function qt(e,n){e&1&&(t(0,`
                `),r(1,"ngx-datatable-column",20),t(2,`
                    `),p(3,Vt,3,0,"ng-template",8),t(4,`
                    `),p(5,Qt,3,1,"ng-template",6),t(6,`
                `),s(),t(7,`
            `)),e&2&&(a(),m("minWidth",80)("width",80))}function Kt(e,n){e&1&&(t(0,`
                    `),u(1,"span",23),t(2,`
                `))}function Xt(e,n){if(e&1&&(t(0,`
                            `),r(1,"div"),t(2),s(),t(3,`
                        `)),e&2){let i=n.$implicit;a(2),S(i.assessmentType)}}function Yt(e,n){if(e&1&&(t(0,`
                    `),r(1,"div",15),t(2,`
                        `),T(3,Xt,4,1,null,null,v),s(),t(5,`
                `)),e&2){let i=n.value;a(3),P(i)}}function Zt(e,n){e&1&&(t(0,`
                    `),u(1,"span",24),t(2,`
                `))}function ti(e,n){if(e&1&&(t(0,`
                            `),r(1,"div"),t(2),s(),t(3,`
                        `)),e&2){let i=n.$implicit;a(2),S((i.assessor==null?null:i.assessor.name)||"n.a")}}function ii(e,n){if(e&1&&(t(0,`
                    `),r(1,"div",15),t(2,`
                        `),T(3,ti,4,1,null,null,v),s(),t(5,`
                `)),e&2){let i=n.value;a(3),P(i)}}function ei(e,n){e&1&&(t(0,`
                    `),u(1,"span",25),t(2,`
                `))}function ni(e,n){if(e&1&&(t(0,`
                            `),r(1,"div"),t(2),x(3,"artemisDate"),s(),t(4,`
                        `)),e&2){let i=n.$implicit;a(2),S(j(3,1,i.completionDate,"long",!0))}}function ai(e,n){if(e&1&&(t(0,`
                    `),r(1,"div",15),t(2,`
                        `),T(3,ni,5,5,null,null,v),s(),t(5,`
                `)),e&2){let i=n.value;a(3),P(i)}}function oi(e,n){e&1&&(t(0,`
                        `),u(1,"span",27),t(2,`
                    `))}function ri(e,n){if(e&1){let i=w();t(0,`
                        `),r(1,"button",28),B("delete",function(){let l=y(i).value,d=c(3);return D(d.deleteSubmission(l))}),t(2,`
                            `),u(3,"fa-icon",18),t(4,`
                        `),s(),t(5,`
                    `)}if(e&2){let i=c(3);a(),m("dialogError",i.dialogError$),a(2),m("icon",i.faTrash)}}function si(e,n){e&1&&(t(0,`
                `),r(1,"ngx-datatable-column",26),t(2,`
                    `),p(3,oi,3,0,"ng-template",8),t(4,`
                    `),p(5,ri,6,2,"ng-template",6),t(6,`
                `),s(),t(7,`
            `)),e&2&&(a(),m("minWidth",120)("width",120))}function pi(e,n){if(e&1&&(t(0,`
    `),r(1,"div",3),t(2,`
        `),r(3,"ngx-datatable",4),t(4,`
            `),r(5,"ngx-datatable-column",5),t(6,`
                `),p(7,Bt,1,1,"ng-template",6),t(8,`
            `),s(),t(9,`
            `),r(10,"ngx-datatable-column",7),t(11,`
                `),p(12,Rt,3,0,"ng-template",8),t(13,`
                `),p(14,Mt,1,1,"ng-template",6),t(15,`
            `),s(),t(16,`
            `),r(17,"ngx-datatable-column",9),t(18,`
                `),p(19,Lt,3,0,"ng-template",8),t(20,`
                `),p(21,jt,2,5,"ng-template",6),t(22,`
            `),s(),t(23,`
            `),r(24,"ngx-datatable-column",10),t(25,`
                `),p(26,Ft,3,0,"ng-template",8),t(27,`
                `),p(28,Ot,1,1,"ng-template",6),t(29,`
            `),s(),t(30,`
            `),r(31,"ngx-datatable-column",10),t(32,`
                `),p(33,Ut,3,0,"ng-template",8),t(34,`
                `),p(35,kt,6,0,"ng-template",6),t(36,`
            `),s(),t(37,`
            `),p(38,qt,8,2),r(39,"ngx-datatable-column",10),t(40,`
                `),p(41,Kt,3,0,"ng-template",8),t(42,`
                `),p(43,Yt,6,0,"ng-template",6),t(44,`
            `),s(),t(45,`
            `),r(46,"ngx-datatable-column",10),t(47,`
                `),p(48,Zt,3,0,"ng-template",8),t(49,`
                `),p(50,ii,6,0,"ng-template",6),t(51,`
            `),s(),t(52,`
            `),r(53,"ngx-datatable-column",10),t(54,`
                `),p(55,ei,3,0,"ng-template",8),t(56,`
                `),p(57,ai,6,0,"ng-template",6),t(58,`
            `),s(),t(59,`
            `),p(60,si,8,2),s(),t(61,`
    `),s(),t(62,`
`)),e&2){let i=c();a(3),m("headerHeight",50)("limit",20)("columnMode","force")("footerHeight",50)("rowHeight","auto")("rows",i.submissions)("sorts",J(27,It,$(26,Et)))("scrollbarH",!0),a(2),m("minWidth",60)("width",60),a(5),m("minWidth",80)("width",80),a(7),m("minWidth",80)("width",80),a(7),m("minWidth",80)("width",80),a(7),m("minWidth",500)("width",500),a(7),h(i.isTmpOrSolutionProgrParticipation||(i.participation==null?null:i.participation.type)===i.ParticipationType.PROGRAMMING?38:-1),a(),m("minWidth",180)("width",180),a(7),m("minWidth",200)("width",200),a(7),m("minWidth",200)("width",200),a(7),h(i.exercise!=null&&i.exercise.isAtLeastInstructor?60:-1)}}var Ji=(()=>{class e{route=_(Q);submissionService=_(tt);translateService=_(q);participationService=_(it);exerciseService=_(Z);programmingExerciseService=_(St);fileUploadAssessmentService=_(Ct);modelingAssessmentsService=_(vt);textAssessmentService=_(Tt);programmingAssessmentService=_(bt);eventManager=_(Y);profileService=_(X);ParticipationType=C;buttonSizeSmall=rt.SMALL;actionTypeEmpty=st.NoButtonTextDelete;dialogErrorSource=new U;dialogError$=this.dialogErrorSource.asObservable();participationId;exerciseStatusBadge="bg-success";isTmpOrSolutionProgrParticipation=!1;exercise;participation;dueDate;submissions;eventSubscriber;isLoading=!0;commitHashURLTemplate;resultIdToBuildJobIdMap;faTrash=K;ngOnInit(){this.setupPage(),this.eventSubscriber=this.eventManager.subscribe("submissionsModification",()=>this.setupPage())}setupPage(){this.isLoading=!0,L([this.route.params,this.route.queryParams??M(void 0)]).subscribe(([i,o])=>{this.participationId=+i.participationId,o?.isTmpOrSolutionProgrParticipation!=null&&(this.isTmpOrSolutionProgrParticipation=o.isTmpOrSolutionProgrParticipation==="true"),this.participationService.getBuildJobIdsForResultsOfParticipation(this.participationId).subscribe(l=>{this.resultIdToBuildJobIdMap=l,this.isTmpOrSolutionProgrParticipation?this.programmingExerciseService.findWithTemplateAndSolutionParticipation(i.exerciseId,!0).subscribe(d=>{this.exercise=d.body,this.exerciseStatusBadge=E().isAfter(E(this.exercise.dueDate))?"bg-danger":"bg-success";let b=this.exercise.templateParticipation,A=this.exercise.solutionParticipation;this.participationId===b?.id?(this.participation=b,this.submissions=b.submissions,b.programmingExercise=this.exercise):this.participationId===A?.id?(this.participation=A,this.submissions=A.submissions,A.programmingExercise=this.exercise):alert(this.translateService.instant("artemisApp.participation.noParticipation")),this.submissions&&this.submissions.forEach(F=>{F.results&&F.results.forEach(O=>{O.buildJobId=this.resultIdToBuildJobIdMap?.[O.id]})}),this.isLoading=!1}):(this.exerciseService.find(i.exerciseId).subscribe(d=>{this.exercise=d.body,this.updateStatusBadgeColor()}),this.fetchParticipationAndSubmissionsForStudent(),this.isLoading=!1)})}),this.profileService.getProfileInfo().subscribe(i=>{this.commitHashURLTemplate=i.commitHashURLTemplate})}fetchParticipationAndSubmissionsForStudent(){L([this.participationService.find(this.participationId),this.submissionService.findAllSubmissionsOfParticipation(this.participationId)]).pipe(W(i=>[i[0].body,i[1].body]),H(()=>M(null))).subscribe(i=>{if(this.isLoading=!1,!i)return;let o=i[0],l=i[1];o&&(this.participation=o,this.updateStatusBadgeColor()),l&&(this.submissions=l,this.participation&&(this.participation.submissions=l),l.forEach(d=>{d.results&&d.results.forEach(b=>{b.submission=d,b.buildJobId=this.resultIdToBuildJobIdMap?.[b.id]})}))})}getName(){return this.participation?.type===C.STUDENT||this.participation?.type===C.PROGRAMMING?this.participation.student?.name||this.participation.team?.name:this.participation?.type===C.SOLUTION?this.translateService.instant("artemisApp.participation.solutionParticipation"):this.participation?.type===C.TEMPLATE?this.translateService.instant("artemisApp.participation.templateParticipation"):"N/A"}getCommitUrl(i){return _t(this.commitHashURLTemplate,this.exercise?.projectKey,this.participation,i)}updateStatusBadgeColor(){let i=!1;this.exercise&&this.participation?(this.dueDate=ht(this.exercise,this.participation),i=xt(this.exercise,this.participation)):this.exercise&&(i=E().isAfter(E(this.exercise.dueDate))),this.exerciseStatusBadge=i?"bg-danger":"bg-success"}deleteSubmission(i){this.submissionService.delete(i).subscribe({next:()=>{this.eventManager.broadcast({name:"submissionsModification",content:"Deleted a submission"}),this.dialogErrorSource.next("")},error:o=>this.dialogErrorSource.next(o.message)})}deleteResult(i,o){if(this.exercise&&i.id&&o.id&&this.participationId)switch(this.exercise.type){case I.TEXT:this.textAssessmentService.deleteAssessment(this.participationId,i.id,o.id).subscribe({next:()=>this.updateResults(i,o),error:l=>this.handleErrorResponse(l)});break;case I.MODELING:this.modelingAssessmentsService.deleteAssessment(this.participationId,i.id,o.id).subscribe({next:()=>this.updateResults(i,o),error:l=>this.handleErrorResponse(l)});break;case I.FILE_UPLOAD:this.fileUploadAssessmentService.deleteAssessment(this.participationId,i.id,o.id).subscribe({next:()=>this.updateResults(i,o),error:l=>this.handleErrorResponse(l)});break;case I.PROGRAMMING:this.programmingAssessmentService.deleteAssessment(this.participationId,i.id,o.id).subscribe({next:()=>this.updateResults(i,o),error:l=>this.handleErrorResponse(l)});break}}viewBuildLogs(i){let o=`/api/programming/build-log/${i}`;window.open(o,"_blank")}updateResults(i,o){i.results=i.results?.filter(l=>l.id!==o.id),this.dialogErrorSource.next("")}handleErrorResponse(i){i.error?.message==="error.hasComplaint"?this.dialogErrorSource.next(this.translateService.instant("artemisApp.result.delete.error.hasComplaint")):this.dialogErrorSource.next(i.message)}static \u0275fac=function(o){return new(o||e)};static \u0275cmp=k({type:e,selectors:[["jhi-participation-submission"]],inputs:{participationId:"participationId"},decls:4,vars:2,consts:[["jhiTranslate","artemisApp.participation.participationSubmission.submissionsForParticipation",3,"translateValues"],[1,"me-2"],[1,"badge",3,"ngClass"],[1,"table-responsive"],["id","participationSubmissionTable",1,"bootstrap",3,"headerHeight","limit","columnMode","footerHeight","rowHeight","rows","sorts","rowClass","scrollbarH"],["name","Id","prop","id",3,"minWidth","width"],["ngx-datatable-cell-template",""],["prop","type",3,"minWidth","width"],["ngx-datatable-header-template",""],["prop","submissionDate",3,"minWidth","width"],["prop","results",3,"minWidth","width"],["jhiTranslate","artemisApp.participation.participationSubmission.submissionType"],["jhiTranslate","artemisApp.participation.participationSubmission.submissionDate"],["jhiTranslate","artemisApp.participation.participationSubmission.resultCount"],["jhiTranslate","artemisApp.participation.participationSubmission.results"],[1,"d-flex","flex-column"],[3,"exercise","result","participation","showUngradedResults","showBadge"],["jhiDeleteButton","","deleteQuestion","artemisApp.result.delete.question2",1,"badge",2,"border-radius","0px",3,"delete","buttonSize","actionType","entityTitle","dialogError"],[3,"icon"],["jhiTranslate","artemisApp.result.buildLogs.viewLogs",1,"detail-link",3,"click"],["prop","commitHash",3,"minWidth","width"],["jhiTranslate","artemisApp.programmingSubmission.commitHash"],["target","_blank","rel","noopener noreferrer",3,"href"],["jhiTranslate","artemisApp.result.assessmentType"],["jhiTranslate","artemisApp.participation.participationSubmission.assessor"],["jhiTranslate","artemisApp.exercise.completionDate"],["prop","id",3,"minWidth","width"],["jhiTranslate","artemisApp.participation.participationSubmission.action"],["id","deleteButton","jhiDeleteButton","","deleteQuestion","artemisApp.participation.participationSubmission.delete",1,"btn","btn-danger","btn-sm","me-1",3,"delete","dialogError"]],template:function(o,l){o&1&&(p(0,wt,9,7),u(1,"br"),t(2,`
`),p(3,pi,63,29)),o&2&&(h(l.participation?0:-1),a(3),h(l.submissions?3:-1))},dependencies:[at,z,ut,dt,ct,lt,mt,ft,pt,nt,ot,et,gt],encapsulation:2})}return e})();export{Ji as a};
//# sourceMappingURL=chunk-CDEHGTYI.js.map
