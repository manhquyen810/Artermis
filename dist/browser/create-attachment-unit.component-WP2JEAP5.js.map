{
  "version": 3,
  "sources": ["src/main/webapp/app/lecture/lecture-unit/lecture-unit-management/create-attachment-unit/create-attachment-unit.component.ts", "src/main/webapp/app/lecture/lecture-unit/lecture-unit-management/create-attachment-unit/create-attachment-unit.component.html"],
  "sourcesContent": ["import { Component, OnInit, ViewChild, inject } from '@angular/core';\r\nimport { Attachment, AttachmentType } from 'app/entities/attachment.model';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport { AttachmentUnit } from 'app/entities/lecture-unit/attachmentUnit.model';\r\nimport dayjs from 'dayjs/esm';\r\nimport { AttachmentUnitService } from 'app/lecture/lecture-unit/lecture-unit-management/attachmentUnit.service';\r\nimport { onError } from 'app/shared/util/global.utils';\r\nimport { AlertService } from 'app/core/util/alert.service';\r\nimport { AttachmentUnitFormComponent, AttachmentUnitFormData } from 'app/lecture/lecture-unit/lecture-unit-management/attachment-unit-form/attachment-unit-form.component';\r\nimport { combineLatest } from 'rxjs';\r\nimport { objectToJsonBlob } from 'app/utils/blob-util';\r\nimport { LectureUnitLayoutComponent } from '../lecture-unit-layout/lecture-unit-layout.component';\r\n\r\n@Component({\r\n    selector: 'jhi-create-attachment-unit',\r\n    templateUrl: './create-attachment-unit.component.html',\r\n    imports: [LectureUnitLayoutComponent, AttachmentUnitFormComponent],\r\n})\r\nexport class CreateAttachmentUnitComponent implements OnInit {\r\n    private activatedRoute = inject(ActivatedRoute);\r\n    private router = inject(Router);\r\n    private attachmentUnitService = inject(AttachmentUnitService);\r\n    private alertService = inject(AlertService);\r\n\r\n    @ViewChild('attachmentUnitForm')\r\n    attachmentUnitForm: AttachmentUnitFormComponent;\r\n    attachmentUnitToCreate: AttachmentUnit = new AttachmentUnit();\r\n    attachmentToCreate: Attachment = new Attachment();\r\n\r\n    isLoading: boolean;\r\n    lectureId: number;\r\n    courseId: number;\r\n\r\n    ngOnInit() {\r\n        const lectureRoute = this.activatedRoute.parent!.parent!;\r\n        combineLatest([lectureRoute.paramMap, lectureRoute.parent!.paramMap]).subscribe(([params, parentParams]) => {\r\n            this.lectureId = Number(params.get('lectureId'));\r\n            this.courseId = Number(parentParams.get('courseId'));\r\n        });\r\n        this.attachmentUnitToCreate = new AttachmentUnit();\r\n        this.attachmentToCreate = new Attachment();\r\n    }\r\n\r\n    createAttachmentUnit(attachmentUnitFormData: AttachmentUnitFormData): void {\r\n        if (!attachmentUnitFormData?.formProperties?.name || !attachmentUnitFormData?.fileProperties?.file || !attachmentUnitFormData?.fileProperties?.fileName) {\r\n            return;\r\n        }\r\n        const { description, name, releaseDate, competencyLinks } = attachmentUnitFormData.formProperties;\r\n        const { file, fileName } = attachmentUnitFormData.fileProperties;\r\n\r\n        // === Setting attachment ===\r\n        this.attachmentToCreate.name = name;\r\n        this.attachmentToCreate.releaseDate = releaseDate;\r\n        this.attachmentToCreate.attachmentType = AttachmentType.FILE;\r\n        this.attachmentToCreate.version = 1;\r\n        this.attachmentToCreate.uploadDate = dayjs();\r\n\r\n        // === Setting attachmentUnit ===\r\n        this.attachmentUnitToCreate.description = description;\r\n        this.attachmentUnitToCreate.competencyLinks = competencyLinks || [];\r\n\r\n        this.isLoading = true;\r\n\r\n        const formData = new FormData();\r\n        formData.append('file', file, fileName);\r\n        formData.append('attachment', objectToJsonBlob(this.attachmentToCreate));\r\n        formData.append('attachmentUnit', objectToJsonBlob(this.attachmentUnitToCreate));\r\n\r\n        this.attachmentUnitService\r\n            .create(formData, this.lectureId)\r\n            .subscribe({\r\n                next: () => this.router.navigate(['../../'], { relativeTo: this.activatedRoute }),\r\n                error: (res: HttpErrorResponse) => {\r\n                    if (res.error.params === 'file' && res?.error?.title) {\r\n                        this.alertService.error(res.error.title);\r\n                    } else {\r\n                        onError(this.alertService, res);\r\n                    }\r\n                },\r\n            })\r\n            .add(() => (this.isLoading = false));\r\n    }\r\n}\r\n", "<jhi-lecture-unit-layout [isLoading]=\"isLoading\">\r\n    <jhi-attachment-unit-form #attachmentUnitForm [isEditMode]=\"false\" (formSubmitted)=\"createAttachmentUnit($event)\" />\r\n</jhi-lecture-unit-layout>\r\n"],
  "mappings": "wzDAmBaA,GAA6B,IAAA,CAApC,MAAOA,CAA6B,CAC9BC,eAAiBC,EAAOC,CAAc,EACtCC,OAASF,EAAOG,CAAM,EACtBC,sBAAwBJ,EAAOK,CAAqB,EACpDC,aAAeN,EAAOO,CAAY,EAG1CC,mBACAC,uBAAyC,IAAIC,EAC7CC,mBAAiC,IAAIC,EAErCC,UACAC,UACAC,SAEAC,UAAQ,CACJ,IAAMC,EAAe,KAAKlB,eAAemB,OAAQA,OACjDC,EAAc,CAACF,EAAaG,SAAUH,EAAaC,OAAQE,QAAQ,CAAC,EAAEC,UAAU,CAAC,CAACC,EAAQC,CAAY,IAAK,CACvG,KAAKT,UAAYU,OAAOF,EAAOG,IAAI,WAAW,CAAC,EAC/C,KAAKV,SAAWS,OAAOD,EAAaE,IAAI,UAAU,CAAC,CACvD,CAAC,EACD,KAAKhB,uBAAyB,IAAIC,EAClC,KAAKC,mBAAqB,IAAIC,CAClC,CAEAc,qBAAqBC,EAA8C,CAC/D,GAAI,CAACA,GAAwBC,gBAAgBC,MAAQ,CAACF,GAAwBG,gBAAgBC,MAAQ,CAACJ,GAAwBG,gBAAgBE,SAC3I,OAEJ,GAAM,CAAEC,YAAAA,EAAaJ,KAAAA,EAAMK,YAAAA,EAAaC,gBAAAA,CAAe,EAAKR,EAAuBC,eAC7E,CAAEG,KAAAA,EAAMC,SAAAA,CAAQ,EAAKL,EAAuBG,eAGlD,KAAKnB,mBAAmBkB,KAAOA,EAC/B,KAAKlB,mBAAmBuB,YAAcA,EACtC,KAAKvB,mBAAmByB,eAAc,OACtC,KAAKzB,mBAAmB0B,QAAU,EAClC,KAAK1B,mBAAmB2B,WAAaC,EAAK,EAG1C,KAAK9B,uBAAuBwB,YAAcA,EAC1C,KAAKxB,uBAAuB0B,gBAAkBA,GAAmB,CAAA,EAEjE,KAAKtB,UAAY,GAEjB,IAAM2B,EAAW,IAAIC,SACrBD,EAASE,OAAO,OAAQX,EAAMC,CAAQ,EACtCQ,EAASE,OAAO,aAAcC,EAAiB,KAAKhC,kBAAkB,CAAC,EACvE6B,EAASE,OAAO,iBAAkBC,EAAiB,KAAKlC,sBAAsB,CAAC,EAE/E,KAAKL,sBACAwC,OAAOJ,EAAU,KAAK1B,SAAS,EAC/BO,UAAU,CACPwB,KAAMA,IAAM,KAAK3C,OAAO4C,SAAS,CAAC,QAAQ,EAAG,CAAEC,WAAY,KAAKhD,cAAc,CAAE,EAChFiD,MAAQC,GAA0B,CAC1BA,EAAID,MAAM1B,SAAW,QAAU2B,GAAKD,OAAOE,MAC3C,KAAK5C,aAAa0C,MAAMC,EAAID,MAAME,KAAK,EAEvCC,EAAQ,KAAK7C,aAAc2C,CAAG,CAEtC,EACH,EACAG,IAAI,IAAO,KAAKvC,UAAY,EAAM,CAC3C,4CA/DSf,EAA6B,2BAA7BA,EAA6BuD,UAAA,CAAA,CAAA,4BAAA,CAAA,EAAAC,UAAA,SAAAC,EAAAC,EAAA,IAAAD,EAAA,4MCnB1CE,EAAA,EAAA,0BAAA,CAAA,EACIC,EAAA,EAAA;KAAA,EAAAD,EAAA,EAAA,2BAAA,EAAA,CAAA,EAAmEE,EAAA,gBAAA,SAAAC,EAAA,CAAAC,OAAAC,EAAAC,CAAA,EAAAC,EAAiBR,EAAA9B,qBAAAkC,CAAA,CAA4B,CAAA,CAAA,EAAhHK,EAAA,EACJP,EAAA,EAAA;CAAA,EAAAO,EAAA,EACAP,EAAA,EAAA;CAAA,QAHyBQ,EAAA,YAAAV,EAAA3C,SAAA,EACyBsD,EAAA,CAAA,EAAAD,EAAA,aAAA,EAAA,kBDgBpCE,EAA4BC,CAA2B,EAAAC,cAAA,CAAA,CAAA,SAExDxE,CAA6B,GAAA",
  "names": ["CreateAttachmentUnitComponent", "activatedRoute", "inject", "ActivatedRoute", "router", "Router", "attachmentUnitService", "AttachmentUnitService", "alertService", "AlertService", "attachmentUnitForm", "attachmentUnitToCreate", "AttachmentUnit", "attachmentToCreate", "Attachment", "isLoading", "lectureId", "courseId", "ngOnInit", "lectureRoute", "parent", "combineLatest", "paramMap", "subscribe", "params", "parentParams", "Number", "get", "createAttachmentUnit", "attachmentUnitFormData", "formProperties", "name", "fileProperties", "file", "fileName", "description", "releaseDate", "competencyLinks", "attachmentType", "version", "uploadDate", "dayjs", "formData", "FormData", "append", "objectToJsonBlob", "create", "next", "navigate", "relativeTo", "error", "res", "title", "onError", "add", "selectors", "viewQuery", "rf", "ctx", "\u0275\u0275elementStart", "\u0275\u0275text", "\u0275\u0275listener", "$event", "i0", "\u0275\u0275restoreView", "_r1", "\u0275\u0275resetView", "\u0275\u0275elementEnd", "\u0275\u0275property", "\u0275\u0275advance", "LectureUnitLayoutComponent", "AttachmentUnitFormComponent", "encapsulation"]
}
