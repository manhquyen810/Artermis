import{a as g}from"./chunk-U6AELCVK.js";import{a as st}from"./chunk-QGGSPP32.js";import{a as lt}from"./chunk-VPHPBAVR.js";import{a as at}from"./chunk-OTCBNILH.js";import{a as it,b as nt}from"./chunk-VRAVBLUK.js";import{b as ot}from"./chunk-DRMCDU75.js";import{d as Z}from"./chunk-AR57MWOI.js";import{c as X}from"./chunk-5MVJAZRV.js";import{c as O}from"./chunk-JNO6DNVW.js";import{K as H}from"./chunk-VZRSC3LP.js";import{K as U,b as q,h as W,m as K}from"./chunk-WA5GEAJB.js";import{a as $}from"./chunk-K3W6YFKH.js";import{c as Q}from"./chunk-JXJXC4DZ.js";import{d as tt}from"./chunk-EDXSOKK5.js";import{Qa as G,oa as z,wd as J}from"./chunk-Z4VHWOB5.js";import{a as et}from"./chunk-U54OSGNH.js";import{f as N,h as V}from"./chunk-M6Z6DKZQ.js";import{c as Y}from"./chunk-E2KBL4LX.js";import{Ad as M,Db as o,Dc as v,Ea as h,Ma as T,Mc as _,Na as S,Oc as u,Rc as k,S as L,Sc as j,Tb as b,Zb as d,dd as t,ed as x,fd as y,kc as c,ld as D,md as E,nd as B,pd as P,sc as m,uc as F,vc as w,wc as R,xc as a,yc as l,yd as A,zc as s,zd as I}from"./chunk-5LC5EQRR.js";function rt(n,p){n&1&&(t(0,`
                    `),s(1,"span",27),t(2,`
                `))}function pt(n,p){n&1&&(t(0,`
                    `),s(1,"span",28),t(2,`
                `))}function mt(n,p){n&1&&(t(0,`
            `),s(1,"span",29),t(2,`
        `))}function ct(n,p){n&1&&(t(0,`
            `),s(1,"span",30),t(2,`
        `))}function dt(n,p){n&1&&(t(0,`
            `),s(1,"span",31),t(2,`
        `))}function ut(n,p){n&1&&(t(0,`
            `),s(1,"span",32),t(2,`
        `))}function Ct(n,p){n&1&&(t(0,`
                    `),s(1,"span",34),t(2,`
                `))}function ft(n,p){n&1&&(t(0,`
                    `),s(1,"span",35),t(2,`
                `))}function ht(n,p){n&1&&(t(0,`
                    `),s(1,"span",36),t(2,`
                `))}function xt(n,p){if(n&1){let e=v();t(0,`
            `),a(1,"button",33),_("click",function(){T(e);let i=u();return S(i.triggerShowAllComplaints())}),t(2,`
                `),d(3,Ct,3,0)(4,ft,3,0)(5,ht,3,0),l(),t(6,`
        `)}if(n&2){let e=u();o(),c("disabled",e.allComplaintsForTutorLoaded),o(2),m(e.isLoadingAllComplaints?3:-1),o(),m(e.complaintType===e.ComplaintType.COMPLAINT?4:-1),o(),m(e.complaintType===e.ComplaintType.MORE_FEEDBACK?5:-1)}}function _t(n,p){if(n&1&&(t(0,`
                        `),s(1,"span",40),t(2,`
                    `)),n&2){let e=u(2);o(),j("jhiTranslate","artemisApp.complaint.listOfComplaints.show",e.filterOption===e.FILTER_OPTION_ADDRESSED_COMPLAINTS?"Only":"","AddressedComplaints")}}function Tt(n,p){n&1&&(t(0,`
                        `),s(1,"span",41),t(2,`
                    `))}function St(n,p){if(n&1){let e=v();t(0,`
            `),a(1,"div",37),t(2,`
                `),a(3,"input",38),_("ngModelChange",function(){T(e);let i=u();return S(i.triggerAddressedComplaints())}),l(),t(4,`
                `),a(5,"label",39),t(6,`
                    `),d(7,_t,3,2)(8,Tt,3,0),l(),t(9,`
            `),l(),t(10,`
        `)}if(n&2){let e=u();o(3),c("ngModel",e.showAddressedComplaints),o(4),m(e.complaintType===e.ComplaintType.COMPLAINT?7:-1),o(),m(e.complaintType===e.ComplaintType.MORE_FEEDBACK?8:-1)}}function vt(n,p){if(n&1&&(t(0,`
                        `),a(1,"th",42),t(2,`
                            `),s(3,"a",43),t(4,`
                            `),s(5,"fa-icon",11),t(6,`
                        `),l(),t(7,`
                        `),a(8,"th",44),t(9,`
                            `),s(10,"a",45),t(11,`
                            `),s(12,"fa-icon",11),t(13,`
                        `),l(),t(14,`
                        `),a(15,"th",46),t(16,`
                            `),s(17,"a",47),t(18,`
                            `),s(19,"fa-icon",11),t(20,`
                        `),l(),t(21,`
                    `)),n&2){let e=u();o(5),c("icon",e.faSort),o(7),c("icon",e.faSort),o(7),c("icon",e.faSort)}}function yt(n,p){if(n&1&&(t(0,`
                            `),a(1,"td"),t(2,`
                                `),a(3,"span"),t(4),l(),t(5,`
                            `),l(),t(6,`
                            `),a(7,"td"),t(8,`
                                `),a(9,"span"),t(10),l(),t(11,`
                            `),l(),t(12,`
                            `),a(13,"td"),t(14,`
                                `),a(15,"span"),t(16),l(),t(17,`
                            `),l(),t(18,`
                        `)),n&2){let e=u().$implicit;o(4),x(e.student==null?null:e.student.login),o(6),x(e.student==null?null:e.student.name),o(6),x(e.complaintResponse==null||e.complaintResponse.reviewer==null?null:e.complaintResponse.reviewer.name)}}function At(n,p){n&1&&t(0,`
                                    >=
                                `)}function Ot(n,p){if(n&1&&(t(0,`
                                    `),s(1,"fa-icon",51),A(2,"artemisTranslate"),t(3,`
                                `)),n&2){let e=u(2);o(),k("ngbTooltip",I(2,2,"artemisApp.complaint.oneWeekUnanswered")),c("icon",e.faExclamationTriangle)}}function Et(n,p){n&1&&(t(0,`
                                `),s(1,"span",52),t(2,`
                            `))}function It(n,p){n&1&&(t(0,`
                                `),s(1,"span",53),t(2,`
                            `))}function gt(n,p){n&1&&(t(0,`
                                `),s(1,"span",54),t(2,`
                            `))}function Lt(n,p){n&1&&(t(0,`
                                `),s(1,"span",55),t(2,`
                            `))}function bt(n,p){n&1&&(t(0,`
                                    `),s(1,"span",56),t(2,`
                                `))}function Ft(n,p){n&1&&(t(0,`
                                    `),s(1,"span",57),t(2,`
                                `))}function wt(n,p){if(n&1){let e=v();t(0,`
                    `),a(1,"tr"),t(2,`
                        `),a(3,"td"),t(4),l(),t(5,`
                        `),a(6,"td"),t(7,`
                            `),a(8,"span"),t(9),l(),t(10,`
                        `),l(),t(11,`
                        `),a(12,"td"),t(13,`
                            `),a(14,"span"),t(15),l(),t(16,`
                        `),l(),t(17,`
                        `),a(18,"td"),t(19,`
                            `),a(20,"span"),t(21),l(),t(22,`
                        `),l(),t(23,`
                        `),d(24,yt,19,3),a(25,"td"),t(26,`
                            `),a(27,"span"),t(28),A(29,"artemisDate"),l(),t(30,`
                        `),l(),t(31,`
                        `),a(32,"td"),t(33,`
                            `),a(34,"span"),t(35,`
                                `),d(36,At,1,0),t(37),A(38,"artemisDurationFromSeconds"),d(39,Ot,4,4),l(),t(40,`
                        `),l(),t(41,`
                        `),a(42,"td"),t(43,`
                            `),d(44,Et,3,0)(45,It,3,0)(46,gt,3,0)(47,Lt,3,0),l(),t(48,`
                        `),a(49,"td"),t(50),l(),t(51,`
                        `),a(52,"td",48),t(53,`
                            `),a(54,"button",49),_("click",function(){let i=T(e).$implicit,C=u();return S(C.openAssessmentEditor(i))}),t(55,`
                                `),s(56,"fa-icon",50),t(57,`
                                `),d(58,bt,3,0)(59,Ft,3,0),l(),t(60,`
                        `),l(),t(61,`
                    `),l(),t(62,`
                `)}if(n&2){let e=p.$implicit,r=u();o(4),y(`
                            `,e.id,`
                        `),o(5),x(e.result==null||e.result.participation==null||e.result.participation.exercise==null?null:e.result.participation.exercise.title),o(6),x(e.result==null||e.result.submission==null?null:e.result.submission.id),o(6),x(e.result==null||e.result.assessor==null?null:e.result.assessor.name),o(3),m(r.course!=null&&r.course.isAtLeastInstructor?24:-1),o(4),x(I(29,18,e.submittedTime)),o(8),m(e.accepted===void 0?36:-1),o(),y(`
                                `,M(38,20,r.complaintService.getResponseTimeInSeconds(e),!0),`
                                `),o(2),m(r.complaintService.shouldHighlightComplaint(e)?39:-1),o(5),m(e.accepted===void 0?44:-1),o(),m(e.accepted===!0&&r.complaintType===r.ComplaintType.COMPLAINT?45:-1),o(),m(e.accepted===!0&&r.complaintType===r.ComplaintType.MORE_FEEDBACK?46:-1),o(),m(e.accepted===!1?47:-1),o(3),y(`
                            `,r.calculateComplaintLockStatus(e),`
                        `),o(6),c("icon",r.faFolderOpen)("fixedWidth",!0),o(2),m(r.complaintType===r.ComplaintType.COMPLAINT?58:-1),o(),m(r.complaintType===r.ComplaintType.MORE_FEEDBACK?59:-1)}}function Rt(n,p){n&1&&(t(0,`
            `),s(1,"span",58),t(2,`
        `))}function kt(n,p){n&1&&(t(0,`
            `),s(1,"span",59),t(2,`
        `))}var oe=(()=>{class n{complaintService=h(st);alertService=h(Q);route=h(N);router=h(V);sortService=h(at);translateService=h(Y);artemisDatePipe=h(O);courseManagementService=h(Z);ComplaintType=g;complaints=[];complaintType;courseId;exerciseId;tutorId;examId;course;correctionRound;complaintsSortingPredicate="id";complaintsReverseOrder=!1;complaintsToShow=[];showAddressedComplaints=!1;allComplaintsForTutorLoaded=!1;isLoadingAllComplaints=!1;filterOption;loading=!0;faSort=G;faFolderOpen=z;faExclamationTriangle=J;FILTER_OPTION_ADDRESSED_COMPLAINTS=4;ngOnInit(){this.route.params.pipe(L(this.route.queryParams,this.route.data)).subscribe(e=>{let r=e[0],i=e[1],C=e[2];this.courseId=Number(r.courseId),this.exerciseId=Number(r.exerciseId),this.examId=Number(r.examId),this.tutorId=Number(i.tutorId),this.correctionRound=Number(i.correctionRound),i.filterOption&&(this.filterOption=Number(i.filterOption)),this.complaintType=C.complaintType,this.loadComplaints()})}loadComplaints(){let e;this.tutorId?this.exerciseId?e=this.complaintService.findAllByTutorIdForExerciseId(this.tutorId,this.exerciseId,this.complaintType):this.examId?e=this.complaintService.findAllByTutorIdForCourseId(this.tutorId,this.courseId,this.complaintType):e=this.complaintService.findAllByTutorIdForCourseId(this.tutorId,this.courseId,this.complaintType):this.exerciseId?e=this.complaintService.findAllByExerciseId(this.exerciseId,this.complaintType):this.examId?e=this.complaintService.findAllByCourseIdAndExamId(this.courseId,this.examId):e=this.complaintService.findAllByCourseId(this.courseId,this.complaintType),this.subscribeToComplaintResponse(e),this.courseManagementService.find(this.courseId).subscribe(r=>{this.course=r?.body})}subscribeToComplaintResponse(e){e.subscribe({next:r=>{this.complaints=r.body,this.filterOption===this.FILTER_OPTION_ADDRESSED_COMPLAINTS&&(this.showAddressedComplaints=!0),this.showAddressedComplaints?this.filterOption===this.FILTER_OPTION_ADDRESSED_COMPLAINTS?this.complaintsToShow=this.complaints.filter(i=>i.accepted!==void 0):this.complaintsToShow=this.complaints:this.complaintsToShow=this.complaints.filter(i=>i.accepted===void 0)},error:r=>X(this.alertService,r),complete:()=>this.loading=!1})}openAssessmentEditor(e){if(!e||!e.result||!e.result.participation||!e.result.submission)return;let r=e.result.participation,i=r.exercise,C=e.result.submission.id;if(!i||!i.type||!C)return;this.correctionRound=this.correctionRound||0,this.complaintType==g.COMPLAINT&&e.accepted&&(this.correctionRound+=1);let f=ot(i.type,this.courseId,i.id,r.id,C,void 0,void 0,e.result.id);this.router.navigate(f,{queryParams:{"correction-round":this.correctionRound}})}sortRows(){switch(this.complaintsSortingPredicate){case"responseTime":this.sortService.sortByFunction(this.complaintsToShow,e=>this.complaintService.getResponseTimeInSeconds(e),this.complaintsReverseOrder);break;case"lockStatus":this.sortService.sortByFunction(this.complaintsToShow,e=>this.calculateComplaintLockStatus(e),this.complaintsReverseOrder);break;default:this.sortService.sortByProperty(this.complaintsToShow,this.complaintsSortingPredicate,this.complaintsReverseOrder)}}triggerAddressedComplaints(){this.showAddressedComplaints=!this.showAddressedComplaints,this.showAddressedComplaints?this.complaintsToShow=this.complaints:this.resetFilterOptions()}triggerShowAllComplaints(){this.isLoadingAllComplaints=!0;let e=this.complaintService.findAllWithoutStudentInformationForCourseId(this.courseId,this.complaintType);this.subscribeToComplaintResponse(e),this.isLoadingAllComplaints=!1,this.allComplaintsForTutorLoaded=!0}calculateComplaintLockStatus(e){if(e.complaintResponse&&this.complaintService.isComplaintLocked(e))if(this.complaintService.isComplaintLockedByLoggedInUser(e)){let r=this.artemisDatePipe.transform(e.complaintResponse?.lockEndDate);return this.translateService.instant("artemisApp.locks.lockInformationYou",{endDate:r})}else{let r=this.artemisDatePipe.transform(e.complaintResponse?.lockEndDate),i=e.complaintResponse?.reviewer?.login;return this.translateService.instant("artemisApp.locks.lockInformation",{endDate:r,user:i})}else return this.translateService.instant("artemisApp.locks.notUnlocked")}updateFilteredComplaints(e){this.complaintsToShow=e.filter(r=>r.accepted===void 0)}resetFilterOptions(){this.updateFilteredComplaints(this.complaints),this.showAddressedComplaints=!1,this.filterOption=void 0}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=b({type:n,selectors:[["jhi-complaint-list"]],features:[P([O])],decls:111,vars:24,consts:[[1,"course-info-bar"],[1,"row","justify-content-between"],[1,"col-md-8"],[1,"col-12","mt-4"],[1,"alert","alert-info",3,"hidden"],[1,"row","table-responsive"],[1,"row","table-responsive","pt-3"],[1,"table",3,"hidden"],["jhiSort","",3,"predicateChange","ascendingChange","sortChange","predicate","ascending"],["jhiSortBy","id"],[1,"th-link"],[3,"icon"],["jhiSortBy","result.participation.exercise.title"],["jhiTranslate","artemisApp.complaint.listOfComplaints.exercise",1,"th-link"],["jhiSortBy","result.submission.id"],["jhiTranslate","artemisApp.complaint.listOfComplaints.submissionId",1,"th-link"],["jhiSortBy","result.assessor.name"],["jhiTranslate","artemisApp.complaint.listOfComplaints.assessorName",1,"th-link"],["jhiSortBy","submittedTime"],["jhiTranslate","artemisApp.complaint.listOfComplaints.dateAndTime",1,"th-link"],["jhiSortBy","responseTime"],["jhiTranslate","artemisApp.complaint.listOfComplaints.responseTime",1,"th-link"],["jhiSortBy","accepted"],["jhiTranslate","artemisApp.complaint.listOfComplaints.status",1,"th-link"],["jhiSortBy","lockStatus"],["jhiTranslate","artemisApp.locks.lockStatus",1,"th-link"],["jhiTranslate","artemisApp.complaint.listOfComplaints.actions"],["jhiTranslate","artemisApp.complaint.listOfComplaints.title"],["jhiTranslate","artemisApp.moreFeedback.list.title"],["jhiTranslate","artemisApp.complaint.listOfComplaints.loadAllComplaintsExplanation"],["jhiTranslate","artemisApp.moreFeedback.list.loadAllRequestsExplanation"],["jhiTranslate","artemisApp.complaint.listOfComplaints.allComplaintsLoaded"],["jhiTranslate","artemisApp.moreFeedback.list.allRequestsLoaded"],["name","loadAllComplaintsForTutor","id","button_loadAllComplaintsForTutor",1,"btn","btn-outline-info","m-1",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["jhiTranslate","artemisApp.complaint.listOfComplaints.loadAllComplaints"],["jhiTranslate","artemisApp.moreFeedback.list.loadAllRequests"],[1,"form-check","col-6","align-baseline"],["type","checkbox","name","showAddressedComplaint","id","field_showAddressedComplaint",1,"form-check-input",3,"ngModelChange","ngModel"],["for","field_showAddressedComplaint",1,"form-check-label"],[3,"jhiTranslate"],["jhiTranslate","artemisApp.moreFeedback.list.showAnsweredRequests"],["jhiSortBy","student.login"],["jhiTranslate","artemisApp.complaint.listOfComplaints.studentLogin",1,"th-link"],["jhiSortBy","student.name"],["jhiTranslate","artemisApp.complaint.listOfComplaints.studentName",1,"th-link"],["jhiSortBy","complaintResponse.reviewer.name"],["jhiTranslate","artemisApp.complaint.listOfComplaints.reviewerName",1,"th-link"],[1,"text-center"],["id","show-complaint",1,"btn","btn-primary","btn-sm",3,"click"],[3,"icon","fixedWidth"],[1,"text-warning",3,"icon","ngbTooltip"],["jhiTranslate","artemisApp.complaint.listOfComplaints.noReply",1,"text-warning"],["jhiTranslate","artemisApp.complaint.listOfComplaints.accepted",1,"text-success"],["jhiTranslate","artemisApp.moreFeedback.accepted",1,"text-success"],["jhiTranslate","artemisApp.complaint.listOfComplaints.rejected",1,"text-danger"],["jhiTranslate","artemisApp.exerciseAssessmentDashboard.showComplaint"],["jhiTranslate","artemisApp.exerciseAssessmentDashboard.showMoreFeedbackRequests"],["jhiTranslate","artemisApp.exerciseAssessmentDashboard.noComplaints"],["jhiTranslate","artemisApp.exerciseAssessmentDashboard.noMoreFeedbackRequests"]],template:function(r,i){r&1&&(a(0,"div",0),t(1,`
    `),a(2,"div",1),t(3,`
        `),a(4,"div",2),t(5,`
            `),a(6,"h2"),t(7,`
                `),d(8,rt,3,0)(9,pt,3,0),l(),t(10,`
        `),l(),t(11,`
    `),l(),t(12,`
`),l(),t(13,`
`),a(14,"div",3),t(15,`
    `),a(16,"div",4),t(17,`
        `),d(18,mt,3,0)(19,ct,3,0)(20,dt,3,0)(21,ut,3,0)(22,xt,7,4),l(),t(23,`
    `),a(24,"div",5),t(25,`
        `),d(26,St,11,3),l(),t(27,`
    `),a(28,"div",6),t(29,`
        `),a(30,"table",7),t(31,`
            `),a(32,"thead"),t(33,`
                `),a(34,"tr",8),B("predicateChange",function(f){return E(i.complaintsSortingPredicate,f)||(i.complaintsSortingPredicate=f),f})("ascendingChange",function(f){return E(i.complaintsReverseOrder,f)||(i.complaintsReverseOrder=f),f}),_("sortChange",function(){return i.sortRows()}),t(35,`
                    `),a(36,"th",9),t(37,`
                        `),a(38,"a",10),t(39,"#"),l(),t(40,`
                        `),s(41,"fa-icon",11),t(42,`
                    `),l(),t(43,`
                    `),a(44,"th",12),t(45,`
                        `),s(46,"a",13),t(47,`
                        `),s(48,"fa-icon",11),t(49,`
                    `),l(),t(50,`
                    `),a(51,"th",14),t(52,`
                        `),s(53,"a",15),t(54,`
                        `),s(55,"fa-icon",11),t(56,`
                    `),l(),t(57,`
                    `),a(58,"th",16),t(59,`
                        `),s(60,"a",17),t(61,`
                        `),s(62,"fa-icon",11),t(63,`
                    `),l(),t(64,`
                    `),d(65,vt,22,3),a(66,"th",18),t(67,`
                        `),s(68,"a",19),t(69,`
                        `),s(70,"fa-icon",11),t(71,`
                    `),l(),t(72,`
                    `),a(73,"th",20),t(74,`
                        `),s(75,"a",21),t(76,`
                        `),s(77,"fa-icon",11),t(78,`
                    `),l(),t(79,`
                    `),a(80,"th",22),t(81,`
                        `),s(82,"a",23),t(83,`
                        `),s(84,"fa-icon",11),t(85,`
                    `),l(),t(86,`
                    `),a(87,"th",24),t(88,`
                        `),s(89,"a",25),t(90,`
                        `),s(91,"fa-icon",11),t(92,`
                    `),l(),t(93,`
                    `),s(94,"th",26),t(95,`
                `),l(),t(96,`
            `),l(),t(97,`
            `),a(98,"tbody"),t(99,`
                `),w(100,wt,63,23,null,null,F),l(),t(102,`
        `),l(),t(103,`
    `),l(),t(104,`
    `),a(105,"div",4),t(106,`
        `),d(107,Rt,3,0)(108,kt,3,0),l(),t(109,`
`),l(),t(110,`
`)),r&2&&(o(8),m(i.complaintType===i.ComplaintType.COMPLAINT?8:-1),o(),m(i.complaintType===i.ComplaintType.MORE_FEEDBACK?9:-1),o(7),c("hidden",!i.course||i.course.isAtLeastInstructor),o(2),m(!i.allComplaintsForTutorLoaded&&i.complaintType===i.ComplaintType.COMPLAINT?18:-1),o(),m(!i.allComplaintsForTutorLoaded&&i.complaintType===i.ComplaintType.MORE_FEEDBACK?19:-1),o(),m(i.allComplaintsForTutorLoaded&&i.complaintType===i.ComplaintType.COMPLAINT?20:-1),o(),m(i.allComplaintsForTutorLoaded&&i.complaintType===i.ComplaintType.MORE_FEEDBACK?21:-1),o(),m(i.allComplaintsForTutorLoaded?-1:22),o(4),m(i.loading?-1:26),o(4),c("hidden",i.complaintsToShow.length===0),o(4),D("predicate",i.complaintsSortingPredicate)("ascending",i.complaintsReverseOrder),o(7),c("icon",i.faSort),o(7),c("icon",i.faSort),o(7),c("icon",i.faSort),o(7),c("icon",i.faSort),o(3),m(i.course!=null&&i.course.isAtLeastInstructor?65:-1),o(5),c("icon",i.faSort),o(7),c("icon",i.faSort),o(7),c("icon",i.faSort),o(7),c("icon",i.faSort),o(9),R(i.complaintsToShow),o(5),c("hidden",i.complaints.length!==0),o(2),m(i.complaintType===i.ComplaintType.COMPLAINT?107:-1),o(),m(i.complaintType===i.ComplaintType.MORE_FEEDBACK?108:-1))},dependencies:[et,U,q,W,K,tt,H,$,O,lt,it,nt],encapsulation:2})}return n})();export{oe as a};
//# sourceMappingURL=chunk-SHW2EEWS.js.map
