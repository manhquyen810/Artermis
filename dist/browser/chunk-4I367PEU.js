import{gd as p,hc as g}from"./chunk-Z4VHWOB5.js";import{a as S}from"./chunk-XUCCGZJR.js";import{Ea as h,Pd as m,Qd as u,Rd as y,ab as o,ya as f}from"./chunk-5LC5EQRR.js";import{j as l}from"./chunk-3E746U5Y.js";var a="artemisapp.theme.preference",c="artemis-theme-override",s=class r{static LIGHT=new r("LIGHT",!0,void 0,g);static DARK=new r("DARK",!1,"theme-dark.css",p);constructor(T,e,t,i){this.identifier=T,this.isDefault=e,this.fileName=t,this.icon=i}identifier;isDefault;fileName;icon;static get all(){return[this.LIGHT,this.DARK]}},b=(()=>{class r{_userPreference=o(void 0);userPreference=this._userPreference.asReadonly();systemPreference=o(s.LIGHT);currentTheme=u(()=>this.userPreference()??this.systemPreference());localStorageService=h(S);darkSchemeMediaQuery;constructor(){y(()=>{let e=this.currentTheme();m(()=>this.applyTheme(e))})}initialize(){this.darkSchemeMediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.darkSchemeMediaQuery.media!=="not all"&&this.darkSchemeMediaQuery.addEventListener("change",()=>{this.darkSchemeMediaQuery.matches?this.systemPreference.set(s.DARK):this.systemPreference.set(s.LIGHT)}),addEventListener("storage",e=>{e.key==="jhi-"+a&&this._userPreference.set(this.getStoredThemePreference())}),this.systemPreference.set(this.darkSchemeMediaQuery.matches?s.DARK:s.LIGHT),this._userPreference.set(this.getStoredThemePreference())}getStoredThemePreference(){let e=this.localStorageService.retrieve(a),t=s.all.find(i=>i.identifier===e);return e&&!t&&this.localStorageService.clear(a),t}print(){return l(this,null,function*(){return new Promise(e=>{let t=document.getElementById(c);t&&(t.rel="none-tmp"),setTimeout(()=>{let i=this.hideNotificationSidebar();window.print(),this.showNotificationSidebar(i)},250),setTimeout(()=>{t&&(t.rel="stylesheet"),e()},500)})})}applyThemePreference(e){e?this.localStorageService.store(a,e.identifier):this.localStorageService.clear(a),this._userPreference.set(e)}applyTheme(e){let t=document.getElementById(c);if(e.isDefault)t?.remove();else{let i=document.getElementsByTagName("head")[0],n=document.createElement("link");n.id=c,n.rel="stylesheet",n.href=e.fileName+"?_="+new Date().setMinutes(0,0,0),n.onload=()=>{t?.remove()};let d=i.getElementsByTagName("link"),E=d[d.length-1];i.insertBefore(n,E?.nextSibling)}}hideNotificationSidebar(){return this.modifyNotificationSidebarDisplayStyling()}showNotificationSidebar(e){return this.modifyNotificationSidebarDisplayStyling(e)}modifyNotificationSidebarDisplayStyling(e){let t=document.getElementById("notification-sidebar"),i="";return t&&(i=t.style.display,t.style.display=e!==void 0?e:"none"),i}static \u0275fac=function(t){return new(t||r)};static \u0275prov=f({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();export{s as a,b};
//# sourceMappingURL=chunk-4I367PEU.js.map
