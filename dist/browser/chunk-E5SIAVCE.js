import{a as dt,b as pt,c as ut,d as gt}from"./chunk-2XM463N5.js";import{a as be}from"./chunk-F452EUSG.js";import{a as ve}from"./chunk-F75WZTS2.js";import{d as he}from"./chunk-2SI4Q343.js";import{a as mt}from"./chunk-ZXG3EZUM.js";import{a as ct}from"./chunk-7VA67MIB.js";import{a as ot}from"./chunk-7MNRIAWL.js";import{a as oe}from"./chunk-TOVMCMTA.js";import{a as at}from"./chunk-FNJRUM5G.js";import{a as M,b as fe,c as lt}from"./chunk-XYQBKB2U.js";import{a as st}from"./chunk-GM5QZPKO.js";import{b as V}from"./chunk-IJRVZ46L.js";import{a as R}from"./chunk-POPNQ63B.js";import{a as rt}from"./chunk-SUUJN3EQ.js";import{c as _e}from"./chunk-CCVWGTN5.js";import{a as nt,c as ne}from"./chunk-M2FHCXD3.js";import{b as ie}from"./chunk-V7PDYRDZ.js";import{a as tt}from"./chunk-VPHPBAVR.js";import{q as xe}from"./chunk-Z2YUBN6N.js";import{f as et}from"./chunk-GERFCPB6.js";import{a as ue,b as Ze}from"./chunk-O26CMRR4.js";import{b as it}from"./chunk-GXOKLIFX.js";import{a as Je}from"./chunk-QA7Y7QBM.js";import{d as Ke}from"./chunk-CT44YL7Q.js";import{K as He,u as Re,v as Be}from"./chunk-VZRSC3LP.js";import{K as Qe,c as Le,h as je,m as Ne}from"./chunk-WA5GEAJB.js";import{e as te}from"./chunk-5GXY5RYT.js";import{a as F}from"./chunk-K3W6YFKH.js";import{c as pe}from"./chunk-JXJXC4DZ.js";import{d as A}from"./chunk-EDXSOKK5.js";import{p as q}from"./chunk-DID2YGL7.js";import{c as N,f as Q}from"./chunk-CXQURQM5.js";import{Vb as Ye,da as We,sb as Ge,sd as Xe}from"./chunk-Z4VHWOB5.js";import{a as ee}from"./chunk-NOBD5HSR.js";import{a as O}from"./chunk-U54OSGNH.js";import{c as $e}from"./chunk-E2KBL4LX.js";import{n as qe,u as ze,x as Ue}from"./chunk-IOA4DPXY.js";import{Ac as W,Bc as G,Db as s,Dc as b,Ea as g,Ed as Ee,H as Ae,Id as ke,Ma as x,Mb as le,Mc as f,Na as _,Nb as me,Oc as m,Pb as De,Qa as D,Sc as de,Tb as E,Va as Ie,Vb as ce,Xb as P,Ya as U,Za as S,Zb as h,_ as Se,ad as L,ba as Oe,bd as J,cd as k,dd as e,ed as K,f as se,fd as C,kc as c,ld as Pe,mc as Ce,md as Fe,nd as Ve,pa as Me,pd as j,r as ye,rd as Y,sc as p,sd as Z,uc as B,vc as H,wb as X,wc as $,xc as a,yc as l,yd as T,z as ae,zc as u,zd as w}from"./chunk-5LC5EQRR.js";import{h as bt,j as ge}from"./chunk-3E746U5Y.js";var xt=class{isOverviewPage;exercise;constructor(){this.isOverviewPage=!1,this.exercise=void 0}};var _t=(()=>{class n{changeDetectorReference=g(ke);onActivate(){this.changeDetectorReference.reattach()}onDeactivate(){this.changeDetectorReference.detach()}static \u0275fac=function(i){return new(i||n)};static \u0275dir=ce({type:n})}return n})();var I=(()=>{class n extends _t{readonly=S(!1);examTimeline=S(!1);submissionVersion;static \u0275fac=(()=>{let t;return function(o){return(t||(t=D(n)))(o||n)}})();static \u0275dir=ce({type:n,inputs:{readonly:[1,"readonly"],examTimeline:[1,"examTimeline"]},features:[P]})}return n})();var re=(()=>{class n{faFloppyDisk=Ge;facSaveSuccess=it;submission=S();save=U();onSave(){this.save.emit()}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=E({type:n,selectors:[["jhi-exercise-save-button"]],inputs:{submission:[1,"submission"]},outputs:{save:"save"},decls:8,vars:4,consts:[["id","save-exam","type","submit",1,"btn","btn-primary",3,"click","disabled"],[1,"saved",3,"fixedWidth","icon"],[1,"d-none","d-sm-inline",3,"jhiTranslate"]],template:function(i,o){if(i&1&&(a(0,"button",0),f("click",function(){return o.onSave()}),e(1,`
    `),u(2,"fa-icon",1),e(3,`
    `),a(4,"span",2),e(5,`
    `),l(),e(6,`
`),l(),e(7,`
`)),i&2){let r,v,y;c("disabled",(r=o.submission())==null?null:r.isSynced),s(2),c("fixedWidth",!0)("icon",(v=o.submission())!=null&&v.submitted&&((v=o.submission())!=null&&v.isSynced)?o.facSaveSuccess:o.faFloppyDisk),s(2),c("jhiTranslate",(y=o.submission())!=null&&y.submitted&&((y=o.submission())!=null&&y.isSynced)?"artemisApp.examParticipation.exerciseSaved":"artemisApp.examParticipation.saveExercise")}},dependencies:[A,O],styles:[".saved[_ngcontent-%COMP%]{--fa-secondary-opacity: 1}"]})}return n})();var St=(n,d)=>({points:n,bonusPoints:d});function Ct(n,d){if(n&1&&(e(0,`
                `),u(1,"jhi-included-in-score-badge",11),e(2,`
            `)),n&2){let t=m(2);s(),c("includedInOverallScore",t.exercise().includedInOverallScore)}}function Et(n,d){if(n&1){let t=b();e(0,`
                        `),a(1,"div",12),e(2,`
                            `),a(3,"jhi-modeling-editor",13),f("onModelChanged",function(o){x(t);let r=m(2);return _(r.modelChanged(o))})("explanationChange",function(o){x(t);let r=m(2);return _(r.explanationChanged(o))}),l(),e(4,`
                        `),l(),e(5,`
                    `)}if(n&2){let t=m(2);s(3),c("umlModel",t.umlModel)("diagramType",t.exercise().diagramType)("readOnly",t.readonly())("withExplanation",!0)("explanation",t.explanationText)}}function Tt(n,d){if(n&1){let t=b();e(0,`
                `),a(1,"jhi-exam-exercise-update-highlighter",14),f("problemStatementUpdateEvent",function(o){x(t);let r=m(2);return _(r.updateProblemStatement(o))}),l(),e(2,`
            `)}if(n&2){let t=m(2);s(),c("exercise",t.exercise())}}function wt(n,d){if(n&1&&(e(0,`
                `),a(1,"p",15),e(2,`
                    `),u(3,"span",16),e(4,`
                `),l(),e(5,`
            `)),n&2){let t=m(2);s(3),c("innerHTML",t.problemStatementHtml,X)}}function yt(n,d){if(n&1){let t=b();e(0,`
    `),a(1,"div",0),e(2,`
        `),a(3,"h3",1),e(4,`
            `),a(5,"span"),e(6),l(),e(7,`
            `),a(8,"span",2),e(9,`
            `),l(),e(10,`
            `),h(11,Ct,3,1),l(),e(12,`
        `),a(13,"jhi-exercise-save-button",3),f("save",function(){x(t);let o=m();return _(o.notifyTriggerSave())}),l(),e(14,`
    `),l(),e(15,`
    `),u(16,"hr"),e(17,`

    `),a(18,"jhi-resizeable-container",4),e(19,`
        `),e(20,`
        `),a(21,"span",5),e(22),T(23,"artemisTranslate"),l(),e(24,`
        `),a(25,"div",6),e(26,`
            `),a(27,"jhi-fullscreen"),e(28,`
                `),a(29,"div",7),e(30,`
                    `),h(31,Et,6,5),l(),e(32,`
            `),l(),e(33,`
        `),l(),e(34,`
        `),e(35,`
        `),e(36,`
        `),u(37,"fa-icon",8),e(38,`\xA0
        `),u(39,"span",9),e(40,`
        `),e(41,`
        `),W(42,10),e(43,`
            `),h(44,Tt,3,1)(45,wt,6,1),G(),e(46,`
        `),e(47,`
    `),l(),e(48,`
`)}if(n&2){let t,i=m();s(6),C(`
                `,(t=i.exercise().exerciseGroup)==null?null:t.title,`
            `),s(2),c("jhiTranslate",i.exercise().bonusPoints?"artemisApp.examParticipation.bonus":"artemisApp.examParticipation.points")("translateValues",Z(13,St,i.exercise().maxPoints,i.exercise().bonusPoints)),s(3),p(i.exercise().includedInOverallScore!==i.IncludedInOverallScore.INCLUDED_COMPLETELY?11:-1),s(2),c("submission",i.studentSubmission()),s(5),c("examTimeline",i.examTimeline()),s(4),K(i.examTimeline()?i.exercise().title:w(23,11,"artemisApp.exam.yourSolution")),s(9),p(i.studentSubmission()&&i.isActive?31:-1),s(6),c("icon",i.faListAlt),s(7),p(i.exercise()?44:-1),s(),p(i.problemStatementHtml?45:-1)}}var Qi=(()=>{class n extends I{exerciseType=N.MODELING;modelingEditor=le.required(_e);studentSubmission=S.required();problemStatementHtml;exercise=S.required();umlModel;isSubmissionSynced=S();saveCurrentExercise=U();explanationText;IncludedInOverallScore=Q;faListAlt=xe;ngOnInit(){this.problemStatementHtml=ie(this.exercise()?.problemStatement),this.updateViewFromSubmission()}updateProblemStatement(t){this.problemStatementHtml=t,this.changeDetectorReference.detectChanges()}getSubmission(){return this.studentSubmission()}getExerciseId(){return this.exercise().id}getExercise(){return this.exercise()}updateViewFromSubmission(){this.studentSubmission()&&(this.studentSubmission().model&&(this.umlModel=JSON.parse(this.studentSubmission().model)),this.explanationText=this.studentSubmission().explanationText??"")}updateSubmissionFromView(){if(!this.modelingEditor()||!this.modelingEditor().getCurrentModel())return;let t=this.modelingEditor().getCurrentModel(),i=JSON.stringify(t);this.studentSubmission()&&(i&&(this.studentSubmission().model=i),this.studentSubmission().explanationText=this.explanationText)}hasUnsavedChanges(){return!this.studentSubmission().isSynced}get isActive(){return this.exercise()&&(!this.exercise().dueDate||q(this.exercise().dueDate).isSameOrAfter(q()))}modelChanged(t){this.studentSubmission().isSynced=!1}explanationChanged(t){this.studentSubmission().isSynced=!1,this.explanationText=t}setSubmissionVersion(t){return ge(this,null,function*(){this.submissionVersion=t,yield this.updateViewFromSubmissionVersion()})}updateViewFromSubmissionVersion(){return ge(this,null,function*(){if(this.submissionVersion?.content){let t=this.submissionVersion.content.substring(0,this.submissionVersion.content.indexOf("; Explanation:"));yield this.modelingEditor().apollonEditor.nextRender,t=t.replace("Model: ",""),this.umlModel=JSON.parse(t);let i=13;this.explanationText=this.submissionVersion.content.substring(this.submissionVersion.content.indexOf("Explanation:")+i)??"",this.changeDetectorReference.detectChanges()}})}notifyTriggerSave(){this.saveCurrentExercise.emit()}static \u0275fac=(()=>{let t;return function(o){return(t||(t=D(n)))(o||n)}})();static \u0275cmp=E({type:n,selectors:[["jhi-modeling-submission-exam"]],viewQuery:function(i,o){i&1&&L(o.modelingEditor,_e,5),i&2&&J()},inputs:{studentSubmission:[1,"studentSubmission"],exercise:[1,"exercise"],isSubmissionSynced:[1,"isSubmissionSynced"]},outputs:{saveCurrentExercise:"saveCurrentExercise"},features:[j([{provide:I,useExisting:n}]),P],decls:1,vars:1,consts:[[1,"d-flex","justify-content-between","align-items-center"],[1,"text-align-left","fw-normal","mb-0"],[3,"jhiTranslate","translateValues"],[3,"save","submission"],[1,"col-12",3,"examTimeline"],["left-header","",1,"exercise-title"],["left-body","",1,"submission-container","d-flex","flex-column","ps-2","mt-3","w-100"],[1,"row","flex-grow-1"],["right-header","",3,"icon"],["right-header","","jhiTranslate","artemisApp.modelingSubmission.problemStatement"],["right-body",""],[3,"includedInOverallScore"],[1,"col-12","editor-large"],[3,"onModelChanged","explanationChange","umlModel","diagramType","readOnly","withExplanation","explanation"],[3,"problemStatementUpdateEvent","exercise"],[1,"mb-3","markdown-preview"],[3,"innerHTML"]],template:function(i,o){i&1&&h(0,yt,49,16),i&2&&p(o.exercise()?0:-1)},dependencies:[O,R,re,oe,ct,_e,A,ne,F],styles:[".submission-container[_ngcontent-%COMP%]{min-height:calc(100vh - 173px)}jhi-modeling-editor[_ngcontent-%COMP%]{width:100%}jhi-modeling-assessment[_ngcontent-%COMP%]{width:100%}.editor-large[_ngcontent-%COMP%]{min-height:100vh}"],changeDetection:0})}return n})();var ft=bt(gt());var At=n=>({points:n});function Ot(n,d){if(n&1&&(e(0,`
            `),u(1,"jhi-included-in-score-badge",7),e(2,`
        `)),n&2){let t=m();s(),c("includedInOverallScore",t.quizConfiguration().includedInOverallScore)}}function Mt(n,d){if(n&1){let t=b();e(0,`
                                `),a(1,"span",12),f("click",function(){x(t);let o=m().$implicit,r=m(2);return _(r.navigateToQuestion(o.id))}),e(2,`
                                    `),a(3,"b",13),e(4,"DD"),l(),e(5,`
                                `),l(),e(6,`
                            `)}if(n&2){let t,i,o=m().$implicit,r=k(7),v=k(10),y=m(2);s(),c("ngbTooltip",(t=y.dragAndDropMappings.get(o.id))!=null&&t.length?r:v)("ngClass",(i=y.dragAndDropMappings.get(o.id))!=null&&i.length?"changed-question":"")}}function It(n,d){if(n&1){let t=b();e(0,`
                                `),a(1,"span",14),f("click",function(){x(t);let o=m().$implicit,r=m(2);return _(r.navigateToQuestion(o.id))}),e(2,`
                                    `),a(3,"b",13),e(4,"MC"),l(),e(5,`
                                `),l(),e(6,`
                            `)}if(n&2){let t,i,o=m().$implicit,r=k(7),v=k(10),y=m(2);s(),c("ngbTooltip",(t=y.selectedAnswerOptions.get(o.id))!=null&&t.length?r:v)("ngClass",(i=y.selectedAnswerOptions.get(o.id))!=null&&i.length?"changed-question":"")}}function Dt(n,d){if(n&1){let t=b();e(0,`
                                `),a(1,"span",15),f("click",function(){x(t);let o=m().$implicit,r=m(2);return _(r.navigateToQuestion(o.id))}),e(2,`
                                    `),a(3,"b",13),e(4,"SA"),l(),e(5,`
                                `),l(),e(6,`
                            `)}if(n&2){let t,i,o=m().$implicit,r=k(7),v=k(10),y=m(2);s(),c("ngbTooltip",(t=y.shortAnswerSubmittedTexts.get(o.id))!=null&&t.length?r:v)("ngClass",(i=y.shortAnswerSubmittedTexts.get(o.id))!=null&&i.length?"changed-question":"")}}function Pt(n,d){n&1&&(e(0),T(1,"artemisTranslate")),n&2&&C("",w(1,1,"artemisApp.quizExercise.explanationAnswered")," ")}function Ft(n,d){n&1&&(e(0),T(1,"artemisTranslate")),n&2&&C("",w(1,1,"artemisApp.quizExercise.explanationNotAnswered")," ")}function Vt(n,d){if(n&1&&(e(0,`
                        `),a(1,"div",11),e(2,`
                            `),h(3,Mt,7,2)(4,It,7,2)(5,Dt,7,2)(6,Pt,2,3,"ng-template",null,0,Ee),e(8,`
                            `),h(9,Ft,2,3,"ng-template",null,1,Ee),e(11,`
                        `),l(),e(12,`
                    `)),n&2){let t=d.$implicit,i=m(2);s(3),p(t.type===i.DRAG_AND_DROP?3:-1),s(),p(t.type===i.MULTIPLE_CHOICE?4:-1),s(),p(t.type===i.SHORT_ANSWER?5:-1)}}function kt(n,d){if(n&1&&(e(0,`
        `),a(1,"div",8),e(2,`
            `),a(3,"div",9),e(4,`
                `),a(5,"div",10),e(6,`
                    `),H(7,Vt,13,3,null,null,B),l(),e(9,`
            `),l(),e(10,`
        `),l(),e(11,`
    `)),n&2){let t=m();s(7),$(t.quizConfiguration().quizQuestions)}}function qt(n,d){if(n&1){let t=b();e(0,`
                        `),a(1,"jhi-multiple-choice-question",17),f("selectedAnswerOptionsChange",function(o){x(t);let r=m().$implicit,v=m(2);return _(v.selectedAnswerOptions.set(r.id,o))}),l(),e(2,`
                    `)}if(n&2){let t=m(),i=t.$implicit,o=t.$index,r=m(2);s(),de("id","question",i.id,""),c("question",i)("selectedAnswerOptions",r.selectedAnswerOptions.get(i.id))("fnOnSelection",r.onSelectionChanged.bind(r))("quizQuestions",r.quizConfiguration().quizQuestions)("questionIndex",o+1)("clickDisabled",r.readonly())}}function zt(n,d){if(n&1){let t=b();e(0,`
                        `),a(1,"jhi-drag-and-drop-question",18),f("mappingsChange",function(o){x(t);let r=m().$implicit,v=m(2);return _(v.dragAndDropMappings.set(r.id,o))}),l(),e(2,`
                    `)}if(n&2){let t=m(),i=t.$implicit,o=t.$index,r=m(2);s(),de("id","question",i.id,""),c("question",i)("mappings",r.dragAndDropMappings.get(i.id))("onMappingUpdate",r.onSelectionChanged.bind(r))("questionIndex",o+1)("clickDisabled",r.readonly())}}function Ut(n,d){if(n&1){let t=b();e(0,`
                        `),a(1,"jhi-short-answer-question",19),f("submittedTextsChange",function(o){x(t);let r=m().$implicit,v=m(2);return _(v.shortAnswerSubmittedTexts.set(r.id,o))}),l(),e(2,`
                    `)}if(n&2){let t=m(),i=t.$implicit,o=t.$index,r=m(2);s(),de("id","question",i.id,""),c("question",i)("submittedTexts",r.shortAnswerSubmittedTexts.get(i.id))("fnOnSubmittedTextUpdate",r.onSelectionChanged.bind(r))("questionIndex",o+1)("clickDisabled",r.readonly())}}function Lt(n,d){if(n&1&&(e(0,`
                `),a(1,"div"),e(2,`
                    `),e(3,`
                    `),h(4,qt,3,8)(5,zt,3,7)(6,Ut,3,7),l(),e(7,`
            `)),n&2){let t=d.$implicit,i=m(2);s(4),p(t.type===i.MULTIPLE_CHOICE?4:-1),s(),p(t.type===i.DRAG_AND_DROP?5:-1),s(),p(t.type===i.SHORT_ANSWER?6:-1)}}function jt(n,d){if(n&1&&(e(0,`
        `),a(1,"div",16),e(2,`
            `),H(3,Lt,8,3,null,null,B),l(),e(5,`
    `)),n&2){let t=m();s(3),$(t.quizConfiguration().quizQuestions)}}var un=(()=>{class n extends I{quizService=g(st);exerciseType=N.QUIZ;DRAG_AND_DROP=V.DRAG_AND_DROP;MULTIPLE_CHOICE=V.MULTIPLE_CHOICE;SHORT_ANSWER=V.SHORT_ANSWER;ButtonSize=Ze;ButtonType=ue;IncludedInOverallScore=Q;mcQuestionComponents=me(ve);dndQuestionComponents=me(he);shortAnswerQuestionComponents=me(be);studentSubmission=S.required();exercise=S();examTimeline=S(!1);quizConfiguration=S.required();saveCurrentExercise=U();selectedAnswerOptions=new Map;dragAndDropMappings=new Map;shortAnswerSubmittedTexts=new Map;ngOnInit(){ft.polyfill(),this.initQuiz(),this.updateViewFromSubmission()}getSubmission(){return this.studentSubmission()}getExerciseId(){return this.quizConfiguration().id}getExercise(){return this.quizConfiguration()}initQuiz(){this.examTimeline()||this.quizService.randomizeOrder(this.quizConfiguration().quizQuestions,this.quizConfiguration().randomizeQuestionOrder),this.selectedAnswerOptions=new Map,this.dragAndDropMappings=new Map,this.shortAnswerSubmittedTexts=new Map;let t=this.quizConfiguration().quizQuestions;t&&t.forEach(i=>{switch(i.type){case V.MULTIPLE_CHOICE:this.selectedAnswerOptions.set(i.id,[]);break;case V.DRAG_AND_DROP:this.dragAndDropMappings.set(i.id,[]);break;case V.SHORT_ANSWER:this.shortAnswerSubmittedTexts.set(i.id,[]);break;default:ee("Unknown question type: "+i);break}},this)}navigateToQuestion(t){let i=document.getElementById("question"+t);i&&i.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}updateViewFromSubmission(){this.selectedAnswerOptions=new Map,this.dragAndDropMappings=new Map,this.shortAnswerSubmittedTexts=new Map;let t=this.quizConfiguration().quizQuestions;t?.length&&t.forEach(i=>{let o=this.studentSubmission()?.submittedAnswers?.find(r=>r.quizQuestion?.id===i.id);switch(i.type){case V.MULTIPLE_CHOICE:if(o){let r=o.selectedOptions;this.selectedAnswerOptions.set(i.id,r?te(r):[])}else this.selectedAnswerOptions.set(i.id,[]);break;case V.DRAG_AND_DROP:if(o){let r=o.mappings;this.dragAndDropMappings.set(i.id,r?te(r):[])}else this.dragAndDropMappings.set(i.id,[]);break;case V.SHORT_ANSWER:if(o){let r=o.submittedTexts;this.shortAnswerSubmittedTexts.set(i.id,r?te(r):[])}else this.shortAnswerSubmittedTexts.set(i.id,[]);break;default:ee("Unknown question type: "+i);break}},this)}onSelectionChanged(){this.studentSubmission().isSynced=!1}hasUnsavedChanges(){return!this.studentSubmission().isSynced}updateSubmissionFromView(){this.studentSubmission().submittedAnswers=[],this.selectedAnswerOptions.forEach((t,i)=>{let o=this.quizConfiguration().quizQuestions?.find(function(v){return v.id===Number(i)});if(!o){ee("question not found for ID: "+i);return}let r=new pt;r.quizQuestion=o,r.selectedOptions=t,this.studentSubmission().submittedAnswers.push(r)},this),this.dragAndDropMappings.forEach((t,i)=>{let o=this.quizConfiguration().quizQuestions?.find(function(v){return v.id===Number(i)});if(!o){ee("question not found for ID: "+i);return}let r=new dt;r.quizQuestion=o,r.mappings=t,this.studentSubmission().submittedAnswers.push(r)},this),this.shortAnswerSubmittedTexts.forEach((t,i)=>{let o=this.quizConfiguration().quizQuestions?.find(function(v){return v.id===Number(i)});if(!o){ee("question not found for ID: "+i);return}let r=new ut;r.quizQuestion=o,r.submittedTexts=t,this.studentSubmission().submittedAnswers.push(r)},this)}updateViewFromSubmissionVersion(){this.studentSubmission().submittedAnswers=JSON.parse(this.submissionVersion.content),this.updateViewFromSubmission()}setSubmissionVersion(t){this.submissionVersion=t,this.updateViewFromSubmissionVersion()}notifyTriggerSave(){this.saveCurrentExercise.emit()}static \u0275fac=(()=>{let t;return function(o){return(t||(t=D(n)))(o||n)}})();static \u0275cmp=E({type:n,selectors:[["jhi-quiz-submission-exam"]],viewQuery:function(i,o){i&1&&(L(o.mcQuestionComponents,ve,5),L(o.dndQuestionComponents,he,5),L(o.shortAnswerQuestionComponents,be,5)),i&2&&J(3)},inputs:{studentSubmission:[1,"studentSubmission"],exercise:[1,"exercise"],examTimeline:[1,"examTimeline"],quizConfiguration:[1,"quizConfiguration"]},outputs:{saveCurrentExercise:"saveCurrentExercise"},features:[j([{provide:I,useExisting:n}]),P],decls:21,vars:8,consts:[["tooltipExplanationTranslate",""],["tooltipNotExplanationTranslate",""],[1,"d-flex","justify-content-between","align-items-center"],[1,"text-align-left","fw-normal","mb-0"],["jhiTranslate","artemisApp.examParticipation.points",3,"translateValues"],[3,"save","submission"],[1,"w-auto","m-0","pb-5"],[3,"includedInOverallScore"],[1,"position-fixed","d-flex","align-items-center","justify-content-center"],[1,"p-0","col-md-auto","quiz-navigation","sticky-top"],[1,"stepwizardquiz","col-6"],[1,"stepwizardquiz__step","mb-3"],[1,"btn","btn-light","btn-circle","stepbutton","stepwizardquiz-circle","draganddropcolor-question",3,"click","ngbTooltip","ngClass"],[1,"fa"],[1,"btn","btn-light","btn-circle","stepbutton","stepwizardquiz-circle","multiplechoicecolor-question",3,"click","ngbTooltip","ngClass"],[1,"btn","btn-light","btn-circle","stepbutton","stepwizardquiz-circle","shortanswercolor-question",3,"click","ngbTooltip","ngClass"],[1,"ms-5"],[3,"selectedAnswerOptionsChange","id","question","selectedAnswerOptions","fnOnSelection","quizQuestions","questionIndex","clickDisabled"],[3,"mappingsChange","id","question","mappings","onMappingUpdate","questionIndex","clickDisabled"],[3,"submittedTextsChange","id","question","submittedTexts","fnOnSubmittedTextUpdate","questionIndex","clickDisabled"]],template:function(i,o){if(i&1&&(a(0,"div",2),e(1,`
    `),a(2,"h3",3),e(3,`
        `),a(4,"span"),e(5),l(),e(6,`
        `),u(7,"span",4),e(8,`
        `),h(9,Ot,3,1),l(),e(10,`
    `),a(11,"jhi-exercise-save-button",5),f("save",function(){return o.notifyTriggerSave()}),l(),e(12,`
`),l(),e(13,`
`),u(14,"hr"),e(15,`

`),a(16,"div",6),e(17,`
    `),h(18,kt,12,0)(19,jt,6,0),l(),e(20,`
`)),i&2){let r;s(5),C(`
            `,(r=o.quizConfiguration().exerciseGroup)==null?null:r.title,`
        `),s(2),c("translateValues",Y(6,At,o.quizConfiguration().maxPoints)),s(2),p(o.quizConfiguration().includedInOverallScore!==o.IncludedInOverallScore.INCLUDED_COMPLETELY?9:-1),s(2),c("submission",o.studentSubmission()),s(7),p(o.quizConfiguration().quizQuestions&&!o.examTimeline()?18:-1),s(),p(o.quizConfiguration().quizQuestions?19:-1)}},dependencies:[O,R,re,He,qe,ve,he,be,F],styles:[".quiz-navigation[_ngcontent-%COMP%]   .draganddropcolor-question[_ngcontent-%COMP%]{background-color:var(--quiz-participation-footer-dnd-background)!important}.quiz-navigation[_ngcontent-%COMP%]   .multiplechoicecolor-question[_ngcontent-%COMP%]{background-color:var(--quiz-participation-footer-mc-background)!important}.quiz-navigation[_ngcontent-%COMP%]   .shortanswercolor-question[_ngcontent-%COMP%]{background-color:var(--quiz-participation-footer-sa-background)!important}.quiz-navigation[_ngcontent-%COMP%]   .changed-question[_ngcontent-%COMP%]{background-color:var(--quiz-participation-footer-changed-background)!important}.stepwizardquiz__step[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%]{vertical-align:initial}.stepwizardquiz__step[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{cursor:help;opacity:1!important}.btn-circle[_ngcontent-%COMP%]{width:30px;height:30px;text-align:center;font-size:12px;font-family:Arial,Helvetica,sans-serif;border-radius:15px;border-spacing:5px;padding:6px 0}.btn-circle.btn-light[_ngcontent-%COMP%]{border-color:#fff}.quiz-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}.quiz-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;justify-content:space-between}.quiz-question[_ngcontent-%COMP%]{flex:1;margin-bottom:20px}.quiz-options[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;justify-content:space-around}@media print{.quiz-container[_ngcontent-%COMP%]{height:auto;page-break-inside:avoid}}"]})}return n})();var Qt=(n,d)=>({points:n,bonusPoints:d}),vt=n=>({count:n});function Rt(n,d){if(n&1&&(e(0,`
                `),u(1,"jhi-included-in-score-badge",15),e(2,`
            `)),n&2){let t=m(2);s(),c("includedInOverallScore",t.exercise().includedInOverallScore)}}function Bt(n,d){if(n&1){let t=b();e(0,`
                `),a(1,"jhi-exam-exercise-update-highlighter",16),f("problemStatementUpdateEvent",function(o){x(t);let r=m(2);return _(r.updateProblemStatement(o))}),l(),e(2,`
            `)}if(n&2){let t=m(2);s(),c("exercise",t.exercise())}}function Ht(n,d){if(n&1&&(e(0,`
                `),a(1,"p",17),e(2,`
                    `),u(3,"span",18),e(4,`
                `),l(),e(5,`
            `)),n&2){let t=m(2);s(3),c("innerHTML",t.problemStatementHtml,X)}}function $t(n,d){if(n&1){let t=b();e(0,`
    `),a(1,"div",1),e(2,`
        `),a(3,"h3",2),e(4,`
            `),a(5,"span"),e(6),l(),e(7,`
            `),a(8,"span",3),e(9,`
            `),l(),e(10,`
            `),h(11,Rt,3,1),l(),e(12,`
        `),a(13,"jhi-exercise-save-button",4),f("save",function(){x(t);let o=m();return _(o.notifyTriggerSave())}),l(),e(14,`
    `),l(),e(15,`
    `),u(16,"hr"),e(17,`
    `),e(18,`
    `),a(19,"jhi-resizeable-container",5),e(20,`
        `),e(21,`
        `),a(22,"span",6),e(23),T(24,"artemisTranslate"),l(),e(25,`
        `),a(26,"div",7),e(27,`
            `),a(28,"div",8),e(29,`
                `),a(30,"div"),e(31,`
                    `),u(32,"span",9),e(33,`
                    `),u(34,"span",10),e(35,`
                `),l(),e(36,`
                `),W(37),e(38,`
                    `),a(39,"textarea",11,0),Ve("ngModelChange",function(o){x(t);let r=m();return Fe(r.answer,o)||(r.answer=o),_(o)}),f("keydown.tab",function(o){x(t);let r=k(40),v=m();return _(v.onTextEditorTab(r,o))})("input",function(o){x(t);let r=m();return _(r.onTextEditorInput(o))}),l(),e(41,`
                `),G(),e(42,`
            `),l(),e(43,`
        `),l(),e(44,`
        `),e(45,`
        `),e(46,`
        `),u(47,"fa-icon",12),e(48,`\xA0
        `),u(49,"span",13),e(50,`
        `),e(51,`
        `),W(52,14),e(53,`
            `),h(54,Bt,3,1)(55,Ht,6,1),G(),e(56,`
        `),e(57,`
    `),l(),e(58,`
`)}if(n&2){let t,i=m();s(6),C(`
                `,(t=i.exercise().exerciseGroup)==null?null:t.title,`
            `),s(2),c("jhiTranslate",i.exercise().bonusPoints?"artemisApp.examParticipation.bonus":"artemisApp.examParticipation.points")("translateValues",Z(18,Qt,i.exercise().maxPoints,i.exercise().bonusPoints)),s(3),p(i.exercise().includedInOverallScore!==i.IncludedInOverallScore.INCLUDED_COMPLETELY?11:-1),s(2),c("submission",i.studentSubmission()),s(6),c("examTimeline",i.examTimeline()),s(4),K(i.examTimeline()?i.exercise().title:w(24,16,"artemisApp.exam.yourSolution")),s(9),c("translateValues",Y(21,vt,i.wordCount)),s(2),c("translateValues",Y(23,vt,i.characterCount)),s(5),c("maxLength",i.maxCharacterCount),Pe("ngModel",i.answer),c("readOnly",i.readonly()||!i.studentSubmission())("disabled",i.readonly()||!i.studentSubmission()),s(8),c("icon",i.faListAlt),s(7),p(i.exercise()?54:-1),s(),p(i.problemStatementHtml?55:-1)}}var kn=(()=>{class n extends I{textService=g(mt);stringCountService=g(at);exerciseType=N.TEXT;studentSubmission=S.required();exercise=S.required();saveCurrentExercise=U();IncludedInOverallScore=Q;maxCharacterCount=3e4;answer;problemStatementHtml;textEditorInput=new se;faListAlt=Ye;onTextEditorTab=et;ngOnInit(){this.problemStatementHtml=ie(this.exercise()?.problemStatement),this.updateViewFromSubmission()}getExerciseId(){return this.exercise().id}getExercise(){return this.exercise()}updateProblemStatement(t){this.problemStatementHtml=t,this.changeDetectorReference.detectChanges()}getSubmission(){return this.studentSubmission()}updateViewFromSubmission(){this.answer=this.studentSubmission().text??""}hasUnsavedChanges(){return!this.studentSubmission().isSynced}updateSubmissionFromView(){this.studentSubmission().text=this.answer,this.studentSubmission().language=this.textService.predictLanguage(this.answer)}get wordCount(){return this.stringCountService.countWords(this.answer)}get characterCount(){return this.stringCountService.countCharacters(this.answer)}onTextEditorInput(t){this.studentSubmission().isSynced=!1,this.textEditorInput.next(t.target.value)}updateViewFromSubmissionVersion(){this.submissionVersion?.content?this.answer=this.submissionVersion.content:this.answer=""}setSubmissionVersion(t){this.submissionVersion=t,this.updateViewFromSubmissionVersion()}notifyTriggerSave(){this.saveCurrentExercise.emit()}static \u0275fac=(()=>{let t;return function(o){return(t||(t=D(n)))(o||n)}})();static \u0275cmp=E({type:n,selectors:[["jhi-text-editor-exam"]],inputs:{studentSubmission:[1,"studentSubmission"],exercise:[1,"exercise"]},outputs:{saveCurrentExercise:"saveCurrentExercise"},features:[j([{provide:I,useExisting:n}]),P],decls:1,vars:1,consts:[["textEditor",""],[1,"d-flex","justify-content-between","align-items-center"],[1,"text-align-left","fw-normal","mb-0"],[3,"jhiTranslate","translateValues"],[3,"save","submission"],[1,"col-12",3,"examTimeline"],["left-header","",1,"exercise-title"],["left-body","",1,"text-editor-grid","mt-4","ps-2","pb-2","w-100"],[1,"grid-area-main"],["jhiTranslate","artemisApp.textExercise.wordCount",1,"badge","bg-primary","mb-2",3,"translateValues"],["jhiTranslate","artemisApp.textExercise.characterCount",1,"badge","bg-primary","mb-2",3,"translateValues"],["id","text-editor",1,"text-editor-textarea",3,"ngModelChange","keydown.tab","input","maxLength","ngModel","readOnly","disabled"],["right-header","",3,"icon"],["right-header","","jhiTranslate","artemisApp.exercise.problemStatement"],["right-body",""],[3,"includedInOverallScore"],[3,"problemStatementUpdateEvent","exercise"],[1,"markdown-preview","mb-3"],[3,"innerHTML"]],template:function(i,o){i&1&&h(0,$t,59,25),i&2&&p(o.exercise()?0:-1)},dependencies:[O,R,re,oe,Qe,Le,je,Ne,A,ne,F],styles:['.text-editor-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-template-areas:"problem-statement" "team-info" "main"}@media (min-width: 768px){.text-editor-grid[_ngcontent-%COMP%]{grid-template-columns:1fr min-content;grid-template-areas:"problem-statement team-info" "main              team-info"}}.text-editor-grid[_ngcontent-%COMP%]   .grid-area-problem-statement[_ngcontent-%COMP%]{grid-area:problem-statement}.text-editor-grid[_ngcontent-%COMP%]   .grid-area-team-info[_ngcontent-%COMP%]{grid-area:team-info;justify-self:flex-end}.text-editor-grid[_ngcontent-%COMP%]   .grid-area-main[_ngcontent-%COMP%]{grid-area:main}.text-editor-textarea[_ngcontent-%COMP%]{width:100%;max-width:750px;height:50vh;padding:10px 12px;border:1px solid var(--text-editor-border-color);border-radius:2px;background-color:var(--text-editor-background);color:var(--text-editor-color)}.text-editor-textarea[_ngcontent-%COMP%]:focus{outline:none;border:1px solid var(--artemis-dark);background-color:var(--text-editor-focus-background);box-shadow:0 0 20px #0000c80a}div.positive-feedback[_ngcontent-%COMP%]{color:#155724;background-color:#d4edda}div.negative-feedback[_ngcontent-%COMP%]{color:#721c24;background-color:#f8d7da}div.neutral-feedback[_ngcontent-%COMP%]{color:#383d41;background-color:#e2e3e5}div[_ngcontent-%COMP%]   .unreferencedFeedback[_ngcontent-%COMP%]{background-color:#f5f5f5}']})}return n})();var Gt=["fileInput"],Yt=(n,d)=>({points:n,bonusPoints:d}),Xt=n=>({filename:n});function Jt(n,d){if(n&1&&(e(0,`
            `),u(1,"jhi-included-in-score-badge",10),e(2,`
        `)),n&2){let t=m(2);s(),c("includedInOverallScore",t.exercise().includedInOverallScore)}}function Kt(n,d){if(n&1&&(e(0,`
                                `),a(1,"div",20),e(2,`
                                    `),a(3,"span",21),e(4),T(5,"uppercase"),l(),e(6,`
                                `),l(),e(7,`
                            `)),n&2){let t=d.$implicit;s(4),C(`
                                        `,w(5,1,t),`
                                    `)}}function Zt(n,d){if(n&1){let t=b();e(0,`
                    `),a(1,"div",11),e(2,`
                        `),a(3,"div",12),e(4,`
                            `),u(5,"label",13),e(6,`
                            `),a(7,"div",14),e(8,`
                                `),a(9,"div",15),e(10,`
                                    `),a(11,"input",16,0),f("change",function(o){x(t);let r=m(2);return _(r.setFileSubmissionForExercise(o))}),l(),e(13,`
                                `),l(),e(14,`
                                `),a(15,"div",17),e(16,`
                                    `),a(17,"button",18),f("click",function(){x(t);let o=m(2);return _(o.saveUploadedFile())}),l(),e(18,`
                                `),l(),e(19,`
                            `),l(),e(20,`
                            `),u(21,"p",19),e(22,`
                            `),H(23,Kt,8,3,null,null,B),l(),e(25,`
                    `),l(),e(26,`
                `)}if(n&2){let t=m(2);s(23),$(t.exercise().filePattern.split(","))}}function ei(n,d){if(n&1&&(e(0,`
                        `),a(1,"span",25),e(2),T(3,"uppercase"),l(),e(4,`
                    `)),n&2){let t=m(3);s(2),C(`
                            `,w(3,1,t.submittedFileExtension),`
                        `)}}function ti(n,d){if(n&1){let t=b();e(0,`
                `),a(1,"div",22),e(2,`
                    `),u(3,"h6",23),e(4,`
                    `),a(5,"a",24),f("click",function(){x(t);let o=m(2);return _(o.downloadFile(o.studentSubmission().filePath))}),l(),e(6,`
                    `),h(7,ei,5,3),l(),e(8,`
            `)}if(n&2){let t=m(2);s(3),c("translateValues",Y(2,Xt,t.submittedFileName)),s(4),p(t.submittedFileExtension?7:-1)}}function ii(n,d){n&1&&(e(0,`
                `),a(1,"div"),e(2,`
                    `),u(3,"h6",26),e(4,`
                `),l(),e(5,`
            `))}function ni(n,d){if(n&1){let t=b();e(0,`
                `),a(1,"jhi-exam-exercise-update-highlighter",27),f("problemStatementUpdateEvent",function(o){x(t);let r=m(2);return _(r.updateProblemStatement(o))}),l(),e(2,`
            `)}if(n&2){let t=m(2);s(),c("exercise",t.exercise())}}function oi(n,d){if(n&1&&(e(0,`
                `),a(1,"p",28),e(2,`
                    `),u(3,"span",29),e(4,`
                `),l(),e(5,`
            `)),n&2){let t=m(2);s(3),c("innerHTML",t.problemStatementHtml,X)}}function ri(n,d){if(n&1&&(e(0,`
    `),a(1,"h3",1),e(2,`
        `),a(3,"span"),e(4),l(),e(5,`
        `),a(6,"span",2),e(7,`
        `),l(),e(8,`
        `),h(9,Jt,3,1),l(),e(10,`
    `),u(11,"hr"),e(12,`
    `),a(13,"jhi-resizeable-container",3),e(14,`
        `),e(15,`
        `),a(16,"span",4),e(17),T(18,"artemisTranslate"),l(),e(19,`
        `),a(20,"div",5),e(21,`
            `),a(22,"div",6),e(23,`
                `),h(24,Zt,27,0),l(),e(25,`
            `),h(26,ti,9,4)(27,ii,6,0),l(),e(28,`
        `),e(29,`
        `),e(30,`
        `),u(31,"fa-icon",7),e(32,`\xA0
        `),u(33,"span",8),e(34,`
        `),W(35,9),e(36,`
            `),e(37,`
            `),h(38,ni,3,1)(39,oi,6,1),G(),e(40,`
        `),e(41,`
    `),l(),e(42,`
`)),n&2){let t,i,o=m();s(4),C(`
            `,(t=o.exercise().exerciseGroup)==null?null:t.title,`
        `),s(2),c("jhiTranslate",o.exercise().bonusPoints?"artemisApp.examParticipation.bonus":"artemisApp.examParticipation.points")("translateValues",Z(14,Yt,o.exercise().maxPoints,o.exercise().bonusPoints)),s(3),p(o.exercise().includedInOverallScore!==o.IncludedInOverallScore.INCLUDED_COMPLETELY?9:-1),s(4),c("examTimeline",o.examTimeline()),s(4),K(o.examTimeline()?o.exercise().title:w(18,12,"artemisApp.exam.yourSolution")),s(7),p(o.isActive&&!o.result&&o.exercise()&&o.studentSubmission()&&!o.readonly()?24:-1),s(2),p(o.submittedFileName&&((i=o.studentSubmission())!=null&&i.filePath)?26:-1),s(),p(!o.submittedFileName&&o.examTimeline()?27:-1),s(4),c("icon",o.farListAlt),s(7),p(o.exercise()?38:-1),s(),p(o.problemStatementHtml?39:-1)}}var no=(()=>{class n extends I{fileUploadSubmissionService=g(ot);alertService=g(pe);translateService=g($e);fileService=g(rt);exerciseType=N.FILE_UPLOAD;fileInput=le("fileInput");studentSubmission=De.required();exercise=S.required();problemStatementHtml;submittedFileName;submittedFileExtension;participation;result;submissionFile;ButtonType=ue;IncludedInOverallScore=Q;filePath;farListAlt=xe;ngOnInit(){this.problemStatementHtml=ie(this.exercise()?.problemStatement),this.updateViewFromSubmission()}updateProblemStatement(t){this.problemStatementHtml=t,this.changeDetectorReference.detectChanges()}setFileSubmissionForExercise(t){if(t.target.files.length){let o=t.target.files[0];this.exercise().filePattern.split(",").some(v=>o.name.toLowerCase().endsWith(v))?o.size>8388608?this.alertService.error("artemisApp.fileUploadSubmission.fileTooBigError",{fileName:o.name}):(this.submissionFile=o,this.studentSubmission().isSynced=!1):this.alertService.error("artemisApp.fileUploadSubmission.fileExtensionError")}}downloadFile(t){this.fileService.downloadFile(t)}get isActive(){return this.exercise()&&(!this.exercise().dueDate||q(this.exercise().dueDate).isSameOrAfter(q()))}getExerciseId(){return this.exercise().id}getExercise(){return this.exercise()}hasUnsavedChanges(){return!this.studentSubmission().isSynced}getSubmission(){return this.studentSubmission()}updateSubmissionFromView(){}updateViewFromSubmission(){if(this.studentSubmission().isSynced&&this.studentSubmission().filePath||this.examTimeline()&&this.studentSubmission().filePath){this.submissionFile=void 0;let t=this.studentSubmission().filePath.split("/");this.submittedFileName=t.last();let i=this.submittedFileName.split(".");this.submittedFileExtension=i.last()}}saveUploadedFile(){this.submissionFile&&this.fileUploadSubmissionService.update(this.studentSubmission(),this.exercise().id,this.submissionFile).subscribe({next:t=>{let i=t.body;this.studentSubmission().filePath=i.filePath,this.studentSubmission().isSynced=!0,this.studentSubmission().submitted=!0,this.updateViewFromSubmission()},error:()=>this.onError()})}onError(){this.alertService.error(this.translateService.instant("error.fileUploadSavingError"))}setSubmissionVersion(t){throw this.submissionVersion=t,new Error("Submission versions are not supported for file upload exercises.")}static \u0275fac=(()=>{let t;return function(o){return(t||(t=D(n)))(o||n)}})();static \u0275cmp=E({type:n,selectors:[["jhi-file-upload-submission-exam"]],viewQuery:function(i,o){i&1&&L(o.fileInput,Gt,5),i&2&&J()},inputs:{studentSubmission:[1,"studentSubmission"],exercise:[1,"exercise"]},outputs:{studentSubmission:"studentSubmissionChange"},features:[j([{provide:I,useExisting:n}]),P],decls:1,vars:1,consts:[["fileInput",""],[1,"text-align-left","fw-normal"],[3,"jhiTranslate","translateValues"],[3,"examTimeline"],["left-header","",1,"exercise-title"],["left-body","",1,"px-2","pb-2","w-100"],[1,"row"],["right-header","",3,"icon"],["id","problem-statement","right-header","","jhiTranslate","artemisApp.exercise.problemStatement"],["right-body",""],[3,"includedInOverallScore"],[1,"col-12","col-md-10"],[1,"form-group"],["for","fileUploadInput","jhiTranslate","artemisApp.fileUploadSubmission.selectFile",1,"form-control-label"],[1,"input-group","background-file"],[1,"custom-file","overflow-ellipsis"],["id","fileUploadInput","type","file",1,"custom-file-input",3,"change"],[1,"col-4"],["id","file-upload-submit","jhiTranslate","artemisApp.examParticipation.uploadFile",1,"btn","btn-primary",3,"click"],["jhiTranslate","artemisApp.fileUploadExercise.supportedFileExtensions",1,"d-inline-block"],[1,"d-inline-block"],[1,"ms-1","badge","bg-info"],[1,"card-text"],["jhiTranslate","artemisApp.fileUploadSubmission.submittedFile",3,"translateValues"],["jhiTranslate","artemisApp.fileUploadSubmission.download",1,"text-primary",3,"click"],[1,"ms-2","badge","bg-info"],["jhiTranslate","artemisApp.timeline.fileUploadNotSubmitted"],[3,"problemStatementUpdateEvent","exercise"],[1,"mb-3","markdown-preview"],[3,"innerHTML"]],template:function(i,o){i&1&&h(0,ri,43,17),i&2&&p(o.exercise()?0:-1)},dependencies:[O,R,oe,A,ne,Ue,F],encapsulation:2})}return n})();function si(n,d){if(n&1){let t=b();e(0,`
            `),a(1,"jhi-exam-live-event",2),f("onAcknowledge",function(){let o=x(t).$implicit,r=m();return _(r.acknowledgeEvent(o))})("onNavigate",function(){let o=x(t).$implicit,r=m();return _(r.navigateToExercise(o))}),l(),e(2,`
        `)}if(n&2){let t=d.$implicit,i=m();s(),c("event",t)("showAcknowledge",i.unacknowledgedEvents.includes(t))}}function ai(n,d){if(n&1){let t=b();e(0,`
        `),a(1,"button",3),f("click",function(){x(t);let o=m();return _(o.closeOverlay())}),e(2,"Close"),l(),e(3,`
    `)}}function li(n,d){if(n&1){let t=b();e(0,`
        `),a(1,"button",3),f("click",function(){x(t);let o=m();return _(o.acknowledgeAllUnacknowledgedEvents())}),e(2,`
            `),u(3,"fa-icon",4),e(4,`
            `),u(5,"span",5),e(6,`
        `),l(),e(7,`
    `)}if(n&2){let t=m();s(3),c("icon",t.faCheck)}}var ht=(()=>{class n{liveEventsService=g(fe);activeModal=g(Re);examExerciseUpdateService=g(nt);allLiveEventsSubscription;newLiveEventsSubscription;unacknowledgedEvents=[];eventsToDisplay;events=[];examStartDate;faCheck=Xe;ExamLiveEventType=M;ngOnDestroy(){this.allLiveEventsSubscription?.unsubscribe(),this.newLiveEventsSubscription?.unsubscribe()}ngOnInit(){this.allLiveEventsSubscription=this.liveEventsService.observeAllEvents(we).subscribe(t=>{this.events=t.filter(i=>!(i.eventType===M.PROBLEM_STATEMENT_UPDATE&&i.createdDate.isBefore(this.examStartDate))),this.eventsToDisplay||this.updateEventsToDisplay()}),this.newLiveEventsSubscription=this.liveEventsService.observeNewEventsAsUser(Te,this.examStartDate).subscribe(t=>{this.unacknowledgedEvents.unshift(t),this.updateEventsToDisplay()})}acknowledgeEvent(t){this.liveEventsService.acknowledgeEvent(t,!0),this.unacknowledgedEvents=this.unacknowledgedEvents.filter(i=>i.id!==t.id),this.unacknowledgedEvents.length===0?(this.closeOverlay(),setTimeout(()=>this.updateEventsToDisplay(),250)):this.updateEventsToDisplay()}navigateToExercise(t){this.acknowledgeEvent(t);let o=t.exerciseId;this.examExerciseUpdateService.navigateToExamExercise(o)}acknowledgeAllUnacknowledgedEvents(){this.unacknowledgedEvents.forEach(t=>this.liveEventsService.acknowledgeEvent(t,!0)),this.unacknowledgedEvents=[],this.closeOverlay(),setTimeout(()=>this.updateEventsToDisplay(),250)}closeOverlay(){this.activeModal.close("cancel")}updateEventsToDisplay(){this.eventsToDisplay=this.unacknowledgedEvents.length>0?this.unacknowledgedEvents:this.events}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=E({type:n,selectors:[["jhi-exam-live-events-overlay"]],inputs:{examStartDate:"examStartDate"},decls:10,vars:2,consts:[[1,"overlay-wrapper"],[1,"events-wrapper"],[3,"onAcknowledge","onNavigate","event","showAcknowledge"],[1,"btn","btn-primary","w-100","mt-2",3,"click"],[3,"icon"],["jhiTranslate","artemisApp.exam.events.acknowledgeAll"]],template:function(i,o){i&1&&(a(0,"div",0),e(1,`
    `),a(2,"div",1),e(3,`
        `),H(4,si,3,2,null,null,B),l(),e(6,`
    `),h(7,ai,4,0)(8,li,8,1),l(),e(9,`
`)),i&2&&(s(4),$(o.eventsToDisplay),s(3),p(o.unacknowledgedEvents.length===0?7:-1),s(),p(o.unacknowledgedEvents.length>1?8:-1))},dependencies:[lt,A,O],styles:[".overlay-wrapper[_ngcontent-%COMP%]{max-height:80svh;display:flex;flex-direction:column;padding:10px}.overlay-wrapper[_ngcontent-%COMP%]   .events-wrapper[_ngcontent-%COMP%]{flex:1;min-height:0;overflow-y:auto;scrollbar-color:var(--bs-secondary-color) transparent}.overlay-wrapper[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.overlay-wrapper[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-scrollbar-thumb{width:10px;border:2px solid transparent;background-clip:padding-box;background-color:var(--bs-secondary-color);border-radius:50px}"]})}return n})();function mi(n,d){if(n&1){let t=b();e(0,`
    `),a(1,"button",0),f("click",function(o){x(t);let r=m();return _(r.openDialog(o))}),e(2,`
        `),u(3,"fa-icon",1),e(4,`
        `),a(5,"span"),e(6),l(),e(7,`
    `),l(),e(8,`
`)}if(n&2){let t=m();s(3),c("icon",t.faBullhorn),s(3),C("(",t.eventCount,")")}}var Te=[M.EXAM_WIDE_ANNOUNCEMENT,M.WORKING_TIME_UPDATE,M.EXAM_ATTENDANCE_CHECK,M.PROBLEM_STATEMENT_UPDATE],we=[M.EXAM_WIDE_ANNOUNCEMENT,M.WORKING_TIME_UPDATE,M.PROBLEM_STATEMENT_UPDATE],Fo=(()=>{class n{alertService=g(pe);modalService=g(Be);liveEventsService=g(fe);modalRef;liveEventsSubscription;allEventsSubscription;eventCount=0;examStartDate;faBullhorn=We;ngOnInit(){this.allEventsSubscription=this.liveEventsService.observeAllEvents(we).subscribe(t=>{let i=t.filter(o=>!(o.eventType===M.PROBLEM_STATEMENT_UPDATE&&o.createdDate.isBefore(this.examStartDate)));this.eventCount=i.length}),this.liveEventsSubscription=this.liveEventsService.observeNewEventsAsUser(Te,this.examStartDate).subscribe(()=>{this.modalRef||this.openDialog()})}ngOnDestroy(){this.liveEventsSubscription?.unsubscribe(),this.allEventsSubscription?.unsubscribe()}openDialog(t){t?.preventDefault(),this.alertService.closeAll(),this.modalRef=this.modalService.open(ht,{size:"lg",backdrop:"static",animation:!1,centered:!0,windowClass:"live-events-modal-window"}),this.modalRef.componentInstance.examStartDate=this.examStartDate,ye(this.modalRef.result).subscribe(()=>this.modalRef=void 0)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=E({type:n,selectors:[["jhi-exam-live-events-button"]],inputs:{examStartDate:"examStartDate"},decls:1,vars:1,consts:[[1,"btn","btn-md","btn-info",3,"click"],[3,"icon"]],template:function(i,o){i&1&&h(0,mi,9,2),i&2&&p(o.eventCount?0:-1)},dependencies:[A],styles:[`.live-events-modal-window .modal-content{background:transparent!important;border:0!important}.live-events-modal-window .modal-header,.live-events-modal-window .modal-body,.live-events-modal-window .modal-footer{border:0!important}
`],encapsulation:2})}return n})();var Yo=(()=>{class n{serverDateService=g(Je);row=!0;endDate;criticalTime;isEndView=!1;timerAboutToEnd=new Ie;isCriticalTime;destroy$=new se;timer=Ae(0,100).pipe(ae(()=>q.duration(this.endDate.diff(this.serverDateService.now()))));displayTime$=this.timer.pipe(ae(t=>this.updateDisplayTime(t)),Se());timePipe=new tt;constructor(){this.timer.pipe(ae(t=>t.asSeconds()),Se(),Oe(t=>t<=1),Me(this.destroy$)).subscribe(()=>{this.timerAboutToEnd.emit(),setTimeout(()=>this.destroy$.next(!0))})}ngOnInit(){let t=q.duration(this.endDate.diff(this.serverDateService.now()));this.setIsCriticalTime(t)}ngOnDestroy(){this.destroy$.next(!0)}updateDisplayTime(t){return this.setIsCriticalTime(t),t.asMilliseconds()<0?this.timePipe.transform(0,!0):this.timePipe.transform(Ke(t.asSeconds()),!0)}setIsCriticalTime(t){let i=te(t);this.criticalTime&&i.subtract(this.criticalTime).asMilliseconds()<0&&(this.isCriticalTime=!0)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=E({type:n,selectors:[["jhi-exam-timer"]],hostVars:2,hostBindings:function(i,o){i&2&&Ce("row",o.row)},inputs:{endDate:"endDate",criticalTime:"criticalTime",isEndView:"isEndView"},outputs:{timerAboutToEnd:"timerAboutToEnd"},decls:8,vars:8,consts:[[1,"col-auto","mb-0","timer","px-1"],["id","displayTime",1,"col-auto","text-overflow","remaining-time","m-0","px-0"]],template:function(i,o){i&1&&(a(0,"div",0),e(1),T(2,"artemisTranslate"),l(),e(3,`
`),a(4,"div",1),e(5),T(6,"async"),l(),e(7,`
`)),i&2&&(s(),C(`
    `,w(2,4,"artemisApp.examParticipation."+(o.isEndView?"timerEndView":"timer")),`
`),s(3),Ce("critical",o.isCriticalTime),s(),C(`
    `,w(6,6,o.displayTime$),`
`))},dependencies:[ze,F],styles:[".timer[_ngcontent-%COMP%]{color:var(--exam-timer-label-color);margin-right:2px}.text-overflow[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.remaining-time[_ngcontent-%COMP%]{text-align:center;min-width:80px}.end-view[_ngcontent-%COMP%]{min-width:140px}.critical[_ngcontent-%COMP%]{background:var(--exam-timer-critical-background)}[_nghost-%COMP%]{margin-right:0;margin-left:0}"]})}return n})();export{xt as a,_t as b,I as c,Fo as d,Yo as e,Qi as f,un as g,kn as h,no as i};
//# sourceMappingURL=chunk-E5SIAVCE.js.map
