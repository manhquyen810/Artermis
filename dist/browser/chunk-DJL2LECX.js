import{B as C,G as E,Jb as p,L as W,La as O,Va as h,Vb as P,Wa as b,_a as K,ra as d,s as H,sa as v,z as u}from"./chunk-5LC5EQRR.js";import{a as y,b as D}from"./chunk-3E746U5Y.js";function k(t,e,o,i){let n=window&&!!window.document&&window.document.documentElement,l=n&&e?window:o;if(t&&(l=t&&n&&typeof t=="string"?z(t,o.nativeElement,i):t,!l))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return l}function z(t,e,o){return(o?window.document:e).querySelector(t)}function g(t){return t&&!t.firstChange}function R(){return typeof window<"u"}var Y={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},j={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"},S=class{constructor(e=!0){this.vertical=e,this.propsMap=e?Y:j}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}};function V(t,e,o){return!!(t&&e||!o&&e)}function A({windowElement:t,axis:e}){return B({axis:e,isWindow:X(t)},t)}function B(t,e){let o=t.isWindow||e&&!e.nativeElement?e:e.nativeElement;return D(y({},t),{container:o})}function X(t){return["Window","global"].some(o=>Object.prototype.toString.call(t).includes(o))}function m(t,e){return t?e.document.documentElement:null}function M(t,e){let o=L(e);return e.isWindow?x(o,t,e):G(o,t,e)}function x(t,e,o){let{axis:i,container:n,isWindow:l}=o,{offsetHeightKey:r,clientHeightKey:c}=N(i),a=t+U(m(l,n),i,l),s=I(e.nativeElement,l,r,c),f=q(e.nativeElement,i,l)+s;return{height:t,scrolled:a,totalToScroll:f,isWindow:l}}function G(t,e,o){let{axis:i,container:n}=o,l=n[i.scrollTopKey()],r=n[i.scrollHeightKey()];return{height:t,scrolled:l,totalToScroll:r,isWindow:!1}}function N(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function L({container:t,isWindow:e,axis:o}){let{offsetHeightKey:i,clientHeightKey:n}=N(o);return I(t,e,i,n)}function I(t,e,o,i){if(isNaN(t[o])){let n=m(e,t);return n?n[i]:0}else return t[o]}function q(t,e,o){let i=e.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[i]+U(t,e,o)}function U(t,e,o){let i=e.pageYOffsetKey(),n=e.scrollTopKey(),l=e.offsetTopKey();return isNaN(window.pageYOffset)?m(o,t)[n]:t.ownerDocument?t.ownerDocument.defaultView[i]:t[l]}function Z(t,e={down:0,up:0},o){let i,n;if(t.totalToScroll<=0)return!1;let l=t.isWindow?t.scrolled:t.height+t.scrolled;if(o)i=(t.totalToScroll-l)/t.totalToScroll,n=(e?.down?e.down:0)/10;else{let c=t.scrolled+(t.totalToScroll-l);i=t.scrolled/c,n=(e?.up?e.up:0)/10}return i<=n}function J(t,e){return t<e.scrolled}function Q(t,e,o){let i=J(t,e);return{fire:Z(e,o,i),scrollDown:i}}var w=class{constructor(e){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},Object.assign(this,e)}updateScrollPosition(e){return this.lastScrollPosition=e}updateTotalToScroll(e){this.lastTotalToScroll!==e&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=e)}updateScroll(e,o){this.updateScrollPosition(e),this.updateTotalToScroll(o)}updateTriggeredFlag(e,o){o?this.triggered.down=e:this.triggered.up=e}isTriggeredScroll(e,o){return o?this.triggered.down===e:this.triggered.up===e}};function _(t){let{scrollContainer:e,scrollWindow:o,element:i,fromRoot:n}=t,l=A({axis:new S(!t.horizontal),windowElement:k(e,o,i,n)}),r=new w({totalToScroll:M(i,l).totalToScroll}),c={container:l.container,throttle:t.throttle},a={up:t.upDistance,down:t.downDistance};return $(c).pipe(C(()=>H(M(i,l))),u(s=>tt(r.lastScrollPosition,s,a)),d(({stats:s})=>r.updateScroll(s.scrolled,s.totalToScroll)),W(({fire:s,scrollDown:f,stats:{totalToScroll:F}})=>V(t.alwaysCallback,s,r.isTriggeredScroll(F,f))),d(({scrollDown:s,stats:{totalToScroll:f}})=>{r.updateTriggeredFlag(f,s)}),u(et))}function $(t){let e=E(t.container,"scroll");return t.throttle&&(e=e.pipe(v(t.throttle,void 0,{leading:!0,trailing:!0}))),e}function tt(t,e,o){let{scrollDown:i,fire:n}=Q(t,e,o);return{scrollDown:i,fire:n,stats:e}}var T={DOWN:"[NGX_ISE] DOWN",UP:"[NGX_ISE] UP"};function et(t){let{scrollDown:e,stats:{scrolled:o}}=t;return{type:e?T.DOWN:T.UP,payload:{currentScrollPosition:o}}}var ht=(()=>{class t{constructor(o,i){this.element=o,this.zone=i,this.scrolled=new h,this.scrolledUp=new h,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:o,infiniteScrollDisabled:i,infiniteScrollDistance:n}){let l=g(o),r=g(i),c=g(n),a=!r&&!this.infiniteScrollDisabled||r&&!i.currentValue||c;(l||r||c)&&(this.destroyScroller(),a&&this.setup())}ngOnDestroy(){this.destroyScroller()}setup(){R()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=_({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(o=>this.handleOnScroll(o))})}handleOnScroll({type:o,payload:i}){let n=o===T.DOWN?this.scrolled:this.scrolledUp;ot(n)&&this.zone.run(()=>n.emit(i))}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}static{this.\u0275fac=function(i){return new(i||t)(p(K),p(b))}}static{this.\u0275dir=P({type:t,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[O]})}}return t})();function ot(t){return t.observed??t.observers.length>0}export{ht as a};
//# sourceMappingURL=chunk-DJL2LECX.js.map
