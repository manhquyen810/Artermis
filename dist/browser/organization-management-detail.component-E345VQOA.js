import{a as J}from"./chunk-YNY5IUYO.js";import{a as E}from"./chunk-G4HSJ7ME.js";import{c as K,d as X,e as Y,f as Z,g as ee}from"./chunk-F3NFBBHK.js";import{a as z}from"./chunk-2HILLGW2.js";import"./chunk-OTCBNILH.js";import{b as q}from"./chunk-T624HJJL.js";import"./chunk-HQTS6JOY.js";import{a as $}from"./chunk-HMZID6NQ.js";import"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import{a as G}from"./chunk-ZK23IHB5.js";import{a as P}from"./chunk-AZBLKUAM.js";import"./chunk-XBLNBTXN.js";import"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import"./chunk-WA5GEAJB.js";import"./chunk-5GXY5RYT.js";import"./chunk-K3W6YFKH.js";import"./chunk-JXJXC4DZ.js";import{d as B}from"./chunk-EDXSOKK5.js";import"./chunk-DID2YGL7.js";import{ob as N}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as Q}from"./chunk-U54OSGNH.js";import{f as k,i as L}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import"./chunk-IOA4DPXY.js";import{Db as l,Dc as S,Ea as v,Ma as u,Mc as h,Na as _,Oc as g,P as w,Sc as I,Tb as A,Yc as j,Zb as c,Zc as W,_c as R,dd as e,ed as p,f as C,fd as U,kc as d,oa as M,qd as V,ra as b,rd as H,s as T,uc as D,vc as F,wc as O,xc as n,yc as i,z as y,zc as s}from"./chunk-5LC5EQRR.js";import"./chunk-3E746U5Y.js";var ie=()=>["login","name"],ae=r=>["/course-management/",r];function re(r,m){if(r&1&&(e(0,`
                            `),n(1,"tr"),e(2,`
                                `),n(3,"td"),e(4,`
                                    `),n(5,"a",20),e(6),i(),e(7,`
                                `),i(),e(8,`
                                `),n(9,"td"),e(10,`
                                    `),n(11,"span"),e(12),i(),e(13,`
                                `),i(),e(14,`
                                `),n(15,"td"),e(16,`
                                    `),n(17,"span"),e(18),i(),e(19,`
                                `),i(),e(20,`
                            `),i(),e(21,`
                        `)),r&2){let t=m.$implicit;l(5),d("routerLink",H(4,ae,t.id)),l(),p(t.id),l(6),p(t.title),l(6),p(t.shortName)}}function oe(r,m){if(r&1){let t=S();e(0,`
                            `),n(1,"span",29),h("click",function(){u(t);let a=g().controls;return _(a.onSort("id"))}),e(2,`
                                `),s(3,"span",30),e(4,`
                                `),s(5,"fa-icon",31),e(6,`
                            `),i(),e(7,`
                        `)}if(r&2){let t=g().controls;l(5),d("icon",t.iconForSortPropField("id"))}}function le(r,m){if(r&1&&(e(0,`
                            `),n(1,"a",20),e(2),i(),e(3,`
                        `)),r&2){let t=m.value;l(),I("routerLink","/admin/user-management/",t==null?null:t.login,""),l(),U(" ",t.id," ")}}function se(r,m){if(r&1){let t=S();e(0,`
                            `),n(1,"span",29),h("click",function(){u(t);let a=g().controls;return _(a.onSort("login"))}),e(2,`
                                `),s(3,"span",32),e(4,`
                                `),s(5,"fa-icon",31),e(6,`
                            `),i(),e(7,`
                        `)}if(r&2){let t=g().controls;l(5),d("icon",t.iconForSortPropField("login"))}}function me(r,m){if(r&1&&(e(0,`
                            `),n(1,"span"),e(2),i(),e(3,`
                        `)),r&2){let t=m.value;l(2),p(t)}}function de(r,m){if(r&1){let t=S();e(0,`
                            `),n(1,"span",29),h("click",function(){u(t);let a=g().controls;return _(a.onSort("name"))}),e(2,`
                                `),s(3,"span",33),e(4,`
                                `),s(5,"fa-icon",31),e(6,`
                            `),i(),e(7,`
                        `)}if(r&2){let t=g().controls;l(5),d("icon",t.iconForSortPropField("name"))}}function pe(r,m){if(r&1&&(e(0,`
                            `),n(1,"span"),e(2),i(),e(3,`
                        `)),r&2){let t=m.value;l(2),p(t)}}function ce(r,m){if(r&1){let t=S();e(0,`
                            `),n(1,"span",29),h("click",function(){u(t);let a=g().controls;return _(a.onSort("email"))}),e(2,`
                                `),s(3,"span",34),e(4,`
                                `),s(5,"fa-icon",31),e(6,`
                            `),i(),e(7,`
                        `)}if(r&2){let t=g().controls;l(5),d("icon",t.iconForSortPropField("email"))}}function ge(r,m){if(r&1&&(e(0,`
                            `),n(1,"span"),e(2),i(),e(3,`
                        `)),r&2){let t=m.value;l(2),p(t)}}function xe(r,m){}function he(r,m){if(r&1){let t=S();e(0,`
                            `),n(1,"div",35),e(2,`
                                `),n(3,"button",36),h("delete",function(){let a=u(t).value,x=g(2);return _(x.removeFromOrganization(a))}),e(4,`
                                    `),s(5,"fa-icon",37),e(6,`
                                `),i(),e(7,`
                            `),i(),e(8,`
                        `)}if(r&2){let t=m.value,o=g(2);l(3),d("actionType",o.ActionType.Remove)("entityTitle",t.login)("dialogError",o.dialogError$),l(2),d("icon",o.faUserSlash)}}function ue(r,m){if(r&1&&(e(0,`
                `),n(1,"ngx-datatable",21),e(2,`
                    `),n(3,"ngx-datatable-column",22),e(4,`
                        `),c(5,oe,8,1,"ng-template",23),e(6,`
                        `),c(7,le,4,3,"ng-template",24),e(8,`
                    `),i(),e(9,`
                    `),n(10,"ngx-datatable-column",25),e(11,`
                        `),c(12,se,8,1,"ng-template",23),e(13,`
                        `),c(14,me,4,1,"ng-template",24),e(15,`
                    `),i(),e(16,`
                    `),n(17,"ngx-datatable-column",26),e(18,`
                        `),c(19,de,8,1,"ng-template",23),e(20,`
                        `),c(21,pe,4,1,"ng-template",24),e(22,`
                    `),i(),e(23,`
                    `),n(24,"ngx-datatable-column",27),e(25,`
                        `),c(26,ce,8,1,"ng-template",23),e(27,`
                        `),c(28,ge,4,1,"ng-template",24),e(29,`
                    `),i(),e(30,`
                    `),n(31,"ngx-datatable-column",28),e(32,`
                        `),c(33,xe,0,0,"ng-template",23),e(34,`
                        `),c(35,he,9,4,"ng-template",24),e(36,`
                    `),i(),e(37,`
                `),i(),e(38,`
            `)),r&2){let t=m.settings,o=g();l(),d("limit",t.limit)("sortType",t.sortType)("columnMode",t.columnMode)("headerHeight",t.headerHeight)("footerHeight",t.footerHeight)("rowHeight",t.rowHeight)("rows",t.rows)("rowClass",o.dataTableRowClass)("scrollbarH",t.scrollbarH),l(2),d("minWidth",60)("width",80)("maxWidth",100),l(7),d("minWidth",150)("width",200)("maxWidth",200),l(7),d("minWidth",150)("width",250)("maxWidth",250),l(7),d("minWidth",150)("width",250),l(7),d("minWidth",150)("width",200)}}var te={alreadyMember:"already-member",newlyAddedMember:"newly-added-member"},Ue=(()=>{class r{organizationService=v(G);userService=v(P);route=v(k);dataTable;organization;ActionType=$;dialogErrorSource=new C;dialogError$=this.dialogErrorSource.asObservable();filteredUsersSize=0;paramSub;isLoading=!1;isSearching=!1;searchFailed=!1;searchNoResults=!1;isTransitioning=!1;rowClass=void 0;faUserSlash=N;ngOnInit(){this.route.data.subscribe(({organization:t})=>{if(this.organization=new z,t){let o=t.body?t.body.id:t.id;this.organizationService.getOrganizationByIdWithUsersAndCourses(o).subscribe(a=>{this.organization=a})}})}trackIdentity(t,o){return o.id??-1}searchAllUsers=t=>t.pipe(M(({text:o})=>(this.searchFailed=!1,this.searchNoResults=!1,o.length<3?T([]):(this.isSearching=!0,this.userService.search(o).pipe(y(a=>a.body)).pipe(b(a=>{a.length===0&&(this.searchNoResults=!0)}),w(()=>(this.searchFailed=!0,T([]))))))),b(()=>{this.isSearching=!1}),b(o=>{setTimeout(()=>{for(let a=0;a<this.dataTable.typeaheadButtons.length;a++){this.organization.users===void 0&&(this.organization.users=[]);let x=this.dataTable.typeaheadButtons[a],f=this.organization.users.map(ne=>ne.id).includes(o[a].id);x.querySelector("fa-icon")||x.insertAdjacentHTML("beforeend",J[f?"users":"users-plus"]),f&&this.dataTable.typeaheadButtons[a].classList.add(te.alreadyMember)}})}));removeFromOrganization(t){t.login&&this.organizationService.removeUserFromOrganization(this.organization.id,t.login).subscribe({next:()=>{this.organization.users=this.organization.users.filter(o=>o.login!==t.login),this.dialogErrorSource.next("")},error:o=>this.dialogErrorSource.next(o.message)})}loadAll(){this.isLoading=!0,this.route.data.subscribe(({organization:t})=>{if(this.organization=new z,t){let o=t.body?t.body.id:t.id;this.organizationService.getOrganizationByIdWithUsersAndCourses(o).subscribe(a=>{this.organization=a,this.isLoading=!1})}})}onAutocompleteSelect=(t,o)=>{!this.organization.users.map(a=>a.id).includes(t.id)&&t.login?(this.isTransitioning=!0,this.organizationService.addUserToOrganization(this.organization.id,t.login).subscribe({next:()=>{this.isTransitioning=!1,this.organization.users.push(t),o(t),this.flashRowClass(te.newlyAddedMember)},error:()=>{this.isTransitioning=!1}})):o(t)};searchTextFromUser=t=>t.login||"";dataTableRowClass=()=>this.rowClass;flashRowClass=t=>{this.rowClass=t,setTimeout(()=>this.rowClass=void 0)};handleUsersSizeChange=t=>{this.filteredUsersSize=t};searchResultFormatter=t=>{let{name:o,login:a}=t;return`${o} (${a})`};static \u0275fac=function(o){return new(o||r)};static \u0275cmp=A({type:r,selectors:[["jhi-organization-management-detail"]],viewQuery:function(o,a){if(o&1&&j(E,5),o&2){let x;W(x=R())&&(a.dataTable=x.first)}},decls:112,vars:20,consts:[["jhiTranslate","artemisApp.organizationManagement.detail.title"],[1,"container"],[1,"row"],[1,"col"],[1,"row-md","jh-entity-details"],["jhiTranslate","global.field.id"],["jhiTranslate","artemisApp.organizationManagement.name"],["jhiTranslate","artemisApp.organizationManagement.shortName"],["jhiTranslate","artemisApp.organizationManagement.url"],["jhiTranslate","artemisApp.organizationManagement.logoUrl"],["jhiTranslate","artemisApp.organizationManagement.description"],["jhiTranslate","artemisApp.organizationManagement.emailPattern"],["jhiTranslate","artemisApp.organizationManagement.courses"],[1,"table-responsive"],[1,"table","table-striped"],["jhiTranslate","artemisApp.course.title"],["jhiTranslate","artemisApp.course.shortName"],[1,"container","p-2"],["jhiTranslate","artemisApp.organizationManagement.users"],["entityType","user","entitiesPerPageTranslation","artemisApp.organizationManagement.userSearch.usersPerPage","showAllEntitiesTranslation","artemisApp.organizationManagement.userSearch.showAllUsers","searchNoResultsTranslation","artemisApp.organizationManagement.userSearch.searchNoResults","searchPlaceholderTranslation","artemisApp.organizationManagement.userSearch.searchForUsers",3,"entitiesSizeChange","isLoading","isSearching","searchFailed","searchNoResults","isTransitioning","allEntities","searchFields","searchTextFromEntity","searchResultFormatter","onSearchWrapper","onAutocompleteSelectWrapper"],[3,"routerLink"],[1,"bootstrap",3,"limit","sortType","columnMode","headerHeight","footerHeight","rowHeight","rows","rowClass","scrollbarH"],["prop","",3,"minWidth","width","maxWidth"],["ngx-datatable-header-template",""],["ngx-datatable-cell-template",""],["prop","login",3,"minWidth","width","maxWidth"],["prop","name",3,"minWidth","width","maxWidth"],["prop","email",3,"minWidth","width"],["prop","",3,"minWidth","width"],[1,"datatable-header-cell-wrapper",3,"click"],["jhiTranslate","global.field.id",1,"datatable-header-cell-label","bold","sortable"],[3,"icon"],["jhiTranslate","artemisApp.userManagement.login",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.userManagement.name",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.userManagement.email",1,"datatable-header-cell-label","bold","sortable"],[1,"w-100","text-end"],["jhiDeleteButton","","deleteQuestion","artemisApp.organizationManagement.userSearch.removeFromOrganization.modalQuestion",3,"delete","actionType","entityTitle","dialogError"],[1,"me-1",3,"icon"]],template:function(o,a){o&1&&(n(0,"div"),e(1,`
    `),n(2,"h2"),e(3,`
        `),s(4,"span",0),e(5," ["),n(6,"b"),e(7),i(),e(8,`]
    `),i(),e(9,`
    `),n(10,"div",1),e(11,`
        `),n(12,"div",2),e(13,`
            `),n(14,"div",3),e(15,`
                `),n(16,"dl",4),e(17,`
                    `),n(18,"dt"),s(19,"span",5),i(),e(20,`
                    `),n(21,"dd"),e(22),i(),e(23,`
                    `),n(24,"dt"),s(25,"span",6),i(),e(26,`
                    `),n(27,"dd"),e(28),i(),e(29,`
                    `),n(30,"dt"),s(31,"span",7),i(),e(32,`
                    `),n(33,"dd"),e(34),i(),e(35,`
                    `),n(36,"dt"),s(37,"span",8),i(),e(38,`
                    `),n(39,"dd"),e(40),i(),e(41,`
                    `),n(42,"dt"),s(43,"span",9),i(),e(44,`
                    `),n(45,"dd"),e(46),i(),e(47,`
                    `),n(48,"dt"),s(49,"span",10),i(),e(50,`
                    `),n(51,"dd"),e(52),i(),e(53,`
                    `),n(54,"dt"),s(55,"span",11),i(),e(56,`
                    `),n(57,"dd"),e(58),i(),e(59,`
                `),i(),e(60,`
            `),i(),e(61,`
        `),i(),e(62,`
        `),n(63,"div",2),e(64,`
            `),n(65,"h3"),e(66,`
                `),s(67,"span",12),e(68,`
            `),i(),e(69,`
            `),n(70,"div",13),e(71,`
                `),n(72,"table",14),e(73,`
                    `),n(74,"thead"),e(75,`
                        `),n(76,"tr"),e(77,`
                            `),n(78,"th"),s(79,"span",5),i(),e(80,`
                            `),n(81,"th"),s(82,"span",15),i(),e(83,`
                            `),n(84,"th"),s(85,"span",16),i(),e(86,`
                        `),i(),e(87,`
                    `),i(),e(88,`
                    `),n(89,"tbody"),e(90,`
                        `),F(91,re,22,6,null,null,D),i(),e(93,`
                `),i(),e(94,`
            `),i(),e(95,`
        `),i(),e(96,`
    `),i(),e(97,`
    `),n(98,"div",17),e(99,`
        `),n(100,"h3"),e(101,`
            `),s(102,"span",18),e(103,`
        `),i(),e(104,`
        `),n(105,"jhi-data-table",19),h("entitiesSizeChange",function(f){return a.handleUsersSizeChange(f)}),e(106,`
            `),c(107,ue,39,22,"ng-template"),e(108,`
        `),i(),e(109,`
    `),i(),e(110,`
`),i(),e(111,`
`)),o&2&&(l(7),p(a.organization.name),l(15),p(a.organization.id),l(6),p(a.organization.name),l(6),p(a.organization.shortName),l(6),p(a.organization.url),l(6),p(a.organization.logoUrl),l(6),p(a.organization.description),l(6),p(a.organization.emailPattern),l(33),O(a.organization.courses),l(14),d("isLoading",a.isLoading)("isSearching",a.isSearching)("searchFailed",a.searchFailed)("searchNoResults",a.searchNoResults)("isTransitioning",a.isTransitioning)("allEntities",a.organization.users)("searchFields",V(19,ie))("searchTextFromEntity",a.searchTextFromUser)("searchResultFormatter",a.searchResultFormatter)("onSearchWrapper",a.searchAllUsers)("onAutocompleteSelectWrapper",a.onAutocompleteSelect))},dependencies:[Q,L,E,ee,Z,Y,K,X,B,q],encapsulation:2})}return r})();export{Ue as OrganizationManagementDetailComponent};
//# sourceMappingURL=organization-management-detail.component-E345VQOA.js.map
