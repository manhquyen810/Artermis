import{a as J}from"./chunk-WIZ2YSLS.js";import{C as D,D as y}from"./chunk-RTOKZMYN.js";import"./chunk-5QODR5GQ.js";import"./chunk-RNPAFOPW.js";import"./chunk-KZGAUMRM.js";import"./chunk-656XE4CO.js";import"./chunk-YGSJB6WY.js";import"./chunk-O2WHE2S3.js";import"./chunk-JJUII2KT.js";import"./chunk-U4DJRHYQ.js";import{a as E,b as p,c as X,d as q}from"./chunk-4YM7AQBQ.js";import"./chunk-DIZEKHOC.js";import"./chunk-V7PDYRDZ.js";import"./chunk-EANMTTQG.js";import"./chunk-PNTOXB52.js";import"./chunk-Z2YUBN6N.js";import"./chunk-AO5E7TEY.js";import{d as Y}from"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import"./chunk-VWRLJYRR.js";import"./chunk-QH7SWO42.js";import"./chunk-P2M2VQE3.js";import"./chunk-GXOKLIFX.js";import"./chunk-5JBXU6VG.js";import"./chunk-4I367PEU.js";import"./chunk-ZPITQMA6.js";import{a as Q}from"./chunk-VL2AJDYR.js";import"./chunk-2CSD5TLZ.js";import"./chunk-ZM53HDCE.js";import"./chunk-MKPB4JKY.js";import"./chunk-I76AVIQH.js";import"./chunk-H2ETPEH6.js";import"./chunk-Z6NSEM73.js";import"./chunk-AR57MWOI.js";import"./chunk-A5PTZAPN.js";import"./chunk-AU6UEH3U.js";import"./chunk-FGAONQTL.js";import"./chunk-HQ6UGNQX.js";import"./chunk-ZLJ76G5I.js";import"./chunk-MLVGKM2P.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import{K as R,u as P,v as j}from"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import{K as H,i as N,k as w,n as G}from"./chunk-WA5GEAJB.js";import"./chunk-DRSQQEUE.js";import"./chunk-7XXWL6ER.js";import"./chunk-VK7JPHFE.js";import"./chunk-BQNBT6PW.js";import"./chunk-5GXY5RYT.js";import{a as K}from"./chunk-K3W6YFKH.js";import"./chunk-TL3DYXRE.js";import"./chunk-JXJXC4DZ.js";import{d as z}from"./chunk-EDXSOKK5.js";import"./chunk-R5BZWVRQ.js";import"./chunk-DID2YGL7.js";import"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Ba as O,fa as W,tb as B,wd as V,y as F}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as _}from"./chunk-U54OSGNH.js";import{f as I}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import"./chunk-IOA4DPXY.js";import{Db as l,Ea as d,Id as L,Mc as g,Oc as C,Rc as u,Tb as h,Yc as M,Zb as A,Zc as U,_c as k,dd as e,kc as m,ra as S,sc as v,xc as i,yc as a,yd as f,zc as s,zd as T}from"./chunk-5LC5EQRR.js";import"./chunk-3E746U5Y.js";var Z=(()=>{class r{activeModal=d(P);textMessage;discardContent(){this.activeModal.close()}continueEditing(){this.activeModal.dismiss("cancel")}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=h({type:r,selectors:[["jhi-unsaved-changes-warning"]],inputs:{textMessage:"textMessage"},decls:22,vars:3,consts:[[1,"modal-header"],["id","close-modal-btn","type","button","data-dismiss","modal","aria-hidden","true",1,"btn-close",3,"click"],[1,"modal-body"],[3,"jhiTranslate"],["id","discard-content-btn",3,"click","title"],["id","continue-editing-btn",3,"click","title"]],template:function(o,n){o&1&&(i(0,"form"),e(1,`
    `),i(2,"div",0),e(3,`
        `),i(4,"button",1),g("click",function(){return n.continueEditing()}),a(),e(5,`
    `),a(),e(6,`
    `),i(7,"div",2),e(8,`
        `),s(9,"h5",3),e(10,`
        `),i(11,"div"),e(12,`
            `),i(13,"jhi-button",4),g("click",function(){return n.discardContent()}),e(14,"Discard"),a(),e(15,`
            `),i(16,"jhi-button",5),g("click",function(){return n.continueEditing()}),e(17,"Go back"),a(),e(18,`
        `),a(),e(19,`
    `),a(),e(20,`
`),a(),e(21,`
`)),o&2&&(l(9),u("jhiTranslate",n.textMessage),l(4),m("title","entity.action.discardChanges"),l(3),m("title","entity.action.goBack"))},dependencies:[H,G,N,w,_,Y],encapsulation:2})}return r})();function ee(r,b){if(r&1&&(e(0,`
                `),i(1,"div"),e(2,`
                    `),s(3,"fa-icon",8),f(4,"artemisTranslate"),e(5,`
                    `),s(6,"span",9),e(7,`
                `),a(),e(8,`
            `)),r&2){let t=C();l(3),u("ngbTooltip",T(4,2,"artemisApp.legal.savedTooltip")),m("icon",t.faCheckCircle)}}function te(r,b){if(r&1&&(e(0,`
                `),i(1,"div"),e(2,`
                    `),s(3,"fa-icon",10),f(4,"artemisTranslate"),e(5,`
                    `),s(6,"span",11),e(7,`
                `),a(),e(8,`
            `)),r&2){let t=C();l(3),u("ngbTooltip",T(4,2,"artemisApp.legal.unsavedTooltip")),m("icon",t.faExclamationTriangle)}}function ne(r,b){if(r&1&&(e(0,`
                `),i(1,"div"),e(2,`
                    `),s(3,"fa-icon",12),f(4,"artemisTranslate"),e(5,`
                    `),s(6,"span",13),e(7,`
                `),a(),e(8,`
            `)),r&2){let t=C();l(3),u("ngbTooltip",T(4,2,"artemisApp.legal.savingTooltip")),m("icon",t.faCircleNotch)}}var Me=(()=>{class r{legalDocumentService=d(q);modalService=d(j);route=d(I);languageHelper=d(Q);changeDetectorRef=d(L);SUPPORTED_LANGUAGES=[E.GERMAN,E.ENGLISH];faBan=W;faSave=B;faExclamationTriangle=V;faCheckCircle=O;faCircleNotch=F;LANGUAGE_OPTIONS=this.SUPPORTED_LANGUAGES.map(t=>({value:t,labelKey:"artemisApp.legal.language."+t,btnClass:"btn-primary"}));DEFAULT_LANGUAGE=E.GERMAN;MAX_HEIGHT=D.EXTRA_LARGE;MIN_HEIGHT=D.MEDIUM;legalDocument;legalDocumentType=p.PRIVACY_STATEMENT;unsavedChanges=!1;isSaving=!1;markdownEditor;currentContentTrimmed="";currentLanguage=this.DEFAULT_LANGUAGE;unsavedChangesWarning;titleKey;ngOnInit(){this.route.url.pipe(S(t=>{this.legalDocumentType=t.some(o=>o.path==="imprint")?p.IMPRINT:p.PRIVACY_STATEMENT})).subscribe(),this.legalDocumentType===p.IMPRINT?this.titleKey="artemisApp.legal.imprint.updateImprint":this.titleKey="artemisApp.legal.privacyStatement.updatePrivacyStatement",this.languageHelper.updateTitle(this.titleKey),this.legalDocument=new X(this.legalDocumentType,this.DEFAULT_LANGUAGE),this.getLegalDocumentForUpdate(this.legalDocumentType,this.DEFAULT_LANGUAGE).subscribe(t=>{this.legalDocument=t})}getLegalDocumentForUpdate(t,o){return t===p.PRIVACY_STATEMENT?this.legalDocumentService.getPrivacyStatementForUpdate(o):this.legalDocumentService.getImprintForUpdate(o)}updateLegalDocument(){this.isSaving=!0,this.legalDocument.text=this.currentContentTrimmed,this.legalDocumentType===p.PRIVACY_STATEMENT?this.legalDocumentService.updatePrivacyStatement(this.legalDocument).subscribe(t=>{this.setUpdatedDocument(t)}):this.legalDocumentService.updateImprint(this.legalDocument).subscribe(t=>{this.setUpdatedDocument(t)})}setUpdatedDocument(t){this.legalDocument=t,this.unsavedChanges=!1,this.isSaving=!1}onContentChanged(t){this.currentContentTrimmed=t.trim(),this.unsavedChanges=t!==this.legalDocument.text}onLanguageChange(t){this.unsavedChanges?this.showWarning(t):(this.currentLanguage=t,this.getLegalDocumentForUpdate(this.legalDocumentType,t).subscribe(o=>{this.legalDocument=o,this.markdownEditor.markdown=this.legalDocument.text,this.markdownEditor.parseMarkdown(),this.unsavedChanges=!1}))}showWarning(t){if(this.unsavedChangesWarning=this.modalService.open(Z,{size:"lg",backdrop:"static"}),this.legalDocumentType===p.PRIVACY_STATEMENT)this.unsavedChangesWarning.componentInstance.textMessage="artemisApp.legal.privacyStatement.unsavedChangesWarning";else if(this.legalDocumentType===p.IMPRINT)this.unsavedChangesWarning.componentInstance.textMessage="artemisApp.legal.imprint.unsavedChangesWarning";else throw new Error("Unknown legal document type!");this.unsavedChangesWarning.result.then(()=>{this.unsavedChanges=!1,this.onLanguageChange(t)}).catch(()=>{})}ngAfterContentChecked(){this.changeDetectorRef.detectChanges()}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=h({type:r,selectors:[["jhi-privacy-statement-update-component"]],viewQuery:function(o,n){if(o&1&&M(y,5),o&2){let c;U(c=k())&&(n.markdownEditor=c.first)}},decls:31,vars:13,consts:[[1,"legal-document-container"],["id","legal-document-update-heading","data-cy","legalDocumentPageHeading",3,"jhiTranslate"],[1,"markdown-editor",3,"markdownChange","markdown","resizableMinHeight","resizableMaxHeight","initialEditorHeight","enableFileUpload"],[1,"btn-below-editor"],["type","submit","id","update-legal-document-btn",1,"btn","btn-primary",3,"click","disabled"],[3,"icon"],["jhiTranslate","entity.action.save"],[3,"valueChange","options","value"],[1,"text-success","me-1",3,"icon","ngbTooltip"],["jhiTranslate","artemisApp.legal.saved",1,"text-info"],[1,"text-warning","me-1",3,"icon","ngbTooltip"],["jhiTranslate","artemisApp.legal.unsaved",1,"text-info"],[1,"me-1",3,"icon","ngbTooltip"],["jhiTranslate","artemisApp.legal.saving",1,"text-info"]],template:function(o,n){o&1&&(i(0,"div",0),e(1,`
    `),i(2,"div"),e(3,`
        `),i(4,"h2"),e(5,`
            `),s(6,"span",1),e(7,`
        `),a(),e(8,`
        `),i(9,"jhi-markdown-editor-monaco",2),g("markdownChange",function(x){return n.onContentChanged(x)}),a(),e(10,`
        `),i(11,"div"),e(12,`
            `),A(13,ee,9,4)(14,te,9,4)(15,ne,9,4),a(),e(16,`
        `),i(17,"div",3),e(18,`
            `),i(19,"button",4),g("click",function(){return n.updateLegalDocument()}),e(20,`
                `),s(21,"fa-icon",5),e(22,`
                `),s(23,"span",6),e(24,`
            `),a(),e(25,`
            `),i(26,"jhi-mode-picker",7),g("valueChange",function(x){return n.onLanguageChange(x)}),a(),e(27,`
        `),a(),e(28,`
    `),a(),e(29,`
`),a(),e(30,`
`)),o&2&&(l(6),u("jhiTranslate",n.titleKey),l(3),m("markdown",n.legalDocument.text)("resizableMinHeight",n.MIN_HEIGHT)("resizableMaxHeight",n.MAX_HEIGHT)("initialEditorHeight",n.MIN_HEIGHT)("enableFileUpload",!1),l(4),v(!n.unsavedChanges&&!n.isSaving?13:-1),l(),v(n.unsavedChanges&&!n.isSaving?14:-1),l(),v(n.isSaving?15:-1),l(4),m("disabled",!n.currentContentTrimmed||n.isSaving),l(2),m("icon",n.faSave),l(5),m("options",n.LANGUAGE_OPTIONS)("value",n.currentLanguage))},dependencies:[_,y,z,R,J,K],styles:[".btn-below-editor[_ngcontent-%COMP%]{display:flex;margin-top:10px}#update-legal-document-btn[_ngcontent-%COMP%]{margin-right:10px}"]})}return r})();export{Me as LegalDocumentUpdateComponent};
//# sourceMappingURL=legal-document-update.component-ZG2I5U4B.js.map
