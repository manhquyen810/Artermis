import{a as we,b as ye}from"./chunk-D4SD7QX4.js";import{a as U,b as w,c as Me}from"./chunk-77A5CC3Z.js";import"./chunk-RUZE5GXG.js";import{a as ge}from"./chunk-7OWNIVQU.js";import{b as fe}from"./chunk-3DNS47RB.js";import{a as ke}from"./chunk-UVXOAEFF.js";import"./chunk-4CVODXGB.js";import{a as Te}from"./chunk-M2R22ST2.js";import{a as Ae}from"./chunk-5WJSNL65.js";import{a as ve}from"./chunk-TOVMCMTA.js";import"./chunk-FNJRUM5G.js";import{a as Ce}from"./chunk-LBLXP4B5.js";import"./chunk-MASKPWNP.js";import{a as Ee}from"./chunk-V55WZ52P.js";import"./chunk-GITU5WHL.js";import{a as _e}from"./chunk-GWS46Z7O.js";import"./chunk-GXLYQKDJ.js";import"./chunk-CCVWGTN5.js";import"./chunk-MD22LTSS.js";import"./chunk-RKZRHQUL.js";import"./chunk-JCAGYDTX.js";import"./chunk-OI2L2OHD.js";import"./chunk-A2A6JFSH.js";import"./chunk-MD6Z63OB.js";import"./chunk-M2FHCXD3.js";import"./chunk-RGQYMQQL.js";import"./chunk-FLZTDUOG.js";import"./chunk-QU4DXSXD.js";import"./chunk-GAUWMTOK.js";import"./chunk-656XE4CO.js";import"./chunk-O2WHE2S3.js";import"./chunk-U4DJRHYQ.js";import"./chunk-JRBFEQNN.js";import"./chunk-DIZEKHOC.js";import"./chunk-V7PDYRDZ.js";import"./chunk-EANMTTQG.js";import"./chunk-65Z25AP3.js";import"./chunk-5M3YV54C.js";import"./chunk-RYZEETVB.js";import"./chunk-VTF2OQPK.js";import{a as F}from"./chunk-BNRTXX46.js";import"./chunk-N4VVKRBU.js";import"./chunk-5AQXEKLE.js";import{b as P}from"./chunk-3JSWSN6W.js";import"./chunk-7XNS72RJ.js";import"./chunk-KYCCMZSV.js";import"./chunk-DXTZ4GAW.js";import"./chunk-2UXGFGK3.js";import"./chunk-O4VJ5OXY.js";import"./chunk-BDII35IB.js";import"./chunk-LARBQRTJ.js";import"./chunk-OTNXTVPX.js";import{q as Se}from"./chunk-Z2YUBN6N.js";import"./chunk-6EYB5QBP.js";import"./chunk-GERFCPB6.js";import"./chunk-T624HJJL.js";import"./chunk-HQTS6JOY.js";import"./chunk-HMZID6NQ.js";import"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import{a as be}from"./chunk-2QXIMOEO.js";import"./chunk-JHBUBEY6.js";import{x as ce,y as de}from"./chunk-R2SUWIPY.js";import"./chunk-35PLMJNP.js";import"./chunk-4I367PEU.js";import"./chunk-QA7Y7QBM.js";import"./chunk-ZPITQMA6.js";import"./chunk-2CUFQLAH.js";import{a as he}from"./chunk-DRMCDU75.js";import"./chunk-Z6NSEM73.js";import"./chunk-AR57MWOI.js";import"./chunk-A5PTZAPN.js";import"./chunk-AU6UEH3U.js";import"./chunk-FGAONQTL.js";import"./chunk-HQ6UGNQX.js";import"./chunk-ZLJ76G5I.js";import"./chunk-MLVGKM2P.js";import{c as le}from"./chunk-CK7FH6VF.js";import{e as me}from"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import{d as V}from"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import"./chunk-CT44YL7Q.js";import"./chunk-ZFM7LHJQ.js";import"./chunk-JNO6DNVW.js";import"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import{K as ne,c as ee,h as te,m as ie,p as se}from"./chunk-WA5GEAJB.js";import"./chunk-VK7JPHFE.js";import"./chunk-BNDLMKXK.js";import"./chunk-BQNBT6PW.js";import"./chunk-5GXY5RYT.js";import{a as ue}from"./chunk-K3W6YFKH.js";import"./chunk-JXJXC4DZ.js";import{d as pe}from"./chunk-EDXSOKK5.js";import"./chunk-R5BZWVRQ.js";import"./chunk-DID2YGL7.js";import{k as re}from"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Q as oe,tb as ae}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as xe}from"./chunk-U54OSGNH.js";import{f as Z,h as $}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import"./chunk-IOA4DPXY.js";import{Ac as M,B as Y,Bc as I,Db as o,Dc as S,Ea as C,L as H,Ma as p,Mc as h,Na as x,Oc as a,Tb as J,Xb as K,Zb as _,dd as t,fd as k,gd as X,kc as c,ld as N,md as B,nd as O,oa as q,ra as Q,s as G,sc as b,xc as m,yc as l,yd as E,zc as d,zd as g}from"./chunk-5LC5EQRR.js";import{i as L,j as y}from"./chunk-3E746U5Y.js";var T=function(i){return i[i.NONE=0]="NONE",i[i.NEW=1]="NEW",i[i.UPDATE=2]="UPDATE",i[i.EDIT=3]="EDIT",i}(T||{}),v=function(i){return i[i.NONE=0]="NONE",i[i.ASSESS=1]="ASSESS",i[i.CREATE=2]="CREATE",i[i.UPDATE=3]="UPDATE",i}(v||{}),A=function(i){return i[i.SUBMISSION=0]="SUBMISSION",i[i.ASSESSMENT=1]="ASSESSMENT",i}(A||{}),f=(()=>{class i{context;ui;submissionEditButton;assessButton;constructor(e,n,s,u){this.context=e,this.ui=n,this.submissionEditButton=s,this.assessButton=u}edit(){this.context.state=new D(this.context)}assess(){this.context.state=new R(this.context)}static initialWithContext=e=>new j(e);static forExistingAssessmentWithContext=e=>new R(e);static forCompletion=e=>new z(e)}return i})(),j=class extends f{constructor(r){super(r,A.SUBMISSION,T.NEW,v.NONE)}},D=class extends f{constructor(r){super(r,A.SUBMISSION,T.UPDATE,v.ASSESS)}edit(){}assess(){this.context.state=new W(this.context)}},W=class extends f{constructor(r){super(r,A.ASSESSMENT,T.EDIT,v.CREATE)}},R=class extends f{constructor(r){super(r,A.ASSESSMENT,T.EDIT,v.UPDATE)}assess(){}},z=class extends f{constructor(r){super(r,A.ASSESSMENT,T.NONE,v.NONE)}edit(){}assess(){}};function Ne(i,r){i&1&&(t(0,`
                    `),d(1,"span",9),t(2,`
                `))}function Be(i,r){i&1&&(t(0,`
                `),m(1,"div",10),t(2,`
                    `),m(3,"div",11),t(4,`
                        `),d(5,"span",12),t(6,`
                    `),l(),t(7,`
                `),l(),t(8,`
            `))}function Oe(i,r){if(i&1){let e=S();t(0,`
                        `),m(1,"button",22),h("click",function(){p(e);let s=a(2);return x(s.createNewExampleTextSubmission())}),t(2,`
                            `),d(3,"fa-icon",23),t(4),E(5,"artemisTranslate"),l(),t(6,`
                    `)}if(i&2){let e=a(2);o(3),c("icon",e.faSave),o(),k(`
                            `,g(5,2,"artemisApp.exampleSubmission.createNewSubmission"),`
                        `)}}function Re(i,r){if(i&1){let e=S();t(0,`
                        `),m(1,"button",24),h("click",function(){p(e);let s=a(2);return x(s.updateExampleTextSubmission())}),t(2,`
                            `),d(3,"fa-icon",23),t(4),E(5,"artemisTranslate"),l(),t(6,`
                    `)}if(i&2){let e=a(2);o(),c("disabled",!e.unsavedSubmissionChanges),o(2),c("icon",e.faSave),o(),k(`
                            `,g(5,3,"artemisApp.exampleSubmission.updateExampleSubmission"),`
                        `)}}function Ve(i,r){if(i&1){let e=S();t(0,`
                        `),m(1,"jhi-confirm-button",25),h("onConfirm",function(){p(e);let s=a(2);return x(s.editSubmission())}),l(),t(2,`
                    `)}if(i&2){let e=a(2);o(),c("icon",e.faEdit)("translateText",!0)}}function Pe(i,r){if(i&1){let e=S();t(0,`
                        `),m(1,"button",26),h("click",function(){p(e);let s=a(2);return x(s.startAssessment())}),t(2,`
                            `),d(3,"fa-icon",23),t(4),E(5,"artemisTranslate"),l(),t(6,`
                    `)}if(i&2){let e=a(2);o(),c("disabled",e.unsavedSubmissionChanges),o(2),c("icon",e.faSave),o(),k(`
                            `,g(5,3,"artemisApp.exampleSubmission.createNewAssessment"),`
                        `)}}function Fe(i,r){if(i&1){let e=S();t(0,`
                        `),m(1,"button",27),h("click",function(){p(e);let s=a(2);return x(s.saveAssessments())}),t(2,`
                            `),d(3,"fa-icon",23),t(4),E(5,"artemisTranslate"),l(),t(6,`
                    `)}if(i&2){let e=a(2);o(),c("disabled",!e.assessmentsAreValid),o(2),c("icon",e.faSave),o(),k(`
                            `,g(5,3,"artemisApp.exampleSubmission.saveNewAssessment"),`
                        `)}}function Ue(i,r){if(i&1){let e=S();t(0,`
                        `),m(1,"button",28),h("click",function(){p(e);let s=a(2);return x(s.saveAssessments())}),t(2,`
                            `),d(3,"fa-icon",23),t(4),E(5,"artemisTranslate"),l(),t(6,`
                    `)}if(i&2){let e=a(2);o(),c("disabled",!e.assessmentsAreValid),o(2),c("icon",e.faSave),o(),k(`
                            `,g(5,3,"artemisApp.exampleSubmission.updateAssessment"),`
                        `)}}function je(i,r){if(i&1){let e=S();t(0,`
            `),m(1,"div",13),t(2,`
                `),m(3,"div"),t(4,`
                    `),m(5,"div",14),t(6,`
                        `),d(7,"span",15),t(8,`
                        `),d(9,"jhi-help-icon",16),t(10,`
                    `),l(),t(11,`
                    `),m(12,"div",17),t(13,`
                        `),m(14,"input",18),h("ngModelChange",function(s){p(e);let u=a();return x(u.onModeChange(s))}),l(),t(15,`
                        `),d(16,"label",19),t(17,`
                        `),m(18,"input",20),h("ngModelChange",function(s){p(e);let u=a();return x(u.onModeChange(s))}),l(),t(19,`
                        `),d(20,"label",21),t(21,`
                    `),l(),t(22,`
                `),l(),t(23,`
                `),_(24,Oe,7,4)(25,Re,7,5)(26,Ve,3,2),t(27,`
                `),_(28,Pe,7,5)(29,Fe,7,5)(30,Ue,7,5),t(31,`
            `),l(),t(32,`
        `)}if(i&2){let e,n,s=a();o(9),c("text","artemisApp.exampleSubmission.selectModelExplanation"),o(5),c("disabled",s.state.submissionEditButton===3)("value",s.ExampleSubmissionMode.READ_AND_CONFIRM)("ngModel",s.selectedMode),o(4),c("disabled",s.state.submissionEditButton===3)("value",s.ExampleSubmissionMode.ASSESS_CORRECTLY)("ngModel",s.selectedMode),o(6),b((e=s.state.submissionEditButton)===s.SubmissionButtonStates.NEW?24:e===s.SubmissionButtonStates.UPDATE?25:e===s.SubmissionButtonStates.EDIT?26:-1),o(4),b((n=s.state.assessButton)===s.AssessButtonStates.ASSESS?28:n===s.AssessButtonStates.CREATE?29:n===s.AssessButtonStates.UPDATE?30:-1)}}function De(i,r){i&1&&(t(0,`
    `),d(1,"h5",29),t(2,`
`))}function We(i,r){i&1&&(t(0,`
            `),d(1,"span",30),t(2,`
        `))}function ze(i,r){if(i&1&&(t(0,`
            `),d(1,"jhi-score-display",31),t(2,`
        `)),i&2){let e=a();o(),c("maxPoints",(e.exercise==null?null:e.exercise.maxPoints)||0)("score",e.totalScore)("maxBonusPoints",(e.exercise==null?null:e.exercise.bonusPoints)||0)}}function Le(i,r){if(i&1){let e=S();t(0,`
            `),m(1,"textarea",32),O("ngModelChange",function(s){p(e);let u=a();return B(u.submission.text,s)||(u.submission.text=s),x(s)}),h("ngModelChange",function(){p(e);let s=a();return x(s.unsavedSubmissionChanges=!0)}),l(),t(2,`
        `)}if(i&2){let e=a();o(),N("ngModel",e.submission.text)}}function Ge(i,r){if(i&1){let e=S();t(0,`
            `),m(1,"jhi-text-assessment-area",33),O("textBlockRefsChange",function(s){p(e);let u=a();return B(u.textBlockRefs,s)||(u.textBlockRefs=s),x(s)}),h("textBlockRefsChange",function(){p(e);let s=a();return x(s.validateFeedback())})("textBlockRefsAddedRemoved",function(){p(e);let s=a();return x(s.recalculateTextBlockRefs())}),l(),t(2,`
        `)}if(i&2){let e=a();o(),c("allowManualBlockSelection",!e.toComplete)("submission",e.submission),N("textBlockRefs",e.textBlockRefs),c("readOnly",e.readOnly||!!e.exercise&&!e.exercise.isAtLeastEditor&&!e.toComplete)}}function Ye(i,r){i&1&&(t(0,`
            `),d(1,"div",34),t(2,`
        `))}function He(i,r){i&1&&(t(0,`
            `),d(1,"div",35),t(2,`
        `))}function qe(i,r){if(i&1&&(t(0,`
            `),d(1,"jhi-assessment-instructions",36),t(2,`
        `)),i&2){let e=a();o(),c("exercise",e.exercise)("isAssessmentTraining",e.toComplete)("showAssessmentInstructions",e.state.ui===e.UIStates.ASSESSMENT)}}function Qe(i,r){if(i&1){let e=S();t(0,`
        `),m(1,"jhi-unreferenced-feedback",37),O("feedbacksChange",function(s){p(e);let u=a(2);return B(u.unreferencedFeedback,s)||(u.unreferencedFeedback=s),x(s)}),h("feedbacksChange",function(){p(e);let s=a(2);return x(s.validateFeedback())}),l(),t(2,`
    `)}if(i&2){let e=a(2);o(),N("feedbacks",e.unreferencedFeedback),c("readOnly",e.readOnly)("addReferenceIdForExampleSubmission",!0)("resultId",e.result.id)}}function Je(i,r){if(i&1&&(t(0,`
    `),_(1,Qe,3,4)),i&2){let e=a();o(),b(e.result&&e.result.id?1:-1)}}function Ke(i,r){if(i&1){let e=S();t(0,`
    `),m(1,"div",38),t(2,`
        `),m(3,"button",39),h("click",function(){p(e);let s=a();return x(s.checkAssessment())}),l(),t(4,`
    `),l(),t(5,`
`)}if(i&2){let e=a();o(3),c("disabled",!e.assessmentsAreValid)}}function Xe(i,r){if(i&1){let e=S();t(0,`
    `),m(1,"div",38),t(2,`
        `),m(3,"button",40),h("click",function(){p(e);let s=a();return x(s.readAndUnderstood())}),t(4,`
            `),d(5,"fa-icon",23),t(6),E(7,"artemisTranslate"),l(),t(8,`
    `),l(),t(9,`
`)}if(i&2){let e=a();o(5),c("icon",e.faSave),o(),k(`
            `,g(7,2,"artemisApp.exampleSubmission.readAndUnderstood"),`
        `)}}var Pt=(()=>{class i extends we{route=C(Z);router=C($);exampleSubmissionService=C(ke);tutorParticipationService=C(ce);guidedTourService=C(de);navigationUtilService=C(he);exerciseService=C(le);isNewSubmission;areNewAssessments=!0;unsavedSubmissionChanges=!1;exerciseId;exampleSubmissionId;exampleSubmission=new U;assessmentsAreValid=!1;result;unreferencedFeedback=[];totalScore;readOnly;toComplete;state=f.initialWithContext(this);SubmissionButtonStates=T;AssessButtonStates=v;UIStates=A;selectedMode;ExampleSubmissionMode=w;referencedBlocksInExampleSubmission=[];faSave=ae;faEdit=oe;farListAlt=Se;constructor(){super(),this.textBlockRefs=[],this.unusedTextBlockRefs=[],this.submission=new Te}get referencedFeedback(){return this.textBlockRefs.map(({feedback:e})=>e).filter(V)}get assessments(){return[...this.referencedFeedback,...this.unreferencedFeedback]}ngOnInit(){return y(this,null,function*(){yield L(i.prototype,this,"ngOnInit").call(this),this.exerciseId=Number(this.route.snapshot.paramMap.get("exerciseId"));let e=this.route.snapshot.paramMap.get("exampleSubmissionId");this.readOnly=!!this.route.snapshot.queryParamMap.get("readOnly"),this.toComplete=!!this.route.snapshot.queryParamMap.get("toComplete"),e==="new"?(this.isNewSubmission=!0,this.exampleSubmissionId=-1):this.exampleSubmissionId=+e,this.loadAll()})}loadAll(){this.exerciseService.find(this.exerciseId).subscribe(e=>{this.exercise=e.body,this.guidedTourService.enableTourForExercise(this.exercise,_e,!1)}),!this.isNewSubmission&&(this.state.edit(),this.exampleSubmissionService.get(this.exampleSubmissionId).subscribe(e=>y(this,null,function*(){this.exampleSubmission=e.body,this.submission=this.exampleSubmission.submission,yield this.fetchExampleResult(),this.toComplete?(this.state=f.forCompletion(this),this.restrictSelectableTextBlocks(),this.textBlockRefs.forEach(n=>delete n.feedback),this.validateFeedback()):this.result?.id&&(this.state=f.forExistingAssessmentWithContext(this)),this.guidedTourService.componentPageLoaded(),this.exampleSubmission.usedForTutorial?this.selectedMode=w.ASSESS_CORRECTLY:this.selectedMode=w.READ_AND_CONFIRM})))}restrictSelectableTextBlocks(){this.textBlockRefs.forEach(e=>{e.block&&this.referencedBlocksInExampleSubmission.includes(e.block.id)?(e.selectable=!0,e.highlighted=!0,e.deletable=!1):(e.selectable=!1,e.highlighted=!1,e.deletable=!0)})}fetchExampleResult(){return new Promise(e=>{this.assessmentsService.getExampleResult(this.exerciseId,this.submission?.id).pipe(H(V)).subscribe(n=>{n&&n.id?(this.result=n,this.exampleSubmission.submission=this.submission=n.submission,this.updateExampleAssessmentSolution(n)):(n&&!n.id&&this.updateExampleAssessmentSolution(n),this.result=new F,this.result.submission=this.submission,this.submission.results=[this.result]),this.prepareTextBlocksAndFeedbacks(),this.areNewAssessments=this.assessments.length<=0,this.validateFeedback(),e()})})}createNewExampleTextSubmission(){let e=new U;e.submission=this.submission,e.exercise=this.exercise,e.usedForTutorial=this.selectedMode===w.ASSESS_CORRECTLY,this.exampleSubmissionService.create(e,this.exerciseId).subscribe({next:n=>{this.exampleSubmission=n.body,this.exampleSubmission.exercise=this.exercise,this.exampleSubmissionId=this.exampleSubmission.id,this.submission=this.exampleSubmission.submission,this.isNewSubmission=!1,this.unsavedSubmissionChanges=!1,this.state.edit(),this.navigationUtilService.replaceNewWithIdInUrl(window.location.href,this.exampleSubmissionId),this.alertService.success("artemisApp.exampleSubmission.submitSuccessful")},error:this.alertService.error})}updateExampleTextSubmission(){this.saveSubmissionIfNeeded().subscribe({next:()=>{this.state.edit(),this.alertService.success("artemisApp.exampleSubmission.saveSuccessful")},error:this.alertService.error})}saveSubmissionIfNeeded(){return this.unsavedSubmissionChanges?this.exampleSubmissionService.update(this.exampleSubmissionForNetwork(),this.exerciseId).pipe(Q(e=>{this.exampleSubmission=e.body,this.unsavedSubmissionChanges=!1})):G({})}startAssessment(){return y(this,null,function*(){this.exampleSubmissionService.prepareForAssessment(this.exerciseId,this.exampleSubmissionId).pipe(Y(()=>this.exampleSubmissionService.get(this.exampleSubmissionId))).subscribe(e=>{this.exampleSubmission=e.body,this.submission=this.exampleSubmission.submission,this.result=new F,this.result.submission=this.submission,this.submission.results=[this.result],this.prepareTextBlocksAndFeedbacks(),this.areNewAssessments=this.assessments.length<=0,this.validateFeedback(),this.state.assess()})})}saveAssessments(){if(this.validateFeedback(),!this.assessmentsAreValid){this.alertService.error("artemisApp.textAssessment.error.invalidAssessments");return}this.saveSubmissionIfNeeded().pipe(q(()=>this.assessmentsService.saveExampleAssessment(this.exerciseId,this.exampleSubmission.id,this.assessments,this.textBlocksWithFeedback))).subscribe({next:e=>{this.result=e.body,this.areNewAssessments=!1,this.state.assess(),this.alertService.success("artemisApp.textAssessment.saveSuccessful")},error:this.alertService.error})}back(){return y(this,null,function*(){let e=re(this.exercise)?.id;if(this.exercise?.exerciseGroup){let n=this.exercise.exerciseGroup.exam?.id,s=this.exercise.exerciseGroup.id;this.readOnly||this.toComplete?yield this.router.navigate(["/course-management",e,"assessment-dashboard",this.exerciseId]):yield this.router.navigate(["/course-management",e,"exams",n,"exercise-groups",s,"text-exercises",this.exerciseId,"example-submissions"])}else this.readOnly||this.toComplete?this.router.navigate(["/course-management",e,"assessment-dashboard",this.exerciseId]):this.router.navigate(["/course-management",e,"text-exercises",this.exerciseId,"example-submissions"])})}checkAssessment(){if(this.validateFeedback(),!this.assessmentsAreValid){this.alertService.error("artemisApp.textAssessment.error.invalidAssessments");return}new Me(this.tutorParticipationService,this.alertService,this).assessExampleSubmission(this.exampleSubmissionForNetwork(),this.exerciseId)}markAllFeedbackToCorrect(){this.textBlockRefs.map(e=>e.feedback).filter(e=>e!=null).concat(this.unreferencedFeedback).forEach(e=>{e.correctionStatus="CORRECT"})}markWrongFeedback(e){e.forEach(n=>{let s=this.textBlockRefs.find(u=>u.feedback?.reference===n.reference);if(s!=null&&s.feedback!=null)s.feedback.correctionStatus=n.type;else{let u=this.unreferencedFeedback.find(Ie=>Ie.reference===n.reference);u&&(u.correctionStatus=n.type)}})}exampleSubmissionForNetwork(){let e=Object.assign({},this.exampleSubmission);if(e.submission=Object.assign({},this.submission),this.result){let n=Object.assign({},this.result);me(e.submission,n),n.feedbacks=this.assessments,delete n?.submission}else delete e.submission.results,delete e.submission.latestResult;return e}validateFeedback(){this.assessmentsAreValid=this.assessments.length>0,this.totalScore=this.computeTotalScore(this.assessments),this.guidedTourService.currentTour&&this.toComplete&&this.guidedTourService.updateAssessmentResult(this.assessments.length,this.totalScore)}readAndUnderstood(){this.tutorParticipationService.assessExampleSubmission(this.exampleSubmission,this.exerciseId).subscribe(()=>{this.alertService.success("artemisApp.exampleSubmission.readSuccessfully"),this.back()})}prepareTextBlocksAndFeedbacks(){let e=Ee.matchBlocksWithFeedbacks(this.submission?.blocks||[],this.result?.feedbacks||[]);this.sortAndSetTextBlockRefs(e,this.textBlockRefs,this.unusedTextBlockRefs,this.submission),this.toComplete||(this.unreferencedFeedback=this.result?.feedbacks?.filter(n=>n.type===P.MANUAL_UNREFERENCED)??[])}editSubmission(){this.assessmentsService.deleteExampleAssessment(this.exercise.id,this.exampleSubmission?.id).subscribe(()=>{delete this.submission?.blocks,this.submission&&this.submission.results&&(this.submission.results=void 0,this.submission.latestResult=void 0),this.result=void 0,this.textBlockRefs=[],this.unusedTextBlockRefs=[],this.state.edit()})}onModeChange(e){this.selectedMode=e,this.unsavedSubmissionChanges=!0,this.exampleSubmission.usedForTutorial=e===w.ASSESS_CORRECTLY}updateExampleAssessmentSolution(e){e&&e.feedbacks&&(this.referencedBlocksInExampleSubmission=e.feedbacks.filter(n=>n.type!==P.MANUAL_UNREFERENCED&&n.reference).map(n=>n.reference)||[])}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=J({type:i,selectors:[["jhi-example-text-submission"]],features:[K],decls:48,vars:19,consts:[[1,"course-info-bar"],[1,"row","justify-content-between"],[1,"col-6"],[1,"col-12","mt-3"],["left-header",""],["left-body",""],["right-header","",3,"icon"],["right-header","","jhiTranslate","artemisApp.textAssessment.instructions"],["right-body",""],["jhiTranslate","artemisApp.exampleSubmission.createNew"],[1,"col"],[1,"my-2","text-center","hint"],["jhiTranslate","artemisApp.exampleSubmission.textHint"],[1,"col-4","text-end","d-flex","align-items-center","gap-2","justify-content-end"],[1,"text-start"],["jhiTranslate","artemisApp.exampleSubmission.assessmentTraining"],[3,"text"],["role","group",1,"btn-group"],["type","radio","name","mode","id","read-and-confirm-button","autocomplete","off",1,"btn-check",3,"ngModelChange","disabled","value","ngModel"],["for","read-and-confirm-button","jhiTranslate","artemisApp.exampleSubmission.readAndConfirm",1,"btn","btn-outline-secondary"],["type","radio","name","mode","id","only-not-imported","autocomplete","off",1,"btn-check",3,"ngModelChange","disabled","value","ngModel"],["for","only-not-imported","jhiTranslate","artemisApp.exampleSubmission.assessCorrectly",1,"btn","btn-outline-secondary"],["id","create-example-submission",1,"btn","btn-primary","col-auto",3,"click"],[3,"icon"],[1,"btn","btn-primary","col-auto",3,"click","disabled"],["id","editSampleSolution","title","artemisApp.exampleSubmission.editExampleSubmission","confirmationText","artemisApp.exampleSubmission.editExampleSubmissionConfirmationQuestion","confirmationTitle","artemisApp.exampleSubmission.editExampleSubmission",1,"col-auto",3,"onConfirm","icon","translateText"],["id","createNewAssessment",1,"btn","btn-primary","col-auto","ms-auto","me-3",3,"click","disabled"],["id","saveNewAssessment",1,"btn","btn-primary","col-auto","ms-auto","me-3",3,"click","disabled"],[1,"btn","btn-primary","col-auto","ms-auto","me-3",3,"click","disabled"],["jhiTranslate","artemisApp.exampleSubmission.home.assessmentTraining",1,"fw-light","mt-3"],["jhiTranslate","artemisApp.exampleSubmission.exampleSubmission"],[3,"maxPoints","score","maxBonusPoints"],["id","example-text-submission-input",2,"width","100%","height","50vh",3,"ngModelChange","ngModel"],[1,"guided-tour-assessment-editor","guided-tour-complete-assessment-editor",3,"textBlockRefsChange","textBlockRefsAddedRemoved","allowManualBlockSelection","submission","textBlockRefs","readOnly"],["role","alert","jhiTranslate","artemisApp.textAssessment.exampleSubmissionInstruction",1,"alert","alert-info","text-center","mb-4"],["role","alert","jhiTranslate","artemisApp.textAssessment.assessmentInstruction",1,"alert","alert-info","text-center","mb-4"],["id","instructions",1,"markdown-preview",3,"exercise","isAssessmentTraining","showAssessmentInstructions"],[3,"feedbacksChange","feedbacks","readOnly","addReferenceIdForExampleSubmission","resultId"],[1,"col-12","text-end","pt-2"],["id","checkAssessment","jhiTranslate","artemisApp.exampleSubmission.submitAssessment",1,"btn","btn-primary","col-3","guided-tour-check-assessment",3,"click","disabled"],[1,"btn","btn-success","col-3","guided-tour-read",3,"click"]],template:function(n,s){n&1&&(m(0,"div",0),t(1,`
    `),m(2,"div",1),t(3,`
        `),m(4,"div",2),t(5,`
            `),m(6,"h2"),t(7,`
                `),_(8,Ne,3,0),t(9),E(10,"artemisTranslate"),l(),t(11,`
            `),_(12,Be,9,0),l(),t(13,`
        `),_(14,je,33,9),l(),t(15,`
`),l(),t(16,`
`),_(17,De,3,0),m(18,"jhi-resizeable-container",3),t(19,`
    `),t(20,`
    `),M(21,4),t(22,`
        `),_(23,We,3,0)(24,ze,3,3),I(),t(25,`
    `),M(26,5),t(27,`
        `),_(28,Le,3,1)(29,Ge,3,4),I(),t(30,`
    `),t(31,`
    `),t(32,`
    `),d(33,"fa-icon",6),t(34,`\xA0
    `),d(35,"span",7),t(36,`
    `),M(37,8),t(38,`
        `),_(39,Ye,3,0)(40,He,3,0)(41,qe,3,3),I(),t(42,`
    `),t(43,`
`),l(),t(44,`
`),_(45,Je,2,1)(46,Ke,6,1)(47,Xe,10,4)),n&2&&(o(8),b(s.isNewSubmission?8:-1),o(),X(`
                `,g(10,17,"artemisApp.exampleSubmission.pageHeader"),`
                `,s.exercise==null?null:s.exercise.title,`
            `),o(3),b(s.state.ui===s.UIStates.ASSESSMENT&&s.toComplete&&s.referencedBlocksInExampleSubmission&&s.referencedBlocksInExampleSubmission.length>0?12:-1),o(2),b(s.exercise!=null&&s.exercise.isAtLeastEditor&&!s.readOnly&&!s.toComplete&&s.exercise?14:-1),o(3),b(s.toComplete?17:-1),o(6),b(s.state.ui===s.UIStates.SUBMISSION?23:-1),o(),b(s.state.ui===s.UIStates.ASSESSMENT?24:-1),o(4),b(s.state.ui===s.UIStates.SUBMISSION?28:-1),o(),b(s.state.ui===s.UIStates.ASSESSMENT?29:-1),o(4),c("icon",s.farListAlt),o(6),b(s.state.ui===s.UIStates.SUBMISSION?39:-1),o(),b(s.state.ui===s.UIStates.ASSESSMENT?40:-1),o(),b(s.exercise?41:-1),o(4),b(s.state.ui===s.UIStates.ASSESSMENT?45:-1),o(),b(s.toComplete?46:-1),o(),b(s.readOnly?47:-1))},dependencies:[xe,be,ne,ee,se,te,ie,pe,Ce,ve,Ae,ye,fe,ge,ue],styles:[".hint[_ngcontent-%COMP%]{color:var(--textblock-assessment-text-feedback-highlighted-color);background-color:var(--textblock-assessment-text-feedback-highlighted-background)}.resizing-bar[_ngcontent-%COMP%], .resizing-bar-assessment[_ngcontent-%COMP%], .resizing-bar-bottom[_ngcontent-%COMP%]{line-height:14px;z-index:1;-moz-user-select:-moz-none;-ms-user-select:none;-webkit-user-select:none;user-select:none;background:0 0}.resizing-bar[_ngcontent-%COMP%], .resizing-bar-assessment[_ngcontent-%COMP%]{position:absolute;cursor:col-resize;height:100%;left:0;top:0;margin-left:-20px}.resizing-bar-bottom[_ngcontent-%COMP%]{cursor:row-resize;width:100%;bottom:0;left:0;margin-bottom:-14px}.resizing-bar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .resizing-bar-assessment[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;display:block;border-style:solid;border-color:#ccc;top:50%;margin:-10px 0 0 3.5px;height:20px;width:7px;border-width:0 1px}.resizing-bar-bottom[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;display:block;border-style:solid;border-color:#ccc;border-width:1px 0;left:50%;margin:3.5px 0 0 -10px;width:20px;height:7px}.card.collapsed[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%], .card.collapsed[_ngcontent-%COMP%]   .card-second-header[_ngcontent-%COMP%], .card.collapsed[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .float-end[_ngcontent-%COMP%], .card.collapsed[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.card.collapsed[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{text-align:center}.submission-area[_ngcontent-%COMP%]{word-wrap:break-word}"]})}return i})();export{Pt as ExampleTextSubmissionComponent};
//# sourceMappingURL=example-text-submission.component-DZQNRT2K.js.map
