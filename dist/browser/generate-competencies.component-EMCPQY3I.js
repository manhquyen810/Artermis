import{a as We}from"./chunk-QE5JM26C.js";import{a as N}from"./chunk-6FT4PREA.js";import{a as Oe,c as ze}from"./chunk-6I3MUES2.js";import{a as Ge}from"./chunk-7MKMUXV6.js";import{a as Ve}from"./chunk-KVEPPZB4.js";import{a as J}from"./chunk-GAUWMTOK.js";import{c as U,l as ke}from"./chunk-DOLVNMRR.js";import{D as Ne}from"./chunk-RTOKZMYN.js";import"./chunk-5QODR5GQ.js";import"./chunk-RNPAFOPW.js";import"./chunk-KZGAUMRM.js";import"./chunk-656XE4CO.js";import"./chunk-YGSJB6WY.js";import"./chunk-O2WHE2S3.js";import"./chunk-JJUII2KT.js";import"./chunk-U4DJRHYQ.js";import{a as Pe}from"./chunk-JRBFEQNN.js";import"./chunk-DIZEKHOC.js";import"./chunk-V7PDYRDZ.js";import"./chunk-EANMTTQG.js";import"./chunk-PNTOXB52.js";import"./chunk-Z2YUBN6N.js";import"./chunk-AO5E7TEY.js";import{a as b,b as X,d as $}from"./chunk-O26CMRR4.js";import{a as je}from"./chunk-MP6UGYTC.js";import"./chunk-VWRLJYRR.js";import{a as Fe}from"./chunk-UDBRF4PR.js";import"./chunk-QH7SWO42.js";import"./chunk-P2M2VQE3.js";import"./chunk-GXOKLIFX.js";import"./chunk-5JBXU6VG.js";import"./chunk-4I367PEU.js";import"./chunk-ZPITQMA6.js";import"./chunk-MKPB4JKY.js";import"./chunk-I76AVIQH.js";import"./chunk-H2ETPEH6.js";import"./chunk-Z6NSEM73.js";import{d as Be}from"./chunk-AR57MWOI.js";import"./chunk-A5PTZAPN.js";import"./chunk-AU6UEH3U.js";import"./chunk-FGAONQTL.js";import"./chunk-HQ6UGNQX.js";import"./chunk-ZLJ76G5I.js";import"./chunk-MLVGKM2P.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import{c as k}from"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import{K as q,a as _e,v as xe}from"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import{I as ye,J as H,K as M,L as B,b as Ce,c as G,e as _,h as O,i as R,j as he,n as z,s as L,t as ve,u as ge,v as W}from"./chunk-WA5GEAJB.js";import"./chunk-DRSQQEUE.js";import"./chunk-7XXWL6ER.js";import"./chunk-VK7JPHFE.js";import"./chunk-BQNBT6PW.js";import"./chunk-5GXY5RYT.js";import{a as F}from"./chunk-K3W6YFKH.js";import"./chunk-TL3DYXRE.js";import{c as Me}from"./chunk-JXJXC4DZ.js";import{d as j}from"./chunk-EDXSOKK5.js";import"./chunk-R5BZWVRQ.js";import"./chunk-DID2YGL7.js";import"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Bb as Ae,Oc as Re,Uc as Le,fa as Ie,hb as we,kb as Ee,q as Te,tb as Q,y as De}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import"./chunk-HKBU2OOC.js";import{a as Se}from"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as x}from"./chunk-U54OSGNH.js";import{f as ue,h as fe}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import{c as be}from"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import{n as de}from"./chunk-IOA4DPXY.js";import{Bb as ne,Db as o,Dc as E,Ea as h,Ma as D,Mc as f,Na as I,Oc as d,Rc as P,Sc as g,Tb as y,Va as w,Yc as se,Zb as v,Zc as le,_c as me,c as ee,dd as e,ed as ce,kc as c,mc as V,rd as A,sc as u,sd as pe,uc as oe,vc as re,wb as ie,wc as ae,x as te,xc as a,yc as s,yd as S,z as Y,zc as l,zd as T}from"./chunk-5LC5EQRR.js";import"./chunk-3E746U5Y.js";var $e=(n,p)=>["jhi-btn","btn",n,p];function Ue(n,p){if(n&1&&(e(0,`
        `),l(1,"fa-icon",1),e(2,`
    `)),n&2){let i=d();o(),c("icon",i.faCircleNotch)}}function Ye(n,p){if(n&1&&(e(0,`
        `),l(1,"jhi-iris-logo",2),e(2,`
    `)),n&2){let i=d();o(),c("size",i.SMALL)}}function Je(n,p){if(n&1&&(e(0,`
        `),l(1,"span",3),e(2,`
    `)),n&2){let i=d();o(),V("ms-1",!0),c("jhiTranslate",i.title)}}var He=(()=>{class n{btnType=b.PRIMARY;btnSize=X.MEDIUM;title;tooltip;disabled=!1;isLoading=!1;featureToggle;shouldSubmit=!0;onClick=new w;faCircleNotch=De;SMALL=Oe.SMALL;static \u0275fac=function(r){return new(r||n)};static \u0275cmp=y({type:n,selectors:[["jhi-iris-logo-button"]],inputs:{btnType:"btnType",btnSize:"btnSize",title:"title",tooltip:"tooltip",disabled:"disabled",isLoading:"isLoading",featureToggle:"featureToggle",shouldSubmit:"shouldSubmit"},outputs:{onClick:"onClick"},decls:7,vars:12,consts:[[3,"click","ngClass","type","ngbTooltip","jhiFeatureToggle","overwriteDisabled"],["animation","spin","size","sm",1,"jhi-btn__loading",3,"icon"],[3,"size"],[1,"jhi-btn__title",3,"jhiTranslate"]],template:function(r,t){r&1&&(a(0,"button",0),S(1,"artemisTranslate"),f("click",function(C){return t.onClick.emit(C)}),e(2,`
    `),v(3,Ue,3,1)(4,Ye,3,1)(5,Je,3,3),s(),e(6,`
`)),r&2&&(P("ngbTooltip",T(1,7,t.tooltip)),c("ngClass",pe(9,$e,t.btnType,t.btnSize))("type",t.shouldSubmit?"submit":"button")("jhiFeatureToggle",t.featureToggle)("overwriteDisabled",t.disabled||t.isLoading),o(3),u(t.isLoading?3:4),o(2),u(t.title?5:-1))},dependencies:[de,q,je,j,ze,x,F],encapsulation:2})}return n})();var Ke=n=>({min:n}),Ze=n=>({max:n});function et(n,p){n&1&&(e(0,`
                    `),l(1,"div",8),e(2,`
                `))}function tt(n,p){if(n&1&&(e(0,`
                    `),l(1,"div",9),e(2,`
                `)),n&2){let i=d(2);o(),c("translateValues",A(1,Ke,i.DESCRIPTION_MIN))}}function it(n,p){if(n&1&&(e(0,`
                    `),l(1,"div",10),e(2,`
                `)),n&2){let i=d(2);o(),c("translateValues",A(1,Ze,i.DESCRIPTION_MAX))}}function nt(n,p){if(n&1&&(e(0,`
            `),a(1,"div",7),e(2,`
                `),v(3,et,3,0)(4,tt,3,3)(5,it,3,3),s(),e(6,`
        `)),n&2){let i=d();o(3),u(i.courseDescriptionControl.errors!=null&&i.courseDescriptionControl.errors.required?3:-1),o(),u(i.courseDescriptionControl.errors!=null&&i.courseDescriptionControl.errors.minlength?4:-1),o(),u(i.courseDescriptionControl.errors!=null&&i.courseDescriptionControl.errors.maxlength?5:-1)}}var Z=(()=>{class n{formBuilder=h(H);isLoading=!1;placeholder="";formSubmitted=new w;form;hasBeenSubmitted=!1;faQuestionCircle=Ee;DESCRIPTION_MAX=1e4;DESCRIPTION_MIN=100;ButtonType=b;ngOnInit(){this.form=this.formBuilder.group({courseDescription:[this.placeholder,[_.required,_.minLength(this.DESCRIPTION_MIN),_.maxLength(this.DESCRIPTION_MAX)]]})}setCourseDescription(i){this.form.controls.courseDescription.setValue(i)}submitForm(){this.formSubmitted.emit(this.form.value.courseDescription??""),this.hasBeenSubmitted=!0}get isSubmitPossible(){return!this.form.invalid}get courseDescriptionControl(){return this.form.controls.courseDescription}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=y({type:n,selectors:[["jhi-course-description-form"]],inputs:{isLoading:"isLoading",placeholder:"placeholder"},outputs:{formSubmitted:"formSubmitted"},decls:20,vars:14,consts:[[3,"ngSubmit","formGroup"],[1,"d-flex","align-items-center"],["jhiTranslate","artemisApp.competency.generate.courseDescription.title","for","courseDescription",1,"me-1","form-control-label"],[1,"text-secondary",3,"icon","ngbTooltip"],[1,"form-group","mb-2"],["id","courseDescription","rows","10","formControlName","courseDescription",1,"form-control",3,"placeholder"],["id","generateButton",3,"btnType","title","tooltip","disabled","isLoading"],[1,"alert","alert-danger","mb-0"],["jhiTranslate","artemisApp.competency.generate.courseDescription.requiredValidationError"],["jhiTranslate","artemisApp.competency.generate.courseDescription.minlengthValidationError",3,"translateValues"],["jhiTranslate","artemisApp.competency.generate.courseDescription.maxlengthValidationError",3,"translateValues"]],template:function(r,t){r&1&&(a(0,"form",0),f("ngSubmit",function(){return t.submitForm()}),e(1,`
    `),a(2,"div",1),e(3,`
        `),l(4,"label",2),e(5,`
        `),l(6,"fa-icon",3),S(7,"artemisTranslate"),e(8,`
    `),s(),e(9,`
    `),a(10,"div",4),e(11,`
        `),l(12,"textarea",5),S(13,"artemisTranslate"),e(14,`
        `),v(15,nt,7,3),s(),e(16,`
    `),l(17,"jhi-iris-logo-button",6),e(18,`
`),s(),e(19,`
`)),r&2&&(c("formGroup",t.form),o(6),P("ngbTooltip",T(7,10,"artemisApp.competency.generate.courseDescription.infoTooltip")),c("icon",t.faQuestionCircle),o(6),c("placeholder",T(13,12,"artemisApp.competency.generate.courseDescription.placeholder")),o(3),u(t.courseDescriptionControl.invalid&&(t.courseDescriptionControl.dirty||t.courseDescriptionControl.touched)?15:-1),o(2),c("btnType",t.ButtonType.PRIMARY_OUTLINE)("title",t.hasBeenSubmitted?"artemisApp.competency.generate.courseDescription.regenerate":"entity.action.generate")("tooltip",t.hasBeenSubmitted?"artemisApp.competency.generate.courseDescription.regenerateTooltip":"")("disabled",!t.isSubmitPossible)("isLoading",t.isLoading))},dependencies:[M,z,G,O,R,B,L,W,x,j,q,He,F],encapsulation:2})}return n})();var Qe=n=>({max:n});function ot(n,p){if(n&1){let i=E();e(0,`
                `),a(1,"jhi-button",18),f("onClick",function(){D(i);let t=d();return I(t.edit())}),s(),e(2,`
            `)}if(n&2){let i=d();o(),g("id","editButton-",i.index,""),c("btnType",i.ButtonType.WARNING)("btnSize",i.ButtonSize.SMALL)("title","entity.action.edit")("icon",i.faPencilAlt)("shouldSubmit",!1)}}function rt(n,p){if(n&1){let i=E();e(0,`
                `),a(1,"jhi-button",19),f("onClick",function(){D(i);let t=d();return I(t.save())}),s(),e(2,`
            `)}if(n&2){let i=d();o(),g("id","saveButton-",i.index,""),c("btnType",i.ButtonType.SUCCESS)("btnSize",i.ButtonSize.SMALL)("title","entity.action.save")("icon",i.faSave)("disabled",!i.isSavePossible)("shouldSubmit",!1)}}function at(n,p){n&1&&(e(0,`
                        `),l(1,"div",21),e(2,`
                    `))}function st(n,p){if(n&1&&(e(0,`
                        `),l(1,"div",22),e(2,`
                    `)),n&2){let i=d(2);o(),c("translateValues",A(1,Qe,i.competencyValidators.TITLE_MAX))}}function lt(n,p){if(n&1&&(e(0,`
                `),a(1,"div",20),e(2,`
                    `),v(3,at,3,0)(4,st,3,3),s(),e(5,`
            `)),n&2){let i=d();o(3),u(i.titleControl.errors!=null&&i.titleControl.errors.required?3:-1),o(),u(i.titleControl.errors!=null&&i.titleControl.errors.maxlength?4:-1)}}function mt(n,p){if(n&1){let i=E();e(0,`
                `),a(1,"jhi-markdown-editor-monaco",23),f("markdownChange",function(t){D(i);let m=d();return I(m.updateDescriptionControl(t))}),s(),e(2,`
            `)}if(n&2){let i=d();o(),g("id","description-",i.index,""),c("markdown",i.descriptionControl.value)("enableFileUpload",!1)}}function ct(n,p){if(n&1&&(e(0,`
                `),l(1,"div",24),S(2,"htmlForMarkdown"),e(3,`
            `)),n&2){let i=d();o(),g("id","description-",i.index,""),c("innerHTML",T(2,3,i.descriptionControl.value||"\xA0"),ie)}}function pt(n,p){if(n&1&&(e(0,`
                        `),l(1,"div",25),e(2,`
                    `)),n&2){let i=d(2);o(),c("translateValues",A(1,Qe,i.competencyValidators.DESCRIPTION_MAX))}}function dt(n,p){if(n&1&&(e(0,`
                `),a(1,"div",20),e(2,`
                    `),v(3,pt,3,3),s(),e(4,`
            `)),n&2){let i=d();o(3),u(i.descriptionControl.errors!=null&&i.descriptionControl.errors.maxlength?3:-1)}}var Xe=(()=>{class n{form;index;isCollapsed=!0;isInEditMode=!1;onDelete=new w;faChevronRight=Le;faTrash=Ae;faWrench=we;faSave=Q;faPencilAlt=Te;competencyValidators=U;ButtonType=b;ButtonSize=X;ngOnInit(){this.titleControl.addValidators([_.required,_.maxLength(U.TITLE_MAX)]),this.descriptionControl.addValidators([_.maxLength(U.DESCRIPTION_MAX)]),this.form.controls.competency.disable(),this.viewedControl.enable()}toggle(){this.isCollapsed=!this.isCollapsed,this.viewedControl.setValue(!0)}delete(){this.onDelete.emit()}edit(){this.form.controls.competency.enable(),this.isInEditMode=!0,this.isCollapsed=!1,this.viewedControl.setValue(!0)}save(){this.form.controls.competency.disable(),this.isInEditMode=!1,this.isCollapsed=!0}updateDescriptionControl(i){this.descriptionControl.setValue(i),this.descriptionControl.markAsDirty()}get isSavePossible(){return!this.form.invalid}get titleControl(){return this.form.controls.competency.controls.title}get descriptionControl(){return this.form.controls.competency.controls.description}get taxonomyControl(){return this.form.controls.competency.controls.taxonomy}get viewedControl(){return this.form.controls.viewed}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=y({type:n,selectors:[["jhi-competency-recommendation"]],inputs:{form:"form",index:"index",isCollapsed:"isCollapsed"},outputs:{onDelete:"onDelete"},decls:57,vars:32,consts:[[1,"card","form-group",3,"formGroup"],[1,"card-header"],[1,"d-flex","align-items-center","mw-100","clickable",3,"click"],[1,"me-3"],[1,"rotate-icon","chevron-position",3,"icon"],[1,"mb-0","text-nowrap","text-truncate","overflow-hidden"],[1,"d-flex","align-items-center","flex-grow-1","justify-content-end"],[1,"d-flex","me-3"],["type","checkbox","formControlName","viewed",1,"me-1",3,"id"],["jhiTranslate","artemisApp.competency.generate.viewedLabel",3,"for"],[3,"click","id","btnType","btnSize","title","icon","shouldSubmit"],["formGroupName","competency",1,"card-body","border-0",3,"ngbCollapse"],[1,"form-group"],["jhiTranslate","artemisApp.competency.title",3,"for"],["type","text","formControlName","title",1,"form-control",3,"id"],["jhiTranslate","artemisApp.competency.description",3,"for"],["jhiTranslate","artemisApp.competency.taxonomy",3,"for"],[3,"selectId","form"],[1,"me-1",3,"onClick","id","btnType","btnSize","title","icon","shouldSubmit"],[1,"me-1",3,"onClick","id","btnType","btnSize","title","icon","disabled","shouldSubmit"],[1,"alert","alert-danger"],["jhiTranslate","artemisApp.competency.create.titleRequiredValidationError"],["jhiTranslate","artemisApp.competency.create.titleMaxLengthValidationError",3,"translateValues"],[1,"markdown-preview",3,"markdownChange","markdown","id","enableFileUpload"],["disabled","true",1,"markdown-preview","border","rounded","p-1",3,"id","innerHTML"],["jhiTranslate","artemisApp.competency.create.descriptionMaxLengthValidationError",3,"translateValues"]],template:function(r,t){if(r&1&&(a(0,"div",0),e(1,`
    `),a(2,"div",1),e(3,`
        `),a(4,"div",2),f("click",function(){return t.toggle()}),e(5,`
            `),a(6,"div",3),e(7,`
                `),l(8,"fa-icon",4),e(9,`
            `),s(),e(10,`
            `),a(11,"h6",5),e(12),s(),e(13,`
        `),s(),e(14,`
        `),a(15,"div",6),e(16,`
            `),a(17,"div",7),e(18,`
                `),l(19,"input",8),e(20,`
                `),l(21,"label",9),e(22,`
            `),s(),e(23,`
            `),v(24,ot,3,7)(25,rt,3,8),a(26,"jhi-button",10),f("click",function(){return t.delete()}),s(),e(27,`
        `),s(),e(28,`
    `),s(),e(29,`
    `),a(30,"div",11),e(31,`
        `),a(32,"div",12),e(33,`
            `),l(34,"label",13),e(35,`
            `),l(36,"input",14),e(37,`
            `),v(38,lt,6,2),s(),e(39,`
        `),a(40,"div",12),e(41,`
            `),l(42,"label",15),e(43,`
            `),v(44,mt,3,4)(45,ct,4,5)(46,dt,5,1),s(),e(47,`
        `),a(48,"div",12),e(49,`
            `),l(50,"label",16),e(51,`
            `),l(52,"jhi-taxonomy-select",17),e(53,`
        `),s(),e(54,`
    `),s(),e(55,`
`),s(),e(56,`
`)),r&2){let m;c("formGroup",t.form),o(8),V("rotated",!t.isCollapsed),c("icon",t.faChevronRight),o(4),ce((m=t.titleControl.value)!==null&&m!==void 0?m:""),o(7),g("id","viewed-",t.index,""),o(2),g("for","viewed-",t.index,""),o(3),u(t.isInEditMode?25:24),o(2),g("id","deleteButton-",t.index,""),c("btnType",t.ButtonType.ERROR)("btnSize",t.ButtonSize.SMALL)("title","entity.action.delete")("icon",t.faTrash)("shouldSubmit",!1),o(4),c("ngbCollapse",t.isCollapsed),o(4),g("for","title-",t.index,""),o(2),g("id","title-",t.index,""),o(2),u(t.titleControl.invalid&&(t.titleControl.dirty||t.titleControl.touched)?38:-1),o(4),g("for","description-",t.index,""),o(2),u(t.isInEditMode?44:45),o(2),u(t.descriptionControl.invalid&&t.descriptionControl.dirty?46:-1),o(4),g("for","taxonomy-",t.index,""),o(2),g("selectId","taxonomy-",t.index,""),c("form",t.taxonomyControl)}},dependencies:[M,G,Ce,O,R,B,L,W,ve,j,x,$,_e,Ne,Ve,Pe],styles:[".card[_ngcontent-%COMP%]{background-color:var(--overview-light-background-color);margin-bottom:.5rem}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;overflow:hidden;flex-wrap:wrap;row-gap:.5rem}"]})}return n})();function ut(n,p){n&1&&(e(0,`
        `),a(1,"div",11),e(2,`
            `),a(3,"div",12),e(4,`
                `),l(5,"span",13),e(6,`
            `),s(),e(7,`
            `),l(8,"span",14),e(9,`
        `),s(),e(10,`
    `))}function ft(n,p){n&1&&(e(0,`
            `),l(1,"div",15),e(2,`
        `))}function Ct(n,p){if(n&1){let i=E();e(0,`
                `),a(1,"jhi-competency-recommendation",16),f("onDelete",function(){let t=D(i).$index,m=d();return I(m.onDelete(t))}),s(),e(2,`
            `)}if(n&2){let i=p.$implicit,r=p.$index;o(),c("form",i)("index",r)}}var Mi=(()=>{class n{courseManagementService=h(Be);courseCompetencyService=h(Ge);competencyService=h(We);alertService=h(Me);activatedRoute=h(ue);router=h(fe);formBuilder=h(H);modalService=h(xe);artemisTranslatePipe=h(F);translateService=h(be);websocketService=h(Se);courseDescriptionForm;courseId;isLoading=!1;submitted=!1;form=new he({competencies:new ye([])});faTimes=Re;faBan=Ie;faSave=Q;ButtonType=b;documentationType="GenerateCompetencies";ngOnInit(){this.activatedRoute.params.subscribe(i=>{this.courseId=Number(i.courseId),te(this.courseManagementService.find(this.courseId)).then(r=>this.courseDescriptionForm.setCourseDescription(r.body?.description??"")).catch(r=>k(this.alertService,r))})}getCompetencyRecommendations(i){this.isLoading=!0,this.getCurrentCompetencies().subscribe(r=>{this.courseCompetencyService.generateCompetenciesFromCourseDescription(this.courseId,i,r).subscribe({next:()=>{let t=`/user/topic/iris/competencies/${this.courseId}`;this.websocketService.subscribe(t),this.websocketService.receive(t).subscribe({next:m=>{if(m.result)for(let C of m.result)this.addCompetencyToForm(C);m.stages.every(C=>C.state===N.DONE)?this.alertService.success("artemisApp.competency.generate.courseDescription.success",{noOfCompetencies:m.result?.length}):m.stages.some(C=>C.state===N.ERROR)&&this.alertService.warning("artemisApp.competency.generate.courseDescription.warning"),m.stages.every(C=>C.state!==N.NOT_STARTED&&C.state!==N.IN_PROGRESS)&&(this.websocketService.unsubscribe(t),this.isLoading=!1)},error:m=>{k(this.alertService,m),this.websocketService.unsubscribe(t),this.isLoading=!1}})},error:t=>{k(this.alertService,t),this.isLoading=!1}})})}getCurrentCompetencies(){let i=this.competencies.getRawValue().map(t=>t.competency),r=this.courseCompetencyService.getAllForCourse(this.courseId);return r?r.pipe(Y(t=>t.body?.map(m=>({title:m.title,description:m.description,taxonomy:m.taxonomy}))),Y(t=>i.concat(t??[]))):new ee(t=>{t.next(i),t.complete()})}addCompetencyToForm(i){let r=this.formBuilder.nonNullable.group({competency:this.formBuilder.nonNullable.group({title:[i.title],description:[i.description],taxonomy:[i.taxonomy]}),viewed:[!1]});this.competencies.push(r)}onDelete(i){let r=this.competencies.at(i).controls.competency.controls.title.getRawValue()??"",t=this.modalService.open(J,{keyboard:!0,size:"md"});t.componentInstance.title="artemisApp.competency.generate.deleteModalTitle",t.componentInstance.text=this.artemisTranslatePipe.transform("artemisApp.competency.generate.deleteModalText",{title:r}),t.result.then(()=>this.competencies.removeAt(i))}onCancel(){this.router.navigate(["../"],{relativeTo:this.activatedRoute})}onSubmit(){if(this.isSubmitPossibleWithoutConfirmation())this.save();else{let i=this.modalService.open(J,{keyboard:!0,size:"md"});i.componentInstance.title="artemisApp.competency.generate.saveModalTitle",i.componentInstance.text=this.artemisTranslatePipe.transform("artemisApp.competency.generate.saveModalText"),i.result.then(this.save.bind(this))}}save(){let i=this.competencies.getRawValue().map(r=>Object.assign(new ke,r.competency));this.competencyService.createBulk(i,this.courseId).subscribe({next:()=>{this.submitted=!0,this.router.navigate(["../"],{relativeTo:this.activatedRoute})},error:r=>k(this.alertService,r)})}get isSubmitPossible(){return!this.form.invalid}isSubmitPossibleWithoutConfirmation(){return!this.form.getRawValue().competencies?.map(r=>r.viewed)?.includes(!1)}get competencies(){return this.form.controls.competencies}canDeactivate(){return this.submitted||!this.isLoading&&this.competencies.length===0}get canDeactivateWarning(){return this.translateService.instant("pendingChanges")}unloadNotification(i){return this.canDeactivate()?!0:(i.preventDefault(),this.canDeactivateWarning)}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=y({type:n,selectors:[["jhi-generate-competencies"]],viewQuery:function(r,t){if(r&1&&se(Z,5),r&2){let m;le(m=me())&&(t.courseDescriptionForm=m.first)}},hostBindings:function(r,t){r&1&&f("beforeunload",function(C){return t.unloadNotification(C)},!1,ne)},decls:31,vars:13,consts:[[1,"container"],[1,"d-flex","align-items-center"],["id","page-heading","jhiTranslate","artemisApp.competency.generate.title"],[3,"type"],[3,"formSubmitted","isLoading"],["jhiTranslate","artemisApp.competency.generate.listTitle",1,"mt-2"],[3,"ngSubmit","formGroup"],["formArrayName","competencies",1,"border-0"],[1,"mt-4"],["id","cancelButton",3,"onClick","btnType","title","icon","shouldSubmit"],["id","saveButton",3,"title","icon","disabled","isLoading"],[1,"d-flex","flex-column","align-items-center","mb-1"],["role","status",1,"spinner-border"],["jhiTranslate","loading",1,"sr-only"],["jhiTranslate","artemisApp.competency.generate.loading"],["jhiTranslate","global.generic.emptyList",1,"mb-1"],[3,"onDelete","form","index"]],template:function(r,t){r&1&&(a(0,"div",0),e(1,`
    `),a(2,"div",1),e(3,`
        `),l(4,"h2",2),e(5,`
        `),l(6,"jhi-documentation-button",3),e(7,`
    `),s(),e(8,`
    `),a(9,"jhi-course-description-form",4),f("formSubmitted",function(C){return t.getCompetencyRecommendations(C)}),s(),e(10,`
    `),l(11,"h3",5),e(12,`
    `),v(13,ut,11,0),a(14,"form",6),f("ngSubmit",function(){return t.onSubmit()}),e(15,`
        `),v(16,ft,3,0),a(17,"div",7),e(18,`
            `),re(19,Ct,3,2,null,null,oe),s(),e(21,`
        `),a(22,"div",8),e(23,`
            `),a(24,"jhi-button",9),f("onClick",function(){return t.onCancel()}),s(),e(25,`
            `),l(26,"jhi-button",10),e(27,`
        `),s(),e(28,`
    `),s(),e(29,`
`),s(),e(30,`
`)),r&2&&(o(6),c("type",t.documentationType),o(3),c("isLoading",t.isLoading),o(4),u(t.isLoading?13:-1),o(),c("formGroup",t.form),o(2),u(!t.competencies.length&&!t.isLoading?16:-1),o(3),ae(t.competencies.controls),o(5),c("btnType",t.ButtonType.SECONDARY)("title","entity.action.cancel")("icon",t.faBan)("shouldSubmit",!1),o(2),c("title","entity.action.save")("icon",t.faSave)("disabled",!t.isSubmitPossible)("isLoading",t.isLoading))},dependencies:[M,z,R,B,L,ge,$,Fe,Z,x,Xe],encapsulation:2})}return n})();export{Mi as GenerateCompetenciesComponent};
//# sourceMappingURL=generate-competencies.component-EMCPQY3I.js.map
