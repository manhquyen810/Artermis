import{a as W,b as ge}from"./chunk-RUZE5GXG.js";import{a as be}from"./chunk-S5MKSB5U.js";import{a as y}from"./chunk-U6AELCVK.js";import{a as Te}from"./chunk-A3NV42OL.js";import{a as Ae}from"./chunk-BNRTXX46.js";import{c as fe}from"./chunk-Z2YUBN6N.js";import{b as xe}from"./chunk-CK7FH6VF.js";import{a as O}from"./chunk-PZ7IDTIM.js";import{c as he}from"./chunk-JNO6DNVW.js";import{K as pe,j as me}from"./chunk-VZRSC3LP.js";import{G as re,K as le,c as se,h as oe,m as ae}from"./chunk-WA5GEAJB.js";import{a as j}from"./chunk-K3W6YFKH.js";import{c as _e}from"./chunk-JXJXC4DZ.js";import{d as Ce}from"./chunk-EDXSOKK5.js";import{c as N,k as V}from"./chunk-CXQURQM5.js";import{Zc as ue,tb as de}from"./chunk-Z4VHWOB5.js";import{a as E}from"./chunk-U54OSGNH.js";import{f as te,h as ne,i as ie}from"./chunk-M6Z6DKZQ.js";import{c as ce}from"./chunk-E2KBL4LX.js";import{i as ee}from"./chunk-IOA4DPXY.js";import{Ad as q,Cb as M,Db as s,Dc as b,Ea as S,Ed as Z,Ma as A,Mc as x,Na as T,Oc as r,Pc as X,Qc as Q,Rc as D,Tb as v,Va as C,Zb as _,aa as I,cd as Y,dd as n,fd as R,kc as d,lc as $,ld as k,mc as F,md as L,nd as w,rd as H,sc as l,sd as J,xc as m,yc as p,yd as h,zc as c,zd as g}from"./chunk-5LC5EQRR.js";function ye(t,a,e,o,i=!1){if(e){let u=V(e);if(i){let f=e.exerciseGroup.exam;a.navigateByUrl(`/course-management/${u?.id}/exams/${f.id}/test-assessment-dashboard/${e.id}`)}else if(e.exerciseGroup){let f=e.exerciseGroup.exam;a.navigateByUrl(`/course-management/${u?.id}/exams/${f.id}/assessment-dashboard/${e.id}`)}else if(e.teamMode&&o){let f=o.participation.team?.id;a.navigateByUrl(`/courses/${u?.id}/exercises/${e.id}/teams/${f}`)}else a.navigateByUrl(`/course-management/${u?.id}/assessment-dashboard/${e.id}`)}else t.back()}var G=(t,a,e,o)=>o?.isAtLeastInstructor?!0:o?.teamMode||t?a:o?.assessmentType===O.AUTOMATIC&&e.result&&e.result.assessor===void 0?!0:e.complaintType===y.COMPLAINT?!a:a,kt=(t,a,e,o,i,u)=>u?.isAtLeastInstructor?!0:o?o.completionDate?i?i.complaintType===y.COMPLAINT&&G(t,a,i,u):!e:!0:!1;var De=t=>({otherUser:t});function ke(t,a){t&1&&(n(0,`
            `),c(1,"span",3),n(2,`
        `))}function Le(t,a){t&1&&(n(0,`
            `),c(1,"span",4),n(2,`
        `))}function we(t,a){t&1&&(n(0,`
            `),c(1,"span",5),n(2,`
        `))}function Be(t,a){if(t&1){let e=b();n(0,`
        `),m(1,"ngb-alert",6),x("close",function(){A(e);let i=r();return T(i.hasAssessmentDueDatePassed=!1)}),p(),n(2,`
    `)}t&2&&(s(),$("font-size","65%"),d("type","warning"))}function Ie(t,a){if(t&1&&(n(0,`
                `),c(1,"span",11),n(2,`
            `)),t&2){let e=r(2);s(),d("translateValues",H(1,De,(e.result==null||e.result.assessor==null?null:e.result.assessor.name)+" ("+(e.result==null||e.result.assessor==null?null:e.result.assessor.login)+")"))}}function Me(t,a){t&1&&(n(0,`
                `),c(1,"span",12),n(2,`
            `))}function Fe(t,a){t&1&&(n(0,`
                `),c(1,"span",13),n(2,`
            `))}function He(t,a){t&1&&(n(0,`
                `),c(1,"span",14),n(2,`
            `))}function Ne(t,a){t&1&&(n(0,`
                `),c(1,"span",15),n(2,`
            `))}function Ve(t,a){t&1&&(n(0,`
                `),c(1,"span",16),n(2,`
            `))}function Oe(t,a){t&1&&(n(0,`
                `),c(1,"span",17),n(2,`
            `))}function je(t,a){t&1&&(n(0,`
                `),c(1,"span",18),n(2,`
            `))}function Pe(t,a){t&1&&(n(0,`
                        `),c(1,"span",20),h(2,"artemisTranslate"),n(3,`
                    `)),t&2&&(s(),D("ngbTooltip",g(2,1,"artemisApp.assessment.diffView.highlightAssessmentDiffTooltipOn")))}function Ue(t,a){t&1&&(n(0,`
                        `),c(1,"span",21),h(2,"artemisTranslate"),n(3,`
                    `)),t&2&&(s(),D("ngbTooltip",g(2,1,"artemisApp.assessment.diffView.highlightAssessmentDiffTooltipOff")))}function ze(t,a){if(t&1){let e=b();n(0,`
                `),m(1,"button",19),x("click",function(){A(e);let i=r(2);return T(i.toggleHighlightDifferences())}),n(2,`
                    `),_(3,Pe,4,3)(4,Ue,4,3),p(),n(5,`
            `)}if(t&2){let e=r(2);s(),d("disabled",e.saveBusy||e.submitBusy||e.cancelBusy),s(2),l(e.highlightDifferences?-1:3),s(),l(e.highlightDifferences?4:-1)}}function Ke(t,a){if(t&1&&(n(0,`
                            `),c(1,"fa-icon",27),n(2,`
                        `)),t&2){let e=r(3);s(),d("icon",e.faSpinner)}}function qe(t,a){if(t&1&&(n(0,`
                            `),c(1,"fa-icon",27),n(2,`
                        `)),t&2){let e=r(3);s(),d("icon",e.faSpinner)}}function We(t,a){if(t&1&&(n(0,`
                                `),c(1,"fa-icon",27),n(2,`
                            `)),t&2){let e=r(4);s(),d("icon",e.faSpinner)}}function Ge(t,a){if(t&1){let e=b();n(0,`
                        `),m(1,"button",28),x("click",function(){A(e);let i=r(3);return T(i.onCancel.emit())}),n(2,`
                            `),_(3,We,3,1),c(4,"span",29),n(5,`
                        `),p(),n(6,`
                    `)}if(t&2){let e=r(3);s(),d("disabled",!(e.exercise!=null&&e.exercise.isAtLeastInstructor||e.isAssessor)||e.saveBusy||e.submitBusy||e.cancelBusy),s(2),l(e.cancelBusy?3:-1)}}function $e(t,a){if(t&1){let e=b();n(0,`
                    `),m(1,"button",22),h(2,"artemisTranslate"),x("click",function(){A(e);let i=r(2);return T(i.save.emit())}),n(3,`
                        `),_(4,Ke,3,1),c(5,"fa-icon",23),n(6,`
                        `),c(7,"span",24),n(8,`
                    `),p(),n(9,`
                    `),m(10,"button",25),h(11,"artemisTranslate"),x("click",function(){A(e);let i=r(2);return i.onSubmit.emit(),T(i.sendSubmitAssessmentEventToAnalytics())}),n(12,`
                        `),_(13,qe,3,1),c(14,"span",26),n(15,`
                    `),p(),n(16,`
                    `),_(17,Ge,7,2)}if(t&2){let e=r(2);s(),d("disabled",e.saveDisabled)("ngbTooltip",g(2,8,"artemisApp.assessment.button.control")+" + S"),s(3),l(e.saveBusy?4:-1),s(),d("icon",e.faSave),s(5),d("disabled",e.submitDisabled)("ngbTooltip",g(11,10,"artemisApp.assessment.button.control")+" + Enter"),s(3),l(e.submitBusy?13:-1),s(4),l(e.isTestRun?-1:17)}}function Xe(t,a){if(t&1&&(n(0,`
                            `),c(1,"fa-icon",27),n(2,`
                        `)),t&2){let e=r(3);s(),d("icon",e.faSpinner)}}function Qe(t,a){if(t&1){let e=b();n(0,`
                    `),m(1,"button",30),h(2,"artemisTranslate"),x("click",function(){A(e);let i=r(2);return T(i.onSubmit.emit())}),n(3,`
                        `),_(4,Xe,3,1),c(5,"span",31),n(6,`
                    `),p(),n(7,`
                `)}if(t&2){let e=r(2);s(),d("disabled",e.overrideDisabled)("ngbTooltip",g(2,3,"artemisApp.assessment.button.control")+" + Enter"),s(3),l(e.submitBusy?4:-1)}}function Ye(t,a){if(t&1&&(n(0,`
                            `),c(1,"fa-icon",27),n(2,`
                        `)),t&2){let e=r(3);s(),d("icon",e.faSpinner)}}function Je(t,a){if(t&1){let e=b();n(0,`
                    `),m(1,"button",32),x("click",function(){A(e);let i=r(2);return T(i.onUseAsExampleSolutionClicked())}),n(2,`
                        `),_(3,Ye,3,1),c(4,"span",33),n(5,`
                    `),p(),n(6,`
                `)}if(t&2){let e=r(2);s(3),l(e.submitBusy?3:-1)}}function Ze(t,a){if(t&1&&(n(0),h(1,"artemisTranslate"),c(2,"fa-icon",23),n(3,`
                `)),t&2){let e=r(2);R(`
                    `,g(1,2,"artemisApp.assessment.button.control")," + Shift + "),s(2),d("icon",e.faSquareCaretRight)}}function et(t,a){if(t&1&&(n(0,`
                            `),c(1,"fa-icon",27),n(2,`
                        `)),t&2){let e=r(3);s(),d("icon",e.faSpinner)}}function tt(t,a){if(t&1){let e=b();n(0,`
                    `),m(1,"button",34),x("click",function(){A(e);let i=r(2);return i.nextSubmission.emit(),T(i.sendAssessNextEventToAnalytics())}),n(2,`
                        `),_(3,et,3,1),c(4,"span",35),n(5,`
                    `),p(),n(6,`
                `)}if(t&2){r();let e=Y(20),o=r();s(),d("disabled",o.assessNextDisabled)("ngbTooltip",e),s(2),l(o.nextSubmissionBusy?3:-1)}}function nt(t,a){if(t&1&&(n(0,`
        `),m(1,"div",7),n(2,`
            `),_(3,Ie,3,3)(4,Me,3,0)(5,Fe,3,0)(6,He,3,0)(7,Ne,3,0)(8,Ve,3,0)(9,Oe,3,0)(10,je,3,0)(11,ze,6,3),c(12,"br"),n(13,`
            `),m(14,"div",8),n(15,`
                `),_(16,$e,18,12)(17,Qe,8,5)(18,Je,7,1)(19,Ze,4,4,"ng-template",null,0,Z),n(21,`
                `),_(22,tt,7,3),m(23,"a",9),n(24,`
                    `),c(25,"span",10),n(26,`
                `),p(),n(27,`
            `),p(),n(28,`
        `),p(),n(29,`
    `)),t&2){let e=r();s(3),l(!e.isAssessor&&!e.hasComplaint?3:-1),s(),l(e.isAssessor&&e.exercise&&!e.exercise.isAtLeastInstructor&&e.hasComplaint&&e.complaintType!==e.ComplaintType.COMPLAINT&&!e.complaintHandled&&e.exercise.assessmentType!==e.AssessmentType.AUTOMATIC?4:-1),s(),l(e.isAssessor&&e.exercise&&!e.exercise.isAtLeastInstructor&&e.hasComplaint&&e.complaintType!==e.ComplaintType.COMPLAINT&&e.exercise.assessmentType===e.AssessmentType.AUTOMATIC&&!e.complaintHandled&&!e.exercise.teamMode?5:-1),s(),l(e.isAssessor&&e.exercise&&!e.exercise.isAtLeastInstructor&&e.hasComplaint&&e.complaintType===e.ComplaintType.COMPLAINT&&!e.complaintHandled&&e.exercise.teamMode?6:-1),s(),l(e.isAssessor&&e.exercise&&!e.exercise.isAtLeastInstructor&&e.hasComplaint&&e.complaintType===e.ComplaintType.COMPLAINT&&e.exercise.assessmentType===e.AssessmentType.AUTOMATIC&&!e.complaintHandled&&!e.exercise.teamMode?7:-1),s(),l(e.isAssessor&&e.exercise&&!e.exercise.isAtLeastInstructor&&e.hasComplaint&&e.exercise.assessmentType!==e.AssessmentType.AUTOMATIC&&e.complaintType===e.ComplaintType.COMPLAINT&&!e.complaintHandled&&!e.exercise.teamMode?8:-1),s(),l(e.isAssessor&&e.exercise&&!e.exercise.isAtLeastInstructor&&e.hasComplaint&&e.complaintHandled&&!e.exercise.teamMode?9:-1),s(),l(e.isAssessor&&(!e.hasComplaint||e.exercise!=null&&e.exercise.isAtLeastInstructor)?10:-1),s(),l(!e.isProgrammingExercise&&e.result&&e.correctionRound>0?11:-1),s(5),l(e.result!=null&&e.result.completionDate?-1:16),s(),l(e.overrideVisible?17:-1),s(),l(e.result!=null&&e.result.completionDate&&(e.exercise!=null&&e.exercise.isAtLeastInstructor)&&(e.exercise.type===e.ExerciseType.MODELING||e.exercise.type===e.ExerciseType.TEXT)?18:-1),s(4),l(e.assessNextVisible?22:-1),s(),d("routerLink",e.exerciseDashboardLink)}}function it(t,a){if(t&1&&(n(0,`
    `),c(1,"jhi-assessment-warning",36),n(2,`
`)),t&2){let e=r();s(),d("exercise",e.exercise)}}var ve=(()=>{class t{textAssessmentAnalytics=S(ge);route=S(te);translateService=S(ce);isLoading;saveBusy;submitBusy;cancelBusy;nextSubmissionBusy;correctionRound=0;isTeamMode;isAssessor;isTestRun=!1;exerciseDashboardLink;canOverride;exercise;result;isIllegalSubmission;hasComplaint=!1;hasMoreFeedbackRequest=!1;complaintHandled=!1;complaintType;assessmentsAreValid;hasAssessmentDueDatePassed;isProgrammingExercise=!1;save=new C;onSubmit=new C;onCancel=new C;nextSubmission=new C;highlightDifferencesChange=new C;useAsExampleSubmission=new C;_highlightDifferences;ExerciseType=N;ComplaintType=y;AssessmentType=O;faSpinner=ue;faSave=de;faSquareCaretRight=fe;set highlightDifferences(e){this._highlightDifferences=e,this.highlightDifferencesChange.emit(this.highlightDifferences)}constructor(){this.textAssessmentAnalytics.setComponentRoute(this.route)}get highlightDifferences(){return this._highlightDifferences}get overrideVisible(){return this.result?.completionDate&&this.canOverride}get assessNextVisible(){return this.result?.completionDate&&(this.isAssessor||this.exercise?.isAtLeastInstructor)&&!this.hasComplaint&&!this.isTeamMode&&!this.isTestRun}get saveDisabled(){return this.result?.completionDate?!0:Ae.hasNonEmptyAssessmentNote(this.result)?this.saveDisabledWithAssessmentNotePresent:this.saveDisabledWithoutAssessmentNotePresent}get saveDisabledWithAssessmentNotePresent(){return!this.isAssessor||this.saveBusy||this.submitBusy||this.cancelBusy}get saveDisabledWithoutAssessmentNotePresent(){return!this.assessmentsAreValid||this.saveDisabledWithAssessmentNotePresent}get submitDisabled(){return!this.assessmentsAreValid||!this.isAssessor||this.saveBusy||this.submitBusy||this.cancelBusy}get overrideDisabled(){return this.overrideVisible?!this.assessmentsAreValid||this.submitBusy:!0}get assessNextDisabled(){return this.assessNextVisible?this.nextSubmissionBusy||this.submitBusy:!0}saveOnControlAndS(e){e.preventDefault(),this.saveDisabled||this.save.emit()}submitOnControlAndEnter(e){e.preventDefault(),this.overrideDisabled?this.submitDisabled||(this.onSubmit.emit(),this.sendSubmitAssessmentEventToAnalytics()):this.onSubmit.emit()}assessNextOnControlShiftAndArrowRight(e){e.preventDefault(),this.assessNextDisabled||(this.nextSubmission.emit(),this.sendAssessNextEventToAnalytics())}toggleHighlightDifferences(){this.highlightDifferences=!this.highlightDifferences,this.highlightDifferencesChange.emit(this.highlightDifferences)}sendSubmitAssessmentEventToAnalytics(){this.exercise?.type===N.TEXT&&this.textAssessmentAnalytics.sendAssessmentEvent(W.SUBMIT_ASSESSMENT)}sendAssessNextEventToAnalytics(){this.exercise?.type===N.TEXT&&this.textAssessmentAnalytics.sendAssessmentEvent(W.ASSESS_NEXT_SUBMISSION)}onUseAsExampleSolutionClicked(){let e=this.translateService.instant("artemisApp.assessment.useAsExampleSubmissionVerificationQuestion");confirm(e)&&this.useAsExampleSubmission.emit()}static \u0275fac=function(o){return new(o||t)};static \u0275cmp=v({type:t,selectors:[["jhi-assessment-header"]],hostBindings:function(o,i){o&1&&x("keydown.control.s",function(f){return i.saveOnControlAndS(f)},!1,M)("keydown.control.enter",function(f){return i.submitOnControlAndEnter(f)},!1,M)("keydown.control.shift.arrowRight",function(f){return i.assessNextOnControlShiftAndArrowRight(f)},!1,M)},inputs:{isLoading:"isLoading",saveBusy:"saveBusy",submitBusy:"submitBusy",cancelBusy:"cancelBusy",nextSubmissionBusy:"nextSubmissionBusy",correctionRound:"correctionRound",isTeamMode:"isTeamMode",isAssessor:"isAssessor",isTestRun:"isTestRun",exerciseDashboardLink:"exerciseDashboardLink",canOverride:"canOverride",exercise:"exercise",result:"result",isIllegalSubmission:"isIllegalSubmission",hasComplaint:"hasComplaint",hasMoreFeedbackRequest:"hasMoreFeedbackRequest",complaintHandled:"complaintHandled",complaintType:"complaintType",assessmentsAreValid:"assessmentsAreValid",hasAssessmentDueDatePassed:"hasAssessmentDueDatePassed",isProgrammingExercise:"isProgrammingExercise",highlightDifferences:"highlightDifferences"},outputs:{save:"save",onSubmit:"onSubmit",onCancel:"onCancel",nextSubmission:"nextSubmission",highlightDifferencesChange:"highlightDifferencesChange",useAsExampleSubmission:"useAsExampleSubmission"},decls:13,vars:5,consts:[["nextSubmissionShortcut",""],[1,"top-container","flex-wrap","flex-lg-nowrap"],[1,"row-container","me-2"],["jhiTranslate","artemisApp.assessment.testRunAssessment"],["jhiTranslate","artemisApp.assessment.assessment"],["jhiTranslate","artemisApp.assessment.assessmentIllegalSubmission",1,"badge","bg-danger","ms-3",2,"font-size","65%"],["jhiTranslate","artemisApp.assessment.assessmentDueDateIsOver",3,"close","type"],[1,"row-container","flex-wrap","flex-lg-nowrap"],[1,"d-flex","flex-wrap","flex-lg-nowrap"],[1,"btn","m-1","btn-info",3,"routerLink"],["jhiTranslate","entity.action.exerciseDashboard"],["id","assessmentLocked","jhiTranslate","artemisApp.assessment.assessmentLocked",1,"text-danger","m-2",2,"font-size","65%",3,"translateValues"],["id","moreFeedbackRequest","jhiTranslate","artemisApp.assessment.moreFeedbackRequest",1,"m-2",2,"font-size","65%"],["id","automaticAssessmentFeedbackRequest","jhiTranslate","artemisApp.assessment.automaticAssessmentFeedbackRequest",1,"m-2",2,"font-size","65%"],["id","teamComplaint","jhiTranslate","artemisApp.assessment.teamComplaint",1,"m-2",2,"font-size","65%"],["id","automaticAssessmentComplaint","jhiTranslate","artemisApp.assessment.automaticAssessmentComplaint",1,"m-2",2,"font-size","65%"],["id","assessmentReadOnlyUnhandledComplaint","jhiTranslate","artemisApp.assessment.assessmentReadOnlyUnhandledComplaint",1,"m-2",2,"font-size","65%"],["id","assessmentReadOnlyHandled","jhiTranslate","artemisApp.assessment.assessmentReadOnlyHandledComplaint",1,"m-2",2,"font-size","65%"],["id","assessmentLockedCurrentUser","jhiTranslate","artemisApp.assessment.assessmentLockedCurrentUser",1,"text-danger","m-2",2,"font-size","65%"],[1,"btn","ms-2","btn-primary",3,"click","disabled"],["jhiTranslate","artemisApp.assessment.diffView.differenceActivate",3,"ngbTooltip"],["jhiTranslate","artemisApp.assessment.diffView.differenceDeactivate",3,"ngbTooltip"],[1,"btn","m-1","btn-primary",3,"click","disabled","ngbTooltip"],[3,"icon"],["jhiTranslate","entity.action.save"],["id","submit",1,"btn","m-1","btn-success",3,"click","disabled","ngbTooltip"],["jhiTranslate","entity.action.submit"],["animation","spin",3,"icon"],[1,"btn","m-1","btn-danger",3,"click","disabled"],["jhiTranslate","entity.action.cancel"],[1,"btn","m-1","btn-danger",3,"click","disabled","ngbTooltip"],["jhiTranslate","artemisApp.assessment.button.overrideAssessment"],["id","useAsExampleSubmission",1,"btn","m-1","btn-primary",3,"click"],["jhiTranslate","artemisApp.assessment.button.useAsExampleSubmission"],["id","assessNextButton",1,"btn","m-1","btn-success",3,"click","disabled","ngbTooltip"],["jhiTranslate","artemisApp.assessment.button.nextSubmission"],[3,"exercise"]],template:function(o,i){o&1&&(m(0,"h3",1),n(1,`
    `),n(2,`
    `),m(3,"div",2),n(4,`
        `),_(5,ke,3,0)(6,Le,3,0)(7,we,3,0),p(),n(8,`
    `),_(9,Be,3,3)(10,nt,30,14),p(),n(11,`
`),_(12,it,3,1)),o&2&&(s(5),l(i.isTestRun?5:6),s(2),l(i.isIllegalSubmission?7:-1),s(2),l(i.hasAssessmentDueDatePassed&&!(i.result!=null&&i.result.completionDate)?9:-1),s(),l(i.isLoading?-1:10),s(2),l(i.exercise?12:-1))},dependencies:[E,me,pe,Ce,ie,Te,j],styles:[".top-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.top-container[_ngcontent-%COMP%]   jhi-alert[_ngcontent-%COMP%]{font-size:initial}.row-container[_ngcontent-%COMP%]{display:flex;align-items:center}"]})}return t})();function st(t,a){t&1&&(n(0,`
        `),c(1,"div",0),n(2,`
    `))}function ot(t,a){t&1&&(n(0,`
        `),c(1,"div",1),n(2,`
    `))}function at(t,a){if(t&1&&(n(0,`
    `),_(1,st,3,0)(2,ot,3,0)),t&2){let e=r();s(),l((e.complaint==null?null:e.complaint.complaintType)===e.ComplaintType.COMPLAINT?1:-1),s(),l((e.complaint==null?null:e.complaint.complaintType)===e.ComplaintType.MORE_FEEDBACK?2:-1)}}var Se=(()=>{class t{ComplaintType=y;complaint;static \u0275fac=function(o){return new(o||t)};static \u0275cmp=v({type:t,selectors:[["jhi-assessment-complaint-alert"]],inputs:{complaint:"complaint"},decls:1,vars:1,consts:[["jhiTranslate","artemisApp.complaint.hint",1,"alert","alert-info"],["jhiTranslate","artemisApp.moreFeedback.hint",1,"alert","alert-info"]],template:function(o,i){o&1&&_(0,at,3,2),o&2&&l(i.complaint?0:-1)},dependencies:[E],encapsulation:2})}return t})();var U=class{id;creator;createdDate;lastUpdatedDate;note};var Re=(()=>{class t{_assessmentNote;onAssessmentNoteChange=new C;set assessmentNote(e){e===void 0?this._assessmentNote=new U:this._assessmentNote=e}get assessmentNote(){return this._assessmentNote}onAssessmentNoteInput(e){this._assessmentNote.note=e.target.value,this.onAssessmentNoteChange.emit(this._assessmentNote)}static \u0275fac=function(o){return new(o||t)};static \u0275cmp=v({type:t,selectors:[["jhi-assessment-note"]],inputs:{assessmentNote:"assessmentNote"},outputs:{onAssessmentNoteChange:"onAssessmentNoteChange"},decls:5,vars:1,consts:[["jhiTranslate","artemisApp.assessment.detail.assessmentNote",1,"col-12"],["name","assessment_note","id","assessment_note",1,"form-control",3,"input","textContent"]],template:function(o,i){if(o&1&&(m(0,"h4",0),n(1,"Assessment Notes"),p(),n(2,`
`),m(3,"textarea",1),x("input",function(f){return i.onAssessmentNoteInput(f)}),p(),n(4,`
`)),o&2){let u;s(3),d("textContent",(u=i.assessmentNote==null?null:i.assessmentNote.note)!==null&&u!==void 0?u:"")}},dependencies:[E],styles:["#assessment_note[_ngcontent-%COMP%]{width:30%}"]})}return t})();var z=class{id;responseText;submittedTime;complaint;reviewer;isCurrentlyLocked;lockEndDate};var K=function(t){return t.REFRESH_LOCK="REFRESH_LOCK",t.RESOLVE_COMPLAINT="RESOLVE_COMPLAINT",t}(K||{}),B=class{responseText;complaintIsAccepted;action};var rt=t=>({endDate:t}),lt=(t,a)=>({user:t,endDate:a});function mt(t,a){t&1&&(n(0,`
    `),m(1,"div",0),n(2,`
        `),m(3,"div",1),n(4,`
            `),c(5,"span",2),n(6,`
        `),p(),n(7,`
    `),p(),n(8,`
`))}function pt(t,a){if(t&1&&(n(0,`
    `),c(1,"h3",3),n(2,`
`)),t&2){let e=r();s(),d("jhiTranslate",e.complaint.complaintType===e.ComplaintType.MORE_FEEDBACK?"artemisApp.moreFeedback.review":"artemisApp.complaint.review")}}function ct(t,a){if(t&1&&(n(0,`
            `),c(1,"div",9),n(2,`
        `)),t&2){let e=r(2);s(),d("jhiTranslate",e.complaint.complaintType===e.ComplaintType.MORE_FEEDBACK?"artemisApp.moreFeedback.alreadyHandled":"artemisApp.complaint.complaintAlreadyHandled")}}function dt(t,a){if(t&1&&(n(0),h(1,"artemisDate"),h(2,"artemisTranslate")),t&2){let e=r(3);R(`
                        `,q(2,3,"artemisApp.locks.lockInformationYou",H(6,rt,g(1,1,e.complaintResponse.lockEndDate))),`
                    `)}}function ut(t,a){if(t&1&&(n(0),h(1,"artemisDate"),h(2,"artemisTranslate")),t&2){let e=r(3);R(`
                        `,q(2,3,"artemisApp.locks.lockInformation",J(6,lt,e.complaintResponse==null||e.complaintResponse.reviewer==null?null:e.complaintResponse.reviewer.login,g(1,1,e.complaintResponse.lockEndDate))),`
                    `)}}function _t(t,a){if(t&1&&(n(0,`
                `),m(1,"div",10),n(2,`
                    `),_(3,dt,3,8)(4,ut,3,9),p(),n(5,`
            `)),t&2){let e=r(2);s(3),l(e.lockedByCurrentUser?3:4)}}function xt(t,a){if(t&1){let e=b();n(0,`
                `),m(1,"button",11),x("click",function(){A(e);let i=r(2);return T(i.removeLock())}),p(),n(2,`
            `)}}function Ct(t,a){if(t&1&&(n(0,`
                                `),m(1,"span",12),n(2),h(3,"artemisTranslate"),h(4,"artemisTranslate"),p(),n(5,`
                            `)),t&2){let e=r(3);s(2),R(`
                                    \xA0`,e.complaint.complaintType===e.ComplaintType.MORE_FEEDBACK?g(3,1,"artemisApp.moreFeedback.accepted"):g(4,3,"artemisApp.complaint.accepted"),`\xA0
                                `)}}function ht(t,a){t&1&&(n(0,`
                                `),m(1,"span",13),n(2),h(3,"artemisTranslate"),p(),n(4,`
                            `)),t&2&&(s(2),R(" \xA0",g(3,1,"artemisApp.complaint.rejected"),"\xA0 "))}function ft(t,a){if(t&1&&(n(0,`
                        `),m(1,"small"),n(2,`
                            `),_(3,Ct,6,5)(4,ht,5,3),p(),n(5,`
                    `)),t&2){let e=r(2);s(3),l(e.complaint!=null&&e.complaint.accepted?3:-1),s(),l(e.complaint!=null&&e.complaint.accepted?-1:4)}}function At(t,a){if(t&1){let e=b();n(0,`
                        `),m(1,"div",17),n(2,`
                            `),m(3,"button",18),h(4,"artemisTranslate"),x("click",function(){A(e);let i=r(3);return T(i.respondToComplaint(!0))}),n(5),h(6,"artemisTranslate"),p(),n(7,`
                            `),m(8,"button",19),h(9,"artemisTranslate"),x("click",function(){A(e);let i=r(3);return T(i.respondToComplaint(!1))}),n(10),h(11,"artemisTranslate"),p(),n(12,`
                            `),n(13,`
                            `),c(14,"div",20),n(15,`
                        `),p(),n(16,`
                    `)}if(t&2){let e=r(3);s(3),D("title",g(4,6,"artemisApp.complaintResponse.updateAssessmentTooltip")),d("disabled",e.isLockedForLoggedInUser||e.complaintResponseTextLength()>e.maxComplaintResponseTextLimit),s(2),R(`
                                `,g(6,8,"artemisApp.complaintResponse.updateAssessment"),`
                            `),s(3),D("title",g(9,10,"artemisApp.complaintResponse.rejectComplaintTooltip")),d("disabled",e.isLockedForLoggedInUser||e.complaintResponseTextLength()>e.maxComplaintResponseTextLimit),s(2),R(`
                                `,g(11,12,"artemisApp.complaintResponse.rejectComplaint"),`
                            `)}}function Tt(t,a){if(t&1){let e=b();n(0,`
                        `),m(1,"div",21),n(2,`
                            `),m(3,"div",22),n(4,`
                                `),m(5,"button",23),h(6,"artemisTranslate"),x("click",function(){A(e);let i=r(3);return T(i.respondToComplaint(!0))}),p(),n(7,`
                            `),p(),n(8,`
                        `),p(),n(9,`
                    `)}if(t&2){let e=r(3);s(5),D("title",g(6,2,"artemisApp.moreFeedbackResponse.sendResponseTooltip")),d("disabled",e.isLockedForLoggedInUser)}}function gt(t,a){if(t&1){let e=b();n(0,`
                `),m(1,"div",7),n(2,`
                    `),c(3,"h3",3),n(4,`
                    `),m(5,"div",14),n(6,`
                        `),m(7,"textarea",15),w("ngModelChange",function(i){A(e);let u=r(2);return L(u.complaintResponse.responseText,i)||(u.complaintResponse.responseText=i),T(i)}),n(8,"                        "),p(),n(9,`
                        `),c(10,"jhi-textarea-counter",16),n(11,`
                    `),p(),n(12,`
                    `),_(13,At,17,14)(14,Tt,10,4),p(),n(15,`
            `)}if(t&2){let e=r(2);s(3),d("jhiTranslate",e.complaint.complaintType===e.ComplaintType.MORE_FEEDBACK?"artemisApp.moreFeedbackResponse.title":"artemisApp.complaintResponse.title"),s(4),d("maxlength",e.maxComplaintResponseTextLimit),k("ngModel",e.complaintResponse.responseText),d("readonly",e.handled||e.isLockedForLoggedInUser)("disabled",e.handled||e.isLockedForLoggedInUser),s(3),d("maxLength",e.maxComplaintResponseTextLimit)("content",e.complaintResponse.responseText)("visible",!e.handled),s(3),l(!e.handled&&e.complaint.complaintType===e.ComplaintType.COMPLAINT?13:-1),s(),l(!e.complaint.accepted&&e.complaint.complaintType===e.ComplaintType.MORE_FEEDBACK?14:-1)}}function bt(t,a){if(t&1){let e=b();n(0,`
    `),m(1,"div",4),n(2,`
        `),_(3,ct,3,1),m(4,"div",5),n(5,`
            `),_(6,_t,6,1)(7,xt,3,0),p(),n(8,`
        `),m(9,"div",6),n(10,`
            `),m(11,"div",7),n(12,`
                `),m(13,"h4"),n(14,`
                    `),c(15,"span",3),n(16,`
                    `),_(17,ft,6,2),p(),n(18,`
                `),m(19,"textarea",8),w("ngModelChange",function(i){A(e);let u=r();return L(u.complaintText,i)||(u.complaintText=i),T(i)}),p(),n(20,`
            `),p(),n(21,`
            `),_(22,gt,16,10),p(),n(23,`
    `),p(),n(24,`
`)}if(t&2){let e=r();s(),F("px-0",e.zeroIndent),s(2),l(e.handled?3:-1),s(3),l(e.showLockDuration?6:-1),s(),l(e.lockedByCurrentUser?7:-1),s(8),d("jhiTranslate",e.complaint.complaintType===e.ComplaintType.MORE_FEEDBACK?"artemisApp.moreFeedback.title":"artemisApp.complaint.title"),s(2),l(e.handled?17:-1),s(2),k("ngModel",e.complaintText),d("readonly",!0)("disabled",!0),s(3),l(e.handled||e.isAllowedToRespond?22:-1)}}var Ee=(()=>{class t{alertService=S(_e);complaintResponseService=S(xe);router=S(ne);location=S(ee);complaint;isTestRun=!1;isAssessor=!1;zeroIndent=!0;exercise;submission;updateAssessmentAfterComplaint=new C;complaintText;handled;complaintResponse=new z;complaintResponseUpdate;ComplaintType=y;isLoading=!1;showLockDuration=!1;lockedByCurrentUser=!1;isLockedForLoggedInUser=!1;course;maxComplaintResponseTextLimit;ngOnInit(){this.course=V(this.exercise),this.maxComplaintResponseTextLimit=this.course?.maxComplaintResponseTextLimit??0,this.exercise?.exerciseGroup&&(this.maxComplaintResponseTextLimit=Math.max(2e3,this.maxComplaintResponseTextLimit)),this.complaint&&(this.complaintText=this.complaint.complaintText,this.handled=this.complaint.accepted!==void 0,this.handled?(this.complaintResponse=this.complaint.complaintResponse,this.lockedByCurrentUser=!1,this.showLockDuration=!1):this.isAllowedToRespond?this.complaint.complaintResponse?(this.complaintResponseUpdate=new B,this.complaintResponseUpdate.action=K.REFRESH_LOCK,this.refreshLock()):this.createLock():this.alertService.error("artemisApp.locks.notAllowedToRespond"))}createLock(){this.isLoading=!0,this.complaintResponseService.createLock(this.complaint.id).pipe(I(()=>{this.isLoading=!1})).subscribe({next:e=>{this.complaintResponse=e.body,this.complaint=this.complaintResponse.complaint,this.lockedByCurrentUser=!0,this.showLockDuration=!0,this.alertService.success("artemisApp.locks.acquired")},error:e=>{this.onError(e)}})}refreshLock(){this.complaintResponse=this.complaint.complaintResponse,this.showLockDuration=!0,this.isLockedForLoggedInUser=this.complaintResponseService.isComplaintResponseLockedForLoggedInUser(this.complaintResponse,this.exercise),this.isLockedForLoggedInUser?this.lockedByCurrentUser=!1:(this.isLoading=!0,this.complaintResponseService.refreshLockOrResolveComplaint(this.complaintResponseUpdate,this.complaint.id).pipe(I(()=>{this.isLoading=!1})).subscribe({next:e=>{this.complaintResponse=e.body,this.complaint=this.complaintResponse.complaint,this.lockedByCurrentUser=!0,this.alertService.success("artemisApp.locks.acquired")},error:e=>{this.onError(e)}}))}navigateBack(){ye(this.location,this.router,this.exercise,this.submission,this.isTestRun)}removeLock(){this.complaintResponseService.removeLock(this.complaint.id).subscribe({next:()=>{this.alertService.success("artemisApp.locks.lockRemoved"),this.navigateBack()},error:e=>{this.onError(e)}})}respondToComplaint(e){if(!this.complaintResponse.responseText||this.complaintResponse.responseText.length<=0){this.alertService.error("artemisApp.complaintResponse.noText");return}if(this.complaintResponse.responseText.length>this.maxComplaintResponseTextLimit){this.alertService.error("artemisApp.complaint.exceededComplaintResponseTextLimit",{maxComplaintRespondTextLimit:this.maxComplaintResponseTextLimit});return}this.isAllowedToRespond&&(this.complaintResponse.complaint=this.complaint,this.complaintResponse.complaint.complaintResponse=void 0,this.complaintResponse.complaint.accepted=e,e&&this.complaint.complaintType===y.COMPLAINT?(this.isLoading=!0,this.updateAssessmentAfterComplaint.emit({complaintResponse:this.complaintResponse,onSuccess:()=>{this.isLoading=!1,this.handled=!0,this.showLockDuration=!1,this.lockedByCurrentUser=!1},onError:()=>{this.isLoading=!1}})):(this.complaintResponseUpdate=new B,this.complaintResponseUpdate.action=K.RESOLVE_COMPLAINT,this.complaintResponseUpdate.responseText=this.complaintResponse.responseText,this.complaintResponseUpdate.complaintIsAccepted=this.complaintResponse.complaint.accepted,this.resolveComplaint()))}resolveComplaint(){this.isLoading=!0,this.complaintResponseService.refreshLockOrResolveComplaint(this.complaintResponseUpdate,this.complaintResponse.complaint.id).pipe(I(()=>{this.isLoading=!1})).subscribe({next:e=>{this.handled=!0,this.complaint.complaintType===y.MORE_FEEDBACK?this.alertService.success("artemisApp.moreFeedbackResponse.created"):this.alertService.success("artemisApp.complaintResponse.created"),this.complaintResponse=e.body,this.complaint=this.complaintResponse.complaint,this.isLockedForLoggedInUser=!1,this.showLockDuration=!1,this.lockedByCurrentUser=!1},error:e=>{this.onError(e)}})}onError(e){let o=e.error;o&&o.errorKey&&o.errorKey==="complaintLock"?this.alertService.error(o.message,o.params):this.alertService.error("error.unexpectedError",{error:e.message})}get isAllowedToRespond(){return G(this.isTestRun,this.isAssessor,this.complaint,this.exercise)}complaintResponseTextLength(){return document.querySelector("#responseTextArea").value.length}static \u0275fac=function(o){return new(o||t)};static \u0275cmp=v({type:t,selectors:[["jhi-complaints-for-tutor-form"]],inputs:{complaint:"complaint",isTestRun:"isTestRun",isAssessor:"isAssessor",zeroIndent:"zeroIndent",exercise:"exercise",submission:"submission"},outputs:{updateAssessmentAfterComplaint:"updateAssessmentAfterComplaint"},decls:3,vars:3,consts:[[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],["jhiTranslate","loading",1,"sr-only"],[3,"jhiTranslate"],[1,"col-12","mt-2"],[1,"mt-3","mb-3"],[1,"row"],[1,"col-12","col-md-6"],["id","complaintTextArea","rows","4",1,"col-12","px-1",3,"ngModelChange","ngModel","readonly","disabled"],[1,"alert","alert-info",3,"jhiTranslate"],["id","lockDuration",1,"alert","alert-info"],["id","lockButton","jhiTranslate","artemisApp.locks.removeButton",1,"btn","btn-secondary",3,"click"],[1,"badge","bg-success"],[1,"badge","bg-danger"],[1,"d-flex","flex-column"],["id","responseTextArea","rows","4","ondrop","return false;",1,"col-12","px-1",3,"ngModelChange","maxlength","ngModel","readonly","disabled"],[3,"maxLength","content","visible"],[1,"d-flex","flex-wrap","gap-1","justify-content-between","mt-1"],["id","acceptComplaintButton","type","button",1,"btn","btn-success","btn-block",3,"click","disabled","title"],["id","rejectComplaintButton","type","button",1,"btn","btn-danger","btn-block",3,"click","disabled","title"],[1,"d-none","d-sm-block"],[1,"row","justify-content-end","mt-3"],[1,"col-12"],["id","respondToMoreFeedbackButton","type","button","jhiTranslate","artemisApp.moreFeedbackResponse.provideFeedback",1,"btn","btn-success","btn-block",3,"click","disabled","title"]],template:function(o,i){o&1&&_(0,mt,9,0)(1,pt,3,1)(2,bt,25,11),o&2&&(l(i.isLoading?0:-1),s(),l(!i.isLoading&&i.complaint?1:-1),s(),l(!i.isLoading&&i.complaint?2:-1))},dependencies:[E,le,se,oe,re,ae,j,be,he],encapsulation:2})}return t})();var yt=["*"];function vt(t,a){if(t&1){let e=b();n(0,`
    `),m(1,"jhi-complaints-for-tutor-form",3),x("updateAssessmentAfterComplaint",function(i){A(e);let u=r();return T(u.updateAssessmentAfterComplaint.emit(i))}),p(),n(2,`
`)}if(t&2){let e=r();s(),d("zeroIndent",!1)("complaint",e.complaint)("exercise",e.exercise)("isAssessor",e.isAssessor)("submission",e.submission)("isTestRun",e.isTestRun)}}var ei=(()=>{class t{assessmentContainerClass=!0;navigateBack=new C;MORE_FEEDBACK=y.MORE_FEEDBACK;isLoading;saveBusy;submitBusy;cancelBusy;nextSubmissionBusy;correctionRound;isTeamMode;isAssessor;canOverride;isTestRun=!1;isIllegalSubmission;exerciseDashboardLink;result;assessmentsAreValid;complaint;exercise;submission;hasAssessmentDueDatePassed;isProgrammingExercise;_highlightDifferences;set highlightDifferences(e){this._highlightDifferences=e,this.highlightDifferencesChange.emit(this.highlightDifferences)}get highlightDifferences(){return this._highlightDifferences}setAssessmentNoteForResult(e){this.result&&(this.result.assessmentNote=e)}save=new C;onSubmit=new C;onCancel=new C;nextSubmission=new C;updateAssessmentAfterComplaint=new C;highlightDifferencesChange=new C;useAsExampleSubmission=new C;static \u0275fac=function(o){return new(o||t)};static \u0275cmp=v({type:t,selectors:[["jhi-assessment-layout"]],hostVars:2,hostBindings:function(o,i){o&2&&F("assessment-container",i.assessmentContainerClass)},inputs:{isLoading:"isLoading",saveBusy:"saveBusy",submitBusy:"submitBusy",cancelBusy:"cancelBusy",nextSubmissionBusy:"nextSubmissionBusy",correctionRound:"correctionRound",isTeamMode:"isTeamMode",isAssessor:"isAssessor",canOverride:"canOverride",isTestRun:"isTestRun",isIllegalSubmission:"isIllegalSubmission",exerciseDashboardLink:"exerciseDashboardLink",result:"result",assessmentsAreValid:"assessmentsAreValid",complaint:"complaint",exercise:"exercise",submission:"submission",hasAssessmentDueDatePassed:"hasAssessmentDueDatePassed",isProgrammingExercise:"isProgrammingExercise",highlightDifferences:"highlightDifferences"},outputs:{navigateBack:"navigateBack",save:"save",onSubmit:"onSubmit",onCancel:"onCancel",nextSubmission:"nextSubmission",updateAssessmentAfterComplaint:"updateAssessmentAfterComplaint",highlightDifferencesChange:"highlightDifferencesChange",useAsExampleSubmission:"useAsExampleSubmission"},ngContentSelectors:yt,decls:9,vars:25,consts:[[3,"navigateBack","save","onSubmit","onCancel","highlightDifferencesChange","nextSubmission","useAsExampleSubmission","isLoading","saveBusy","submitBusy","cancelBusy","nextSubmissionBusy","isTeamMode","isAssessor","isTestRun","isIllegalSubmission","exerciseDashboardLink","canOverride","assessmentsAreValid","hasAssessmentDueDatePassed","exercise","result","correctionRound","isProgrammingExercise","highlightDifferences","hasComplaint","hasMoreFeedbackRequest","complaintHandled","complaintType"],[3,"complaint"],[3,"onAssessmentNoteChange","assessmentNote"],[1,"row","mt-4",3,"updateAssessmentAfterComplaint","zeroIndent","complaint","exercise","isAssessor","submission","isTestRun"]],template:function(o,i){o&1&&(X(),m(0,"jhi-assessment-header",0),x("navigateBack",function(){return i.navigateBack.emit()})("save",function(){return i.save.emit()})("onSubmit",function(){return i.onSubmit.emit()})("onCancel",function(){return i.onCancel.emit()}),w("highlightDifferencesChange",function(f){return L(i.highlightDifferences,f)||(i.highlightDifferences=f),f}),x("nextSubmission",function(){return i.nextSubmission.emit()})("useAsExampleSubmission",function(){return i.useAsExampleSubmission.emit()}),p(),n(1,`
`),c(2,"jhi-assessment-complaint-alert",1),n(3,`
`),Q(4),n(5,`
`),m(6,"jhi-assessment-note",2),x("onAssessmentNoteChange",function(f){return i.setAssessmentNoteForResult(f)}),p(),n(7,`
`),_(8,vt,3,6)),o&2&&(d("isLoading",i.isLoading)("saveBusy",i.saveBusy)("submitBusy",i.submitBusy)("cancelBusy",i.cancelBusy)("nextSubmissionBusy",i.nextSubmissionBusy)("isTeamMode",i.isTeamMode)("isAssessor",i.isAssessor)("isTestRun",i.isTestRun)("isIllegalSubmission",i.isIllegalSubmission)("exerciseDashboardLink",i.exerciseDashboardLink)("canOverride",i.canOverride)("assessmentsAreValid",i.assessmentsAreValid)("hasAssessmentDueDatePassed",i.hasAssessmentDueDatePassed)("exercise",i.exercise)("result",i.result)("correctionRound",i.correctionRound)("isProgrammingExercise",i.isProgrammingExercise),k("highlightDifferences",i.highlightDifferences),d("hasComplaint",!!i.complaint)("hasMoreFeedbackRequest",(i.complaint==null?null:i.complaint.complaintType)===i.MORE_FEEDBACK)("complaintHandled",i.complaint?i.complaint.accepted!==void 0:!1)("complaintType",i.complaint==null?null:i.complaint.complaintType),s(2),d("complaint",i.complaint),s(4),d("assessmentNote",i.result==null?null:i.result.assessmentNote),s(2),l(i.complaint?8:-1))},dependencies:[ve,Se,Re,Ee],styles:[".assessment-container[_ngcontent-%COMP%]{display:flex;min-height:calc(100vh - 173px);flex-flow:column nowrap}"]})}return t})();export{ye as a,kt as b,ei as c};
//# sourceMappingURL=chunk-RJFCCH4I.js.map
