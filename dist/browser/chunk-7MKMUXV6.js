import{f as y}from"./chunk-MLVGKM2P.js";import{c as p}from"./chunk-CK7FH6VF.js";import{a as C,b as f}from"./chunk-XBLNBTXN.js";import{a as v,b as u}from"./chunk-EELXLOHY.js";import{b as h}from"./chunk-R5BZWVRQ.js";import{L as n,O as a}from"./chunk-IOA4DPXY.js";import{Ea as c,ra as m,ya as l,z as o}from"./chunk-5LC5EQRR.js";var L=(()=>{class i{httpClient=c(a);entityTitleService=c(f);lectureUnitService=c(y);accountService=c(h);resourceURL="api/atlas";getForImport(e){let t=this.createCompetencySearchHttpParams(e);return this.httpClient.get(`${this.resourceURL}/course-competencies/for-import`,{params:t,observe:"response"}).pipe(o(r=>r&&r.body))}createCompetencySearchHttpParams(e){return new n().set("pageSize",String(e.pageSize)).set("page",String(e.page)).set("sortingOrder",e.sortingOrder).set("sortedColumn",e.sortedColumn).set("title",e.title).set("description",e.description).set("courseTitle",e.courseTitle).set("semester",e.semester)}getAllForCourse(e,t=!1){return this.httpClient.get(`${this.resourceURL}/courses/${e}/course-competencies${t?"?filter=true":""}`,{observe:"response"}).pipe(o(r=>this.convertArrayResponseDatesFromServer(r)),m(r=>r?.body?.forEach(this.sendTitlesToEntityTitleService.bind(this))))}getProgress(e,t,r=!1){let s=new n;return s=s.set("refresh",r.toString()),this.httpClient.get(`${this.resourceURL}/courses/${t}/course-competencies/${e}/student-progress`,{params:s,observe:"response"})}getCourseProgress(e,t){return this.httpClient.get(`${this.resourceURL}/courses/${t}/course-competencies/${e}/course-progress`,{observe:"response"})}findById(e,t){return this.httpClient.get(`${this.resourceURL}/courses/${t}/course-competencies/${e}`,{observe:"response"}).pipe(o(r=>(this.convertCompetencyResponseFromServer(r),this.sendTitlesToEntityTitleService(r?.body),r)))}generateCompetenciesFromCourseDescription(e,t,r){let s={courseDescription:t,currentCompetencies:r};return this.httpClient.post(`${this.resourceURL}/courses/${e}/course-competencies/generate-from-description`,s,{observe:"response"})}getCourseCompetencyTitles(e){return this.httpClient.get(`${this.resourceURL}/courses/${e}/course-competencies/titles`,{observe:"response"})}importAll(e,t,r){let s=new n().set("importRelations",r);return this.httpClient.post(`${this.resourceURL}/courses/${e}/course-competencies/import-all/${t}`,null,{params:s,observe:"response"})}createCompetencyRelation(e,t){let r={tailCompetencyId:e.tailCompetency?.id,headCompetencyId:e.headCompetency?.id,relationType:e.type};return this.httpClient.post(`${this.resourceURL}/courses/${t}/course-competencies/relations`,r,{observe:"response"})}getCompetencyRelations(e){return this.httpClient.get(`${this.resourceURL}/courses/${e}/course-competencies/relations`,{observe:"response"})}removeCompetencyRelation(e,t){return this.httpClient.delete(`${this.resourceURL}/courses/${t}/course-competencies/relations/${e}`,{observe:"response"})}getJoL(e,t){return this.httpClient.get(`${this.resourceURL}/courses/${e}/course-competencies/${t}/jol`,{observe:"response"}).pipe(o(r=>r))}setJudgementOfLearning(e,t,r){return this.httpClient.put(`${this.resourceURL}/courses/${e}/course-competencies/${t}/jol/${r}`,null,{observe:"response"})}getJoLAllForCourse(e){return this.httpClient.get(`${this.resourceURL}/courses/${e}/course-competencies/jol`,{observe:"response"}).pipe(o(t=>t))}convertCompetencyResponseFromServer(e){return e.body?.softDueDate&&(e.body.softDueDate=u(e.body.softDueDate)),e.body?.lectureUnitLinks?.forEach(t=>{t.lectureUnit&&(t.lectureUnit=this.lectureUnitService.convertLectureUnitDateFromServer(t.lectureUnit))}),e.body?.course&&this.accountService.setAccessRightsForCourse(e.body.course),this.convertExerciseLinksFromServer(e.body?.exerciseLinks),e}convertExerciseLinksFromServer(e){e?.forEach(t=>{t.exercise=p.convertExerciseDatesFromServer(t.exercise),p.parseExerciseCategories(t.exercise),t.exercise&&this.accountService.setAccessRightsForExercise(t.exercise)})}convertCompetencyFromClient(e){let t=Object.assign({},e,{softDueDate:v(e.softDueDate)});return this.convertCompetencyLinksFromClient(t),t}convertCompetencyLinksFromClient(e){e.lectureUnitLinks?.forEach(t=>{t.lectureUnit&&(t.lectureUnit=this.lectureUnitService.convertLectureUnitDatesFromClient(t.lectureUnit))}),e.exerciseLinks?.forEach(t=>{t.exercise&&(t.exercise=p.convertExerciseFromClient(t.exercise))})}convertArrayResponseDatesFromServer(e){return e.body&&e.body.map(t=>t.softDueDate=u(t.softDueDate)),e}sendTitlesToEntityTitleService(e){this.entityTitleService.setTitle(C.COMPETENCY,[e?.id],e?.title)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();export{L as a};
//# sourceMappingURL=chunk-7MKMUXV6.js.map
