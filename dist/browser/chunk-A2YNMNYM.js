import{b as p,c as z,d as E}from"./chunk-TDXQOKRD.js";import{a as d}from"./chunk-4YACL3TM.js";import{a as c}from"./chunk-IJQAYIKN.js";import{b as r}from"./chunk-IJRVZ46L.js";import{f as a}from"./chunk-U4DJRHYQ.js";import{a as h}from"./chunk-O26CMRR4.js";import{b as l}from"./chunk-5JBXU6VG.js";import{Ea as u,Vb as o}from"./chunk-5LC5EQRR.js";var g=class{minutes;seconds;constructor(x,i){this.minutes=x,this.seconds=i}};var S=(()=>{class n{dragAndDropQuestionUtil=u(d);shortAnswerQuestionUtil=u(c);DRAG_AND_DROP=r.DRAG_AND_DROP;MULTIPLE_CHOICE=r.MULTIPLE_CHOICE;SHORT_ANSWER=r.SHORT_ANSWER;QuizMode=l;ButtonType=h;warningQuizCache=!1;quizIsValid;quizExercise;savedEntity;isExamMode;isImport;invalidReasons;invalidWarnings;invalidFlaggedQuestions={};pendingChangesCache;cacheValidation(i){this.warningQuizCache=this.computeInvalidWarnings().length>0,this.quizIsValid=this.isValidQuiz(),this.pendingChangesCache=this.pendingChanges(),this.checkForInvalidFlaggedQuestions(),this.invalidReasons=this.computeInvalidReasons(),this.invalidWarnings=this.computeInvalidWarnings(),i.detectChanges()}isValidQuiz(){if(!this.quizExercise)return!1;let i=this.quizExercise.title!=null&&this.quizExercise.title!==""&&this.quizExercise.title.length<a&&this.quizExercise.duration!==0&&this.quizExercise.quizQuestions!=null&&!!this.quizExercise.quizQuestions.length,s=this.quizExercise.quizQuestions?.every(function(e){return p(e,this.dragAndDropQuestionUtil,this.shortAnswerQuestionUtil)},this),t=this.quizExercise.quizQuestions?.map(e=>e.points??0).reduce((e,q)=>e+q,0);return i&&s===!0&&t!==void 0&&t>0&&!this.testRunExistsAndShouldNotBeIgnored()}testRunExistsAndShouldNotBeIgnored(){return!this.isImport&&this.isExamMode&&!!this.quizExercise.testRunParticipationsExist}computeInvalidWarnings(){return this.quizExercise?this.quizExercise.quizQuestions?.map((s,t)=>{if(s.type===r.MULTIPLE_CHOICE&&s.answerOptions.some(e=>!e.explanation))return{translateKey:"artemisApp.quizExercise.invalidReasons.explanationIsMissing",translateValues:{index:t+1}}}).filter(Boolean):[]}computeInvalidReasons(){let i=new Array;if(!this.quizExercise)return[];(!this.quizExercise.title||this.quizExercise.title==="")&&i.push({translateKey:"artemisApp.quizExercise.invalidReasons.quizTitle",translateValues:{}}),this.quizExercise.title.length>=a&&i.push({translateKey:"artemisApp.quizExercise.invalidReasons.quizTitleLength",translateValues:{threshold:a}}),this.quizExercise.duration||i.push({translateKey:"artemisApp.quizExercise.invalidReasons.quizDuration",translateValues:{}}),(!this.quizExercise.quizQuestions||this.quizExercise.quizQuestions.length===0)&&i.push({translateKey:"artemisApp.quizExercise.invalidReasons.noQuestion",translateValues:{}}),this.testRunExistsAndShouldNotBeIgnored()&&i.push({translateKey:"artemisApp.quizExercise.edit.testRunSubmissionsExist",translateValues:{}}),this.quizExercise.quizQuestions.forEach(function(t,e){z(i,t,e,this.dragAndDropQuestionUtil,this.shortAnswerQuestionUtil)},this);let s=this.quizExercise?this.quizExercise.quizQuestions?.map((t,e)=>{if(this.invalidFlaggedQuestions[t.id])return{translateKey:"artemisApp.quizExercise.invalidReasons.questionHasInvalidFlaggedElements",translateValues:{index:e+1}}}).filter(Boolean):[];return i.concat(s)}pendingChanges(){return!this.quizExercise||!this.savedEntity?!1:JSON.stringify(this.quizExercise)!==JSON.stringify(this.savedEntity)}checkForInvalidFlaggedQuestions(){this.quizExercise&&(this.invalidFlaggedQuestions=E(this.quizExercise.quizQuestions??[]))}isEmpty(i){return Object.keys(i).length===0}static \u0275fac=function(s){return new(s||n)};static \u0275dir=o({type:n})}return n})();export{g as a,S as b};
//# sourceMappingURL=chunk-A2YNMNYM.js.map
