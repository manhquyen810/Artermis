import{b as S}from"./chunk-V7PDYRDZ.js";import{e as f}from"./chunk-5GXY5RYT.js";import{ya as u}from"./chunk-5LC5EQRR.js";var F=(()=>{class l{validateNoMisleadingShortAnswerMapping(t){if(!t.correctMappings)return!0;let e=f(t.correctMappings),o=[];for(let n of t.spots){let r=!1;this.getAllSolutionsForSpot(t.correctMappings,n).forEach(a=>{e.length>0&&e.length!==t.correctMappings.length&&(r=!0),e.length===t.correctMappings.length&&this.getAllSolutionsForSpot(t.correctMappings,n).filter(h=>this.getAllSpotsForSolutions(t.correctMappings,h).length===1).length>0&&(r=!0),e=e.filter(p=>!this.isSameSolution(a,p.solution))});let i=this.getAllSolutionsForSpot(t.correctMappings,n).length>=t.spots.length;r||i?o.push(!0):o.push(!1)}return!o.includes(!1)}isMappedTogether(t,e,o){return!!this.getShortAnswerMapping(t,e,o)}getAllSpotsForSolutions(t,e){return t?.filter(function(o){return this.isSameSolution(o.solution,e)},this).map(function(o){return o.spot})}getAllSolutionsForSpot(t,e){return t?.filter(o=>this.isSameSpot(o.spot,e),this).map(o=>o.solution)}isSameSetOfSpots(t,e){return t?.length!==e?.length?!1:t?.every(o=>e?.some(n=>this.isSameSpot(o,n)))&&e?.every(o=>t?.some(n=>this.isSameSpot(n,o)))}getShortAnswerMapping(t,e,o){return t?.find(n=>this.isSameSpot(o,n.spot)&&this.isSameSolution(e,n.solution),this)}isSameSpot(t,e){return t===e||t!==void 0&&e!==void 0&&(t.id&&e.id&&t.id===e.id||t.tempID!=null&&e.tempID!=null&&t.tempID===e.tempID)}isSameSolution(t,e){return t===e||t!==void 0&&e!==void 0&&(t.id&&e.id&&t.id===e.id||t.tempID!=null&&e.tempID!=null&&t.tempID===e.tempID)}everySpotHasASolution(t,e){let o=0;for(let n of e){let r=this.getAllSolutionsForSpot(t,n);r&&r.length>0&&o++}return o===e.length}everyMappedSolutionHasASpot(t){return!(t.filter(e=>e.spot===void 0).length>0)}hasMappingDuplicateValues(t){if(t.filter(o=>o.spot===void 0).length>0)return!1;let e=0;for(let o=0;o<t.length-1;o++)for(let n=o+1;n<t.length;n++)t[o].spot.spotNr===t[n].spot.spotNr&&t[o].solution.text===t[n].solution.text&&e++;return e>0}getSampleSolutions(t){let e=[];for(let o of t.spots){let n=this.getAllSolutionsForSpot(t.correctMappings,o);for(let r of t.correctMappings)if(r.spot.id===o.id&&!e.some(s=>s.text===r.solution.text&&!this.allSolutionsAreInSampleSolution(n,e))){e.push(r.solution);break}}return e}allSolutionsAreInSampleSolution(t,e){let o=0;for(let n of t||[])for(let r of e||[])if(n.text===r.text){o++;break}return o===t?.length}atLeastAsManySolutionsAsSpots(t){return t.spots.length<=t.solutions.length}divideQuestionTextIntoTextParts(t){let e=/\[-spot\s*[0-9]+\]/g;function o([n,...r],s=[]){return n===void 0?s:[n,...o(s,r)]}return t.split(/\n/g).map(n=>{let r=n.match(e)||[],s=n.split(e).map(i=>i.trim());return o(s,r).filter(i=>i.length>0)})}isInputField(t){return t.search(/\[-spot/g)!==-1}getSpotNr(t){return+t.split(/\[-spot/g)[1].split("]")[0].trim()}getSpot(t,e){return e.spots.filter(o=>o.spotNr===t)[0]}transformTextPartsIntoHTML(t){let e=t.map(o=>o.map(n=>S(n.trim())));return this.addIndentationToTextParts(t,e)}addIndentationToTextParts(t,e){for(let o=0;o<e.length;o++){let n=e[o][0],r="";if(t[o].length>1?r=e[o][0]===""&&t[o][1].startsWith("[-spot")?this.getFirstWord(t[o][1]):this.getFirstWord(t[o][0]):r=this.getFirstWord(t[o][0]),r==="")continue;let s=n.indexOf(r),i="&nbsp;".repeat(this.getIndentation(t[o][0]).length);e[o][0]=[n.substring(0,s),i,n.substring(s).trim()].join("")}return e}getIndentation(t){if(!t)return"";t.startsWith("`")&&(t=t.substring(1));let e=0,o="";for(;t[e]===" ";)o=o.concat(" "),e++;return o}getFirstWord(t){if(!t)return"";let e=t.trim().split(" ").filter(o=>o!=="");return e.length===0?"":e[0]==="`"?e[1]:e[0].startsWith("`")?e[0].substring(1):e[0]}static \u0275fac=function(e){return new(e||l)};static \u0275prov=u({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();export{F as a};
//# sourceMappingURL=chunk-IJQAYIKN.js.map
