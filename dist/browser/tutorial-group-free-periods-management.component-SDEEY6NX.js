import"./chunk-HLUEVYPH.js";import{a as O}from"./chunk-X237AILQ.js";import{a as Le}from"./chunk-OTCBNILH.js";import{b as Oe}from"./chunk-T624HJJL.js";import"./chunk-HQTS6JOY.js";import"./chunk-HMZID6NQ.js";import"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import"./chunk-ZPITQMA6.js";import{a as We,b as Ze,c as Be,d as Ue,e as ze}from"./chunk-HK7MJBP6.js";import"./chunk-2CUFQLAH.js";import"./chunk-MKPB4JKY.js";import"./chunk-I76AVIQH.js";import"./chunk-H2ETPEH6.js";import"./chunk-Z6NSEM73.js";import{a as te,b as I}from"./chunk-AU6UEH3U.js";import{a as Ve}from"./chunk-FGAONQTL.js";import{c as A}from"./chunk-5MVJAZRV.js";import{c as V}from"./chunk-JNO6DNVW.js";import"./chunk-EELXLOHY.js";import{u as X,v as ee}from"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import{C as ye,J as Ge,K as Se,L as Ee,c as xe,e as Ce,h as De,i as Pe,n as _e,s as be,v as ve}from"./chunk-WA5GEAJB.js";import"./chunk-5GXY5RYT.js";import{a as ie}from"./chunk-K3W6YFKH.js";import{c as k}from"./chunk-JXJXC4DZ.js";import{d as j}from"./chunk-EDXSOKK5.js";import{p as K}from"./chunk-DID2YGL7.js";import"./chunk-S4QLGR2R.js";import{Bb as Ae,Lc as Ie,Oc as je,S as Me,hb as ke,i as we}from"./chunk-Z4VHWOB5.js";import"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import{a as z}from"./chunk-NOBD5HSR.js";import{a as P}from"./chunk-U54OSGNH.js";import{f as Fe}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import{n as J}from"./chunk-IOA4DPXY.js";import{A as le,Cd as E,Db as l,Dc as v,Dd as U,Ea as u,Id as ge,La as de,Ma as f,Mc as c,Na as h,Oc as d,P as $,Rc as Y,Tb as D,Va as W,W as se,Zb as g,aa as M,cd as Z,dd as e,ed as fe,f as _,fd as S,j as q,kc as m,oa as me,pa as b,pd as he,qd as Te,r as H,rd as y,sc as T,sd as B,uc as ue,vc as pe,wc as ce,xc as n,yc as a,yd as x,zc as s,zd as Q}from"./chunk-5LC5EQRR.js";import{a as ae}from"./chunk-3E746U5Y.js";var Qe=r=>({timeZone:r}),re=r=>({isInvalid:r}),Je=()=>({max:"256"});function Ke(r,p){r&1&&(e(0,`
                        `),s(1,"div",28),e(2,`
                    `))}function Xe(r,p){r&1&&(e(0,`
                        `),s(1,"div",31),e(2,`
                    `))}function et(r,p){r&1&&(e(0,`
                        `),s(1,"div",32),e(2,`
                    `))}function tt(r,p){if(r&1&&(e(0,`
                    `),s(1,"label",29),e(2,`
                    `),n(3,"div",17),e(4,`
                        `),s(5,"input",30),e(6,`
                        `),n(7,"button",19),s(8,"fa-icon",20),a(),e(9,`
                        `),s(10,"owl-date-time",21,1),e(12,`
                    `),a(),e(13,`
                    `),g(14,Xe,3,0),x(15,"artemisDate"),x(16,"artemisDate"),g(17,et,3,0)),r&2){let i=Z(11),t=d(2);l(5),m("ngClass",y(19,re,(t.form.controls.endDate==null?null:t.form.controls.endDate.invalid)&&((t.form.controls.endDate==null?null:t.form.controls.endDate.dirty)||(t.form.controls.endDate==null?null:t.form.controls.endDate.touched))))("owlDateTimeTrigger",i)("owlDateTime",i),l(2),m("owlDateTimeTrigger",i),l(),m("icon",t.faCalendarAlt),l(2),m("firstDayOfWeek",1)("pickerType","calendar")("pickerMode","dialog"),l(4),T(t.form.controls.endDate!=null&&t.form.controls.endDate.invalid&&(t.form.controls.endDate!=null&&t.form.controls.endDate.dirty||t.form.controls.endDate!=null&&t.form.controls.endDate.touched)&&(!(t.form.controls.endDate==null||t.form.controls.endDate.errors==null)&&t.form.controls.endDate.errors.required)?14:t.form.controls.endDate!=null&&t.form.controls.endDate.touched&&(t.form.controls.startDate!=null&&t.form.controls.startDate.touched)&&E(15,9,t.form.controls.endDate==null?null:t.form.controls.endDate.value,"short-date",!1,t.timeZone)<=E(16,14,t.form.controls.startDate==null?null:t.form.controls.startDate.value,"short-date",!1,t.timeZone)?17:-1)}}function it(r,p){r&1&&(e(0,`
                        `),s(1,"div",32),e(2,`
                    `))}function rt(r,p){if(r&1&&(e(0,`
                    `),s(1,"label",33),e(2,`
                    `),n(3,"div",17),e(4,`
                        `),s(5,"input",34),e(6,`
                        `),s(7,"owl-date-time",35,2),e(9,`
                    `),a(),e(10,`

                    `),s(11,"label",36),e(12,`
                    `),n(13,"div",17),e(14,`
                        `),s(15,"input",37),e(16,`
                        `),s(17,"owl-date-time",38,3),e(19,`
                    `),a(),e(20,`
                    `),g(21,it,3,0),x(22,"artemisDate"),x(23,"artemisDate")),r&2){let i=Z(8),t=Z(18),o=d(2);l(5),m("ngClass",y(21,re,(o.form.controls.startTime==null?null:o.form.controls.startTime.invalid)&&((o.form.controls.startTime==null?null:o.form.controls.startTime.dirty)||(o.form.controls.startTime==null?null:o.form.controls.startTime.touched))))("owlDateTimeTrigger",i)("owlDateTime",i),l(2),m("pickerType","timer")("pickerMode","dialog"),l(8),m("ngClass",y(23,re,(o.form.controls.endTime==null?null:o.form.controls.endTime.invalid)&&((o.form.controls.endTime==null?null:o.form.controls.endTime.dirty)||(o.form.controls.endTime==null?null:o.form.controls.endTime.touched))))("owlDateTimeTrigger",t)("owlDateTime",t),l(2),m("pickerType","timer")("pickerMode","dialog"),l(4),T(o.form.controls.endTime!=null&&o.form.controls.endTime.touched&&(o.form.controls.startTime!=null&&o.form.controls.startTime.touched)&&o.form.controls.startTime&&E(22,11,o.form.controls.endTime==null?null:o.form.controls.endTime.value,"time",!1,o.timeZone)<=E(23,16,o.form.controls.startTime==null?null:o.form.controls.startTime.value,"time",!1,o.timeZone)?21:-1)}}function ot(r,p){r&1&&(e(0,`
                        `),s(1,"div",39),e(2,`
                    `)),r&2&&(l(),m("translateValues",Te(1,Je)))}function nt(r,p){if(r&1){let i=v();e(0,`
            `),n(1,"form",8),c("ngSubmit",function(){f(i);let o=d();return h(o.submitForm())}),e(2,`
                `),n(3,"div",9),e(4,`
                    `),n(5,"input",10),c("click",function(){f(i);let o=d();return h(o.setTimeFrame(o.TimeFrame.Period))}),a(),e(6,`
                    `),s(7,"label",11),e(8,`

                    `),n(9,"input",12),c("click",function(){f(i);let o=d();return h(o.setTimeFrame(o.TimeFrame.Day))}),a(),e(10,`
                    `),s(11,"label",13),e(12,`

                    `),n(13,"input",14),c("click",function(){f(i);let o=d();return h(o.setTimeFrame(o.TimeFrame.PeriodWithinDay))}),a(),e(14,`
                    `),s(15,"label",15),e(16,`
                `),a(),e(17,`

                `),e(18,`
                `),n(19,"div"),e(20,`
                    `),s(21,"label",16),e(22,`
                    `),n(23,"div",17),e(24,`
                        `),s(25,"input",18),e(26,`
                        `),n(27,"button",19),s(28,"fa-icon",20),a(),e(29,`
                        `),s(30,"owl-date-time",21,0),e(32,`
                    `),a(),e(33,`
                    `),g(34,Ke,3,0),a(),e(35,`

                `),g(36,tt,18,21)(37,rt,24,25),n(38,"div",22),e(39,`
                    `),s(40,"label",23),e(41,`
                    `),s(42,"textarea",24),x(43,"artemisTranslate"),e(44,`
                    `),g(45,ot,3,2),a(),e(46,`
                `),n(47,"div",25),e(48,`
                    `),n(49,"div",7),e(50,`
                        `),n(51,"button",26),e(52,`
                            `),s(53,"span",27),e(54,`
                        `),a(),e(55,`
                    `),a(),e(56,`
                `),a(),e(57,`
            `),a(),e(58,`
        `)}if(r&2){let i=Z(31),t=d();l(),m("formGroup",t.form),l(4),m("checked",t.timeFrame===t.TimeFrame.Period),l(4),m("checked",t.timeFrame===t.TimeFrame.Day),l(4),m("checked",t.timeFrame===t.TimeFrame.PeriodWithinDay),l(8),m("jhiTranslate",t.timeFrame!==t.TimeFrame.Period?"artemisApp.forms.tutorialFreePeriodForm.dateInput.label":"artemisApp.forms.tutorialFreePeriodForm.dateInput.labelStart"),l(4),m("ngClass",y(21,re,(t.form.controls.startDate==null?null:t.form.controls.startDate.invalid)&&((t.form.controls.startDate==null?null:t.form.controls.startDate.dirty)||(t.form.controls.startDate==null?null:t.form.controls.startDate.touched))))("owlDateTimeTrigger",i)("owlDateTime",i),l(2),m("owlDateTimeTrigger",i),l(),m("icon",t.faCalendarAlt),l(2),m("firstDayOfWeek",1)("pickerType","calendar")("pickerMode","dialog"),l(4),T(t.form.controls.startDate!=null&&t.form.controls.startDate.invalid&&(t.form.controls.startDate!=null&&t.form.controls.startDate.dirty||t.form.controls.startDate!=null&&t.form.controls.startDate.touched)&&(!(t.form.controls.startDate==null||t.form.controls.startDate.errors==null)&&t.form.controls.startDate.errors.required)?34:-1),l(2),T(t.timeFrame===t.TimeFrame.Period?36:t.timeFrame===t.TimeFrame.PeriodWithinDay?37:-1),l(6),m("placeholder",Q(43,19,"artemisApp.forms.tutorialFreePeriodForm.reasonInput.placeholder")),l(3),T(t.form.controls.reason!=null&&t.form.controls.reason.invalid&&(t.form.controls.reason!=null&&t.form.controls.reason.dirty||t.form.controls.reason!=null&&t.form.controls.reason.touched&&(!(t.form.controls.reason==null||t.form.controls.reason.errors==null)&&t.form.controls.reason.errors.maxlength))?45:-1),l(6),m("disabled",!t.isSubmitPossible),l(2),Y("jhiTranslate",t.isEditMode?"global.generic.edit":"global.generic.create")}}var at={datePickerInput:{weekday:"long",year:"numeric",month:"long",day:"numeric"},timePickerInput:{hour:"numeric",minute:"numeric"}},C=function(r){return r[r.Day=0]="Day",r[r.Period=1]="Period",r[r.PeriodWithinDay=2]="PeriodWithinDay",r}(C||{}),oe=(()=>{class r{fb=u(Ge);formData={startDate:void 0,endDate:void 0,startTime:void 0,endTime:void 0,reason:void 0};isEditMode=!1;timeZone;formSubmitted=new W;faCalendarAlt=we;form;timeFrame=C.Day;TimeFrame=C;setTimeFrame(i){["endDate","endTime","startTime"].forEach(o=>{(i===C.Day||i===C.Period&&o!=="endDate"||i===C.PeriodWithinDay&&o==="endDate")&&this.resetDateControl(o)}),this.timeFrame=i}resetDateControl(i){let t=this.form.get(i);t&&(t.reset(),t.markAsUntouched())}get isStartBeforeEnd(){if(this.timeFrame===C.PeriodWithinDay&&this.endTimeControl?.value&&this.startTimeControl?.value){let i=new Date(this.endTimeControl.value.getTime()),t=new Date(this.startTimeControl.value.getTime());return i.setSeconds(0,0),t.setSeconds(0,0),i>t}else if(this.timeFrame===C.Period&&this.endDateControl?.value&&this.startDateControl?.value){let i=new Date(this.endDateControl.value.getTime()),t=new Date(this.startDateControl.value.getTime());return i.setHours(0,0,0,0),t.setHours(0,0,0,0),i>t}return!0}get timeFrameControl(){return this.timeFrame}get startDateControl(){return this.form.get("startDate")}get endDateControl(){return this.form.get("endDate")}get startTimeControl(){return this.form.get("startTime")}get endTimeControl(){return this.form.get("endTime")}get reasonControl(){return this.form.get("reason")}get isSubmitPossible(){return!this.startDateControl?.value||!this.startDateControl?.valid?!1:this.timeFrame===C.Day?!0:this.timeFrame===C.Period?!!this.endDateControl?.value&&!!this.endDateControl?.valid&&this.isStartBeforeEnd:this.timeFrame===C.PeriodWithinDay?!!this.startTimeControl?.value&&!!this.startTimeControl?.valid&&!!this.endTimeControl?.value&&!!this.endTimeControl?.valid&&this.isStartBeforeEnd&&!this.isStartTimeInvalid&&!this.isEndTimeInvalid:!1}ngOnInit(){this.initializeForm()}ngOnChanges(){this.initializeForm(),this.isEditMode&&this.formData&&(this.setFormValues(this.formData),this.setFirstTimeFrameInEditMode(this.formData))}submitForm(){let i=ae({},this.form.value);this.formSubmitted.emit(i)}setFormValues(i){this.form.patchValue({startDate:i.startDate,endDate:i.endDate,startTime:i.startTime,endTime:i.endTime,reason:i.reason})}setFirstTimeFrameInEditMode(i){!i.endDate&&!i.startTime&&!i.endTime?this.setTimeFrame(C.Day):!i.endDate&&i.startTime&&i.endTime?this.setTimeFrame(C.PeriodWithinDay):this.setTimeFrame(C.Period)}initializeForm(){this.form||(this.form=this.fb.group({startDate:[void 0,[Ce.required]],endDate:[void 0],startTime:[void 0],endTime:[void 0],reason:[void 0]}))}get isStartTimeInvalid(){return this.startTimeControl?this.startTimeControl.invalid&&(this.startTimeControl.touched||this.startTimeControl.dirty):!1}get isEndTimeInvalid(){return this.endTimeControl?this.endTimeControl.invalid&&(this.endTimeControl.touched||this.endTimeControl.dirty):!1}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=D({type:r,selectors:[["jhi-tutorial-free-period-form"]],inputs:{formData:"formData",isEditMode:"isEditMode",timeZone:"timeZone"},outputs:{formSubmitted:"formSubmitted"},features:[he([{provide:Ze,useValue:at}]),de],decls:12,vars:4,consts:[["startDatePicker",""],["endDatePicker",""],["startTimePicker",""],["endTimePicker",""],[1,"row"],[1,"col-12","mb-2"],["jhiTranslate","artemisApp.generic.timeZone",1,"alert","alert-info",3,"translateValues"],[1,"col-12"],[1,"row",3,"ngSubmit","formGroup"],["role","group",1,"btn-group"],["type","radio","name","timeFrame","id","FreePeriod","autocomplete","off",1,"btn-check",3,"click","checked"],["for","FreePeriod","jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.timeFrame.period",1,"btn","btn-outline-primary"],["type","radio","name","timeFrame","id","FreeDay","autocomplete","off",1,"btn-check",3,"click","checked"],["for","FreeDay","jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.timeFrame.day",1,"btn","btn-outline-primary"],["type","radio","name","timeFrame","id","FreePeriodWithinDay","autocomplete","off",1,"btn-check",3,"click","checked"],["for","FreePeriodWithinDay","jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.timeFrame.periodWithinDay",1,"btn","btn-outline-primary"],["for","startDate",1,"form-label",3,"jhiTranslate"],[1,"input-group"],["name","startDate","id","startDate","required","","formControlName","startDate","readonly","","jhiOwlDateTimeFormat","",1,"form-control",3,"ngClass","owlDateTimeTrigger","owlDateTime"],["type","button",1,"btn","btn-secondary",3,"owlDateTimeTrigger"],[3,"icon"],["datePickerInput","",3,"firstDayOfWeek","pickerType","pickerMode"],[1,"form-group"],["for","reason","jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.reasonInput.label"],["id","reason","rows","6","formControlName","reason",1,"form-control",3,"placeholder"],[1,"row","mt-2"],["id","submitButton","type","submit",1,"btn","btn-primary",3,"disabled"],[3,"jhiTranslate"],["jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.dateInput.requiredDateError",1,"alert","alert-danger"],["for","endDate","jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.dateInput.labelEnd",1,"form-label"],["name","endDate","id","endDate","required","","formControlName","endDate","readonly","","jhiOwlDateTimeFormat","",1,"form-control",3,"ngClass","owlDateTimeTrigger","owlDateTime"],["jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.dateInput.requiredEndDateError",1,"alert","alert-danger"],["jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.dateInput.invalidEndDateError",1,"alert","alert-danger"],["for","startTime","jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.dateInput.labelStartTime",1,"form-label"],["name","startTime","id","startTime","required","","formControlName","startTime","readonly","","jhiOwlDateTimeFormat","",1,"form-control",3,"ngClass","owlDateTimeTrigger","owlDateTime"],["timePickerInput","",3,"pickerType","pickerMode"],["for","endTime","jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.dateInput.labelEndTime",1,"form-label"],["name","endTime","id","endTime","required","","formControlName","endTime","readonly","","jhiOwlDateTimeFormat","",1,"form-control",3,"ngClass","owlDateTimeTrigger","owlDateTime"],[3,"pickerType","pickerMode"],["jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.reasonInput.maxLengthValidationError",1,"alert","alert-danger",3,"translateValues"]],template:function(t,o){t&1&&(n(0,"div",4),e(1,`
    `),n(2,"div",5),e(3,`
        `),s(4,"div",6),e(5,`
    `),a(),e(6,`
    `),n(7,"div",7),e(8,`
        `),g(9,nt,59,23),a(),e(10,`
`),a(),e(11,`
`)),t&2&&(l(4),m("translateValues",y(2,Qe,o.timeZone)),l(5),T(o.form?9:-1))},dependencies:[P,Se,_e,xe,De,Pe,ye,Ee,be,ve,ze,We,Ue,Be,J,j,V,ie],encapsulation:2,changeDetection:0})}return r})();function lt(r,p){if(r&1){let i=v();e(0,`
        `),n(1,"div"),e(2,`
            `),n(3,"div",1),e(4,`
                `),s(5,"h4",2),e(6,`
                `),n(7,"button",3),c("click",function(){f(i);let o=d();return h(o.clear())}),a(),e(8,`
            `),a(),e(9,`
            `),n(10,"div",4),e(11,`
                `),n(12,"jhi-tutorial-free-period-form",5),c("formSubmitted",function(o){f(i);let F=d();return h(F.createTutorialGroupFreePeriod(o))}),a(),e(13,`
            `),a(),e(14,`
        `),a(),e(15,`
    `)}if(r&2){let i=d();l(12),m("timeZone",i.course.timeZone)("isEditMode",!1)}}var N=(()=>{class r{activeModal=u(X);tutorialGroupFreePeriodService=u(I);alertService=u(k);ngUnsubscribe=new _;tutorialGroupFreePeriodToCreate=new te;isLoading;tutorialGroupConfigurationId;course;isInitialized=!1;initialize(){!this.tutorialGroupConfigurationId||!this.course?z("Error: Component not fully configured"):this.isInitialized=!0}createTutorialGroupFreePeriod(i){let{startDate:t,endDate:o,startTime:F,endTime:G,reason:ne}=i;this.tutorialGroupFreePeriodToCreate.startDate=r.combineDateAndTimeWithAlternativeDate(t,F,void 0),this.tutorialGroupFreePeriodToCreate.endDate=r.combineDateAndTimeWithAlternativeDate(o,G,t),this.tutorialGroupFreePeriodToCreate.reason=ne,this.isLoading=!0,this.tutorialGroupFreePeriodService.create(this.course.id,this.tutorialGroupConfigurationId,this.tutorialGroupFreePeriodToCreate).pipe(M(()=>{this.isLoading=!1}),b(this.ngUnsubscribe)).subscribe({next:()=>{this.activeModal.close()},error:w=>{A(this.alertService,w),this.clear()}})}static combineDateAndTimeWithAlternativeDate(i,t,o){if(!i){if(!o){let G=new Error("date and time are undefined");throw z(G),G}let F=new Date(o);return F.setHours(t?.getHours()??23,t?.getMinutes()??59),F}return i.setHours(t?.getHours()??(o?23:0),t?.getMinutes()??(o?59:0)),i}clear(){this.activeModal.dismiss()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=D({type:r,selectors:[["jhi-create-tutorial-group-free-day"]],inputs:{tutorialGroupConfigurationId:"tutorialGroupConfigurationId",course:"course"},decls:4,vars:2,consts:[[3,"isLoading"],[1,"modal-header"],["jhiTranslate","artemisApp.pages.createTutorialFreePeriod.title",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formSubmitted","timeZone","isEditMode"]],template:function(t,o){t&1&&(n(0,"jhi-loading-indicator-container",0),e(1,`
    `),g(2,lt,16,2),a(),e(3,`
`)),t&2&&(m("isLoading",o.isLoading),l(2),T(o.isInitialized?2:-1))},dependencies:[O,P,oe],encapsulation:2,changeDetection:0})}return r})();function st(r,p){if(r&1){let i=v();e(0,`
        `),n(1,"div"),e(2,`
            `),n(3,"div",1),e(4,`
                `),s(5,"h4",2),e(6,`
                `),n(7,"button",3),c("click",function(){f(i);let o=d();return h(o.clear())}),a(),e(8,`
            `),a(),e(9,`
            `),n(10,"div",4),e(11,`
                `),n(12,"jhi-tutorial-free-period-form",5),c("formSubmitted",function(o){f(i);let F=d();return h(F.updateTutorialGroupFreePeriod(o))}),a(),e(13,`
            `),a(),e(14,`
        `),a(),e(15,`
    `)}if(r&2){let i=d();l(12),m("timeZone",i.course.timeZone)("formData",i.formData)("isEditMode",!0)}}var Ne=(()=>{class r{activeModal=u(X);tutorialGroupFreePeriodService=u(I);alertService=u(k);isLoading=!1;tutorialGroupFreePeriod;tutorialGroupsConfiguration;course;isInitialized=!1;ngUnsubscribe=new _;formData;initialize(){if(!this.tutorialGroupFreePeriod||!this.course||!this.tutorialGroupsConfiguration){z("Error: Component not fully configured");return}let i=R.isFreePeriod(this.tutorialGroupFreePeriod),t=R.isFreePeriodWithinDay(this.tutorialGroupFreePeriod);this.formData={startDate:this.tutorialGroupFreePeriod.start?.tz(this.course.timeZone).toDate(),endDate:i?this.tutorialGroupFreePeriod.end?.tz(this.course.timeZone).toDate():void 0,startTime:t?this.tutorialGroupFreePeriod.start?.tz(this.course.timeZone).toDate():void 0,endTime:t?this.tutorialGroupFreePeriod.end?.tz(this.course.timeZone).toDate():void 0,reason:this.tutorialGroupFreePeriod.reason},t&&(this.formData.startTime&&this.tutorialGroupFreePeriod.start&&this.formData.startTime.setHours(this.tutorialGroupFreePeriod.start.tz(this.course.timeZone).hour()),this.formData.endTime&&this.tutorialGroupFreePeriod.end&&this.formData.endTime.setHours(this.tutorialGroupFreePeriod.end.tz(this.course.timeZone).hour())),this.isInitialized=!0}updateTutorialGroupFreePeriod(i){let{startDate:t,endDate:o,startTime:F,endTime:G,reason:ne}=i,w=new te;w.startDate=N.combineDateAndTimeWithAlternativeDate(t,F,void 0),w.endDate=N.combineDateAndTimeWithAlternativeDate(o,G,t),w.reason=ne,this.isLoading=!0,this.tutorialGroupFreePeriodService.update(this.course.id,this.tutorialGroupsConfiguration.id,this.tutorialGroupFreePeriod.id,w).pipe(M(()=>{this.isLoading=!1}),b(this.ngUnsubscribe)).subscribe({next:()=>{this.activeModal.close()},error:Ye=>{this.clear(),A(this.alertService,Ye)}})}clear(){this.activeModal.dismiss()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=D({type:r,selectors:[["jhi-edit-tutorial-group-free-period"]],inputs:{tutorialGroupFreePeriod:"tutorialGroupFreePeriod",tutorialGroupsConfiguration:"tutorialGroupsConfiguration",course:"course"},decls:4,vars:2,consts:[[3,"isLoading"],[1,"modal-header"],["jhiTranslate","artemisApp.pages.editTutorialFreePeriod.title",1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formSubmitted","timeZone","formData","isEditMode"]],template:function(t,o){t&1&&(n(0,"jhi-loading-indicator-container",0),e(1,`
    `),g(2,st,16,3),a(),e(3,`
`)),t&2&&(m("isLoading",o.isLoading),l(2),T(o.isInitialized?2:-1))},dependencies:[O,P,oe],encapsulation:2,changeDetection:0})}return r})();var Re=(()=>{class r{tutorialGroupFreePeriodService=u(I);modalService=u(ee);course;tutorialGroupConfiguration;tutorialFreePeriod;tutorialFreePeriodDeleted=new W;tutorialFreePeriodEdited=new W;dialogErrorSource=new _;dialogError$=this.dialogErrorSource.asObservable();ngUnsubscribe=new _;faWrench=ke;faUsers=Me;faTrash=Ae;deleteTutorialFreePeriod=()=>{this.tutorialGroupFreePeriodService.delete(this.course.id,this.tutorialGroupConfiguration.id,this.tutorialFreePeriod.id).pipe(b(this.ngUnsubscribe)).subscribe({next:()=>{this.dialogErrorSource.next(""),this.tutorialFreePeriodDeleted.emit()},error:i=>this.dialogErrorSource.next(i.message)})};openEditFreePeriodDialog(i){i.stopPropagation();let t=this.modalService.open(Ne,{size:"lg",scrollable:!1,backdrop:"static",animation:!1});t.componentInstance.course=this.course,t.componentInstance.tutorialGroupFreePeriod=this.tutorialFreePeriod,t.componentInstance.tutorialGroupsConfiguration=this.tutorialGroupConfiguration,t.componentInstance.initialize(),H(t.result).pipe($(()=>q),b(this.ngUnsubscribe)).subscribe(()=>{this.tutorialFreePeriodEdited.emit()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.dialogErrorSource.unsubscribe()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=D({type:r,selectors:[["jhi-tutorial-group-free-period-row-buttons"]],inputs:{course:"course",tutorialGroupConfiguration:"tutorialGroupConfiguration",tutorialFreePeriod:"tutorialFreePeriod"},outputs:{tutorialFreePeriodDeleted:"tutorialFreePeriodDeleted",tutorialFreePeriodEdited:"tutorialFreePeriodEdited"},decls:18,vars:11,consts:[[1,"btn-group","flex-btn-group-container"],["type","button",1,"btn","btn-warning","btn-sm","me-1",3,"click","id"],[3,"icon"],["jhiTranslate","entity.action.edit",1,"d-none","d-md-inline"],["jhiDeleteButton","","deleteQuestion","artemisApp.pages.tutorialFreePeriodsManagement.deleteDialog.question",3,"delete","id","entityTitle","dialogError"]],template:function(t,o){t&1&&(n(0,"div",0),e(1,`
    `),e(2,`

    `),n(3,"button",1),c("click",function(G){return o.openEditFreePeriodDialog(G)}),e(4,`
        `),s(5,"fa-icon",2),e(6,`
        `),s(7,"span",3),e(8,`
    `),a(),e(9,`
    `),e(10,`
    `),n(11,"button",4),x(12,"artemisDate"),c("delete",function(){return o.deleteTutorialFreePeriod()}),e(13,`
        `),s(14,"fa-icon",2),e(15,`
    `),a(),e(16,`
`),a(),e(17,`
`)),t&2&&(l(3),m("id","edit-"+o.tutorialFreePeriod.id),l(2),m("icon",o.faWrench),l(6),Y("entityTitle",E(12,6,o.tutorialFreePeriod.start,"long-date",!1,o.course.timeZone)),m("id","delete-"+o.tutorialFreePeriod.id)("dialogError",o.dialogError$),l(3),m("icon",o.faTrash))},dependencies:[j,P,Oe,V],encapsulation:2,changeDetection:0})}return r})();var mt=r=>({"text-past":r}),qe=(r,p)=>[r,"long-date",!1,p,!0],He=(r,p)=>[r,"time",!1,p,!1];function dt(r,p){if(r&1){let i=v();e(0,`
                `),n(1,"tr",10),e(2,`
                    `),n(3,"td",9),e(4),a(),e(5,`
                    `),n(6,"td",11),e(7),x(8,"artemisDate"),a(),e(9,`
                    `),n(10,"td",11),e(11),x(12,"artemisDate"),a(),e(13,`
                    `),n(14,"td",11),e(15),x(16,"artemisDate"),a(),e(17,`
                    `),n(18,"td",11),e(19),x(20,"artemisDate"),a(),e(21,`
                    `),n(22,"td",11),e(23,`
                        `),n(24,"span",12),e(25),a(),e(26,`
                    `),a(),e(27,`
                    `),n(28,"td",9),e(29,`
                        `),n(30,"div",13),e(31,`
                            `),n(32,"jhi-tutorial-group-free-period-row-buttons",14),c("tutorialFreePeriodDeleted",function(){f(i);let o=d();return h(o.loadAll())})("tutorialFreePeriodEdited",function(){f(i);let o=d();return h(o.loadAll())}),a(),e(33,`
                        `),a(),e(34,`
                    `),a(),e(35,`
                `),a(),e(36,`
            `)}if(r&2){let i=p.$implicit,t=d();l(),m("ngClass",y(34,mt,t.isInThePast(i))),l(3),S(`
                        `,i.id,`
                    `),l(3),S(`
                        `,U(8,10,B(36,qe,i.start,t.course.timeZone)),`
                    `),l(4),S(`
                        `,U(12,16,B(39,qe,i.end,t.course.timeZone)),`
                    `),l(4),S(`
                        `,t.TutorialGroupFreePeriodsManagementComponent.isFreeDay(i)||t.TutorialGroupFreePeriodsManagementComponent.isFreePeriod(i)?"-":U(16,22,B(42,He,i.start,t.course.timeZone)),`
                    `),l(4),S(`
                        `,t.TutorialGroupFreePeriodsManagementComponent.isFreeDay(i)||t.TutorialGroupFreePeriodsManagementComponent.isFreePeriod(i)?"-":U(20,28,B(45,He,i.end,t.course.timeZone)),`
                    `),l(6),S(" ",i.reason?i.reason:"-"," "),l(7),m("course",t.course)("tutorialGroupConfiguration",t.tutorialGroupsConfiguration)("tutorialFreePeriod",i)}}var $e=(()=>{class r{course;tutorialGroupsConfiguration;tutorialGroupFreePeriods;labelText;loadAll;TutorialGroupFreePeriodsManagementComponent=R;isInThePast(i){return i.end.isBefore(K())}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=D({type:r,selectors:[["jhi-tutorial-group-free-periods-table"]],inputs:{course:"course",tutorialGroupsConfiguration:"tutorialGroupsConfiguration",tutorialGroupFreePeriods:"tutorialGroupFreePeriods",labelText:"labelText",loadAll:"loadAll"},decls:35,vars:3,consts:[[1,"form-label"],[1,"table-responsive"],[1,"table","table-sm","table-hover"],["jhiTranslate","global.field.id",1,"col-1"],["jhiTranslate","artemisApp.entities.tutorialFreePeriod.startDate",1,"col-2"],["jhiTranslate","artemisApp.entities.tutorialFreePeriod.endDate",1,"col-2"],["jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.dateInput.labelStartTime",1,"col-2"],["jhiTranslate","artemisApp.forms.tutorialFreePeriodForm.dateInput.labelEndTime",1,"col-2"],["jhiTranslate","artemisApp.entities.tutorialFreePeriod.reason",1,"col-2"],[1,"col-1"],[1,"free-period-row",3,"ngClass"],[1,"col-2"],[1,"free-period-reason-overflow"],[1,"extra-buttons"],[3,"tutorialFreePeriodDeleted","tutorialFreePeriodEdited","course","tutorialGroupConfiguration","tutorialFreePeriod"]],template:function(t,o){t&1&&(n(0,"label",0),e(1),x(2,"artemisTranslate"),a(),e(3,`
`),n(4,"div",1),e(5,`
    `),n(6,"table",2),e(7,`
        `),n(8,"thead"),e(9,`
            `),n(10,"tr"),e(11,`
                `),s(12,"th",3),e(13,`
                `),s(14,"th",4),e(15,`
                `),s(16,"th",5),e(17,`
                `),s(18,"th",6),e(19,`
                `),s(20,"th",7),e(21,`
                `),s(22,"th",8),e(23,`
                `),s(24,"th",9),e(25,`
            `),a(),e(26,`
        `),a(),e(27,`
        `),n(28,"tbody"),e(29,`
            `),pe(30,dt,37,48,null,null,ue),a(),e(32,`
    `),a(),e(33,`
`),a(),e(34,`
`)),t&2&&(l(),fe(Q(2,1,o.labelText)),l(29),ce(o.tutorialGroupFreePeriods))},dependencies:[P,J,Re,V,ie],styles:[".long-text[_ngcontent-%COMP%]{max-width:300px}.free-period-row[_ngcontent-%COMP%]   .extra-buttons[_ngcontent-%COMP%]{visibility:hidden}.free-period-row[_ngcontent-%COMP%]:hover   .extra-buttons[_ngcontent-%COMP%]{visibility:visible}tr.text-past[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:gray}.free-period-reason-overflow[_ngcontent-%COMP%]{overflow:hidden;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical}"],changeDetection:0})}return r})();var ut=r=>({timeZone:r});function pt(r,p){if(r&1&&(e(0,`
                `),s(1,"jhi-tutorial-group-free-periods-table",10),e(2,`
            `)),r&2){let i=d(2);l(),m("course",i.course)("tutorialGroupsConfiguration",i.tutorialGroupsConfiguration)("tutorialGroupFreePeriods",i.freePeriods)("labelText","artemisApp.forms.tutorialFreePeriodForm.timeFrame.period")("loadAll",i.loadAll.bind(i))}}function ct(r,p){if(r&1&&(e(0,`
                `),s(1,"jhi-tutorial-group-free-periods-table",10),e(2,`
            `)),r&2){let i=d(2);l(),m("course",i.course)("tutorialGroupsConfiguration",i.tutorialGroupsConfiguration)("tutorialGroupFreePeriods",i.freeDays)("labelText","artemisApp.forms.tutorialFreePeriodForm.timeFrame.day")("loadAll",i.loadAll.bind(i))}}function ft(r,p){if(r&1&&(e(0,`
                `),s(1,"jhi-tutorial-group-free-periods-table",10),e(2,`
            `)),r&2){let i=d(2);l(),m("course",i.course)("tutorialGroupsConfiguration",i.tutorialGroupsConfiguration)("tutorialGroupFreePeriods",i.freePeriodsWithinDay)("labelText","artemisApp.forms.tutorialFreePeriodForm.timeFrame.periodWithinDay")("loadAll",i.loadAll.bind(i))}}function ht(r,p){if(r&1){let i=v();e(0,`
        `),n(1,"div",1),e(2,`
            `),n(3,"div",2),e(4,`
                `),n(5,"div",3),e(6,`
                    `),s(7,"h4",4),e(8,`
                    `),n(9,"div"),e(10,`
                        `),n(11,"button",5),c("click",function(o){f(i);let F=d();return h(F.openCreateFreePeriodDialog(o))}),e(12,`
                            `),s(13,"fa-icon",6),e(14,`
                            `),s(15,"span",7),e(16,`
                        `),a(),e(17,`
                    `),a(),e(18,`
                `),a(),e(19,`
            `),a(),e(20,`
            `),n(21,"div",8),e(22,`
                `),s(23,"div",9),e(24,`
            `),a(),e(25,`

            `),e(26,`
            `),g(27,pt,3,5)(28,ct,3,5)(29,ft,3,5),a(),e(30,`
    `)}if(r&2){let i=d();l(13),m("icon",i.faPlus),l(10),m("translateValues",y(5,ut,i.course.timeZone)),l(4),T(i.freePeriods!=null&&i.freePeriods.length?27:-1),l(),T(i.freeDays!=null&&i.freeDays.length?28:-1),l(),T(i.freePeriodsWithinDay!=null&&i.freePeriodsWithinDay.length?29:-1)}}var R=(()=>{class r{activatedRoute=u(Fe);tutorialGroupsConfigurationService=u(Ve);alertService=u(k);sortService=u(Le);modalService=u(ee);cdr=u(ge);isLoading=!1;tutorialGroupsConfiguration;tutorialGroupFreePeriods=[];course;faTimes=je;faPlus=Ie;dialogErrorSource=new _;dialogError$=this.dialogErrorSource.asObservable();ngUnsubscribe=new _;ngOnInit(){this.loadAll()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.dialogErrorSource.unsubscribe()}get freeDays(){return this.tutorialGroupFreePeriods.filter(i=>r.isFreeDay(i))}static isFreeDay(i){let t=i.start.hour()===0&&i.start.minute()===0,o=i.end.hour()===23&&i.end.minute()===59;return i.start.isSame(i.end,"day")&&t&&o}get freePeriods(){return this.tutorialGroupFreePeriods.filter(i=>r.isFreePeriod(i))}static isFreePeriod(i){return!i.start.isSame(i.end,"day")}get freePeriodsWithinDay(){return this.tutorialGroupFreePeriods.filter(i=>r.isFreePeriodWithinDay(i))}static isFreePeriodWithinDay(i){return i.start.date()===i.end.date()&&!r.isFreeDay(i)}getCurrentDate(){return K()}loadAll(){this.isLoading=!0,le([this.activatedRoute.data]).pipe(se(1),me(([{course:i}])=>(this.course=i,this.tutorialGroupsConfigurationService.getOneOfCourse(this.course.id))),M(()=>this.isLoading=!1),b(this.ngUnsubscribe)).subscribe({next:i=>{i.body&&(this.tutorialGroupsConfiguration=i.body,this.tutorialGroupsConfiguration.tutorialGroupFreePeriods?this.tutorialGroupFreePeriods=this.sortService.sortByProperty(this.tutorialGroupsConfiguration.tutorialGroupFreePeriods,"start",!1):this.tutorialGroupFreePeriods=[])},error:i=>A(this.alertService,i)}).add(()=>this.cdr.detectChanges())}openCreateFreePeriodDialog(i){i.stopPropagation();let t=this.modalService.open(N,{size:"lg",scrollable:!1,backdrop:"static",animation:!1});t.componentInstance.course=this.course,t.componentInstance.tutorialGroupConfigurationId=this.tutorialGroupsConfiguration.id,t.componentInstance.initialize(),H(t.result).pipe($(()=>q),b(this.ngUnsubscribe)).subscribe(()=>{this.loadAll()})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=D({type:r,selectors:[["jhi-tutorial-free-periods"]],decls:4,vars:2,consts:[[3,"isLoading"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between"],["jhiTranslate","artemisApp.pages.tutorialFreePeriodsManagement.title"],["type","button","id","create-tutorial-free-day",1,"btn","btn-primary",3,"click"],[3,"icon"],["jhiTranslate","artemisApp.pages.tutorialFreePeriodsManagement.createFreePeriodButton"],[1,"col-12","mb-2"],["jhiTranslate","artemisApp.pages.tutorialFreePeriodsManagement.timeZoneExplanation",1,"alert","alert-info",3,"translateValues"],[3,"course","tutorialGroupsConfiguration","tutorialGroupFreePeriods","labelText","loadAll"]],template:function(t,o){t&1&&(n(0,"jhi-loading-indicator-container",0),e(1,`
    `),g(2,ht,31,7),a(),e(3,`
`)),t&2&&(m("isLoading",o.isLoading),l(2),T(o.tutorialGroupsConfiguration&&o.tutorialGroupFreePeriods?2:-1))},dependencies:[O,P,j,$e],styles:[".long-text[_ngcontent-%COMP%]{max-width:300px}.free-period-row[_ngcontent-%COMP%]   .extra-buttons[_ngcontent-%COMP%]{visibility:hidden}.free-period-row[_ngcontent-%COMP%]:hover   .extra-buttons[_ngcontent-%COMP%]{visibility:visible}tr.text-past[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:gray}.free-period-reason-overflow[_ngcontent-%COMP%]{overflow:hidden;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical}"],changeDetection:0})}return r})();export{R as TutorialGroupFreePeriodsManagementComponent};
//# sourceMappingURL=tutorial-group-free-periods-management.component-SDEEY6NX.js.map
