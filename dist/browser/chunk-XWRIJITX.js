import{a as y,b as E,c as F,d as U}from"./chunk-36ZQVNBH.js";import{a as oe,b as re,c as ae}from"./chunk-XUG3TIT6.js";import{a as X}from"./chunk-YNY5IUYO.js";import{a as S}from"./chunk-G4HSJ7ME.js";import{c as Z,d as ee,e as te,f as ne,g as ie}from"./chunk-F3NFBBHK.js";import{a as O}from"./chunk-ST7GO324.js";import{a as J}from"./chunk-LYZAUST5.js";import{b as $}from"./chunk-T624HJJL.js";import{a as Y}from"./chunk-HMZID6NQ.js";import{d as q}from"./chunk-EDXSOKK5.js";import{cc as Q,ob as B}from"./chunk-Z4VHWOB5.js";import{a as K}from"./chunk-U54OSGNH.js";import{i as z}from"./chunk-M6Z6DKZQ.js";import{M as v}from"./chunk-IOA4DPXY.js";import{Db as r,Dc as g,Ma as x,Mc as _,Na as h,Oc as p,P as I,Pc as D,Qc as k,Sc as N,Tb as j,Va as V,Yc as H,Zb as c,Zc as M,_c as L,dd as e,ed as b,f as A,fd as G,kc as m,oa as W,qd as P,ra as w,s as C,sc as T,xc as a,yc as l,z as R,zc as u}from"./chunk-5LC5EQRR.js";var pe=["*"],me=()=>["login","name"];function ce(n,s){if(n&1){let t=g();e(0,`
                `),a(1,"jhi-user-import-button",4),_("importDone",function(){x(t);let i=p();return h(i.importFinish.emit())}),l(),e(2,`
            `)}if(n&2){let t=p();r(),m("courseId",t.course.id)("courseGroup",t.courseGroup)("tutorialGroup",t.tutorialGroup)}}function ue(n,s){if(n&1){let t=g();e(0,`
                `),a(1,"button",5),_("click",function(){x(t);let i=p();return h(i.exportUserInformation())}),e(2,`
                    `),u(3,"fa-icon",6),e(4,`
                    `),u(5,"span",7),e(6,`
                `),l(),e(7,`
            `)}if(n&2){let t=p();r(3),m("icon",t.faDownload)("fixedWidth",!0)}}function de(n,s){if(n&1){let t=g();e(0,`
                        `),a(1,"span",17),_("click",function(){x(t);let i=p().controls;return h(i.onSort("id"))}),e(2,`
                            `),u(3,"span",18),e(4,`
                            `),u(5,"fa-icon",19),e(6,`
                        `),l(),e(7,`
                    `)}if(n&2){let t=p().controls;r(5),m("icon",t.iconForSortPropField("id"))}}function _e(n,s){if(n&1&&(e(0,`
                            `),a(1,"a",20),e(2),l(),e(3,`
                        `)),n&2){let t=p().value;r(),N("routerLink","/admin/user-management/",t==null?null:t.login,""),r(),G(" ",t.id," ")}}function xe(n,s){if(n&1&&e(0),n&2){let t=p().value;G(`
                            `,t==null?null:t.id,`
                        `)}}function he(n,s){if(n&1&&(e(0,`
                        `),c(1,_e,4,3)(2,xe,1,1)),n&2){let t=p(2);r(),T(t.isAdmin?1:2)}}function ge(n,s){n&1&&(e(0,`
                        `),a(1,"span",21),e(2,`
                            `),u(3,"span",22),e(4,`
                        `),l(),e(5,`
                    `))}function fe(n,s){if(n&1&&(e(0,`
                        `),u(1,"jhi-profile-picture",23),e(2,`
                    `)),n&2){let t=s.value;r(),m("authorId",t.id)("authorName",t.name)("imageUrl",t.imageUrl)}}function Ce(n,s){if(n&1){let t=g();e(0,`
                        `),a(1,"span",17),_("click",function(){x(t);let i=p().controls;return h(i.onSort("login"))}),e(2,`
                            `),u(3,"span",24),e(4,`
                            `),u(5,"fa-icon",19),e(6,`
                        `),l(),e(7,`
                    `)}if(n&2){let t=p().controls;r(5),m("icon",t.iconForSortPropField("login"))}}function be(n,s){if(n&1&&(e(0,`
                        `),a(1,"span"),e(2),l(),e(3,`
                    `)),n&2){let t=s.value;r(2),b(t)}}function we(n,s){if(n&1){let t=g();e(0,`
                        `),a(1,"span",17),_("click",function(){x(t);let i=p().controls;return h(i.onSort("visibleRegistrationNumber"))}),e(2,`
                            `),u(3,"span",25),e(4,`
                            `),u(5,"fa-icon",19),e(6,`
                        `),l(),e(7,`
                    `)}if(n&2){let t=p().controls;r(5),m("icon",t.iconForSortPropField("visibleRegistrationNumber"))}}function Te(n,s){if(n&1&&(e(0,`
                        `),a(1,"span"),e(2),l(),e(3,`
                    `)),n&2){let t=s.value;r(2),b(t)}}function ve(n,s){if(n&1){let t=g();e(0,`
                        `),a(1,"span",17),_("click",function(){x(t);let i=p().controls;return h(i.onSort("name"))}),e(2,`
                            `),u(3,"span",26),e(4,`
                            `),u(5,"fa-icon",19),e(6,`
                        `),l(),e(7,`
                    `)}if(n&2){let t=p().controls;r(5),m("icon",t.iconForSortPropField("name"))}}function Ge(n,s){if(n&1&&(e(0,`
                        `),a(1,"span"),e(2),l(),e(3,`
                    `)),n&2){let t=s.value;r(2),b(t)}}function Se(n,s){if(n&1){let t=g();e(0,`
                        `),a(1,"span",17),_("click",function(){x(t);let i=p().controls;return h(i.onSort("email"))}),e(2,`
                            `),u(3,"span",27),e(4,`
                            `),u(5,"fa-icon",19),e(6,`
                        `),l(),e(7,`
                    `)}if(n&2){let t=p().controls;r(5),m("icon",t.iconForSortPropField("email"))}}function ye(n,s){if(n&1&&(e(0,`
                        `),a(1,"span"),e(2),l(),e(3,`
                    `)),n&2){let t=s.value;r(2),b(t)}}function Ee(n,s){}function Fe(n,s){if(n&1){let t=g();e(0,`
                        `),a(1,"div",28),e(2,`
                            `),a(3,"button",29),_("delete",function(){let i=x(t).value,d=p(2);return h(d.removeFromGroup(i))}),e(4,`
                                `),u(5,"fa-icon",30),e(6,`
                            `),l(),e(7,`
                        `),l(),e(8,`
                    `)}if(n&2){let t=s.value,o=p(2);r(3),m("actionType",o.ActionType.Remove)("entityTitle",t.login)("dialogError",o.dialogError$),r(2),m("icon",o.faUserSlash)}}function Ue(n,s){if(n&1&&(e(0,`
            `),a(1,"ngx-datatable",8),e(2,`
                `),a(3,"ngx-datatable-column",9),e(4,`
                    `),c(5,de,8,1,"ng-template",10),e(6,`
                    `),c(7,he,3,1,"ng-template",11),e(8,`
                `),l(),e(9,`
                `),a(10,"ngx-datatable-column",9),e(11,`
                    `),c(12,ge,6,0,"ng-template",10),e(13,`
                    `),c(14,fe,3,3,"ng-template",11),e(15,`
                `),l(),e(16,`
                `),a(17,"ngx-datatable-column",12),e(18,`
                    `),c(19,Ce,8,1,"ng-template",10),e(20,`
                    `),c(21,be,4,1,"ng-template",11),e(22,`
                `),l(),e(23,`
                `),a(24,"ngx-datatable-column",13),e(25,`
                    `),c(26,we,8,1,"ng-template",10),e(27,`
                    `),c(28,Te,4,1,"ng-template",11),e(29,`
                `),l(),e(30,`
                `),a(31,"ngx-datatable-column",14),e(32,`
                    `),c(33,ve,8,1,"ng-template",10),e(34,`
                    `),c(35,Ge,4,1,"ng-template",11),e(36,`
                `),l(),e(37,`
                `),a(38,"ngx-datatable-column",15),e(39,`
                    `),c(40,Se,8,1,"ng-template",10),e(41,`
                    `),c(42,ye,4,1,"ng-template",11),e(43,`
                `),l(),e(44,`
                `),a(45,"ngx-datatable-column",16),e(46,`
                    `),c(47,Ee,0,0,"ng-template",10),e(48,`
                    `),c(49,Fe,9,4,"ng-template",11),e(50,`
                `),l(),e(51,`
            `),l(),e(52,`
        `)),n&2){let t=s.settings,o=p();r(),m("limit",t.limit)("sortType",t.sortType)("columnMode",t.columnMode)("headerHeight",t.headerHeight)("footerHeight",t.footerHeight)("rowHeight",t.rowHeight)("rows",t.rows)("rowClass",o.dataTableRowClass)("scrollbarH",t.scrollbarH),r(2),m("minWidth",60)("width",80)("maxWidth",100),r(7),m("minWidth",100)("width",120)("maxWidth",120),r(7),m("minWidth",150)("width",200)("maxWidth",200),r(7),m("minWidth",150)("width",200)("maxWidth",200),r(7),m("minWidth",150)("width",250)("maxWidth",250),r(7),m("minWidth",150)("width",250),r(7),m("minWidth",150)("width",200)}}var le={alreadyMember:"already-member",newlyAddedMember:"newly-added-member"},it=(()=>{class n{dataTable;allGroupUsers=[];isLoadingAllGroupUsers=!1;isAdmin=!1;course;tutorialGroup=void 0;courseGroup;exportFileName;userSearch=()=>C(new v({body:[]}));addUserToGroup=()=>C(new v);removeUserFromGroup=()=>C(new v);handleUsersSizeChange=()=>{};importFinish=new V;ActionType=Y;dialogErrorSource=new A;dialogError$=this.dialogErrorSource.asObservable();isSearching=!1;searchFailed=!1;searchNoResults=!1;isTransitioning=!1;rowClass=void 0;faDownload=Q;faUserSlash=B;ngOnDestroy(){this.dialogErrorSource.unsubscribe()}searchAllUsers=t=>t.pipe(W(({text:o})=>(this.searchFailed=!1,this.searchNoResults=!1,o.length<3?C([]):(this.isSearching=!0,this.userSearch(o).pipe(R(i=>i.body)).pipe(w(i=>{i.length===0&&(this.searchNoResults=!0)}),I(()=>(this.searchFailed=!0,C([]))))))),w(()=>{this.isSearching=!1}),w(o=>{setTimeout(()=>{for(let i=0;i<this.dataTable.typeaheadButtons.length;i++){let d=this.dataTable.typeaheadButtons[i],f=this.allGroupUsers.map(se=>se.id).includes(o[i].id);d.querySelector("fa-icon")||d.insertAdjacentHTML("beforeend",X[f?"users":"users-plus"]),f&&d.classList.add(le.alreadyMember)}})}));onAutocompleteSelect=(t,o)=>{!this.allGroupUsers.map(i=>i.id).includes(t.id)&&t.login?(this.isTransitioning=!0,this.addUserToGroup(t.login).subscribe({next:()=>{this.isTransitioning=!1,this.allGroupUsers.push(t),o(t),this.flashRowClass(le.newlyAddedMember)},error:()=>{this.isTransitioning=!1}})):o(t)};removeFromGroup(t){t.login&&this.removeUserFromGroup(t.login).subscribe({next:()=>{this.allGroupUsers=this.allGroupUsers.filter(o=>o.login!==t.login),this.dialogErrorSource.next("")},error:o=>this.dialogErrorSource.next(o.message)})}searchResultFormatter=t=>{let{name:o,login:i}=t;return`${o} (${i})`};searchTextFromUser=t=>t.login||"";dataTableRowClass=()=>this.rowClass;flashRowClass=t=>{this.rowClass=t,setTimeout(()=>this.rowClass=void 0)};exportUserInformation=()=>{if(this.allGroupUsers.length>0){let t=this.allGroupUsers.map(i=>({[y]:i.name?.trim()??"",[E]:i.login?.trim()??"",[F]:i.email?.trim()??"",[U]:i.visibleRegistrationNumber?.trim()??""})),o=[y,E,F,U];this.exportAsCsv(t,o)}};exportAsCsv=(t,o)=>{let i={fieldSeparator:";",quoteStrings:!0,quoteCharacter:'"',showLabels:!0,showTitle:!1,filename:this.exportFileName,useTextFile:!1,useBom:!0,columnHeaders:o},d=oe(i),f=re(d)(t);ae(d)(f)};static \u0275fac=function(o){return new(o||n)};static \u0275cmp=j({type:n,selectors:[["jhi-course-group"]],viewQuery:function(o,i){if(o&1&&H(S,5),o&2){let d;M(d=L())&&(i.dataTable=d.first)}},inputs:{allGroupUsers:"allGroupUsers",isLoadingAllGroupUsers:"isLoadingAllGroupUsers",isAdmin:"isAdmin",course:"course",tutorialGroup:"tutorialGroup",courseGroup:"courseGroup",exportFileName:"exportFileName",userSearch:"userSearch",addUserToGroup:"addUserToGroup",removeUserFromGroup:"removeUserFromGroup",handleUsersSizeChange:"handleUsersSizeChange"},outputs:{importFinish:"importFinish"},ngContentSelectors:pe,decls:22,vars:14,consts:[[1,"d-flex","flex-wrap","justify-content-between","align-items-center","mb-1"],[1,"mb-1"],[1,"d-flex","mt-1","mb-1","gap-1"],["id","registered-students","entityType","user","entitiesPerPageTranslation","artemisApp.course.courseGroup.usersPerPage","showAllEntitiesTranslation","artemisApp.course.courseGroup.showAllUsers","searchNoResultsTranslation","artemisApp.course.courseGroup.searchNoResults","searchPlaceholderTranslation","artemisApp.course.courseGroup.searchForUsers",3,"entitiesSizeChange","isLoading","isSearching","searchFailed","searchNoResults","isTransitioning","allEntities","searchFields","searchTextFromEntity","searchResultFormatter","onSearchWrapper","onAutocompleteSelectWrapper"],[3,"importDone","courseId","courseGroup","tutorialGroup"],[1,"btn","btn-primary","btn-sm",3,"click"],[3,"icon","fixedWidth"],["jhiTranslate","artemisApp.instructorDashboard.exportCSV"],[1,"bootstrap",3,"limit","sortType","columnMode","headerHeight","footerHeight","rowHeight","rows","rowClass","scrollbarH"],["prop","",3,"minWidth","width","maxWidth"],["ngx-datatable-header-template",""],["ngx-datatable-cell-template",""],["prop","login",3,"minWidth","width","maxWidth"],["prop","visibleRegistrationNumber",3,"minWidth","width","maxWidth"],["prop","name",3,"minWidth","width","maxWidth"],["prop","email",3,"minWidth","width"],["prop","",3,"minWidth","width"],[1,"datatable-header-cell-wrapper",3,"click"],["jhiTranslate","global.field.id",1,"datatable-header-cell-label","bold","sortable"],[3,"icon"],[3,"routerLink"],[1,"datatable-header-cell-wrapper"],["jhiTranslate","artemisApp.course.courseGroup.profilePicture",1,"datatable-header-cell-label","bold","sortable"],["imageSizeInRem","1.5","fontSizeInRem","0.6","imageId","user-profile-picture","defaultPictureId","user-default-profile-picture",3,"authorId","authorName","imageUrl"],["jhiTranslate","artemisApp.course.courseGroup.login",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.course.courseGroup.registrationNumber",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.course.courseGroup.name",1,"datatable-header-cell-label","bold","sortable"],["jhiTranslate","artemisApp.course.courseGroup.email",1,"datatable-header-cell-label","bold","sortable"],[1,"w-100","text-end"],["jhiDeleteButton","","deleteQuestion","artemisApp.course.courseGroup.removeFromGroup.modalQuestion",3,"delete","actionType","entityTitle","dialogError"],[1,"me-1",3,"icon"]],template:function(o,i){o&1&&(D(),a(0,"div"),e(1,`
    `),a(2,"div",0),e(3,`
        `),a(4,"h2",1),e(5,`
            `),e(6,`
            `),k(7),e(8,`
        `),l(),e(9,`
        `),a(10,"div",2),e(11,`
            `),c(12,ce,3,3)(13,ue,8,2),l(),e(14,`
    `),l(),e(15,`
    `),a(16,"jhi-data-table",3),_("entitiesSizeChange",function(f){return i.handleUsersSizeChange(f)}),e(17,`
        `),c(18,Ue,53,28,"ng-template"),e(19,`
    `),l(),e(20,`
`),l(),e(21,`
`)),o&2&&(r(12),T(i.course!=null&&i.course.isAtLeastInstructor?12:-1),r(),T(i.course!=null&&i.course.isAtLeastInstructor&&i.allGroupUsers.length>0?13:-1),r(3),m("isLoading",i.isLoadingAllGroupUsers)("isSearching",i.isSearching)("searchFailed",i.searchFailed)("searchNoResults",i.searchNoResults)("isTransitioning",i.isTransitioning)("allEntities",i.allGroupUsers)("searchFields",P(13,me))("searchTextFromEntity",i.searchTextFromUser)("searchResultFormatter",i.searchResultFormatter)("onSearchWrapper",i.searchAllUsers)("onAutocompleteSelectWrapper",i.onAutocompleteSelect))},dependencies:[O,q,K,S,ie,ne,te,Z,ee,z,J,$],styles:[`jhi-course-group ngb-typeahead-window{min-width:400px}jhi-course-group ngb-typeahead-window .dropdown-item{display:flex;justify-content:space-between}jhi-course-group ngb-typeahead-window .dropdown-item.active{background-color:#28a745}jhi-course-group ngb-typeahead-window .dropdown-item.already-member{color:#212529;background-color:#e9f6ec;opacity:.5}jhi-course-group ngb-typeahead-window .dropdown-item.already-member.active{background-color:#daf2e0;opacity:.8}jhi-course-group .datatable-body-row.newly-added-member{animation-name:flash-animation;animation-delay:.15s;animation-duration:1.5s;animation-timing-function:ease-out}@keyframes flash-animation{30%{background-color:#c4e7cc}}
`],encapsulation:2})}return n})();export{it as a};
//# sourceMappingURL=chunk-XWRIJITX.js.map
