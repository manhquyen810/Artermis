import{a as f}from"./chunk-QA7Y7QBM.js";import{i as h}from"./chunk-CT44YL7Q.js";import{p as i}from"./chunk-DID2YGL7.js";import{c as l}from"./chunk-E2KBL4LX.js";import{Ea as s,Id as o,Wa as a,Wb as m}from"./chunk-5LC5EQRR.js";var x=(()=>{class e{cdRef=s(o);ngZone=s(a);translateService=s(l);serverDateService=s(f);currentTimer;lastTime;lastValue;lastOmitSuffix;lastLocale;lastText;formatFn;format(t){return t.locale(this.lastLocale).from(this.serverDateService.now(),this.lastOmitSuffix)}transform(t,r,u){return this.hasChanged(t,r)?(this.lastTime=c(t),this.lastValue=t,this.lastOmitSuffix=r,this.lastLocale=this.translateService.currentLang,this.formatFn=u||this.format.bind(this),this.removeTimer(),this.createTimer(),this.lastText=this.formatFn(i(t))):this.createTimer(),this.lastText}ngOnDestroy(){this.removeTimer()}createTimer(){if(this.currentTimer)return;let t=i(this.lastValue),r=T(t)*1e3;this.currentTimer=this.ngZone.runOutsideAngular(()=>typeof window<"u"?window.setTimeout(()=>{this.lastText=this.formatFn(i(this.lastValue)),this.currentTimer=null,this.ngZone.run(()=>this.cdRef.markForCheck())},r):null)}removeTimer(){this.currentTimer&&(window.clearTimeout(this.currentTimer),this.currentTimer=null)}hasChanged(t,r){return c(t)!==this.lastTime||this.translateService.currentLang!==this.lastLocale||r!==this.lastOmitSuffix}static \u0275fac=function(r){return new(r||e)};static \u0275pipe=m({name:"artemisTimeAgo",type:e,pure:!1})}return e})();function c(e){return h(e)?e.getTime():i.isDayjs(e)?e.valueOf():i(e).valueOf()}function T(e){let n=Math.abs(i().diff(e,"minute"));return n<1?1:n<60?30:n<180?300:3600}export{x as a};
//# sourceMappingURL=chunk-KYCCMZSV.js.map
