import{b as v}from"./chunk-GGF54D4U.js";import"./chunk-GITU5WHL.js";import"./chunk-G5WFAKZV.js";import{a as se}from"./chunk-VJKFYSDP.js";import"./chunk-NUC4ZXFE.js";import"./chunk-FLFES4R7.js";import{a as ne}from"./chunk-5PWC33TE.js";import{a as oe}from"./chunk-A2A6JFSH.js";import"./chunk-MD6Z63OB.js";import"./chunk-M2FHCXD3.js";import"./chunk-RGQYMQQL.js";import{a as T}from"./chunk-SLVT6IA5.js";import{e as h,f as x}from"./chunk-FAFORKWV.js";import"./chunk-FLZTDUOG.js";import"./chunk-MY22ELD7.js";import{b as re}from"./chunk-T4L3VFV2.js";import"./chunk-YSX3GO3R.js";import"./chunk-W3K7VYWC.js";import{a as te}from"./chunk-QU4DXSXD.js";import"./chunk-5QODR5GQ.js";import"./chunk-RNPAFOPW.js";import"./chunk-YGSJB6WY.js";import"./chunk-O2WHE2S3.js";import"./chunk-JJUII2KT.js";import"./chunk-V7PDYRDZ.js";import"./chunk-EANMTTQG.js";import"./chunk-PNTOXB52.js";import"./chunk-EGRHWZRV.js";import{a as ie}from"./chunk-MBS3WUDO.js";import{b as ee}from"./chunk-22YQSX6Z.js";import"./chunk-R56P6PAY.js";import"./chunk-65Z25AP3.js";import"./chunk-5M3YV54C.js";import"./chunk-RYZEETVB.js";import"./chunk-VTF2OQPK.js";import"./chunk-BNRTXX46.js";import"./chunk-VPHPBAVR.js";import"./chunk-N4VVKRBU.js";import"./chunk-5AQXEKLE.js";import{j as $}from"./chunk-3JSWSN6W.js";import"./chunk-7XNS72RJ.js";import"./chunk-KYCCMZSV.js";import"./chunk-DXTZ4GAW.js";import"./chunk-2UXGFGK3.js";import"./chunk-O4VJ5OXY.js";import"./chunk-BDII35IB.js";import"./chunk-LARBQRTJ.js";import"./chunk-OTNXTVPX.js";import"./chunk-Z2YUBN6N.js";import"./chunk-OTCBNILH.js";import"./chunk-AO5E7TEY.js";import"./chunk-PA7LJOOC.js";import"./chunk-AOI2U3YC.js";import"./chunk-USOMQCKZ.js";import"./chunk-6EYB5QBP.js";import"./chunk-GERFCPB6.js";import"./chunk-T624HJJL.js";import"./chunk-HQTS6JOY.js";import"./chunk-HMZID6NQ.js";import{a as R,b as y,d as I}from"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import"./chunk-2QXIMOEO.js";import"./chunk-JHBUBEY6.js";import"./chunk-4I367PEU.js";import"./chunk-QA7Y7QBM.js";import"./chunk-ZPITQMA6.js";import"./chunk-AZBLKUAM.js";import"./chunk-2CUFQLAH.js";import"./chunk-DRMCDU75.js";import"./chunk-Z6NSEM73.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import"./chunk-CT44YL7Q.js";import"./chunk-ZFM7LHJQ.js";import"./chunk-JNO6DNVW.js";import"./chunk-EELXLOHY.js";import"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import"./chunk-WA5GEAJB.js";import{m as Z}from"./chunk-VK7JPHFE.js";import{c as X}from"./chunk-BNDLMKXK.js";import"./chunk-BQNBT6PW.js";import"./chunk-5GXY5RYT.js";import"./chunk-K3W6YFKH.js";import{c as q}from"./chunk-JXJXC4DZ.js";import{d as J}from"./chunk-EDXSOKK5.js";import{b as Q}from"./chunk-R5BZWVRQ.js";import"./chunk-DID2YGL7.js";import{c as Y,k as G}from"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{cc as H,cd as W}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import{a as _}from"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as K}from"./chunk-U54OSGNH.js";import{f as j,h as N,i as z}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import"./chunk-IOA4DPXY.js";import{Ac as F,Bc as L,Db as n,Dc as V,Ea as a,Ma as P,Mc as S,Na as A,Oc as p,Tb as b,W as E,Yc as k,Zb as g,Zc as B,_c as D,dd as t,kc as s,qd as U,ra as C,rd as O,sc as u,sd as M,xc as d,yc as m,z as w,zc as c}from"./chunk-5LC5EQRR.js";import"./chunk-3E746U5Y.js";var le=(i,l)=>[i,l],ae=(()=>{class i{programmingExerciseService=a(T);alertService=a(q);ButtonType=R;ButtonSize=y;FeatureToggle=_;exerciseId;participationId;buttonSize=y.SMALL;title="artemisApp.programmingExercise.export.downloadRepo";faDownload=H;exportRepository(){this.exerciseId&&this.participationId&&this.programmingExerciseService.exportStudentRepository(this.exerciseId,this.participationId).pipe(E(1)).subscribe(e=>{ie(e),this.alertService.success("artemisApp.programmingExercise.export.successMessageRepo")})}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=b({type:i,selectors:[["jhi-programming-exercise-student-repo-download"]],inputs:{exerciseId:"exerciseId",participationId:"participationId",buttonSize:"buttonSize",title:"title"},decls:2,vars:10,consts:[[3,"onClick","disabled","btnType","btnSize","shouldSubmit","featureToggle","icon","title"]],template:function(o,r){o&1&&(d(0,"jhi-button",0),S("onClick",function(){return r.exportRepository()}),m(),t(1,`
`)),o&2&&s("disabled",!r.exerciseId||!r.participationId)("btnType",r.ButtonType.INFO)("btnSize",r.buttonSize)("shouldSubmit",!1)("featureToggle",M(7,le,r.FeatureToggle.ProgrammingExercises,r.FeatureToggle.Exports))("icon",r.faDownload)("title",r.title)},dependencies:[I],encapsulation:2})}return i})();var de=i=>[i],me=()=>[];function ue(i,l){if(i&1){let e=V();t(0,`
                    `),d(1,"jhi-button",6),S("onClick",function(){P(e);let r=p(2);return A(r.showInlineFeedback=!r.showInlineFeedback)}),m(),t(2,`
                `)}if(i&2){let e=p(2);n(),s("btnType",e.ButtonType.PRIMARY_OUTLINE)("title","artemisApp.repository.toggleInlineFeedback."+(e.showInlineFeedback?"hide":"show"))}}function xe(i,l){if(i&1&&(t(0,`
                    `),c(1,"jhi-result",7),t(2,`
                `)),i&2){let e=p(2);n(),s("result",e.result)("showUngradedResults",!0)("showBadge",!0)("exercise",e.exercise)}}function fe(i,l){if(i&1&&(t(0,`
                    `),d(1,"a",8),t(2,`
                        `),c(3,"fa-icon",9),t(4,`
                        `),c(5,"span",10),t(6,`
                    `),m(),t(7,`
                `)),i&2){let e=p(2);n(),s("routerLink",e.routeCommitHistory),n(2),s("icon",e.faClockRotateLeft)}}function he(i,l){if(i&1&&(t(0,`
                    `),d(1,"a",8),t(2,`
                        `),c(3,"fa-icon",9),t(4,`
                        `),c(5,"span",11),t(6,`
                    `),m(),t(7,`
                `)),i&2){let e=p(2);n(),s("routerLink",e.vcsAccessLogRoute),n(2),s("icon",e.faClockRotateLeft)}}function ge(i,l){if(i&1&&(t(0,`
                    `),c(1,"jhi-code-button",12),t(2,`
                `)),i&2){let e=p(2);n(),s("loading",!!e.exercise.loading)("smallButtons",!1)("participations",O(6,de,e.participation))("exercise",e.exercise)("repositoryUri",e.repositoryUri)("routerLinkForRepositoryView",U(8,me))}}function ye(i,l){if(i&1&&(t(0,`
                        `),c(1,"jhi-programming-exercise-student-repo-download",13),t(2,`
                    `)),i&2){let e=p(3);n(),s("buttonSize",e.ButtonSize.MEDIUM)("exerciseId",e.exercise.id)("participationId",e.participation.id)}}function Ce(i,l){if(i&1&&(t(0,`
                        `),c(1,"jhi-programming-exercise-instructor-repo-download",14),t(2,`
                    `)),i&2){let e=p(3);n(),s("repositoryType",e.repositoryType)("exerciseId",e.exercise.id)("buttonSize",e.ButtonSize.MEDIUM)}}function be(i,l){if(i&1&&(t(0,`
                    `),g(1,ye,3,3)(2,Ce,3,3)),i&2){let e=p(2);n(),u(e.repositoryType==="USER"?1:2)}}function Se(i,l){if(i&1&&(t(0,`
        `),d(1,"jhi-code-editor-container",0),t(2,`
            `),d(3,"div",1),t(4,`
                `),c(5,"h1",2),t(6,`
            `),m(),t(7,`
            `),d(8,"div",3),t(9,`
                `),g(10,ue,3,2),m(),t(11,`
            `),d(12,"div",4),t(13,`
                `),g(14,xe,3,4)(15,fe,8,2)(16,he,8,2)(17,ge,3,9)(18,be,3,1),m(),t(19,`
            `),c(20,"jhi-programming-exercise-instructions",5),t(21,`
        `),m(),t(22,`
    `)),i&2){let e=p();n(),s("forRepositoryView",!0)("showInlineFeedback",e.showInlineFeedback)("editable",!1)("buildable",!1)("participation",e.participation)("showEditorInstructions",e.showEditorInstructions)("allowHiddenFiles",!0)("isTutorAssessment",!0)("readOnlyManualFeedback",!0)("course",e.getCourseFromExercise(e.exercise)),n(9),u(e.resultHasInlineFeedback?10:-1),n(4),u(e.result?14:-1),n(),u(e.routeCommitHistory?15:-1),n(),u(e.vcsAccessLogRoute&&e.enableVcsAccessLog&&e.allowVcsAccessLog&&e.localVcEnabled?16:-1),n(),u(e.exercise!=null&&e.exercise.allowOfflineIde?17:-1),n(),u(e.exercise.id?18:-1),n(2),s("exercise",e.exercise)("participation",e.participation)("personalParticipation",!0)}}var ni=(()=>{class i{accountService=a(Q);domainService=a(se);route=a(j);profileService=a(X);programmingExerciseParticipationService=a(te);programmingExerciseService=a(T);router=a(N);codeEditorContainer;PROGRAMMING=Y.PROGRAMMING;FeatureToggle=_;ButtonSize=y;ButtonType=R;getCourseFromExercise=G;paramSub;participation;exercise;userId;loadingParticipation=!1;participationCouldNotBeFetched=!1;showEditorInstructions=!0;routeCommitHistory;vcsAccessLogRoute;repositoryUri;repositoryType;enableVcsAccessLog=!1;isInCourseManagement=!1;allowVcsAccessLog=!1;result;resultHasInlineFeedback=!1;showInlineFeedback=!1;localVcEnabled=!1;faClockRotateLeft=W;participationWithLatestResultSub;differentParticipationSub;ngOnDestroy(){this.paramSub?.unsubscribe(),this.participationWithLatestResultSub?.unsubscribe(),this.differentParticipationSub?.unsubscribe()}ngOnInit(){this.accountService.identity().then(e=>{this.userId=e.id}),this.routeCommitHistory=this.router.url+"/commit-history",this.paramSub=this.route.params.subscribe(e=>{this.loadingParticipation=!0,this.participationCouldNotBeFetched=!1;let o=Number(e.exerciseId),r=Number(e.repositoryId);this.repositoryType=e.repositoryType??x.USER,this.vcsAccessLogRoute=this.router.url+"/vcs-access-log",this.enableVcsAccessLog=this.router.url.includes("course-management")&&e.repositoryType!==x.TESTS,this.repositoryType===x.USER?this.loadStudentParticipation(r):this.repositoryType===x.AUXILIARY?this.loadAuxiliaryRepository(o,r):this.loadDifferentParticipation(this.repositoryType,o)}),this.profileService.getProfileInfo().subscribe(e=>{this.localVcEnabled=e.activeProfiles.includes(Z)})}loadDifferentParticipation(e,o){this.differentParticipationSub=this.programmingExerciseService.findWithTemplateAndSolutionParticipationAndLatestResults(o).pipe(C(r=>{this.exercise=r.body,e===x.TEMPLATE?(this.participation=this.exercise.templateParticipation,this.domainService.setDomain([h.PARTICIPATION,this.exercise.templateParticipation]),this.repositoryUri=this.participation.repositoryUri):e===x.SOLUTION?(this.participation=this.exercise.solutionParticipation,this.domainService.setDomain([h.PARTICIPATION,this.exercise.solutionParticipation]),this.repositoryUri=this.participation.repositoryUri):e===x.TESTS?(this.domainService.setDomain([h.TEST_REPOSITORY,this.exercise]),this.repositoryUri=this.exercise.testRepositoryUri):(this.participationCouldNotBeFetched=!0,this.loadingParticipation=!1),this.allowVcsAccessLog=this.accountService.isAtLeastInstructorInCourse(this.getCourseFromExercise(this.exercise))})).subscribe({next:()=>{this.loadingParticipation=!1},error:()=>{this.participationCouldNotBeFetched=!0,this.loadingParticipation=!1}})}loadStudentParticipation(e){this.participationWithLatestResultSub=this.getParticipationWithLatestResult(e).pipe(C(o=>{this.domainService.setDomain([h.PARTICIPATION,o]),this.participation=o,this.exercise=this.participation.exercise,this.allowVcsAccessLog=this.accountService.isAtLeastInstructorInCourse(this.getCourseFromExercise(this.exercise)),this.repositoryUri=this.participation.repositoryUri})).subscribe({next:()=>{this.loadingParticipation=!1},error:()=>{this.participationCouldNotBeFetched=!0,this.loadingParticipation=!1}})}getParticipationWithLatestResult(e){return this.programmingExerciseParticipationService.getStudentParticipationWithLatestResult(e).pipe(w(o=>(o.results?.length&&(o.results[0].participation=o,this.result=o.results[0],this.resultHasInlineFeedback=this.result.feedbacks?.some(r=>$.getReferenceLine(r)!==void 0)??!1),o)))}loadAuxiliaryRepository(e,o){this.programmingExerciseService.findWithAuxiliaryRepository(e).pipe(C(r=>{this.exercise=r.body;let f=this.exercise.auxiliaryRepositories?.find(ce=>ce.id===o);f&&(this.domainService.setDomain([h.AUXILIARY_REPOSITORY,f]),this.repositoryUri=f.repositoryUri)})).subscribe({next:()=>{this.loadingParticipation=!1},error:()=>{this.participationCouldNotBeFetched=!0}})}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=b({type:i,selectors:[["jhi-repository-view"]],viewQuery:function(o,r){if(o&1&&k(v,5),o&2){let f;B(f=D())&&(r.codeEditorContainer=f.first)}},decls:4,vars:1,consts:[[3,"forRepositoryView","showInlineFeedback","editable","buildable","participation","showEditorInstructions","allowHiddenFiles","isTutorAssessment","readOnlyManualFeedback","course"],["editorTitle",""],["jhiTranslate","artemisApp.repository.source"],["editorTitleActions","",1,"d-flex","ps-3"],["editorToolbar","",2,"text-align","right"],["editorSidebar","",1,"instructions-wrapper__content","card-body","p-0",3,"exercise","participation","personalParticipation"],[3,"onClick","btnType","title"],[2,"padding-right","20px",3,"result","showUngradedResults","showBadge","exercise"],[1,"btn","btn-primary",3,"routerLink"],[3,"icon"],["jhiTranslate","artemisApp.repository.commitHistory.openCommitHistory"],["jhiTranslate","artemisApp.repository.vcsAccessLog.openVcsAccessLog"],[3,"loading","smallButtons","participations","exercise","repositoryUri","routerLinkForRepositoryView"],[3,"buttonSize","exerciseId","participationId"],[3,"repositoryType","exerciseId","buttonSize"]],template:function(o,r){o&1&&(F(0),t(1,`
    `),g(2,Se,23,19),L(),t(3,`
`)),o&2&&(n(2),u(!r.loadingParticipation&&!r.participationCouldNotBeFetched?2:-1))},dependencies:[v,K,I,ee,z,J,re,ae,ne,oe],encapsulation:2})}return i})();export{ni as RepositoryViewComponent};
//# sourceMappingURL=repository-view.component-IW5SQGDE.js.map
