import{a as We}from"./chunk-J2B6GP6U.js";import{b as Ye,c as $e,d as Xe}from"./chunk-5XX2X5VF.js";import"./chunk-6FT4PREA.js";import"./chunk-6I3MUES2.js";import{a as Je}from"./chunk-NPMFKF37.js";import{a as He}from"./chunk-7MKMUXV6.js";import{a as Ge}from"./chunk-477H2IQN.js";import"./chunk-UBFIUABE.js";import"./chunk-KNK6NHCW.js";import"./chunk-FLTLUO4X.js";import"./chunk-GM5QZPKO.js";import"./chunk-IJRVZ46L.js";import"./chunk-NUC4ZXFE.js";import"./chunk-FLFES4R7.js";import"./chunk-SBDPY7ZH.js";import"./chunk-MVBHDJDH.js";import"./chunk-POPNQ63B.js";import"./chunk-RPFDXKEJ.js";import"./chunk-SKB5UJGX.js";import"./chunk-TBEJU7WR.js";import{a as Be}from"./chunk-C7XGVC6R.js";import"./chunk-4NYYKXW4.js";import"./chunk-5A2TLSYI.js";import"./chunk-MY22ELD7.js";import"./chunk-T4L3VFV2.js";import"./chunk-YSX3GO3R.js";import"./chunk-W3K7VYWC.js";import"./chunk-QU4DXSXD.js";import{o as je,q as Re,r as ke,s as Fe,t as Ne}from"./chunk-DOLVNMRR.js";import{a as Ve}from"./chunk-QZKVSIAC.js";import"./chunk-JRBFEQNN.js";import"./chunk-DIZEKHOC.js";import"./chunk-V7PDYRDZ.js";import"./chunk-EANMTTQG.js";import"./chunk-22YQSX6Z.js";import"./chunk-R56P6PAY.js";import"./chunk-65Z25AP3.js";import"./chunk-5M3YV54C.js";import"./chunk-RYZEETVB.js";import"./chunk-VTF2OQPK.js";import"./chunk-BNRTXX46.js";import"./chunk-VPHPBAVR.js";import"./chunk-N4VVKRBU.js";import"./chunk-5AQXEKLE.js";import"./chunk-3JSWSN6W.js";import"./chunk-7XNS72RJ.js";import"./chunk-KYCCMZSV.js";import{i as Ue}from"./chunk-DXTZ4GAW.js";import"./chunk-2UXGFGK3.js";import{d as J}from"./chunk-O4VJ5OXY.js";import{b as ie,h as ne,i as oe}from"./chunk-BDII35IB.js";import"./chunk-LARBQRTJ.js";import"./chunk-OTNXTVPX.js";import"./chunk-Z2YUBN6N.js";import"./chunk-PA7LJOOC.js";import"./chunk-AOI2U3YC.js";import"./chunk-USOMQCKZ.js";import"./chunk-6EYB5QBP.js";import"./chunk-GERFCPB6.js";import"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import{a as H}from"./chunk-2QXIMOEO.js";import{a as we}from"./chunk-FXB5LS64.js";import"./chunk-JHBUBEY6.js";import"./chunk-QA7Y7QBM.js";import"./chunk-ZPITQMA6.js";import"./chunk-AZBLKUAM.js";import"./chunk-2CUFQLAH.js";import"./chunk-Z6NSEM73.js";import{a as Pe}from"./chunk-HQ6UGNQX.js";import{a as U,b as Ee,c as Le}from"./chunk-MLVGKM2P.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import{c as Ae}from"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import"./chunk-UHM5AJSI.js";import{d as _}from"./chunk-CT44YL7Q.js";import"./chunk-JNO6DNVW.js";import"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import{G as K,K as ye}from"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import"./chunk-WA5GEAJB.js";import{c as De,q as Me,r as Oe}from"./chunk-VK7JPHFE.js";import{c as Te}from"./chunk-BNDLMKXK.js";import"./chunk-BQNBT6PW.js";import"./chunk-5GXY5RYT.js";import{a as G}from"./chunk-K3W6YFKH.js";import{c as te}from"./chunk-JXJXC4DZ.js";import{d as Ie}from"./chunk-EDXSOKK5.js";import"./chunk-R5BZWVRQ.js";import{p as y}from"./chunk-DID2YGL7.js";import{c as B}from"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Gb as ve,N as be,qc as Se}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import{a as _e}from"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as E}from"./chunk-U54OSGNH.js";import{f as ge,h as Z,i as Ce}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import{c as ee}from"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import{O as he}from"./chunk-IOA4DPXY.js";import{Ad as ae,Db as r,Dc as Q,Ea as C,Ed as V,La as O,Ma as $,Mc as P,Na as X,Oc as u,Tb as v,Va as z,Yc as me,Zb as f,Zc as de,_a as le,_c as pe,cd as q,dd as t,ed as N,fd as ue,gd as w,hd as xe,kc as h,lc as I,mc as W,qd as re,rd as F,sc as x,sd as fe,uc as k,vc as L,wc as A,xc as a,ya as ce,yc as s,yd as b,z as se,zc as m,zd as S}from"./chunk-5LC5EQRR.js";import{a as j,b as R}from"./chunk-3E746U5Y.js";var Qe=(()=>{class i{http=C(he);resourceUrl="api/atlas/metrics";getCourseMetricsForUser(e){return this.http.get(`${this.resourceUrl}/course/${e}/student`,{observe:"response"}).pipe(se(n=>(n.body&&(n.body.exerciseMetrics&&n.body.exerciseMetrics.exerciseInformation&&(n.body.exerciseMetrics.exerciseInformation=this.convertToExerciseInformation(n.body.exerciseMetrics.exerciseInformation,n.body.exerciseMetrics?.categories??{},n.body.exerciseMetrics.teamId)),n.body.lectureUnitStudentMetricsDTO&&n.body.lectureUnitStudentMetricsDTO.lectureUnitInformation&&(n.body.lectureUnitStudentMetricsDTO.lectureUnitInformation=this.convertToLectureUnitInformation(n.body.lectureUnitStudentMetricsDTO.lectureUnitInformation)),n.body.competencyMetrics&&n.body.competencyMetrics.competencyInformation&&(n.body.competencyMetrics.competencyInformation=this.convertToCompetencyInformation(n.body.competencyMetrics.competencyInformation),n.body.competencyMetrics.currentJolValues=this.filterJolWhereMasteryChanged(n.body.competencyMetrics))),n)))}convertToExerciseInformation(e,n,o){return Object.keys(e).reduce((c,p)=>{let d=n[p]?.map(T=>JSON.parse(T))||[],g=e[p];return c[p]=R(j({},g),{startDate:y(g.start),dueDate:g.due?y(g.due):void 0,type:this.mapToExerciseType(g.type),categories:d,studentAssignedTeamId:o?o?.[p]:void 0}),c},{})}convertToLectureUnitInformation(e){return Object.keys(e).reduce((n,o)=>{let c=e[o];return n[o]=R(j({},c),{releaseDate:y(c.releaseDate),type:this.mapToLectureUnitType(c.type)}),n},{})}filterJolWhereMasteryChanged(e){return Object.fromEntries(Object.entries(e.currentJolValues??{}).filter(([n,o])=>{let c=e?.progress?.[Number(n)]??0,p=e?.confidence?.[Number(n)]??1;return o.competencyProgress===c&&o.competencyConfidence===p}))}convertToCompetencyInformation(e){return Object.keys(e).reduce((n,o)=>{let c=e[o];return n[o]=R(j({},c),{softDueDate:c.softDueDate?y(c.softDueDate):void 0}),n},{})}mapToExerciseType(e){switch(e){case"de.tum.cit.aet.artemis.programming.domain.ProgrammingExercise":return B.PROGRAMMING;case"de.tum.cit.aet.artemis.modeling.domain.ModelingExercise":return B.MODELING;case"de.tum.cit.aet.artemis.quiz.domain.QuizExercise":return B.QUIZ;case"de.tum.cit.aet.artemis.text.domain.TextExercise":return B.TEXT;case"de.tum.cit.aet.artemis.fileupload.domain.FileUploadExercise":return B.FILE_UPLOAD;default:throw new Error(`Unknown exercise type: ${e}`)}}mapToLectureUnitType(e){switch(e){case"de.tum.cit.aet.artemis.lecture.domain.AttachmentUnit":return U.ATTACHMENT;case"de.tum.cit.aet.artemis.lecture.domain.ExerciseUnit":return U.EXERCISE;case"de.tum.cit.aet.artemis.lecture.domain.TextUnit":return U.TEXT;case"de.tum.cit.aet.artemis.lecture.domain.VideoUnit":return U.VIDEO;case"de.tum.cit.aet.artemis.lecture.domain.OnlineUnit":return U.ONLINE;default:throw new Error(`Unknown lecture unit type: ${e}`)}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ce({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function ct(i,l){i&1&&(t(0,`
    `),m(1,"jhi-iris-base-chatbot"),t(2,`
`))}var ze=(()=>{class i{chatService=C($e);courseId;ngOnChanges(e){e.courseId&&this.chatService.switchTo(Ye.COURSE,this.courseId)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=v({type:i,selectors:[["jhi-course-chatbot"]],inputs:{courseId:"courseId"},features:[O],decls:1,vars:1,template:function(n,o){n&1&&f(0,ct,3,0),n&2&&x(o.courseId?0:-1)},dependencies:[Xe],styles:["[_nghost-%COMP%]{flex:1 0 auto;min-height:0;max-height:100%;width:100%;display:flex;flex-direction:column;border:1px solid var(--border-color);border-radius:var(--border-radius)}"]})}return i})();var mt=i=>[i,200];function dt(i,l){if(i&1&&(t(0,`
            `),t(1,`
            `),a(2,"div",7),t(3,`
                `),a(4,"div",8),t(5,`
                    `),m(6,"span",9),t(7,`
                    `),m(8,"span",10),t(9,`
                `),s(),t(10,`
                `),a(11,"div",8),t(12,`
                    `),m(13,"span",9),t(14,`
                    `),m(15,"span",11),t(16,`
                `),s(),t(17,`
            `),s(),t(18,`
        `)),i&2){let e=u();r(6),I("background-color",e.YOUR_GRAPH_COLOR),r(7),I("background-color",e.AVERAGE_GRAPH_COLOR)}}function pt(i,l){if(i&1&&(t(0,`
                    `),a(1,"div",14),t(2,`
                        `),a(3,"b",15),t(4),s(),t(5),s(),t(6,`
                `)),i&2){let e=l.model;r(4),N(e.extra.title),r(),w(`
                        `,e.series,": ",e.value,`%
                    `)}}function ut(i,l){if(i&1&&(t(0,`
                                `),a(1,"div",8),t(2,`
                                    `),m(3,"span",9),t(4),s(),t(5,`
                            `)),i&2){let e=l.$implicit;r(3),I("background-color",e.color),r(),w(`
                                    `,e.series,": ",e.value,`%
                                `)}}function xt(i,l){if(i&1&&(t(0,`
                        `),a(1,"div",14),t(2,`
                            `),a(3,"b",15),t(4),s(),t(5,`
                            `),L(6,ut,6,4,null,null,k),s(),t(8,`
                    `)),i&2){let e=u().model;r(4),N(e[0].extra.title),r(2),A(e)}}function ft(i,l){if(i&1&&(t(0,`
                    `),f(1,xt,9,1)),i&2){let e=l.model;r(),x(e.isEmpty?-1:1)}}function ht(i,l){if(i&1&&(t(0,`
        `),a(1,"div",12,0),t(3,`
            `),a(4,"ngx-charts-line-chart",13),b(5,"artemisTranslate"),b(6,"artemisTranslate"),t(7,`
                `),f(8,pt,7,3,"ng-template",null,1,V),t(10,`
                `),f(11,ft,2,1,"ng-template",null,2,V),t(13,`
            `),s(),t(14,`
        `),s(),t(15,`
    `)),i&2){let e=q(2),n=u();r(4),h("view",F(17,mt,e.offsetWidth))("results",n.ngxData)("scheme",n.ngxColor)("legend",!1)("maxXAxisTickLength",6)("xAxis",!0)("xAxisLabel",S(5,13,"artemisApp.courseStudentDashboard.exercisePerformance.xAxisLabel"))("showXAxisLabel",!0)("yAxis",!0)("yAxisLabel",S(6,15,"artemisApp.courseStudentDashboard.exercisePerformance.yAxisLabel"))("showYAxisLabel",!0)("yScaleMin",0)("yScaleMax",n.yScaleMax)}}function gt(i,l){i&1&&(t(0,`
        `),m(1,"div",16),t(2,`
    `))}var qe=J.BLUE,Ze=J.YELLOW,Ke=(()=>{class i{translateService=C(ee);exercisePerformance=[];yourScoreLabel;averageScoreLabel;ngxData;ngxColor={name:"Performance in Exercises",selectable:!0,group:ie.Ordinal,domain:[qe,Ze]};yScaleMax=100;translateServiceSubscription;YOUR_GRAPH_COLOR=qe;AVERAGE_GRAPH_COLOR=Ze;constructor(){this.translateServiceSubscription=this.translateService.onLangChange.subscribe(()=>{this.setupChart()})}ngOnInit(){this.setupChart()}ngOnDestroy(){this.translateServiceSubscription.unsubscribe()}ngOnChanges(){this.setupChart()}get isDataAvailable(){return this.ngxData&&this.ngxData.length>0&&this.ngxData.some(e=>e.series.length>0)}setupChart(){this.yourScoreLabel=this.translateService.instant("artemisApp.courseStudentDashboard.exercisePerformance.yourScoreLabel"),this.averageScoreLabel=this.translateService.instant("artemisApp.courseStudentDashboard.exercisePerformance.averageScoreLabel"),this.ngxData=[{name:this.yourScoreLabel,series:this.exercisePerformance.map(n=>({name:n.shortName?.toUpperCase()||n.title,value:_(n.score||0,1),extra:{title:n.title}}))},{name:this.averageScoreLabel,series:this.exercisePerformance.map(n=>({name:n.shortName?.toUpperCase()||n.title,value:_(n.averageScore||0,1),extra:{title:n.title}}))}];let e=Math.max(...this.ngxData.flatMap(n=>n.series.map(o=>o.value)));this.yScaleMax=Math.max(100,Math.ceil(e/10)*10)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=v({type:i,selectors:[["jhi-course-exercise-performance"]],inputs:{exercisePerformance:"exercisePerformance"},features:[O],decls:16,vars:2,consts:[["containerRef",""],["tooltipTemplate",""],["seriesTooltipTemplate",""],[1,"d-flex","flex-wrap","justify-content-between","align-items-baseline","gap-2"],[1,"d-flex","gap-2","align-items-baseline"],["jhiTranslate","artemisApp.courseStudentDashboard.exercisePerformance.title"],["text","artemisApp.courseStudentDashboard.exercisePerformance.info"],[1,"d-flex","gap-3"],[1,"d-flex","align-items-center","gap-1"],[1,"tooltip-label"],["jhiTranslate","artemisApp.courseStudentDashboard.exercisePerformance.yourScoreLabel"],["jhiTranslate","artemisApp.courseStudentDashboard.exercisePerformance.averageScoreLabel"],[1,"mt-2","justify-content-center"],[3,"view","results","scheme","legend","maxXAxisTickLength","xAxis","xAxisLabel","showXAxisLabel","yAxis","yAxisLabel","showYAxisLabel","yScaleMin","yScaleMax"],[1,"d-flex","flex-column","align-items-start","py-2"],[1,"mb-1"],["jhiTranslate","artemisApp.courseStudentDashboard.exercisePerformance.noData",1,"mt-2"]],template:function(n,o){n&1&&(a(0,"div"),t(1,`
    `),a(2,"div",3),t(3,`
        `),a(4,"div",4),t(5,`
            `),m(6,"h4",5),t(7,`
            `),m(8,"jhi-help-icon",6),t(9,`
        `),s(),t(10,`
        `),f(11,dt,19,4),s(),t(12,`
    `),f(13,ht,16,19)(14,gt,3,0),s(),t(15,`
`)),n&2&&(r(11),x(o.isDataAvailable?11:-1),r(2),x(o.isDataAvailable?13:14))},dependencies:[E,H,oe,ne,G],styles:[".tooltip-label[_ngcontent-%COMP%]{width:15px;height:15px;display:inline-block;border-radius:3px}"]})}return i})();var Ct=i=>[i,200];function yt(i,l){if(i&1&&(t(0,`
            `),t(1,`
            `),a(2,"div",7),t(3,`
                `),a(4,"div",8),t(5,`
                    `),m(6,"span",9),t(7,`
                    `),m(8,"span",10),t(9,`
                `),s(),t(10,`
                `),a(11,"div",8),t(12,`
                    `),m(13,"span",9),t(14,`
                    `),m(15,"span",11),t(16,`
                `),s(),t(17,`
            `),s(),t(18,`
        `)),i&2){let e=u();r(6),I("background-color",e.YOUR_GRAPH_COLOR),r(7),I("background-color",e.AVERAGE_GRAPH_COLOR)}}function _t(i,l){if(i&1&&(t(0,`
                    `),a(1,"div",14),t(2,`
                        `),a(3,"b",15),t(4),s(),t(5),s(),t(6,`
                `)),i&2){let e=l.model;r(4),N(e.extra.title),r(),w(`
                        `,e.series,": ",e.value,`%
                    `)}}function bt(i,l){if(i&1&&(t(0,`
                                `),a(1,"div",8),t(2,`
                                    `),m(3,"span",9),t(4),s(),t(5,`
                            `)),i&2){let e=l.$implicit;r(3),I("background-color",e.color),r(),w(`
                                    `,e.series,": ",e.value,`%
                                `)}}function vt(i,l){if(i&1&&(t(0,`
                        `),a(1,"div",14),t(2,`
                            `),a(3,"b",15),t(4),s(),t(5,`
                            `),L(6,bt,6,4,null,null,k),s(),t(8,`
                    `)),i&2){let e=u().model;r(4),N(e[0].extra.title),r(2),A(e)}}function St(i,l){if(i&1&&(t(0,`
                    `),f(1,vt,9,1)),i&2){let e=l.model;r(),x(e.isEmpty?-1:1)}}function Tt(i,l){if(i&1&&(t(0,`
        `),a(1,"div",12,0),t(3,`
            `),a(4,"ngx-charts-line-chart",13),b(5,"artemisTranslate"),b(6,"artemisTranslate"),t(7,`
                `),f(8,_t,7,3,"ng-template",null,1,V),t(10,`
                `),f(11,St,2,1,"ng-template",null,2,V),t(13,`
            `),s(),t(14,`
        `),s(),t(15,`
    `)),i&2){let e=q(2),n=u();r(4),h("view",F(17,Ct,e.offsetWidth))("results",n.ngxData)("scheme",n.ngxColor)("legend",!1)("maxXAxisTickLength",6)("xAxis",!0)("xAxisLabel",S(5,13,"artemisApp.courseStudentDashboard.exerciseLateness.xAxisLabel"))("showXAxisLabel",!0)("yAxis",!0)("yAxisLabel",S(6,15,"artemisApp.courseStudentDashboard.exerciseLateness.yAxisLabel"))("showYAxisLabel",!0)("yScaleMin",0)("yScaleMax",n.yScaleMax)}}function Et(i,l){i&1&&(t(0,`
        `),m(1,"div",16),t(2,`
    `))}var et=J.BLUE,tt=J.YELLOW,it=(()=>{class i{translateService=C(ee);exerciseLateness=[];yourLatenessLabel;averageLatenessLabel;ngxData;ngxColor={name:"Lateness in Exercises",selectable:!0,group:ie.Ordinal,domain:[et,tt]};yScaleMax=100;translateServiceSubscription;YOUR_GRAPH_COLOR=et;AVERAGE_GRAPH_COLOR=tt;constructor(){this.translateServiceSubscription=this.translateService.onLangChange.subscribe(()=>{this.setupChart()})}ngOnInit(){this.setupChart()}ngOnDestroy(){this.translateServiceSubscription.unsubscribe()}ngOnChanges(){this.setupChart()}get isDataAvailable(){return this.ngxData&&this.ngxData.length>0&&this.ngxData.some(e=>e.series.length>0)}setupChart(){this.yourLatenessLabel=this.translateService.instant("artemisApp.courseStudentDashboard.exerciseLateness.yourLatenessLabel"),this.averageLatenessLabel=this.translateService.instant("artemisApp.courseStudentDashboard.exerciseLateness.averageLatenessLabel"),this.ngxData=[{name:this.yourLatenessLabel,series:this.exerciseLateness.map(n=>({name:n.shortName?.toUpperCase()||n.title,value:_(n.relativeLatestSubmission||100,1),extra:{title:n.title}}))},{name:this.averageLatenessLabel,series:this.exerciseLateness.map(n=>({name:n.shortName?.toUpperCase()||n.title,value:_(n.relativeAverageLatestSubmission||100,1),extra:{title:n.title}}))}];let e=Math.max(...this.ngxData.flatMap(n=>n.series.map(o=>o.value)));this.yScaleMax=Math.max(100,Math.ceil(e/10)*10)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=v({type:i,selectors:[["jhi-course-exercise-lateness"]],inputs:{exerciseLateness:"exerciseLateness"},features:[O],decls:16,vars:2,consts:[["containerRef",""],["tooltipTemplate",""],["seriesTooltipTemplate",""],[1,"d-flex","flex-wrap","justify-content-between","align-items-baseline","gap-2"],[1,"d-flex","gap-2","align-items-baseline"],["jhiTranslate","artemisApp.courseStudentDashboard.exerciseLateness.title"],["text","artemisApp.courseStudentDashboard.exerciseLateness.info"],[1,"d-flex","gap-3"],[1,"d-flex","align-items-center","gap-1"],[1,"tooltip-label"],["jhiTranslate","artemisApp.courseStudentDashboard.exerciseLateness.yourLatenessLabel"],["jhiTranslate","artemisApp.courseStudentDashboard.exerciseLateness.averageLatenessLabel"],[1,"mt-2","justify-content-center"],[3,"view","results","scheme","legend","maxXAxisTickLength","xAxis","xAxisLabel","showXAxisLabel","yAxis","yAxisLabel","showYAxisLabel","yScaleMin","yScaleMax"],[1,"d-flex","flex-column","align-items-start","py-2"],[1,"mb-1"],["jhiTranslate","artemisApp.courseStudentDashboard.exerciseLateness.noData",1,"mt-2"]],template:function(n,o){n&1&&(a(0,"div"),t(1,`
    `),a(2,"div",3),t(3,`
        `),a(4,"div",4),t(5,`
            `),m(6,"h4",5),t(7,`
            `),m(8,"jhi-help-icon",6),t(9,`
        `),s(),t(10,`
        `),f(11,yt,19,4),s(),t(12,`
    `),f(13,Tt,16,19)(14,Et,3,0),s(),t(15,`
`)),n&2&&(r(11),x(o.isDataAvailable?11:-1),r(2),x(o.isDataAvailable?13:14))},dependencies:[E,H,oe,ne,G],styles:[".tooltip-label[_ngcontent-%COMP%]{width:15px;height:15px;display:inline-block;border-radius:3px}"]})}return i})();function Lt(i,l){if(i&1&&(t(0,`
        `),a(1,"div",5),t(2,`
            `),m(3,"span",6),t(4,`
            `),m(5,"star-rating",7),t(6,`
        `),s(),t(7,`
    `)),i&2){let e=u();r(5),h("value",e.mastery/100*5)("size","24")("readOnly",!0)("totalStars",5)}}var nt=(()=>{class i{courseCompetencyService=C(He);alertService=C(te);courseId;competencyId;rating;mastery;ratingChange=new z;onRate(e){if(this.rating!==void 0||this.courseId===void 0)return;let n=e.newValue;this.courseCompetencyService.setJudgementOfLearning(this.courseId,this.competencyId,n).subscribe(()=>{this.rating=n,this.ratingChange.emit(n)},()=>{this.alertService.error("artemisApp.courseStudentDashboard.judgementOfLearning.error")})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=v({type:i,selectors:[["jhi-judgement-of-learning-rating"]],inputs:{courseId:"courseId",competencyId:"competencyId",rating:"rating",mastery:"mastery"},outputs:{ratingChange:"ratingChange"},decls:17,vars:5,consts:[[1,"alert","alert-info"],[1,"d-flex","gap-1","align-items-center"],["jhiTranslate","artemisApp.courseStudentDashboard.judgementOfLearning.title"],["text","artemisApp.courseStudentDashboard.judgementOfLearning.info"],["checkedColor","var(--yellow)","uncheckedColor","var(--gray-500)",3,"rate","value","size","readOnly","totalStars"],[1,"mt-2"],["jhiTranslate","artemisApp.courseStudentDashboard.judgementOfLearning.artemisRating"],["checkedColor","var(--info)","uncheckedColor","var(--gray-500)",3,"value","size","readOnly","totalStars"]],template:function(n,o){if(n&1&&(t(0,`
`),a(1,"div",0),t(2,`
    `),a(3,"div",1),t(4,`
        `),a(5,"b"),t(6,`
            `),m(7,"span",2),t(8,`
        `),s(),t(9,`
        `),m(10,"jhi-help-icon",3),t(11,`
    `),s(),t(12,`
    `),a(13,"star-rating",4),P("rate",function(p){return o.onRate(p)}),s(),t(14,`
    `),f(15,Lt,8,4),s(),t(16,`
`)),n&2){let c;r(13),h("value",(c=o.rating)!==null&&c!==void 0?c:0)("size","24")("readOnly",o.rating!=null)("totalStars",5),r(2),x(o.rating!=null&&o.mastery!=null?15:-1)}},dependencies:[Je,H,E],encapsulation:2})}return i})();var ot=i=>({progress:i}),At=(i,l)=>["/courses",i,"lectures",l];function Pt(i,l){if(i&1&&(t(0,`
                `),m(1,"fa-icon",8),b(2,"artemisTranslate"),t(3,`
            `)),i&2){let e=u();r(),h("icon",e.getIcon(e.competency.taxonomy))("fixedWidth",!0)("ngbTooltip",S(2,3,"artemisApp.courseCompetency.taxonomies."+e.competency.taxonomy))}}function Dt(i,l){if(i&1&&(t(0,`
                    `),a(1,"div",9),t(2,`
                        `),m(3,"fa-icon",10),b(4,"artemisTranslate"),t(5,`
                        `),m(6,"ngb-progressbar",11),b(7,"artemisTranslate"),t(8,`
                    `),s(),t(9,`
                `)),i&2){let e=u();r(3),h("icon",e.faList)("ngbTooltip",S(4,5,"artemisApp.studentAnalyticsDashboard.competencyAccordion.exercises")),r(3),h("value",e.exercisesProgress)("max",100)("ngbTooltip",ae(7,7,"artemisApp.studentAnalyticsDashboard.competencyAccordion.exerciseProgress",F(10,ot,e.exercisesProgress)))}}function Mt(i,l){if(i&1&&(t(0,`
                    `),a(1,"div",9),t(2,`
                        `),m(3,"fa-icon",10),b(4,"artemisTranslate"),t(5,`
                        `),m(6,"ngb-progressbar",11),b(7,"artemisTranslate"),t(8,`
                    `),s(),t(9,`
                `)),i&2){let e=u();r(3),h("icon",e.faFilePdf)("ngbTooltip",S(4,5,"artemisApp.studentAnalyticsDashboard.competencyAccordion.lectures")),r(3),h("value",e.lectureUnitsProgress)("max",100)("ngbTooltip",ae(7,7,"artemisApp.studentAnalyticsDashboard.competencyAccordion.lectureProgress",F(10,ot,e.lectureUnitsProgress)))}}function Ot(i,l){if(i&1){let e=Q();t(0,`
            `),a(1,"div"),t(2,`
                `),a(3,"jhi-judgement-of-learning-rating",12),P("ratingChange",function(o){$(e);let c=u();return X(c.onRatingChange(o))}),s(),t(4,`
            `),s(),t(5,`
        `)}if(i&2){let e=u();r(),W("pb-1",e.course&&(e.nextExercises.length>0||e.nextLectureUnits.length>0)),r(2),h("competencyId",e.competency.id)("courseId",e.course==null?null:e.course.id)("mastery",e.mastery)("rating",e.jolRating)}}function It(i,l){i&1&&(t(0,`
                `),m(1,"h5",13),t(2,`
            `))}function wt(i,l){if(i&1&&(t(0,`
                    `),m(1,"jhi-course-exercise-row",14),t(2,`
                `)),i&2){let e=l.$implicit,n=u(3);r(),h("course",n.course)("exercise",e)}}function Ut(i,l){if(i&1&&(t(0,`
                `),L(1,wt,3,2,null,null,k)),i&2){let e=u(2);r(),A(e.nextExercises)}}function jt(i,l){if(i&1&&(t(0,`
                    `),a(1,"div",15),t(2,`
                        `),m(3,"a",16),t(4,`
                        `),a(5,"div",17),t(6,`
                            `),m(7,"fa-icon",18),b(8,"artemisTranslate"),t(9),s(),t(10,`
                    `),s(),t(11,`
                `)),i&2){let e=l.$implicit,n=u(3);r(3),h("routerLink",fe(7,At,n.course.id,e.lectureId)),r(4),h("icon",e.type===n.LectureUnitType.ATTACHMENT?n.faFile:n.lectureUnitIcons[e.type])("ngbTooltip",S(8,5,n.lectureUnitTooltips[e.type])),r(2),w(`
                            `,e.lectureTitle,`
                            -
                            `,e.name,`
                        `)}}function Rt(i,l){if(i&1&&(t(0,`
                `),L(1,jt,12,10,null,null,k)),i&2){let e=u(2);r(),A(e.nextLectureUnits)}}function kt(i,l){i&1&&(t(0,`
                `),m(1,"div",19),t(2,`
            `))}function Ft(i,l){if(i&1&&(t(0,`
            `),f(1,It,3,0)(2,Ut,3,0)(3,Rt,3,0)(4,kt,3,0)),i&2){let e=u();r(),x(e.nextLectureUnits.length>0||e.nextExercises.length>0?1:-1),r(),x(e.nextExercises.length>0?2:-1),r(),x(e.nextLectureUnits.length>0?3:-1),r(),x(e.nextExercises.length===0&&e.nextLectureUnits.length===0?4:-1)}}var rt=(()=>{class i{router=C(Z);course;competency;metrics;index;openedIndex;accordionToggle=new z;open=!1;nextExercises=[];nextLectureUnits=[];exercisesProgress;lectureUnitsProgress;confidence=1;mastery=0;progress=0;jolRating;promptForRating=!1;faList=be;faFile=Se;faFilePdf=ve;lectureUnitIcons=Ee;lectureUnitTooltips=Le;LectureUnitType=U;getIcon=Re;getProgress=ke;getConfidence=Fe;getMastery=Ne;round=_;ngOnChanges(e){if(e.openedIndex&&this.index!==this.openedIndex&&(this.open=!1),e.metrics){this.setNextExercises(),this.setNextLessonUnits(),this.calculateProgressValues();let n=Object.values(this.metrics.competencyMetrics?.competencyInformation??{}).map(o=>R(j({},o),{userProgress:[{progress:this.metrics.competencyMetrics?.progress?.[o.id]??0,confidence:this.metrics.competencyMetrics?.confidence?.[o.id]??1}]}));this.promptForRating=je.shouldPromptForJol(this.competency,{progress:this.metrics.competencyMetrics?.progress?.[this.competency.id],confidence:this.metrics.competencyMetrics?.confidence?.[this.competency.id]},n)}}setNextExercises(){this.metrics||(this.nextExercises=[]);let e=this.course?.exercises??[],n=Object.fromEntries(e.map(d=>[d.id,d])),o=(this.metrics.competencyMetrics?.exercises?.[this.competency.id]??[]).flatMap(d=>[n[d]]).filter(d=>d.releaseDate?.isBefore(y())).filter(d=>d.dueDate?.isAfter(y())||Ue(d)),c=Object.fromEntries(o.map(d=>{let g=d.studentParticipations?.flatMap(T=>T.results??[]).reduce((T,D)=>Math.max(T,D.score??0),-1)??0;return[d.id,g]})),p=De;this.nextExercises=o.filter(d=>d.id&&c[d.id]<=p).sort((d,g)=>{let T=d.id?c[d.id]??0:0,D=g.id?c[g.id]??0:0;if(T!==D)return T-D;let M=d.dueDate??d.startDate,st=g.dueDate??g.startDate;return M?.diff(st)??0}).slice(0,5)}setNextLessonUnits(){this.metrics||(this.nextLectureUnits=[]);let e=this.metrics.lectureUnitStudentMetricsDTO?.completed??[],n=this.metrics.competencyMetrics?.lectureUnits?.[this.competency.id]??[];this.nextLectureUnits=n.filter(o=>!e.includes(o)).flatMap(o=>this.metrics.lectureUnitStudentMetricsDTO?.lectureUnitInformation?.[o]??[]).filter(o=>o.releaseDate?.isBefore(y())).sort((o,c)=>o.releaseDate?.isBefore(c?.releaseDate)?-1:1).slice(0,Math.max(0,5-this.nextExercises.length))}calculateProgressValues(){let e=this.metrics.competencyMetrics?.currentJolValues?.[this.competency.id];this.jolRating=e?.jolValue,this.exercisesProgress=this.calculateExercisesProgress(),this.lectureUnitsProgress=this.calculateLectureUnitsProgress();let n=this.getUserProgress();this.jolRating!==void 0?(this.progress=this.getProgress(n),this.confidence=this.getConfidence(n),this.mastery=this.getMastery(n)):(this.progress=0,this.confidence=1,this.mastery=0)}calculateExercisesProgress(){if(!this.metrics.exerciseMetrics)return;let e=this.metrics.competencyMetrics?.exercises?.[this.competency.id];if(e===void 0||e.length===0)return;let n=e?.map(p=>(this.metrics.exerciseMetrics?.score?.[p]??0)*(this.metrics.exerciseMetrics?.exerciseInformation?.[p]?.maxPoints??0)/100).reduce((p,d)=>p+d,0),o=e?.map(p=>this.metrics.exerciseMetrics?.exerciseInformation?.[p]?.maxPoints??0).reduce((p,d)=>p+d,0),c=n/o*100;return _(c,1)}calculateLectureUnitsProgress(){if(!this.metrics.lectureUnitStudentMetricsDTO)return;let n=this.metrics.competencyMetrics?.lectureUnits?.[this.competency.id]?.filter(p=>this.metrics.lectureUnitStudentMetricsDTO?.lectureUnitInformation?.[p]?.releaseDate?.isBefore(y()));if(n===void 0||n.length===0)return;let c=(n?.filter(p=>this.metrics.lectureUnitStudentMetricsDTO?.completed?.includes(p)).length??0)/n.length*100;return _(c,1)}getUserProgress(){let e=this.metrics.competencyMetrics?.progress?.[this.competency.id]??0,n=this.metrics.competencyMetrics?.confidence?.[this.competency.id]??1;return{progress:e,confidence:n}}toggle(){this.open=!this.open,this.accordionToggle.emit({opened:this.open,index:this.index})}onRatingChange(e){this.metrics.competencyMetrics&&(this.metrics.competencyMetrics.currentJolValues=R(j({},this.metrics.competencyMetrics.currentJolValues),{[this.competency.id]:{competencyId:this.competency.id,jolValue:e,judgementTime:y().toString(),competencyProgress:this.progress,competencyConfidence:this.confidence}}),this.calculateProgressValues())}navigateToCompetencyDetailPage(e){e.stopPropagation(),this.router.navigate(["/courses",this.course.id,"competencies",this.competency.id])}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=v({type:i,selectors:[["jhi-competency-accordion"]],inputs:{course:"course",competency:"competency",metrics:"metrics",index:"index",openedIndex:"openedIndex"},outputs:{accordionToggle:"accordionToggle"},features:[O],decls:31,vars:19,consts:[[1,"competency-accordion-header","d-flex","flex-column","flex-sm-row","align-items-start","align-items-sm-center","justify-between","gap-2","px-4",3,"click","id"],[1,"fw-medium","mb-0","py-2","col-sm-6","d-flex","gap-2"],[1,"w-100","d-flex","align-items-center","gap-4"],[1,"w-100","d-flex","flex-column","gap-2"],[1,"competency-rings-container","py-2"],[3,"progress","mastery","hideProgress","playAnimation"],[1,"competency-accordion-body"],["jhiTranslate","artemisApp.studentAnalyticsDashboard.button.viewLecturesAndExercises",1,"btn","btn-primary","w-100","my-2",3,"click"],["container","body",3,"icon","fixedWidth","ngbTooltip"],[1,"d-flex","gap-3","align-items-center","justify-content-center"],[3,"icon","ngbTooltip"],["type","success overflow-visible","height","0.75rem",1,"w-100",3,"value","max","ngbTooltip"],[3,"ratingChange","competencyId","courseId","mastery","rating"],["jhiTranslate","artemisApp.studentAnalyticsDashboard.competencyAccordion.nextActivities",1,"fw-medium","fs-5","mt-1"],[3,"course","exercise"],[1,"lecture-unit-container","d-flex","align-items-center","my-2","px-2","position-relative"],[1,"stretched-link",3,"routerLink"],[1,"m-0","fs-5","fw-medium","px-2"],[1,"me-2",3,"icon","ngbTooltip"],["jhiTranslate","artemisApp.studentAnalyticsDashboard.competencyAccordion.congratulations",1,"alert","alert-success"]],template:function(n,o){n&1&&(a(0,"div"),t(1,`
    `),a(2,"button",0),P("click",function(){return o.toggle()}),t(3,`
        `),a(4,"h4",1),t(5,`
            `),f(6,Pt,4,5),t(7),s(),t(8,`
        `),a(9,"div",2),t(10,`
            `),a(11,"div",3),t(12,`
                `),f(13,Dt,10,12)(14,Mt,10,12),s(),t(15,`
            `),a(16,"div",4),t(17,`
                `),m(18,"jhi-competency-rings",5),t(19,`
            `),s(),t(20,`
        `),s(),t(21,`
    `),s(),t(22,`
    `),a(23,"div",6),t(24,`
        `),f(25,Ot,6,6)(26,Ft,5,4),a(27,"button",7),P("click",function(p){return o.navigateToCompetencyDetailPage(p)}),s(),t(28,`
    `),s(),t(29,`
`),s(),t(30,`
`)),n&2&&(r(2),W("closed",!o.open),h("id","competency-accordion-"+o.competency.id),r(4),x(o.competency.taxonomy?6:-1),r(),ue(`
            `,o.competency.title,`
        `),r(6),x(o.exercisesProgress!==void 0?13:-1),r(),x(o.lectureUnitsProgress!==void 0?14:-1),r(4),W("muted-competency-rings",o.promptForRating&&o.jolRating===void 0),h("progress",o.progress)("mastery",o.mastery)("hideProgress",o.promptForRating&&o.jolRating===void 0)("playAnimation",!1),r(5),W("competency-accordion-body-open",o.open)("competency-accordion-body-closed",!o.open),r(2),x(o.promptForRating?25:-1),r(),x(o.course?26:-1))},dependencies:[Ie,ye,K,We,nt,E,Ge,Ce,G],styles:[".competency-accordion-header[_ngcontent-%COMP%]{background-color:var(--overview-light-background-color);color:var(--bs-body-color);cursor:pointer;padding:5px;width:100%;border:none;text-align:left;outline:none;border-radius:3px 3px 0 0;transition:.2s}.competency-accordion-header[_ngcontent-%COMP%], .competency-accordion-body[_ngcontent-%COMP%]{margin:0}.competency-accordion-header.closed[_ngcontent-%COMP%]{border-radius:3px}.competency-accordion-header[_ngcontent-%COMP%]:not([disabled]):hover{background-color:#64646f33}.competency-accordion-ring[_ngcontent-%COMP%]{width:95px}.competency-accordion-body[_ngcontent-%COMP%]{padding:0 18px;background-color:var(--overview-light-background-color);color:var(--bs-body-color);overflow:hidden;width:100%;transition:max-height .2s ease-out,padding .2s ease-out;border-radius:0 0 3px 3px}.competency-accordion-body-open[_ngcontent-%COMP%]{padding:10px 18px}.competency-accordion-body-closed[_ngcontent-%COMP%]{max-height:0;padding:0 18px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.competency-accordion-header[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .competency-accordion-body[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{padding:0 18px}@media only screen and (max-width: 600px){.competency-accordion-body[_ngcontent-%COMP%]{overflow-y:auto}}.lecture-unit-container[_ngcontent-%COMP%]{flex-wrap:nowrap!important;min-height:50px;min-width:100%;border:1px solid var(--overview-blue-border-color);background-color:var(--overview-light-background-color);border-radius:3px;transition:transform .2s linear}.lecture-unit-container[_ngcontent-%COMP%]:hover{transform:scale(1.012);background-color:var(--hover-slightly-darker-body-bg)}.competency-rings-container[_ngcontent-%COMP%]{max-width:65px;width:100%}"]})}return i})();var Nt=["competencyAccordionElement"],at=()=>[],Vt=(i,l)=>l.id;function Bt(i,l){if(i&1&&(t(0,`
    `),a(1,"div",2),t(2,`
        `),m(3,"jhi-course-chatbot",3),t(4,`
    `),s(),t(5,`
`)),i&2){let e=u();r(3),h("courseId",e.courseId)}}function Gt(i,l){i&1&&(t(0,`
        `),a(1,"div",4),t(2,`
            `),a(3,"div",5),t(4,`
                `),m(5,"span",6),t(6,`
            `),s(),t(7,`
        `),s(),t(8,`
    `))}function Ht(i,l){if(i&1&&(t(0,`
                `),a(1,"div",9),t(2,`
                    `),m(3,"h4",10),t(4,`
                    `),a(5,"div",11),t(6,`
                        `),a(7,"ngb-progressbar",12),t(8,`
                            `),a(9,"span",13),t(10),s(),t(11,`
                        `),s(),t(12,`
                    `),s(),t(13,`
                `),s(),t(14,`
            `)),i&2){let e=u(3);r(7),h("value",e.points)("max",e.maxPoints),r(3),xe("",e.points," / ",e.maxPoints," (",e.progress,"%)")}}function Jt(i,l){if(i&1&&(t(0,`
            `),f(1,Ht,15,5),m(2,"jhi-course-exercise-performance",7),t(3,`
            `),m(4,"jhi-course-exercise-lateness",8),t(5,`
        `)),i&2){let e=u(2);r(),x(e.points>0||e.maxPoints>0?1:-1),r(),h("exercisePerformance",e.exercisePerformance||re(3,at)),r(2),h("exerciseLateness",e.exerciseLateness||re(4,at))}}function Yt(i,l){i&1&&(t(0,`
            `),m(1,"div",14),t(2,`
        `))}function $t(i,l){if(i&1){let e=Q();t(0,`
                            `),a(1,"jhi-competency-accordion",18,0),P("accordionToggle",function(o){$(e);let c=u(4);return X(c.handleToggle(o))}),s(),t(3,`
                        `)}if(i&2){let e=l.$implicit,n=l.$index,o=u(4);r(),h("course",o.course)("competency",e)("metrics",o.studentMetrics)("index",n)("openedIndex",o.openedAccordionIndex)}}function Xt(i,l){if(i&1&&(t(0,`
                        `),L(1,$t,4,5,null,null,Vt)),i&2){let e=u(3);r(),A(e.competencies)}}function Wt(i,l){if(i&1&&(t(0,`
            `),a(1,"div",15),t(2,`
                `),m(3,"h3",16),t(4,`
                `),a(5,"div",17),t(6,`
                    `),f(7,Xt,3,0),s(),t(8,`
            `),s(),t(9,`
        `)),i&2){let e=u(2);r(7),x(e.studentMetrics?7:-1)}}function Qt(i,l){i&1&&(t(0,`
            `),m(1,"div",19),t(2,`
        `))}function zt(i,l){if(i&1){let e=Q();t(0,`
            `),a(1,"jhi-feature-overlay",20),t(2,`
                `),a(3,"div",21),t(4,`
                    `),a(5,"button",22),P("click",function(){$(e);let o=u(2);return X(o.navigateToLearningPaths())}),s(),t(6,`
                `),s(),t(7,`
            `),s(),t(8,`
        `)}if(i&2){let e=u(2);r(),h("enabled",e.atlasEnabled),r(2),h("jhiFeatureToggleHide",e.FeatureToggle.LearningPaths)}}function qt(i,l){if(i&1&&(t(0,`
        `),f(1,Jt,6,5)(2,Yt,3,0)(3,Wt,10,1)(4,Qt,3,0)(5,zt,9,2)),i&2){let e=u();r(),x(e.hasExercises?1:2),r(2),x(e.hasCompetencies?3:4),r(2),x(e.course!=null&&e.course.learningPathsEnabled?5:-1)}}var Vn=(()=>{class i{courseStorageService=C(Pe);alertService=C(te);route=C(ge);router=C(Z);courseDashboardService=C(Qe);irisSettingsService=C(Ve);profileService=C(Te);courseId;exerciseId;points=0;maxPoints=0;progress=0;isLoading=!1;hasExercises=!1;hasCompetencies=!1;exerciseLateness;exercisePerformance;irisEnabled=!1;atlasEnabled=!1;studentMetrics;paramSubscription;courseUpdatesSubscription;metricsSubscription;competencies=[];openedAccordionIndex;course;FeatureToggle=_e;round=_;competencyAccordions;ngOnInit(){this.paramSubscription=this.route?.parent?.params.subscribe(e=>{this.courseId=parseInt(e.courseId,10),this.profileService.getProfileInfo().subscribe(n=>{n?.activeProfiles.includes(Oe)&&this.irisSettingsService.getCombinedCourseSettings(this.courseId).subscribe(o=>{this.irisEnabled=!!o?.irisCourseChatSettings?.enabled})})}),this.setCourse(this.courseStorageService.getCourse(this.courseId)),this.courseUpdatesSubscription=this.courseStorageService.subscribeToCourseUpdates(this.courseId).subscribe(e=>{this.setCourse(e)}),this.profileService.getProfileInfo().subscribe(e=>this.atlasEnabled=e.activeProfiles.includes(Me))}ngOnDestroy(){this.paramSubscription?.unsubscribe(),this.courseUpdatesSubscription?.unsubscribe(),this.metricsSubscription?.unsubscribe()}loadMetrics(){this.metricsSubscription&&this.metricsSubscription.unsubscribe(),this.isLoading=!0,this.metricsSubscription=this.courseDashboardService.getCourseMetricsForUser(this.courseId).subscribe({next:e=>{if(e.body){this.studentMetrics=e.body;let n=e.body.lectureUnitStudentMetricsDTO??{},o=e.body.exerciseMetrics??{},c=Object.values(o?.exerciseInformation??{}).filter(d=>d.dueDate&&d.dueDate.isBefore(y())).sort((d,g)=>(d.dueDate??d.startDate).isBefore(g.dueDate)?-1:1).map(d=>d.id);c=c.slice(-10),this.hasExercises=c.length>0,this.setOverallPerformance(c,o),this.setExercisePerformance(c,o),this.setExerciseLateness(c,o);let p=e.body.competencyMetrics??{};this.competencies=Object.values(p.competencyInformation??{}).filter(d=>{let g=p.exercises?.[d.id]??[];for(let D of g){let M=o.exerciseInformation?.[D];if(M&&M.startDate.isBefore(y()))return!0}let T=p.lectureUnits?.[d.id]??[];for(let D of T){let M=n.lectureUnitInformation?.[D];if(M&&M.releaseDate&&M.releaseDate.isBefore(y()))return!0}}).sort((d,g)=>d.id<g.id?-1:1),this.hasCompetencies=this.competencies.length>0}this.isLoading=!1},error:e=>{Ae(this.alertService,e),this.isLoading=!1}})}setOverallPerformance(e,n){let o=Object.values(n?.exerciseInformation??{}).filter(d=>e.includes(d.id)),c=o.reduce((d,g)=>d+(n.score?.[g.id]||0)/100*g.maxPoints,0);this.points=_(c,1);let p=o.reduce((d,g)=>d+g.maxPoints,0);this.maxPoints=_(p,1),this.progress=_(c/p*100,1)}setExercisePerformance(e,n){this.exercisePerformance=e.flatMap(o=>{let c=n?.exerciseInformation?.[o];return c?[{exerciseId:o,title:c.title,shortName:c.shortName,score:n.score?.[o],averageScore:n.averageScore?.[o]}]:[]})}setExerciseLateness(e,n){this.exerciseLateness=e.flatMap(o=>{let c=n?.exerciseInformation?.[o];return c?[{exerciseId:o,title:c.title,shortName:c.shortName,relativeLatestSubmission:n.latestSubmission?.[o],relativeAverageLatestSubmission:n.averageLatestSubmission?.[o]}]:[]})}setCourse(e){let n=this.course?.id!==e?.id;this.course=e,this.course&&n&&this.loadMetrics()}handleToggle(e){this.openedAccordionIndex=e.opened?e.index:void 0}navigateToLearningPaths(){this.router.navigate(["courses",this.courseId,"learning-path"])}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=v({type:i,selectors:[["jhi-course-dashboard"]],viewQuery:function(n,o){if(n&1&&me(Nt,5,le),n&2){let c;de(c=pe())&&(o.competencyAccordions=c)}},decls:6,vars:2,consts:[["competencyAccordionElement",""],[1,"stats-container"],[1,"chat-container"],[3,"courseId"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border"],["jhiTranslate","loading",1,"sr-only"],[3,"exercisePerformance"],[3,"exerciseLateness"],[1,"d-sm-flex","gap-3","align-items-baseline"],["jhiTranslate","artemisApp.courseStudentDashboard.overallPerformance.title"],[1,"flex-grow-1"],["type","success overflow-visible","height","1.75rem",3,"value","max"],[1,"fs-5","mx-2"],["jhiTranslate","artemisApp.courseStudentDashboard.noMetrics"],[1,"competency-accordion-container","justify-content-center","align-items-center","w-100"],["jhiTranslate","artemisApp.studentAnalyticsDashboard.competencyAccordion.title"],[1,"competencies","d-flex","flex-column","gap-2"],[3,"accordionToggle","course","competency","metrics","index","openedIndex"],["jhiTranslate","artemisApp.studentAnalyticsDashboard.competencyAccordion.noData"],[3,"enabled"],[1,"competency-accordion-container","row","justify-content-center","w-100",3,"jhiFeatureToggleHide"],["jhiTranslate","artemisApp.studentAnalyticsDashboard.button.showLearningPath",1,"btn","btn-primary","mt-2",3,"click"]],template:function(n,o){n&1&&(f(0,Bt,6,1),a(1,"div",1),t(2,`
    `),f(3,Gt,9,0)(4,qt,6,3),s(),t(5,`
`)),n&2&&(x(o.irisEnabled?0:-1),r(3),x(o.isLoading?3:4))},dependencies:[ze,E,K,Ke,it,rt,Be,we],styles:["[_nghost-%COMP%]{min-height:100%;max-height:100%;width:100%;display:flex;gap:10px}[_nghost-%COMP%]   .chat-container[_ngcontent-%COMP%]{flex:1;min-height:100%;max-height:100%;display:flex;flex-direction:column;min-width:0}[_nghost-%COMP%]   .stats-container[_ngcontent-%COMP%]{flex:1;min-width:0;overflow-y:auto;overflow-x:hidden;scrollbar-color:var(--gray-500) transparent;scrollbar-width:thin;padding-right:3px;margin-right:-3px}[_nghost-%COMP%]   .stats-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px}[_nghost-%COMP%]   .stats-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:var(--gray-500);border-radius:5px}[_nghost-%COMP%]   .stats-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:transparent}.competencies[_ngcontent-%COMP%]{min-height:min-content;width:100%}"]})}return i})();export{Vn as CourseDashboardComponent};
//# sourceMappingURL=course-dashboard.component-RRN2DJ7L.js.map
