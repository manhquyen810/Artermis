import{a as K}from"./chunk-7P4SPTAP.js";import{a as X}from"./chunk-3FYXV53Z.js";import{a as H}from"./chunk-V55WZ52P.js";import{c as v}from"./chunk-CWEZ7BG4.js";import"./chunk-JCAGYDTX.js";import"./chunk-OI2L2OHD.js";import"./chunk-3JSWSN6W.js";import"./chunk-2UXGFGK3.js";import{d as g}from"./chunk-O4VJ5OXY.js";import{f as z,g as U}from"./chunk-BDII35IB.js";import"./chunk-LARBQRTJ.js";import"./chunk-GERFCPB6.js";import{a as R}from"./chunk-2QXIMOEO.js";import"./chunk-2CUFQLAH.js";import"./chunk-Z6NSEM73.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import{d as B}from"./chunk-CT44YL7Q.js";import"./chunk-EELXLOHY.js";import"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import"./chunk-WA5GEAJB.js";import"./chunk-5GXY5RYT.js";import{a as F}from"./chunk-K3W6YFKH.js";import{d as N}from"./chunk-EDXSOKK5.js";import"./chunk-R5BZWVRQ.js";import"./chunk-DID2YGL7.js";import"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Ka as V}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import"./chunk-NOBD5HSR.js";import{a as k}from"./chunk-U54OSGNH.js";import{f as D,h as j}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import{c as P}from"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import"./chunk-IOA4DPXY.js";import{Db as l,Dc as I,Ea as u,Ed as w,Ma as _,Mc as b,Na as C,Oc as S,Tb as A,Xb as M,Zb as h,cd as y,dd as t,ed as d,fd as T,kc as f,rd as E,sc as x,xc as r,yc as s,yd as O,zc as a,zd as L}from"./chunk-5LC5EQRR.js";import"./chunk-3E746U5Y.js";var W=n=>[n,600],G=n=>({interval:n}),Y=n=>({median:n});function q(n,c){n&1&&(t(0,`
                            `),a(1,"div",18),t(2,`
                        `))}function J(n,c){n&1&&(t(0,`
                                `),a(1,"b",21),t(2,`
                            `))}function Q(n,c){n&1&&(t(0,`
                                `),a(1,"b",22),t(2,`
                            `))}function Z(n,c){if(n&1&&(t(0,`
                            `),r(1,"b"),t(2),s(),t(3,`
                            `),h(4,J,3,0)(5,Q,3,0),a(6,"br"),t(7,`
                            `),a(8,"span",19),t(9,`
                            `),a(10,"br"),t(11,`
                            `),a(12,"b",20),t(13,`
                        `)),n&2){let i=c.model,e=S(2);l(2),T("",i.value," "),l(2),x(i.value!==1?4:-1),l(),x(i.value===1?5:-1),l(3),f("translateValues",E(5,G,i.label)),l(4),f("translateValues",E(7,Y,e.getMedianAmountOfAssessedSubmissions(i.label)))}}function $(n,c){if(n&1){let i=I();t(0,`
        `),r(1,"div"),t(2,`
            `),r(3,"table",6),t(4,`
                `),r(5,"tr"),t(6,`
                    `),r(7,"th"),a(8,"span",7),s(),t(9,`
                    `),r(10,"th"),a(11,"span",8),s(),t(12,`
                    `),r(13,"th"),a(14,"span",9),s(),t(15,`
                    `),r(16,"th",10),t(17,`
                        `),h(18,q,3,0),a(19,"span",11),t(20,`
                    `),s(),t(21,`
                    `),r(22,"th"),a(23,"span",12),s(),t(24,`
                `),s(),t(25,`
                `),r(26,"tr"),t(27,`
                    `),r(28,"td"),t(29),s(),t(30,`
                    `),r(31,"td"),t(32),s(),t(33,`
                    `),r(34,"td"),t(35),s(),t(36,`
                    `),r(37,"td"),t(38),s(),t(39,`
                    `),r(40,"td"),t(41),s(),t(42,`
                `),s(),t(43,`
                `),a(44,"tr"),t(45,`
            `),s(),t(46,`
            `),r(47,"div",13),t(48,`
                `),r(49,"div",14,0),t(51,`
                    `),r(52,"div",15),t(53,`
                        `),a(54,"h3",3),t(55,`
                        `),a(56,"jhi-help-icon",16),t(57,`
                    `),s(),t(58,`
                    `),r(59,"ngx-charts-bar-vertical",17),b("select",function(){_(i);let o=S();return C(o.onSelect())}),t(60,`
                        `),h(61,Z,14,9,"ng-template",null,1,w),t(63,`
                    `),s(),t(64,`
                `),s(),t(65,`
            `),s(),t(66,`
        `),s(),t(67,`
    `)}if(n&2){let i=y(50),e=S();l(18),x(e.showMedianLegend?18:-1),l(11),d(e.numberOfSubmissions?e.numberOfSubmissions:"0"),l(3),d(e.totalTimeSpent?e.totalTimeSpent:"< 1 min"),l(3),d(e.averageTimeSpent?e.averageTimeSpent:"0"),l(3),d(e.medianValue?e.medianValue:"0.00"),l(3),d(e.numberOfTutorsInvolvedInCourse?e.numberOfTutorsInvolvedInCourse:"0"),l(15),f("text","artemisApp.textExercise.tutorEffortStatistics.titleDescription")("placement","right auto"),l(3),f("roundEdges",!1)("view",E(20,W,i.offsetWidth))("scheme",e.ngxColor)("results",e.ngxData)("xAxis",!0)("yAxis",!0)("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxisLabel",e.xAxisLabel)("yAxisLabel",e.yAxisLabel)("yAxisTickFormatting",e.yAxisTickFormatting)("yScaleMax",e.yScaleMax)}}function tt(n,c){n&1&&(t(0,`
        `),r(1,"div",23),t(2,`
            `),a(3,"span",24),t(4,`
        `),s(),t(5,`
    `))}var bt=(()=>{class n extends K{route=u(D);router=u(j);textExerciseService=u(X);textAssessmentService=u(H);translateService=u(P);tutorEfforts=[];numberOfSubmissions;totalTimeSpent;averageTimeSpent;currentExerciseId;currentCourseId;numberOfTutorsInvolvedInCourse;effortDistribution;yScaleMax=10;medianValue;showMedianLegend=!1;bucketSize=10;xAxisLabel;yAxisLabel;faSync=V;constructor(){super(),this.translateService.onLangChange.subscribe(()=>{this.translateLabels()})}ngOnInit(){this.translateLabels(),this.ngxChartLabels=["[0-10)","[10-20)","[20-30)","[30-40)","[40-50)","[50-60)","[60-70)","[70-80)","[80-90)","[90-100)","[100-110)","[110-120)","120+"],this.ngxColor.domain=Array(13).fill(g.LIGHT_BLUE),this.route.params.subscribe(i=>{this.currentExerciseId=Number(i.exerciseId),this.currentCourseId=Number(i.courseId)}),this.loadTutorEfforts()}loadTutorEfforts(){this.textExerciseService.calculateTutorEffort(this.currentExerciseId,this.currentCourseId).subscribe(i=>{this.handleTutorEffortResponse(i)}),this.loadNumberOfTutorsInvolved()}handleTutorEffortResponse(i){if(this.tutorEfforts=i,!this.tutorEfforts)return;this.numberOfSubmissions=this.tutorEfforts.reduce((m,{numberOfSubmissionsAssessed:p})=>m+p,0);let e=this.tutorEfforts.reduce((m,{totalTimeSpentMinutes:p})=>m+p,0);this.totalTimeSpent=Math.round(e*10)/10;let o=this.totalTimeSpent===0?0:this.numberOfSubmissions/this.totalTimeSpent;this.averageTimeSpent=o?Math.round((o+Number.EPSILON)*100)/100:0,this.distributeEffortToSets(),this.ngxData=[],this.effortDistribution.forEach((m,p)=>{this.ngxData.push({name:this.ngxChartLabels[p],value:m})}),this.determineMaxChartHeight(this.effortDistribution),this.medianValue=this.computeEffortMedian(),this.highlightMedian(this.medianValue),this.ngxData=[...this.ngxData]}loadNumberOfTutorsInvolved(){this.textAssessmentService.getNumberOfTutorsInvolvedInAssessment(this.currentCourseId,this.currentExerciseId).subscribe(i=>{this.numberOfTutorsInvolvedInCourse=i})}distributeEffortToSets(){this.effortDistribution=new Array(this.ngxChartLabels.length).fill(0),this.tutorEfforts.forEach(i=>{let e=this.determineIndex(i.totalTimeSpentMinutes);this.effortDistribution[e]++})}onSelect(){this.router.navigate(["/course-management",this.currentCourseId,"assessment-dashboard",this.currentExerciseId])}getMedianAmountOfAssessedSubmissions(i){let e=this.ngxChartLabels.indexOf(i),o=this.identifyMinimumAndMaximumTimesSpent(e);return this.computeMedianAmountOfAssessedSubmissions(o)}determineMaxChartHeight(i){this.yScaleMax=Math.max(this.yScaleMax,...i)}translateLabels(){this.xAxisLabel=this.translateService.instant("artemisApp.textExercise.tutorEffortStatistics.minutes"),this.yAxisLabel=this.translateService.instant("artemisApp.textExercise.tutorEffortStatistics.tutors")}computeEffortMedian(){if(this.tutorEfforts.length===0)return 0;let i=this.tutorEfforts.map(e=>e.totalTimeSpentMinutes);return v(i)}determineIndex(i){let e=this.ngxChartLabels.length-1,o=i/this.bucketSize;return Math.min(Math.floor(o),e)}highlightMedian(i){let e=this.determineIndex(i);this.ngxData[e].value>0?(this.ngxColor.domain[e]=g.BLUE,this.showMedianLegend=!0):this.showMedianLegend=!1}computeMedianAmountOfAssessedSubmissions(i){let e;i.maximumTimeSpent?e=m=>m.totalTimeSpentMinutes>=i.minimumTimeSpent&&m.totalTimeSpentMinutes<i.maximumTimeSpent:e=m=>m.totalTimeSpentMinutes>=i.minimumTimeSpent;let o=this.tutorEfforts.filter(e);return B(v(o.map(m=>m.numberOfSubmissionsAssessed)),2)}identifyMinimumAndMaximumTimesSpent(i){let o=[0,10,20,30,40,50,60,70,80,90,100,110,120][i],m=o!==120?o+10:void 0;return{minimumTimeSpent:o,maximumTimeSpent:m}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=A({type:n,selectors:[["jhi-text-exercise-tutor-effort-statistics"]],features:[M],decls:16,vars:7,consts:[["containerRef",""],["tooltipTemplate",""],[1,"d-flex","flex-row","justify-content-between","align","items","center"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.title"],[1,"btn","btn-primary","btn-sm","mb-2",3,"click"],[3,"icon","fixedWidth"],[1,"table"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.numberOfSubmissionsAssessed"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.totalTimeSpent"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.averageTime"],[1,"d-flex","flex-row","align-items-center","justify-content-center"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.effortMedian"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.numberOfTutorsInvolved"],[1,"row","d-flex","justify-content-center"],[1,"col-10"],[1,"d-flex","flex-row","justify-content-center","align-items-center"],[3,"text","placement"],[3,"select","roundEdges","view","scheme","results","xAxis","yAxis","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","yAxisTickFormatting","yScaleMax"],[1,"color-legend"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.forMinutes",3,"translateValues"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.medianOfSubmissions",3,"translateValues"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.multipleTutors"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.singleTutor"],[1,"text-center"],["jhiTranslate","artemisApp.textExercise.tutorEffortStatistics.noData"]],template:function(e,o){e&1&&(r(0,"div"),t(1,`
    `),r(2,"div",2),t(3,`
        `),a(4,"h4",3),t(5,`
        `),r(6,"button",4),b("click",function(){return o.loadTutorEfforts()}),t(7,`
            `),a(8,"fa-icon",5),t(9),O(10,"artemisTranslate"),s(),t(11,`
    `),s(),t(12,`
    `),h(13,$,68,22)(14,tt,6,0),s(),t(15,`
`)),e&2&&(l(8),f("icon",o.faSync)("fixedWidth",!0),l(),T("\xA0",L(10,5,"artemisApp.showStatistic.recalculateStatistics"),`
        `),l(4),x(o.tutorEfforts&&o.tutorEfforts.length>0?13:-1),l(),x(o.tutorEfforts&&o.tutorEfforts.length===0||!o.tutorEfforts?14:-1))},dependencies:[k,N,R,U,z,F],styles:[".table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{text-align:start}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;font-size:x-large;font-weight:bolder}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:small;font-weight:400;text-align:center}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .color-legend[_ngcontent-%COMP%]{width:5px;height:5px;background:#5d8ac9;border-radius:3px}jhi-help-icon[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:.5rem;margin-left:5px}ngx-charts-bar-vertical[_ngcontent-%COMP%]{font-size:x-large;font-weight:bolder}"]})}return n})();export{bt as TutorEffortStatisticsComponent};
//# sourceMappingURL=tutor-effort-statistics.component-VB25O5ZL.js.map
