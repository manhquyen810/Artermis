import{a as c}from"./chunk-NOBD5HSR.js";import{O as b}from"./chunk-IOA4DPXY.js";import{Ea as T,h as l,j as u,ya as p}from"./chunk-5LC5EQRR.js";var o=function(t){return t.COURSE="COURSE",t.EXERCISE="EXERCISE",t.LECTURE="LECTURE",t.COMPETENCY="COMPETENCY",t.DIAGRAM="DIAGRAM",t.ORGANIZATION="ORGANIZATION",t.EXAM="EXAM",t.TUTORIAL_GROUP="TUTORIAL_GROUP",t}(o||{}),m=3e3,h=(()=>{class t{http=T(b);titleSubjects=new Map;getTitle(e,r){try{if(!e||!r?.length||r.some(i=>!i&&i!==0))return c(new Error(`Supplied invalid parameters to getTitle() of EntityTitleService: Type=${e}, ids=${r}`)),u;let a=t.createMapKey(e,r),{subject:s}=this.titleSubjects.computeIfAbsent(a,()=>({timeout:setTimeout(()=>this.fetchTitle(e,r),m),subject:new l(1)}));return s.asObservable()}catch(a){return c(a),u}}setTitle(e,r,a){try{if(!r?.length||r.some(E=>!E&&E!==0)||!a){c(new Error(`Supplied invalid parameters to setTitle() of EntityTitleService: Type=${e}, ids=${r}, title=${a}`));return}let s=t.createMapKey(e,r),{subject:i,timeout:n}=this.titleSubjects.computeIfAbsent(s,()=>({subject:new l(1)}));i.next(a),n&&clearTimeout(n)}catch(s){c(s)}}setExerciseTitle(e){e.exerciseGroup&&!e?.isAtLeastTutor?this.setTitle(o.EXERCISE,[e.id],e.exerciseGroup.title):this.setTitle(o.EXERCISE,[e.id],e.title)}fetchTitle(e,r){let a="api/";switch(e){case o.COURSE:a+="core/courses";break;case o.EXERCISE:a+="exercise/exercises";break;case o.LECTURE:a+="lecture/lectures";break;case o.COMPETENCY:a+="atlas/competencies";break;case o.DIAGRAM:a+="modeling/apollon-diagrams";break;case o.EXAM:a+="exam/exams";break;case o.ORGANIZATION:a+="core/organizations";break;case o.TUTORIAL_GROUP:a+="tutorialgroup/tutorial-groups";break}this.http.get(`${a}/${r[0]}/title`,{observe:"response",responseType:"text"}).subscribe(s=>{s.body&&this.setTitle(e,r,s.body)})}static createMapKey(e,r){return`${e}-${r.join("-")}`}static \u0275fac=function(r){return new(r||t)};static \u0275prov=p({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();export{o as a,h as b};
//# sourceMappingURL=chunk-XBLNBTXN.js.map
