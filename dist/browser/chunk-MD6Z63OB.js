import{a as f}from"./chunk-5ZXXURLP.js";import{L as g,O as m}from"./chunk-IOA4DPXY.js";import{Ea as h,P as p,g as u,oa as l,ra as a,s as o,ya as b,z as c}from"./chunk-5LC5EQRR.js";var $=class i{id;weight;bonusPoints;bonusMultiplier;visibility;constructor(e,t,s,r,n){this.id=e,this.weight=t,this.bonusPoints=s,this.bonusMultiplier=r,this.visibility=n}static from(e){return new i(e.id,e.weight,e.bonusPoints,e.bonusMultiplier,e.visibility)}},y=class i{id;penalty;maxPenalty;state;constructor(e,t,s,r){this.id=e,this.penalty=t,this.maxPenalty=s,this.state=r}static from(e){return new i(e.id,e.penalty,e.maxPenalty,e.state)}},U=(()=>{class i{websocketService=h(f);http=h(m);resourceUrl="api/programming/programming-exercises";connections={};subjects={};testCases=new Map;ngOnDestroy(){Object.values(this.connections).forEach(t=>this.websocketService.unsubscribe(t))}subscribeForTestCases(t){return this.subjects[t]?this.subjects[t]:this.getTestCases(t).pipe(c(s=>s.length?s:void 0),p(()=>o(void 0)),l(s=>(s&&this.testCases.set(t,s),this.initTestCaseSubscription(t,s))))}notifyTestCases(t,s){this.subjects[t]&&this.subjects[t].next(s)}getTestCases(t){return this.testCases.has(t)?o(this.testCases.get(t)):this.http.get(`${this.resourceUrl}/${t}/test-cases`).pipe(a(s=>{this.testCases.set(t,s)}))}updateTestCase(t,s){return this.http.patch(`${this.resourceUrl}/${t}/update-test-cases`,s)}getGradingStatistics(t){return this.http.get(`${this.resourceUrl}/${t}/grading/statistics`)}resetTestCases(t){return this.http.patch(`${this.resourceUrl}/${t}/test-cases/reset`,{})}reEvaluate(t){return this.http.put(`${this.resourceUrl}/${t}/grading/re-evaluate`,{})}initTestCaseSubscription(t,s){let r=`/topic/programming-exercises/${t}/test-cases`;return this.websocketService.subscribe(r),this.connections[t]=r,this.subjects[t]=new u(s),this.websocketService.receive(r).pipe(c(n=>n.length?n:void 0),a(n=>{n&&this.testCases.set(t,n),this.notifySubscribers(t,n)})).subscribe(),this.subjects[t]}notifySubscribers(t,s){this.subjects[t].next(s)}getCodeAnalysisCategories(t){return this.http.get(`${this.resourceUrl}/${t}/static-code-analysis-categories`)}updateCodeAnalysisCategories(t,s){return this.http.patch(`${this.resourceUrl}/${t}/static-code-analysis-categories`,s)}resetCategories(t){return this.http.patch(`${this.resourceUrl}/${t}/static-code-analysis-categories/reset`,{})}importCategoriesFromExercise(t,s){let r=new g().set("sourceExerciseId",s);return this.http.patch(`${this.resourceUrl}/${t}/static-code-analysis-categories/import`,{},{params:r})}static \u0275fac=function(s){return new(s||i)};static \u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();export{$ as a,y as b,U as c};
//# sourceMappingURL=chunk-MD6Z63OB.js.map
