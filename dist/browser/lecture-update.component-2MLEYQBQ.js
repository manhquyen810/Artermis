import{a as oe}from"./chunk-CFJ5GCKD.js";import{a as et}from"./chunk-DRT3JEBM.js";import{b as re}from"./chunk-UQA7EKND.js";import{a as ae}from"./chunk-SCKWR57U.js";import{a as Xe}from"./chunk-IL7JUOEF.js";import{a as Ge}from"./chunk-3T3Y3KKP.js";import{a as Ke}from"./chunk-VWWNT6V2.js";import{a as Ze}from"./chunk-USEVVH46.js";import{a as $e,b as ne}from"./chunk-5MIORMFK.js";import{a as ee}from"./chunk-T3DAFG3B.js";import{a as Je,b as te}from"./chunk-KO36B5XH.js";import{a as Ye,b as ie}from"./chunk-BGOKISYV.js";import"./chunk-2D32KPWA.js";import"./chunk-7MKMUXV6.js";import{a as He,b as ue}from"./chunk-KU7ZFTWF.js";import"./chunk-CDMXF7Y5.js";import"./chunk-TXYCUEEB.js";import"./chunk-477H2IQN.js";import"./chunk-KIXGOQMJ.js";import"./chunk-UBFIUABE.js";import"./chunk-KNK6NHCW.js";import"./chunk-FLTLUO4X.js";import"./chunk-GM5QZPKO.js";import"./chunk-IJRVZ46L.js";import"./chunk-NUC4ZXFE.js";import"./chunk-FLFES4R7.js";import{a as qe}from"./chunk-X4L2PWEV.js";import"./chunk-47G2PPX4.js";import{a as ze}from"./chunk-33RKLPG3.js";import"./chunk-AYOCTQ7R.js";import{a as Re}from"./chunk-PVMY5D66.js";import"./chunk-SBDPY7ZH.js";import"./chunk-MVBHDJDH.js";import"./chunk-POPNQ63B.js";import"./chunk-RPFDXKEJ.js";import"./chunk-SKB5UJGX.js";import"./chunk-TBEJU7WR.js";import"./chunk-SUUJN3EQ.js";import"./chunk-YOWUV6EQ.js";import"./chunk-X3HHHVRJ.js";import{a as Q}from"./chunk-EHCOTJGL.js";import"./chunk-4NYYKXW4.js";import"./chunk-5A2TLSYI.js";import"./chunk-MY22ELD7.js";import"./chunk-T4L3VFV2.js";import"./chunk-YSX3GO3R.js";import"./chunk-W3K7VYWC.js";import"./chunk-QU4DXSXD.js";import"./chunk-DOLVNMRR.js";import{D as Qe}from"./chunk-RTOKZMYN.js";import"./chunk-5QODR5GQ.js";import{b as Be,c as We}from"./chunk-RNPAFOPW.js";import"./chunk-KZGAUMRM.js";import"./chunk-656XE4CO.js";import"./chunk-YGSJB6WY.js";import"./chunk-O2WHE2S3.js";import"./chunk-JJUII2KT.js";import"./chunk-U4DJRHYQ.js";import"./chunk-QZKVSIAC.js";import"./chunk-JRBFEQNN.js";import"./chunk-DIZEKHOC.js";import"./chunk-V7PDYRDZ.js";import"./chunk-EANMTTQG.js";import"./chunk-PNTOXB52.js";import"./chunk-22YQSX6Z.js";import"./chunk-R56P6PAY.js";import"./chunk-65Z25AP3.js";import"./chunk-5M3YV54C.js";import"./chunk-RYZEETVB.js";import"./chunk-VTF2OQPK.js";import"./chunk-BNRTXX46.js";import"./chunk-VPHPBAVR.js";import"./chunk-N4VVKRBU.js";import"./chunk-5AQXEKLE.js";import"./chunk-3JSWSN6W.js";import"./chunk-7XNS72RJ.js";import"./chunk-KYCCMZSV.js";import"./chunk-DXTZ4GAW.js";import"./chunk-2UXGFGK3.js";import"./chunk-O4VJ5OXY.js";import"./chunk-BDII35IB.js";import"./chunk-LARBQRTJ.js";import"./chunk-OTNXTVPX.js";import"./chunk-Z2YUBN6N.js";import"./chunk-OTCBNILH.js";import"./chunk-AO5E7TEY.js";import"./chunk-PA7LJOOC.js";import"./chunk-AOI2U3YC.js";import{b as $}from"./chunk-TECMX7AA.js";import"./chunk-USOMQCKZ.js";import"./chunk-6EYB5QBP.js";import"./chunk-GERFCPB6.js";import"./chunk-VRAVBLUK.js";import"./chunk-T624HJJL.js";import"./chunk-HQTS6JOY.js";import"./chunk-HMZID6NQ.js";import"./chunk-O26CMRR4.js";import"./chunk-MP6UGYTC.js";import"./chunk-VWRLJYRR.js";import"./chunk-2QXIMOEO.js";import"./chunk-KK6FVDB6.js";import"./chunk-JHBUBEY6.js";import{a as ke}from"./chunk-UDBRF4PR.js";import"./chunk-QH7SWO42.js";import"./chunk-P2M2VQE3.js";import"./chunk-GXOKLIFX.js";import"./chunk-5JBXU6VG.js";import"./chunk-4I367PEU.js";import"./chunk-QA7Y7QBM.js";import{b as Ne}from"./chunk-ZPITQMA6.js";import"./chunk-AZBLKUAM.js";import"./chunk-HK7MJBP6.js";import"./chunk-2CUFQLAH.js";import{a as Ie}from"./chunk-DRMCDU75.js";import"./chunk-MKPB4JKY.js";import"./chunk-I76AVIQH.js";import"./chunk-H2ETPEH6.js";import"./chunk-Z6NSEM73.js";import"./chunk-AR57MWOI.js";import"./chunk-A5PTZAPN.js";import"./chunk-AU6UEH3U.js";import"./chunk-FGAONQTL.js";import"./chunk-HQ6UGNQX.js";import{a as Me}from"./chunk-ZLJ76G5I.js";import{a as C}from"./chunk-MLVGKM2P.js";import"./chunk-CK7FH6VF.js";import"./chunk-PUNMJFMR.js";import"./chunk-R75LTV62.js";import{c as k}from"./chunk-5MVJAZRV.js";import"./chunk-XBLNBTXN.js";import"./chunk-G3JOQOSD.js";import"./chunk-G4I63THF.js";import"./chunk-PZ7IDTIM.js";import"./chunk-UHM5AJSI.js";import"./chunk-CT44YL7Q.js";import"./chunk-JNO6DNVW.js";import{a as de}from"./chunk-5YQ3ACZE.js";import"./chunk-EELXLOHY.js";import{K as Fe}from"./chunk-VZRSC3LP.js";import"./chunk-5SKDOIBQ.js";import{K,c as Ee,h as G,i as we,k as Le,m as J,n as be}from"./chunk-WA5GEAJB.js";import"./chunk-DRSQQEUE.js";import"./chunk-7XXWL6ER.js";import"./chunk-GG62Q4DZ.js";import"./chunk-VK7JPHFE.js";import"./chunk-BNDLMKXK.js";import"./chunk-BQNBT6PW.js";import{e as me}from"./chunk-5GXY5RYT.js";import{a as Z}from"./chunk-K3W6YFKH.js";import"./chunk-TL3DYXRE.js";import{c as Y}from"./chunk-JXJXC4DZ.js";import{d as je}from"./chunk-EDXSOKK5.js";import"./chunk-R5BZWVRQ.js";import{p as I}from"./chunk-DID2YGL7.js";import"./chunk-CXQURQM5.js";import"./chunk-S4QLGR2R.js";import{Wa as Ae,fa as De,kb as Oe,tb as Ve}from"./chunk-Z4VHWOB5.js";import"./chunk-XUCCGZJR.js";import"./chunk-HKBU2OOC.js";import"./chunk-5ZXXURLP.js";import{a as Pe}from"./chunk-NOBD5HSR.js";import{a as B}from"./chunk-U54OSGNH.js";import{f as X,h as Te}from"./chunk-M6Z6DKZQ.js";import"./chunk-3Y6745HG.js";import"./chunk-E2KBL4LX.js";import"./chunk-PZTBTDSR.js";import"./chunk-IOA4DPXY.js";import{Ad as ye,Db as s,Dc as g,Ea as v,Ma as p,Mb as S,Mc as f,Na as h,Nb as _e,Oc as d,Pb as Ce,Qd as j,Rc as R,Rd as z,Tb as O,Yc as Ue,Za as fe,Zb as T,Zc as xe,_c as ve,a as he,ab as b,ad as x,bd as V,cd as H,dd as t,fd as Se,kc as u,ld as F,md as E,nd as P,rd as ge,sc as _,xc as o,yc as a,yd as D,zc as m,zd as M}from"./chunk-5LC5EQRR.js";import"./chunk-3E746U5Y.js";var se=(()=>{class r{lecture;titleChannelNameComponent=S.required(re);hideChannelNameInput=!1;ngOnInit(){this.hideChannelNameInput=!this.requiresChannelName(this.lecture)}requiresChannelName(e){return Ne(e.course)?e.id===void 0?!0:e.channelName!==void 0:!1}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=O({type:r,selectors:[["jhi-lecture-title-channel-name"]],viewQuery:function(n,i){n&1&&x(i.titleChannelNameComponent,re,5),n&2&&V()},inputs:{lecture:"lecture"},decls:2,vars:6,consts:[["channelNamePrefix","lecture-",3,"titleChange","channelNameChange","title","channelName","hideTitleLabel","emphasizeLabels","hideChannelName","initChannelName"]],template:function(n,i){n&1&&(o(0,"jhi-title-channel-name",0),P("titleChange",function(l){return E(i.lecture.title,l)||(i.lecture.title=l),l})("channelNameChange",function(l){return E(i.lecture.channelName,l)||(i.lecture.channelName=l),l}),a(),t(1,`
`)),n&2&&(F("title",i.lecture.title)("channelName",i.lecture.channelName),u("hideTitleLabel",!1)("emphasizeLabels",!1)("hideChannelName",i.hideChannelNameInput)("initChannelName",i.lecture.id===void 0))},dependencies:[re],encapsulation:2})}return r})();var ce=(()=>{class r{lecture=fe.required();validateDatesFunction;periodSectionDatepickers=_e($);isPeriodSectionValid=j(()=>{for(let e of this.periodSectionDatepickers())if(!e.isValid())return!1;return!0});static \u0275fac=function(n){return new(n||r)};static \u0275cmp=O({type:r,selectors:[["jhi-lecture-update-period"]],viewQuery:function(n,i){n&1&&x(i.periodSectionDatepickers,$,5),n&2&&V()},inputs:{lecture:[1,"lecture"],validateDatesFunction:"validateDatesFunction"},decls:30,vars:12,consts:[["id","artemisApp.lecture.sections.period"],["jhiTranslate","artemisApp.lecture.sections.period"],["jhiTranslate","artemisApp.lecture.sections.periodDescription"],[1,"d-flex"],[1,"form-group","flex-grow-1"],["name","visibleDate","id","visible-date",3,"ngModelChange","valueChange","labelName","ngModel"],[1,"form-group","flex-grow-1","ms-3"],["name","startDate","id","start-date",3,"ngModelChange","valueChange","labelName","ngModel"],["name","endDate","id","end-date",3,"ngModelChange","valueChange","labelName","ngModel"]],template:function(n,i){n&1&&(o(0,"div"),t(1,`
    `),o(2,"h3",0),m(3,"span",1),a(),t(4,`
    `),o(5,"p"),m(6,"span",2),a(),t(7,`
    `),o(8,"div",3),t(9,`
        `),o(10,"div",4),t(11,`
            `),o(12,"jhi-date-time-picker",5),D(13,"artemisTranslate"),P("ngModelChange",function(l){return E(i.lecture().visibleDate,l)||(i.lecture().visibleDate=l),l}),f("valueChange",function(){return i.validateDatesFunction()}),a(),t(14,`
        `),a(),t(15,`
        `),o(16,"div",6),t(17,`
            `),o(18,"jhi-date-time-picker",7),D(19,"artemisTranslate"),P("ngModelChange",function(l){return E(i.lecture().startDate,l)||(i.lecture().startDate=l),l}),f("valueChange",function(){return i.validateDatesFunction()}),a(),t(20,`
        `),a(),t(21,`
        `),o(22,"div",6),t(23,`
            `),o(24,"jhi-date-time-picker",8),D(25,"artemisTranslate"),P("ngModelChange",function(l){return E(i.lecture().endDate,l)||(i.lecture().endDate=l),l}),f("valueChange",function(){return i.validateDatesFunction()}),a(),t(26,`
        `),a(),t(27,`
    `),a(),t(28,`
`),a(),t(29,`
`)),n&2&&(s(12),R("labelName",M(13,6,"artemisApp.lecture.visibleDate")),F("ngModel",i.lecture().visibleDate),s(6),R("labelName",M(19,8,"artemisApp.lecture.startDate")),F("ngModel",i.lecture().startDate),s(6),R("labelName",M(25,10,"artemisApp.lecture.endDate")),F("ngModel",i.lecture().endDate))},dependencies:[B,$,K,G,J,Z],encapsulation:2})}return r})();function nt(r,U){r&1&&(t(0,`
            `),o(1,"h4"),m(2,"span",6),a(),t(3,`
        `))}function rt(r,U){r&1&&(t(0,`
            `),o(1,"h4"),m(2,"span",7),a(),t(3,`
        `))}function ot(r,U){if(r&1){let e=g();t(0,`
            `),o(1,"jhi-text-unit-form",8),f("onCancel",function(){p(e);let i=d();return h(i.onCloseLectureUnitForms())})("formSubmitted",function(i){p(e);let c=d();return h(c.createEditTextUnit(i))}),a(),t(2,`
        `)}if(r&2){let e=d();s(),u("isEditMode",e.isEditingLectureUnit)("hasCancelButton",!0)("formData",e.textUnitFormData)}}function at(r,U){if(r&1){let e=g();t(0,`
            `),o(1,"jhi-video-unit-form",8),f("onCancel",function(){p(e);let i=d();return h(i.onCloseLectureUnitForms())})("formSubmitted",function(i){p(e);let c=d();return h(c.createEditVideoUnit(i))}),a(),t(2,`
        `)}if(r&2){let e=d();s(),u("isEditMode",e.isEditingLectureUnit)("hasCancelButton",!0)("formData",e.videoUnitFormData)}}function st(r,U){if(r&1){let e=g();t(0,`
            `),o(1,"jhi-online-unit-form",8),f("onCancel",function(){p(e);let i=d();return h(i.onCloseLectureUnitForms())})("formSubmitted",function(i){p(e);let c=d();return h(c.createEditOnlineUnit(i))}),a(),t(2,`
        `)}if(r&2){let e=d();s(),u("isEditMode",e.isEditingLectureUnit)("hasCancelButton",!0)("formData",e.onlineUnitFormData)}}function ct(r,U){if(r&1){let e=g();t(0,`
            `),o(1,"jhi-attachment-unit-form",8),f("onCancel",function(){p(e);let i=d();return h(i.onCloseLectureUnitForms())})("formSubmitted",function(i){p(e);let c=d();return h(c.createEditAttachmentUnit(i))}),a(),t(2,`
        `)}if(r&2){let e=d();s(),u("isEditMode",e.isEditingLectureUnit)("hasCancelButton",!0)("formData",e.attachmentUnitFormData)}}function lt(r,U){if(r&1){let e=g();t(0,`
            `),o(1,"jhi-create-exercise-unit",9),f("onExerciseUnitCreated",function(){p(e);let i=d();return h(i.onExerciseUnitCreated())})("onCancel",function(){p(e);let i=d();return h(i.onCloseLectureUnitForms())}),a(),t(2,`
        `)}if(r&2){let e=d();s(),u("shouldNavigateOnSubmit",!1)("lectureId",e.lecture.id)("courseId",e.lecture.course==null?null:e.lecture.course.id)("hasCancelButton",!0)}}var le=(()=>{class r{activatedRoute=v(X);alertService=v(Y);textUnitService=v($e);videoUnitService=v(Je);onlineUnitService=v(Ye);attachmentUnitService=v(Re);lecture;unitManagementComponent;textUnitForm=S(ne);videoUnitForm=S(te);onlineUnitForm=S(ie);attachmentUnitForm=S(ee);isUnitConfigurationValid=j(()=>(this.textUnitForm()?.isFormValid()||!this.isTextUnitFormOpen())&&(this.videoUnitForm()?.isFormValid()||!this.isVideoUnitFormOpen())&&(this.onlineUnitForm()?.isFormValid()||!this.isOnlineUnitFormOpen())&&(this.attachmentUnitForm()?.isFormValid()||!this.isAttachmentUnitFormOpen()));isEditingLectureUnit;isTextUnitFormOpen=b(!1);isExerciseUnitFormOpen=b(!1);isVideoUnitFormOpen=b(!1);isOnlineUnitFormOpen=b(!1);isAttachmentUnitFormOpen=b(!1);currentlyProcessedTextUnit;currentlyProcessedVideoUnit;currentlyProcessedOnlineUnit;currentlyProcessedAttachmentUnit;textUnitFormData;videoUnitFormData;onlineUnitFormData;attachmentUnitFormData;ngOnInit(){this.activatedRoute.queryParams.subscribe(e=>{e.shouldOpenCreateExercise&&this.onCreateLectureUnit(C.EXERCISE)})}onCreateLectureUnit(e){switch(this.isEditingLectureUnit=!1,this.onCloseLectureUnitForms(),e){case C.TEXT:this.isTextUnitFormOpen.set(!0);break;case C.EXERCISE:this.isExerciseUnitFormOpen.set(!0);break;case C.VIDEO:this.isVideoUnitFormOpen.set(!0);break;case C.ONLINE:this.isOnlineUnitFormOpen.set(!0);break;case C.ATTACHMENT:this.isAttachmentUnitFormOpen.set(!0);break}}isAnyUnitFormOpen=j(()=>this.isTextUnitFormOpen()||this.isVideoUnitFormOpen()||this.isOnlineUnitFormOpen()||this.isAttachmentUnitFormOpen()||this.isExerciseUnitFormOpen());onCloseLectureUnitForms(){this.isTextUnitFormOpen.set(!1),this.isVideoUnitFormOpen.set(!1),this.isOnlineUnitFormOpen.set(!1),this.isAttachmentUnitFormOpen.set(!1),this.isExerciseUnitFormOpen.set(!1)}createEditTextUnit(e){if(!e?.name)return;let{name:n,releaseDate:i,content:c,competencyLinks:l}=e;this.currentlyProcessedTextUnit=this.isEditingLectureUnit?this.currentlyProcessedTextUnit:new Ze,this.currentlyProcessedTextUnit.name=n,this.currentlyProcessedTextUnit.releaseDate=i,this.currentlyProcessedTextUnit.content=c,this.currentlyProcessedTextUnit.competencyLinks=l,(this.isEditingLectureUnit?this.textUnitService.update(this.currentlyProcessedTextUnit,this.lecture.id):this.textUnitService.create(this.currentlyProcessedTextUnit,this.lecture.id)).subscribe({next:()=>{this.onCloseLectureUnitForms(),this.unitManagementComponent.loadData()},error:y=>k(this.alertService,y)})}createEditVideoUnit(e){if(!e?.name||!e?.source)return;let{name:n,description:i,releaseDate:c,source:l,competencyLinks:y}=e;this.currentlyProcessedVideoUnit=this.isEditingLectureUnit?this.currentlyProcessedVideoUnit:new Ge,this.currentlyProcessedVideoUnit.name=n||void 0,this.currentlyProcessedVideoUnit.releaseDate=c||void 0,this.currentlyProcessedVideoUnit.description=i||void 0,this.currentlyProcessedVideoUnit.source=l||void 0,this.currentlyProcessedVideoUnit.competencyLinks=y,(this.isEditingLectureUnit?this.videoUnitService.update(this.currentlyProcessedVideoUnit,this.lecture.id):this.videoUnitService.create(this.currentlyProcessedVideoUnit,this.lecture.id)).subscribe({next:()=>{this.onCloseLectureUnitForms(),this.unitManagementComponent.loadData()},error:w=>k(this.alertService,w)})}createEditOnlineUnit(e){if(!e?.name||!e?.source)return;let{name:n,description:i,releaseDate:c,source:l,competencyLinks:y}=e;this.currentlyProcessedOnlineUnit=this.isEditingLectureUnit?this.currentlyProcessedOnlineUnit:new Ke,this.currentlyProcessedOnlineUnit.name=n||void 0,this.currentlyProcessedOnlineUnit.releaseDate=c||void 0,this.currentlyProcessedOnlineUnit.description=i||void 0,this.currentlyProcessedOnlineUnit.source=l||void 0,this.currentlyProcessedOnlineUnit.competencyLinks=y||void 0,(this.isEditingLectureUnit?this.onlineUnitService.update(this.currentlyProcessedOnlineUnit,this.lecture.id):this.onlineUnitService.create(this.currentlyProcessedOnlineUnit,this.lecture.id)).subscribe({next:()=>{this.onCloseLectureUnitForms(),this.unitManagementComponent.loadData()},error:w=>k(this.alertService,w)})}createEditAttachmentUnit(e){if(!e?.formProperties?.name||!e?.fileProperties?.file||!e?.fileProperties?.fileName)return;let{description:n,name:i,releaseDate:c,updateNotificationText:l,competencyLinks:y}=e.formProperties,{file:w,fileName:W}=e.fileProperties;this.currentlyProcessedAttachmentUnit=this.isEditingLectureUnit?this.currentlyProcessedAttachmentUnit:new qe;let L=this.isEditingLectureUnit?this.currentlyProcessedAttachmentUnit.attachment:new Xe;this.isEditingLectureUnit&&(this.currentlyProcessedAttachmentUnit.attachment=void 0,L.attachmentUnit=void 0);let q;l&&(q=l),i&&(L.name=i),c&&(L.releaseDate=c),L.attachmentType="FILE",L.version=1,L.uploadDate=I(),n&&(this.currentlyProcessedAttachmentUnit.description=n),this.currentlyProcessedAttachmentUnit.competencyLinks=y;let N=new FormData;N.append("file",w,W),N.append("attachment",de(L)),N.append("attachmentUnit",de(this.currentlyProcessedAttachmentUnit)),(this.isEditingLectureUnit?this.attachmentUnitService.update(this.lecture.id,this.currentlyProcessedAttachmentUnit.id,N,q):this.attachmentUnitService.create(N,this.lecture.id)).subscribe({next:()=>{this.onCloseLectureUnitForms(),this.unitManagementComponent.loadData()},error:A=>{A.error?.params==="file"&&A?.error?.title?this.alertService.error(A.error.title):k(this.alertService,A)}})}onExerciseUnitCreated(){this.onCloseLectureUnitForms(),this.unitManagementComponent.loadData()}startEditLectureUnit(e){switch(this.isEditingLectureUnit=!0,e.lecture=new Q,e.lecture.id=this.lecture.id,e.lecture.course=this.lecture.course,this.currentlyProcessedTextUnit=e,this.currentlyProcessedVideoUnit=e,this.currentlyProcessedOnlineUnit=e,this.currentlyProcessedAttachmentUnit=e,this.isTextUnitFormOpen.set(e.type===C.TEXT),this.isVideoUnitFormOpen.set(e.type===C.VIDEO),this.isExerciseUnitFormOpen.set(e.type===C.EXERCISE),this.isOnlineUnitFormOpen.set(e.type===C.ONLINE),this.isAttachmentUnitFormOpen.set(e.type===C.ATTACHMENT),e.type){case C.TEXT:this.textUnitFormData={name:this.currentlyProcessedTextUnit.name,releaseDate:this.currentlyProcessedTextUnit.releaseDate,content:this.currentlyProcessedTextUnit.content};break;case C.VIDEO:this.videoUnitFormData={name:this.currentlyProcessedVideoUnit.name,description:this.currentlyProcessedVideoUnit.description,releaseDate:this.currentlyProcessedVideoUnit.releaseDate,source:this.currentlyProcessedVideoUnit.source};break;case C.ONLINE:this.onlineUnitFormData={name:this.currentlyProcessedOnlineUnit.name,description:this.currentlyProcessedOnlineUnit.description,releaseDate:this.currentlyProcessedOnlineUnit.releaseDate,source:this.currentlyProcessedOnlineUnit.source};break;case C.ATTACHMENT:this.attachmentUnitFormData={formProperties:{name:this.currentlyProcessedAttachmentUnit.attachment.name,description:this.currentlyProcessedAttachmentUnit.description,releaseDate:this.currentlyProcessedAttachmentUnit.attachment.releaseDate,version:this.currentlyProcessedAttachmentUnit.attachment.version},fileProperties:{fileName:this.currentlyProcessedAttachmentUnit.attachment.link}};break}}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=O({type:r,selectors:[["jhi-lecture-update-units"]],viewQuery:function(n,i){if(n&1&&(x(i.textUnitForm,ne,5),x(i.videoUnitForm,te,5),x(i.onlineUnitForm,ie,5),x(i.attachmentUnitForm,ee,5),Ue(ue,5)),n&2){V(4);let c;xe(c=ve())&&(i.unitManagementComponent=c.first)}},inputs:{lecture:"lecture"},decls:26,vars:11,consts:[["jhiTranslate","artemisApp.lecture.sections.units"],["jhiTranslate","artemisApp.lecture.sections.unitsDescription"],[3,"onEditLectureUnitClicked","lectureId","emitEditEvents","showCreationCard","showCompetencies"],[1,"form-group","w-100","d-flex","justify-content-start"],[3,"onUnitCreationCardClicked","emitEvents"],[1,"form-group"],["jhiTranslate","artemisApp.lecture.editLectureUnit"],["jhiTranslate","artemisApp.lecture.newLectureUnit"],[3,"onCancel","formSubmitted","isEditMode","hasCancelButton","formData"],[3,"onExerciseUnitCreated","onCancel","shouldNavigateOnSubmit","lectureId","courseId","hasCancelButton"]],template:function(n,i){n&1&&(o(0,"div"),t(1,`
    `),o(2,"h3"),m(3,"span",0),a(),t(4,`
    `),o(5,"p"),m(6,"span",1),a(),t(7,`
    `),o(8,"jhi-lecture-unit-management",2),f("onEditLectureUnitClicked",function(l){return i.startEditLectureUnit(l)}),a(),t(9,`
    `),o(10,"div",3),t(11,`
        `),o(12,"jhi-unit-creation-card",4),f("onUnitCreationCardClicked",function(l){return i.onCreateLectureUnit(l)}),a(),t(13,`
    `),a(),t(14,`
    `),o(15,"div",5),t(16,`
        `),T(17,nt,4,0)(18,rt,4,0)(19,ot,3,3)(20,at,3,3)(21,st,3,3)(22,ct,3,3)(23,lt,3,4),a(),t(24,`
`),a(),t(25,`
`)),n&2&&(s(8),u("lectureId",i.lecture.id)("emitEditEvents",!0)("showCreationCard",!1)("showCompetencies",!1),s(4),u("emitEvents",!0),s(5),_(i.isEditingLectureUnit?17:i.isAnyUnitFormOpen()?18:-1),s(2),_(i.isTextUnitFormOpen()?19:-1),s(),_(i.isVideoUnitFormOpen()?20:-1),s(),_(i.isOnlineUnitFormOpen()?21:-1),s(),_(i.isAttachmentUnitFormOpen()?22:-1),s(),_(i.isExerciseUnitFormOpen()?23:-1))},dependencies:[B,ue,He,ne,te,ie,ee,ze],encapsulation:2})}return r})();var mt=r=>({extensions:r});function dt(r,U){if(r&1){let e=g();t(0,`
                        `),o(1,"div",21),t(2,`
                            `),m(3,"label",22),t(4,`
                            `),o(5,"div",4),t(6,`
                                `),o(7,"input",23),P("ngModelChange",function(i){p(e);let c=d();return E(c.courseTitle,i)||(c.courseTitle=i),h(i)}),a(),t(8,`
                            `),a(),t(9,`
                        `),a(),t(10,`
                    `)}if(r&2){let e=d();s(7),F("ngModel",e.courseTitle)}}function ut(r,U){if(r&1){let e=g();t(0,`
                        `),o(1,"div",24),t(2,`
                            `),m(3,"label",25),t(4,`
                            `),o(5,"jhi-markdown-editor-monaco",26),P("markdownChange",function(i){p(e);let c=d();return E(c.lecture().description,i)||(c.lecture().description=i),h(i)}),f("markdownChange",function(){p(e);let i=d();return h(i.updateIsChangesMadeToTitleOrPeriodSection())}),a(),t(6,`
                        `),a(),t(7,`
                    `)}if(r&2){let e=d();s(5),u("domainActions",e.domainActionsDescription),F("markdown",e.lecture().description)}}function pt(r,U){if(r&1&&(t(0,`
                    `),o(1,"div"),t(2,`
                        `),o(3,"h3",27),m(4,"span",28),a(),t(5,`
                        `),o(6,"p",29),t(7,`
                            `),m(8,"span",30),t(9,`
                        `),a(),t(10,`
                        `),m(11,"jhi-lecture-attachments",31),t(12,`
                    `),a(),t(13,`
                `)),r&2){let e=d();s(11),u("lectureId",e.lecture().id)("showHeader",!1)}}function ht(r,U){if(r&1){let e=g();t(0,`
                `),o(1,"div",32),t(2,`
                    `),m(3,"jhi-lecture-update-units",13),t(4,`
                    `),o(5,"div",33),t(6,`
                        `),o(7,"input",34),f("change",function(){p(e);let i=d();return h(i.onSelectProcessUnit())}),a(),t(8,`
                        `),m(9,"span",35),t(10,`
                        `),m(11,"fa-icon",36),D(12,"artemisTranslate"),t(13,`
                    `),a(),t(14,`
                `),a(),t(15,`
            `)}if(r&2){let e=d(),n=H(5);s(3),u("lecture",e.lecture()),s(4),u("disabled",n.form.invalid||e.isSaving),s(4),u("icon",e.faQuestionCircle)("ngbTooltip",M(12,4,"artemisApp.attachmentUnit.createAttachmentUnits.lectureFileToolTip"))}}function ft(r,U){r&1&&(t(0,`
                `),o(1,"div",37),t(2,`
                    `),o(3,"ul",38),t(4,`
                        `),m(5,"li",39),t(6,`
                        `),m(7,"li",40),t(8,`
                        `),m(9,"li",41),t(10,`
                    `),a(),t(11,`
                `),a(),t(12,`
            `))}function _t(r,U){r&1&&(t(0,`
                        `),m(1,"div",46),t(2,`
                    `))}function Ct(r,U){if(r&1){let e=g();t(0,`
                `),o(1,"div",21),t(2,`
                    `),o(3,"label"),t(4),D(5,"artemisTranslate"),a(),t(6,`
                    `),m(7,"small",42),t(8,`
                    `),m(9,"fa-icon",36),D(10,"artemisTranslate"),t(11,`
                    `),o(12,"div",43),t(13,`
                        `),o(14,"div",44),t(15,`
                            `),o(16,"input",45),D(17,"artemisTranslate"),f("change",function(i){p(e);let c=d();return h(c.onFileChange(i))})("click",function(){p(e);let i=d();return h(i.fileInputTouched=!0)}),a(),t(18,`
                        `),a(),t(19,`
                    `),a(),t(20,`
                    `),T(21,_t,3,0),a(),t(22,`
            `)}if(r&2){let e=d();s(4),Se("",M(5,6,"artemisApp.attachmentUnit.createAttachmentUnit.file"),"*"),s(5),u("icon",e.faQuestionCircle)("ngbTooltip",ye(10,8,"artemisApp.attachmentUnit.createAttachmentUnit.fileLimitationTooltip",ge(13,mt,e.allowedFileExtensions))),s(7),u("accept",e.acceptedFileExtensionsFileBrowser)("placeholder",M(17,11,"artemisApp.attachmentUnit.createAttachmentUnit.chooseFile")),s(5),_(!e.fileName&&e.fileInputTouched?21:-1)}}function Ut(r,U){r&1&&(t(0,`
                                    `),m(1,"span",51),t(2,`
                                `))}function xt(r,U){if(r&1){let e=g();t(0,`
                    `),o(1,"div",47),t(2,`
                        `),o(3,"div",48),t(4,`
                            `),o(5,"button",49),f("click",function(){p(e);let i=d();return h(i.proceedToUnitSplit())}),t(6,`
                                `),m(7,"fa-icon",17)(8,"span",50),t(9,`
                                `),T(10,Ut,3,0),a(),t(11,`
                        `),a(),t(12,`
                    `),a(),t(13,`
                `)}if(r&2){let e=d(),n=H(5);s(5),u("disabled",n.form.invalid||e.isSaving||!e.processUnitMode||e.isProcessing||!e.fileName),s(2),u("icon",e.faPuzzleProcess),s(3),_(e.isProcessing?10:-1)}}var ki=(()=>{class r{documentationType="Lecture";faQuestionCircle=Oe;faSave=Ve;faPuzzleProcess=Ae;faBan=De;allowedFileExtensions=Be;acceptedFileExtensionsFileBrowser=We;alertService=v(Y);lectureService=v(Me);activatedRoute=v(X);navigationUtilService=v(Ie);router=v(Te);titleSection=S.required(se);lecturePeriodSection=S.required(ce);attachmentsSection=S(ae);unitSection=S(le);formStatusBar=S(oe);courseTitle=Ce("");lecture=b(new Q);lectureOnInit;isEditMode=b(!1);isSaving;isProcessing;processUnitMode;formStatusSections;courses;domainActionsDescription=[new et];file;fileName;fileInputTouched=!1;isNewlyCreatedExercise=!1;isChangeMadeToTitleOrPeriodSection=!1;shouldDisplayDismissWarning=!0;areSectionsValid=j(()=>this.titleSection().titleChannelNameComponent().isFormValidSignal()&&this.lecturePeriodSection().isPeriodSectionValid()&&(this.unitSection()?.isUnitConfigurationValid()??!0)&&(this.attachmentsSection()?.isFormValid()??!0));subscriptions=new he;constructor(){z(()=>{this.titleSection()?.titleChannelNameComponent()&&this.lecturePeriodSection()&&(this.subscriptions.add(this.titleSection().titleChannelNameComponent().titleChange.subscribe(()=>{this.updateIsChangesMadeToTitleOrPeriodSection()})),this.subscriptions.add(this.titleSection().titleChannelNameComponent().channelNameChange.subscribe(()=>{this.updateIsChangesMadeToTitleOrPeriodSection()})),this.subscriptions.add(this.lecturePeriodSection().periodSectionDatepickers().forEach(e=>{e.valueChange.subscribe(()=>{this.updateIsChangesMadeToTitleOrPeriodSection()})})))}),z(()=>{this.updateFormStatusBar()}),z(function(){this.unitSection()&&this.isNewlyCreatedExercise&&(this.isNewlyCreatedExercise=!1,this.formStatusBar()?.scrollToHeadline("artemisApp.lecture.sections.period"))}.bind(this))}ngOnInit(){this.isSaving=!1,this.processUnitMode=!1,this.isProcessing=!1,this.activatedRoute.parent.data.subscribe(e=>{let n=e.lecture;this.lecture.set(n??new Q);let i=e.course;i&&(this.lecture().course=i)}),this.isEditMode.set(!this.router.url.endsWith("/new")),this.lectureOnInit=me(this.lecture()),this.courseTitle.set(this.lecture().course?.title??"")}ngOnDestroy(){this.subscriptions.unsubscribe()}updateFormStatusBar(){let e=[];e.push({title:"artemisApp.lecture.sections.title",valid:!!this.titleSection().titleChannelNameComponent().isFormValidSignal()},{title:"artemisApp.lecture.sections.period",valid:!!this.lecturePeriodSection().isPeriodSectionValid()}),this.isEditMode()&&e.push({title:"artemisApp.lecture.sections.attachments",valid:!!this.attachmentsSection()?.isFormValid()},{title:"artemisApp.lecture.sections.units",valid:!!this.unitSection()?.isUnitConfigurationValid()}),this.formStatusSections=e}isChangeMadeToTitleSection(){return this.lecture().title!==this.lectureOnInit.title||this.lecture().channelName!==this.lectureOnInit.channelName||(this.lecture().description??"")!==(this.lectureOnInit.description??"")}isChangeMadeToPeriodSection(){let{visibleDate:e,startDate:n,endDate:i}=this.lecture(),{visibleDate:c,startDate:l,endDate:y}=this.lectureOnInit,w=A=>!I(A).isValid(),W=(A,tt)=>I(A).isSame(I(tt)),L=!c&&w(e),q=!l&&w(n),N=!y&&w(i);return!W(e,c)&&!L||!W(n,l)&&!q||!W(i,y)&&!N}updateIsChangesMadeToTitleOrPeriodSection(){this.isChangeMadeToTitleOrPeriodSection=this.isChangeMadeToTitleSection()||this.isChangeMadeToPeriodSection()}previousState(){this.shouldDisplayDismissWarning=!1,this.navigationUtilService.navigateBackWithOptional(["course-management",this.lecture().course.id.toString(),"lectures"],this.lecture().id?.toString())}save(){this.shouldDisplayDismissWarning=!1,this.isSaving=!0,this.isProcessing=!0,this.lecture().id!==void 0?this.subscribeToSaveResponse(this.lectureService.update(this.lecture())):this.subscribeToSaveResponse(this.lectureService.create(this.lecture()))}proceedToUnitSplit(){this.save()}onSelectProcessUnit(){this.processUnitMode=!this.processUnitMode}onFileChange(e){let n=e.target;if(!n.files?.length){this.fileName="";return}this.file=n.files[0],this.fileName=this.file.name}subscribeToSaveResponse(e){e.subscribe({next:n=>this.onSaveSuccess(n.body),error:n=>this.onSaveError(n)})}onSaveSuccess(e){if(this.isSaving=!1,!e.course?.id){Pe("Lecture has no course id: "+e);return}this.processUnitMode?(this.isProcessing=!1,this.alertService.success(`Lecture with title ${e.title} was successfully ${this.lecture().id!==void 0?"updated":"created"}.`),this.router.navigate(["course-management",e.course.id,"lectures",e.id,"unit-management","attachment-units","process"],{state:{file:this.file,fileName:this.fileName}})):this.isEditMode()?this.router.navigate(["course-management",e.course.id,"lectures",e.id]):(this.isNewlyCreatedExercise=!0,this.isEditMode.set(!0),this.lectureOnInit=me(e),this.lecture.set(e),this.updateIsChangesMadeToTitleOrPeriodSection(),window.history.replaceState({},"",`course-management/${e.course.id}/lectures/${e.id}/edit`),this.shouldDisplayDismissWarning=!0)}onSaveError(e){this.isSaving=!1,e.error&&e.error.title?this.alertService.addErrorAlert(e.error.title,e.error.message,e.error.params):k(this.alertService,e)}onDatesValuesChanged(){let e=this.lecture().startDate,n=this.lecture().endDate,i=this.lecture().visibleDate;n&&e?.isAfter(n)&&(this.lecture().endDate=e.clone()),i&&e?.isBefore(i)&&(this.lecture().visibleDate=e.clone())}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=O({type:r,selectors:[["jhi-lecture-update"]],viewQuery:function(n,i){n&1&&(x(i.titleSection,se,5),x(i.lecturePeriodSection,ce,5),x(i.attachmentsSection,ae,5),x(i.unitSection,le,5),x(i.formStatusBar,oe,5)),n&2&&V(5)},inputs:{courseTitle:[1,"courseTitle"]},outputs:{courseTitle:"courseTitleChange"},decls:66,vars:16,consts:[["editForm","ngForm"],[1,"row","justify-content-center"],[1,"col-md-8"],["name","editForm","role","form",3,"ngSubmit"],[1,"d-flex"],[1,"flex-grow-1"],[1,"d-flex","align-items-center"],["id","jhi-lecture-heading",3,"jhiTranslate"],[3,"type"],[3,"formStatusSections"],["id","artemisApp.lecture.sections.title"],["jhiTranslate","artemisApp.lecture.sections.title"],["jhiTranslate","artemisApp.lecture.sections.titleDescription"],[3,"lecture"],[3,"lecture","validateDatesFunction"],[1,"flex-grow-1","d-flex","justify-content-end"],["type","button","id","cancel-save",1,"btn","btn-secondary",3,"click"],[1,"me-1",3,"icon"],["jhiTranslate","entity.action.cancel"],["type","submit","id","save-entity",1,"btn","btn-primary","ms-2",3,"disabled"],["jhiTranslate","entity.action.save"],[1,"form-group"],["jhiTranslate","artemisApp.lecture.course","for","field_course",1,"form-control-label"],["id","field_course","disabled","","type","text","name","course",1,"form-control",3,"ngModelChange","ngModel"],["id","field_description",1,"form-group"],["jhiTranslate","artemisApp.lecture.description","for","field_description",1,"form-control-label"],[1,"markdown-editor",3,"markdownChange","domainActions","markdown"],["id","artemisApp.lecture.sections.attachments"],["jhiTranslate","artemisApp.lecture.sections.attachments"],["id","artemisApp.lecture.sections.attachmentsDescription"],["jhiTranslate","artemisApp.lecture.sections.attachmentsDescription"],[3,"lectureId","showHeader"],[1,"mt-3"],[1,"py-2"],["type","checkbox","name","processUnit",1,"form-check-input",3,"change","disabled"],["jhiTranslate","artemisApp.attachmentUnit.createAttachmentUnits.processAutomatically",1,"px-1"],[3,"icon","ngbTooltip"],[1,"alert","alert-warning","mt-3"],[1,"informative-text"],["jhiTranslate","artemisApp.attachmentUnit.createAttachmentUnits.informativeText.firstLine"],["jhiTranslate","artemisApp.attachmentUnit.createAttachmentUnits.informativeText.secondLine"],["jhiTranslate","artemisApp.attachmentUnit.createAttachmentUnits.informativeText.note"],["id","fileHelp","jhiTranslate","artemisApp.attachmentUnit.createAttachmentUnit.fileLimitation",1,"form-text","text-body-secondary"],[1,"input-group","background-file"],[1,"custom-file","overflow-ellipsis"],["id","fileInput","type","file","aria-describedby","fileHelp",1,"custom-file-input","file-input-margin",3,"change","click","accept","placeholder"],["jhiTranslate","artemisApp.attachmentUnit.createAttachmentUnit.fileRequiredValidationError",1,"alert","alert-danger"],[1,"flex-grow-1","ms-3"],[1,"process-units-button"],["type","button","id","process-units-entity",1,"btn","btn-success",3,"click","disabled"],["jhiTranslate","artemisApp.attachmentUnit.createAttachmentUnits.processUnits"],[1,"spinner-border","spinner-border-sm"]],template:function(n,i){if(n&1){let c=g();o(0,"div",1),t(1,`
    `),o(2,"div",2),t(3,`
        `),o(4,"form",3,0),f("ngSubmit",function(){return p(c),h(i.save())}),t(6,`
            `),o(7,"div",4),t(8,`
                `),o(9,"div",5),t(10,`
                    `),o(11,"div",6),t(12,`
                        `),m(13,"h2",7),t(14,`
                        `),m(15,"jhi-documentation-button",8),t(16,`
                    `),a(),t(17,`
                `),a(),t(18,`
            `),a(),t(19,`
            `),m(20,"jhi-form-status-bar",9),t(21,`
            `),o(22,"div"),t(23,`
                `),o(24,"div"),t(25,`
                    `),o(26,"h3",10),m(27,"span",11),a(),t(28,`
                    `),o(29,"p"),m(30,"span",12),a(),t(31,`
                    `),T(32,dt,11,1),m(33,"jhi-lecture-title-channel-name",13),t(34,`
                    `),T(35,ut,8,2),a(),t(36,`
                `),m(37,"jhi-lecture-update-period",14),t(38,`
                `),o(39,"div",15),t(40,`
                    `),o(41,"button",16),f("click",function(){return p(c),h(i.previousState())}),t(42,`
                        `),m(43,"fa-icon",17)(44,"span",18),t(45,`
                    `),a(),t(46,`
                    `),o(47,"button",19),t(48,`
                        `),m(49,"fa-icon",17)(50,"span",20),t(51,`
                    `),a(),t(52,`
                `),a(),t(53,`
                `),T(54,pt,14,2),a(),t(55,`
            `),T(56,ht,16,6)(57,ft,13,0)(58,Ct,23,15),o(59,"div",4),t(60,`
                `),T(61,xt,14,3),a(),t(62,`
        `),a(),t(63,`
    `),a(),t(64,`
`),a(),t(65,`
`)}if(n&2){let c=H(5);s(13),u("jhiTranslate",i.isEditMode()?"artemisApp.lecture.home.editLabel":"artemisApp.lecture.home.createLabel"),s(2),u("type",i.documentationType),s(5),u("formStatusSections",i.formStatusSections),s(12),_(i.courseTitle()?32:-1),s(),u("lecture",i.lecture()),s(2),_(i.lecture()?35:-1),s(2),u("lecture",i.lecture())("validateDatesFunction",i.onDatesValuesChanged),s(6),u("icon",i.faBan),s(4),u("disabled",c.form.invalid||i.isSaving||i.processUnitMode||!i.isChangeMadeToTitleOrPeriodSection||!i.areSectionsValid()),s(2),u("icon",i.faSave),s(5),_(i.isEditMode()?54:-1),s(2),_(i.isEditMode()?56:-1),s(),_(i.processUnitMode?57:-1),s(),_(i.processUnitMode?58:-1),s(3),_(i.processUnitMode?61:-1)}},dependencies:[K,be,Ee,G,we,J,Le,B,ke,oe,se,Qe,ce,je,ae,le,Fe,Z],styles:[".markdown-editor[_ngcontent-%COMP%]{height:350px}.guided-mode-button[_ngcontent-%COMP%], .process-units-button[_ngcontent-%COMP%]{float:right}"]})}return r})();export{ki as LectureUpdateComponent};
//# sourceMappingURL=lecture-update.component-2MLEYQBQ.js.map
